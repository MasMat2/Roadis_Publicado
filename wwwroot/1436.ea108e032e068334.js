"use strict";(self.webpackChunkroadis_app=self.webpackChunkroadis_app||[]).push([[1436],{71436:(vh,Ns,qr)=>{qr.d(Ns,{a:()=>ct});var Se=qr(36895),Xt=qr(24006),me=qr(62861),Je=qr(88796),Ve=qr(63172),ht=qr(41138),$e=qr(94650);class ct{static#e=this.\u0275fac=function(mi){return new(mi||ct)};static#t=this.\u0275mod=$e.oAB({type:ct});static#r=this.\u0275inj=$e.cJS({providers:[ht.g,me.Q],imports:[Se.ez,Je.A0,Xt.u5,Ve.sF]})}},41138:(vh,Ns,qr)=>{qr.d(Ns,{g:()=>me});var Se=qr(80574),Xt=qr(94650);class me{constructor(){this.lstGridPageSize=new Array,this.lstGridPageSize[0]={id:0,cant:5},this.lstGridPageSize[1]={id:1,cant:10},this.lstGridPageSize[2]={id:2,cant:25},this.lstGridPageSize[3]={id:3,cant:50},this.lstGridPageSize[4]={id:4,cant:100}}cargarListaPaginado(){return this.lstGridPageSize}getDefault(){return this.lstGridPageSize[1].id}download(Ve,ht,$e,ct,Fr){const cr=Se.P6.json_to_sheet([ct],{skipHeader:!0});Se.P6.sheet_add_json(cr,ht,{skipHeader:!0,origin:"A2"}),cr["!cols"]=Fr;const mi=Se.P6.book_new();Se.P6.book_append_sheet(mi,cr,"Sheet1");Ve&&Ve.fileName&&Ve.fileName.length;const Pr=new Date,Tn=Pr.getFullYear()+("0"+(Pr.getMonth()+1)).slice(-2)+("0"+Pr.getDate()).slice(-2)+"_"+Ve.fileName+"."+$e;(0,Se.NC)(mi,Tn)}b64toBlob(Ve,ht){const ct=atob(Ve),Fr=[];for(let mi=0;mi<ct.length;mi+=512){const yo=ct.slice(mi,mi+512),Pr=new Array(yo.length);for(let Un=0;Un<yo.length;Un++)Pr[Un]=yo.charCodeAt(Un);const Tn=new Uint8Array(Pr);Fr.push(Tn)}return new Blob(Fr,{type:ht})}getHeadersOfChildren(Ve){const ht={};for(let $e=0;$e<Ve.length;$e++)""!==Ve[$e].field&&!Ve[$e].hide&&(ht[Ve[$e].field]=Ve[$e].headerName);return ht}getHeadersOfChildrenWithHidden(Ve){let ht={};for(let $e=0;$e<Ve.length;$e++)""!==Ve[$e].field&&(ht[Ve[$e].field]=Ve[$e].headerName);return ht}getFormats(Ve){const ht={};for(let $e=0;$e<Ve.length;$e++)""!==Ve[$e].field&&!Ve[$e].hide&&(void 0!==Ve[$e].valueGetter||void 0!==Ve[$e].cellRenderer?ht[Ve[$e].field]=Ve[$e].valueGetter:void 0!==Ve[$e].valueFormatter?ht[Ve[$e].field]=Ve[$e].valueFormatter:ht[Ve[$e].field]=void 0);return ht}getFormatsWithHidden(Ve){let ht={};for(let $e=0;$e<Ve.length;$e++)""!=Ve[$e].field&&(null!=Ve[$e].valueGetter?ht[Ve[$e].field]=Ve[$e].valueGetter:null!=Ve[$e].cellRenderer?ht[Ve[$e].field]=Ve[$e].cellRenderer:ht[Ve[$e].field]=void 0);return ht}getHeaderSizes(Ve){const ht=[];for(const $e in Ve){const ct={wch:Ve[$e].length};ht.push(ct)}return ht}getContentFileFromData(Ve,ht){const $e=[];for(let ct=0;ct<ht.length;ct++){const Fr={};for(const cr in Ve)if(void 0!==Ve[cr])if("valueGetter"===Ve[cr].name)ht[ct].node={id:ct},Fr[cr]=Ve[cr](ht[ct]);else{const mi={value:this.getValue(cr,ht[ct].data)};"function"==typeof Ve[cr]&&(Fr[cr]=Ve[cr](mi))}else Fr[cr]=this.getValue(cr,ht[ct].data);$e.push(Fr)}return $e}getValue(Ve,ht){const $e=Ve.split(".");let ct=ht;return $e.forEach(Fr=>{ct=null!==ct[Fr]?ct[Fr]:""}),ct}static#e=this.\u0275fac=function(ht){return new(ht||me)};static#t=this.\u0275prov=Xt.Yz7({token:me,factory:me.\u0275fac})}},63172:(vh,Ns,qr)=>{qr.d(Ns,{N8:()=>Xa,sF:()=>Uo});var Se=qr(94650);function Xt(o){return null==o||""===o?null:o}function me(o,t){return void 0===t&&(t=!1),null!=o&&(""!==o||t)}function Je(o){return!me(o)}function Ve(o){return null==o||0===o.length}function ht(o){return null!=o&&"function"==typeof o.toString?o.toString():null}function $e(o){if(void 0!==o){if(null===o||""===o)return null;if("number"==typeof o)return isNaN(o)?void 0:o;var t=parseInt(o,10);return isNaN(t)?void 0:t}}function ct(o){if(void 0!==o)return null!==o&&""!==o&&("boolean"==typeof o?o:/true/i.test(o))}function Pr(o){if(o instanceof Set||o instanceof Map){var t=[];return o.forEach(function(e){return t.push(e)}),t}return Object.values(o)}var Tn=Object.freeze({__proto__:null,makeNull:Xt,exists:me,missing:Je,missingOrEmpty:Ve,toStringOrNull:ht,attrToNumber:$e,attrToBoolean:ct,attrToString:function Fr(o){if(null!=o&&""!==o)return o},referenceCompare:function cr(o,t){return null==o&&null==t||!(null==o&&null!=t||null!=o&&null==t)&&o===t},jsonEquals:function mi(o,t){return(o?JSON.stringify(o):null)===(t?JSON.stringify(t):null)},defaultComparator:function yo(o,t,e){void 0===e&&(e=!1);var r=null==o,i=null==t;if(o&&o.toNumber&&(o=o.toNumber()),t&&t.toNumber&&(t=t.toNumber()),r&&i)return 0;if(r)return-1;if(i)return 1;function n(u,c){return u>c?1:u<c?-1:0}if("string"!=typeof o||!e)return n(o,t);try{return o.localeCompare(t)}catch{return n(o,t)}},values:Pr}),Un=function(){function o(){this.existingKeys={}}return o.prototype.addExistingKeys=function(t){for(var e=0;e<t.length;e++)this.existingKeys[t[e]]=!0},o.prototype.getUniqueKey=function(t,e){t=ht(t);for(var r=0;;){var i=void 0;if(t?(i=t,0!==r&&(i+="_"+r)):e?(i=e,0!==r&&(i+="_"+r)):i=""+r,!this.existingKeys[i])return this.existingKeys[i]=!0,i;r++}},o}();function Xe(o,t){null!=o&&(Array.isArray(o)?o.forEach(function(e,r){return t(""+r,e)}):Object.keys(o).forEach(function(e){return t(e,o[e])}))}function Tf(o){for(var t={},e=Object.keys(o),r=0;r<e.length;r++){var i=e[r],n=o[i];t[i]=n}return t}function jn(o,t){if(o){var e=o,r={};return Object.keys(e).forEach(function(i){if(!(t&&t.indexOf(i)>=0)){var n=e[i],u=fr(n)&&n.constructor===Object;r[i]=u?jn(n):n}}),r}}function On(o,t){return o[t]}function Yo(o,t,e){o[t]=e}function St(o,t,e,r){var i=On(o,e);void 0!==i&&Yo(t,e,r?r(i):i)}function en(o){var t={};return o.filter(function(e){return null!=e}).forEach(function(e){Object.keys(e).forEach(function(r){return t[r]=null})}),Object.keys(t)}function Ir(o){if(!o)return[];var t=Object;if("function"==typeof t.values)return t.values(o);var e=[];for(var r in o)o.hasOwnProperty(r)&&o.propertyIsEnumerable(r)&&e.push(o[r]);return e}function Qr(o,t,e,r){void 0===e&&(e=!0),void 0===r&&(r=!1),me(t)&&Xe(t,function(i,n){var u=o[i];if(u!==n){if(r)if(null==u&&null!=n)"object"==typeof n&&n.constructor===Object&&(u={},o[i]=u);fr(n)&&fr(u)&&!Array.isArray(u)?Qr(u,n,e,r):(e||void 0!==n)&&(o[i]=n)}})}function Za(o,t,e){if(t&&o){if(!e)return o[t];for(var r=t.split("."),i=o,n=0;n<r.length;n++){if(null==i)return;i=i[r[n]]}return i}}function el(o,t){Object.keys(o).forEach(function(i){"object"==typeof o[i]&&(o[i]=void 0)});var e=Object.getPrototypeOf(o),r={};Object.keys(e).forEach(function(i){if("function"==typeof e[i]){r[i]={value:function(){console.warn("AG Grid: "+t+" function "+i+"() cannot be called as the grid has been destroyed.\n                     Please don't call grid API functions on destroyed grids - as a matter of fact you shouldn't\n                     be keeping the API reference, your application has a memory leak! Remove the API reference\n                     when the grid is destroyed.")},writable:!0}}}),Object.defineProperties(o,r)}function fr(o){return"object"==typeof o&&null!==o}var gh=Object.freeze({__proto__:null,iterateObject:Xe,cloneObject:Tf,deepCloneObject:function or(o){return JSON.parse(JSON.stringify(o))},deepCloneDefinition:jn,getProperty:On,setProperty:Yo,copyPropertiesIfPresent:function yi(o,t){for(var e=[],r=2;r<arguments.length;r++)e[r-2]=arguments[r];e.forEach(function(i){return St(o,t,i)})},copyPropertyIfPresent:St,getAllKeysInObjects:en,getAllValuesInObject:Ir,mergeDeep:Qr,missingOrEmptyObject:function Ci(o){return Je(o)||0===Object.keys(o).length},get:function ks(o,t,e){if(null==o)return e;for(var r=t.split("."),i=o;r.length>1;)if(null==(i=i[r.shift()]))return e;return i[r[0]]??e},set:function zn(o,t,e){if(null!=o){var r=t.split("."),i=o;r.forEach(function(n,u){i[n]||(i[n]={}),u<r.length-1&&(i=i[n])}),i[r[r.length-1]]=e}},getValueUsingField:Za,removeAllReferences:el,isNonNullObject:fr}),Lr={};function _t(o,t){Lr[t]||(o(),Lr[t]=!0)}function An(o){if(o.name)return o.name;var t=/function\s+([^\(]+)/.exec(o.toString());return t&&2===t.length?t[1].trim():null}function si(o){return!!(o&&o.constructor&&o.call&&o.apply)}function tl(o){bu(o,400)}var Xo=[],Au=!1;function Du(o){Xo.push(o),!Au&&(Au=!0,window.setTimeout(function(){var t=Xo.slice();Xo.length=0,Au=!1,t.forEach(function(e){return e()})},0))}function bu(o,t){void 0===t&&(t=0),o.length>0&&window.setTimeout(function(){return o.forEach(function(e){return e()})},t)}function Jr(o,t){var e;return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var n=this;window.clearTimeout(e),e=window.setTimeout(function(){o.apply(n,r)},t)}}function qo(o,t){var e=0;return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var u=(new Date).getTime();u-e<t||(e=u,o.apply(this,r))}}function Fu(o,t,e,r){void 0===e&&(e=100);var i=(new Date).getTime(),n=null,u=!1,c=function(){var v=(new Date).getTime()-i>e;(o()||v)&&(t(),u=!0,null!=n&&(window.clearInterval(n),n=null),v&&r&&console.warn(r))};c(),u||(n=window.setInterval(c,10))}function Of(o){o&&o()}var Af=Object.freeze({__proto__:null,doOnce:_t,getFunctionName:An,isFunction:si,executeInAWhile:tl,executeNextVMTurn:Du,executeAfter:bu,debounce:Jr,throttle:qo,waitUntil:Fu,compose:function Pu(){for(var o=[],t=0;t<arguments.length;t++)o[t]=arguments[t];return function(e){return o.reduce(function(r,i){return i(r)},e)}},callIfPresent:Of,noop:function(){}}),mh=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},Kn=function(){function o(t,e){if(this.beanWrappers={},this.destroyed=!1,t&&t.beanClasses){this.contextParams=t,this.logger=e,this.logger.log(">> creating ag-Application Context"),this.createBeans();var r=this.getBeanInstances();this.wireBeans(r),this.logger.log(">> ag-Application Context ready - component is alive")}}return o.prototype.getBeanInstances=function(){return Pr(this.beanWrappers).map(function(t){return t.beanInstance})},o.prototype.createBean=function(t,e){if(!t)throw Error("Can't wire to bean since it is null");return this.wireBeans([t],e),t},o.prototype.wireBeans=function(t,e){this.autoWireBeans(t),this.methodWireBeans(t),this.callLifeCycleMethods(t,"preConstructMethods"),me(e)&&t.forEach(e),this.callLifeCycleMethods(t,"postConstructMethods")},o.prototype.createBeans=function(){var t=this;this.contextParams.beanClasses.forEach(this.createBeanWrapper.bind(this)),Xe(this.beanWrappers,function(r,i){var n;i.bean.__agBeanMetaData&&i.bean.__agBeanMetaData.autowireMethods&&i.bean.__agBeanMetaData.autowireMethods.agConstructor&&(n=i.bean.__agBeanMetaData.autowireMethods.agConstructor);var u=t.getBeansForParameters(n,i.bean.name),c=new(i.bean.bind.apply(i.bean,function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(mh(arguments[t]));return o}([null],u)));i.beanInstance=c});var e=Object.keys(this.beanWrappers).join(", ");this.logger.log("created beans: "+e)},o.prototype.createBeanWrapper=function(t){var e=t.__agBeanMetaData;if(!e){var r=void 0;return r=t.prototype.constructor?An(t.prototype.constructor):""+t,void console.error("Context item "+r+" is not a bean")}var i={bean:t,beanInstance:null,beanName:e.beanName};this.beanWrappers[e.beanName]=i},o.prototype.autoWireBeans=function(t){var e=this;t.forEach(function(r){e.forEachMetaDataInHierarchy(r,function(i,n){var u=i.agClassAttributes;u&&u.forEach(function(c){var v=e.lookupBeanInstance(n,c.beanName,c.optional);r[c.attributeName]=v})})})},o.prototype.methodWireBeans=function(t){var e=this;t.forEach(function(r){e.forEachMetaDataInHierarchy(r,function(i,n){Xe(i.autowireMethods,function(u,c){if("agConstructor"!==u){var v=e.getBeansForParameters(c,n);r[u].apply(r,v)}})})})},o.prototype.forEachMetaDataInHierarchy=function(t,e){for(var r=Object.getPrototypeOf(t);null!=r;){var i=r.constructor;if(i.hasOwnProperty("__agBeanMetaData"))e(i.__agBeanMetaData,this.getBeanName(i));r=Object.getPrototypeOf(r)}},o.prototype.getBeanName=function(t){if(t.__agBeanMetaData&&t.__agBeanMetaData.beanName)return t.__agBeanMetaData.beanName;var e=t.toString();return e.substring(9,e.indexOf("("))},o.prototype.getBeansForParameters=function(t,e){var r=this,i=[];return t&&Xe(t,function(n,u){var c=r.lookupBeanInstance(e,u);i[Number(n)]=c}),i},o.prototype.lookupBeanInstance=function(t,e,r){if(void 0===r&&(r=!1),"context"===e)return this;if(this.contextParams.providedBeanInstances&&this.contextParams.providedBeanInstances.hasOwnProperty(e))return this.contextParams.providedBeanInstances[e];var i=this.beanWrappers[e];return i?i.beanInstance:(r||console.error("AG Grid: unable to find bean reference "+e+" while initialising "+t),null)},o.prototype.callLifeCycleMethods=function(t,e){var r=this;t.forEach(function(i){return r.callLifeCycleMethodsOnBean(i,e)})},o.prototype.callLifeCycleMethodsOnBean=function(t,e,r){var i={};this.forEachMetaDataInHierarchy(t,function(u){var c=u[e];c&&c.forEach(function(v){v!=r&&(i[v]=!0)})}),Object.keys(i).forEach(function(u){return t[u]()})},o.prototype.getBean=function(t){return this.lookupBeanInstance("getBean",t,!0)},o.prototype.destroy=function(){if(!this.destroyed){this.logger.log(">> Shutting down ag-Application Context");var t=this.getBeanInstances();this.destroyBeans(t),this.contextParams.providedBeanInstances=null,this.destroyed=!0,this.logger.log(">> ag-Application Context shut down - component is dead")}},o.prototype.destroyBean=function(t){t&&this.destroyBeans([t])},o.prototype.destroyBeans=function(t){var e=this;return t?(t.forEach(function(r){e.callLifeCycleMethodsOnBean(r,"preDestroyMethods","destroy");var i=r;"function"==typeof i.destroy&&i.destroy()}),[]):[]},o}();function Iu(o,t,e){var r=Hi(o.constructor);r.preConstructMethods||(r.preConstructMethods=[]),r.preConstructMethods.push(t)}function Re(o,t,e){var r=Hi(o.constructor);r.postConstructMethods||(r.postConstructMethods=[]),r.postConstructMethods.push(t)}function Mr(o,t,e){var r=Hi(o.constructor);r.preDestroyMethods||(r.preDestroyMethods=[]),r.preDestroyMethods.push(t)}function He(o){return function(t){Hi(t).beanName=o}}function D(o){return function(t,e,r){Df(t,o,!1,t,e,null)}}function Ft(o){return function(t,e,r){Df(t,o,!0,t,e,null)}}function Df(o,t,e,r,i,n){if(null!==t)if("number"!=typeof n){var u=Hi(o.constructor);u.agClassAttributes||(u.agClassAttributes=[]),u.agClassAttributes.push({attributeName:i,beanName:t,optional:e})}else console.error("AG Grid: Autowired should be on an attribute");else console.error("AG Grid: Autowired name should not be null")}function Zr(o){return function(t,e,r){var n,i="function"==typeof t?t:t.constructor;if("number"==typeof r){var u=void 0;e?(n=Hi(i),u=e):(n=Hi(i),u="agConstructor"),n.autowireMethods||(n.autowireMethods={}),n.autowireMethods[u]||(n.autowireMethods[u]={}),n.autowireMethods[u][r]=o}}}function Hi(o){return o.hasOwnProperty("__agBeanMetaData")||(o.__agBeanMetaData={}),o.__agBeanMetaData}var Ne,o,$n=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},il=function(o,t){return function(e,r){t(e,r,o)}},Yn=function(){function o(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}return o.prototype.setBeans=function(t,e,r,i){if(void 0===i&&(i=null),this.frameworkOverrides=r,this.gridOptionsService=e,i){var n=e.useAsyncEvents();this.addGlobalListener(i,n)}},o.prototype.getListeners=function(t,e,r){var i=e?this.allAsyncListeners:this.allSyncListeners,n=i.get(t);return!n&&r&&(n=new Set,i.set(t,n)),n},o.prototype.noRegisteredListenersExist=function(){return 0===this.allSyncListeners.size&&0===this.allAsyncListeners.size&&0===this.globalSyncListeners.size&&0===this.globalAsyncListeners.size},o.prototype.addEventListener=function(t,e,r){void 0===r&&(r=!1),this.getListeners(t,r,!0).add(e)},o.prototype.removeEventListener=function(t,e,r){void 0===r&&(r=!1);var i=this.getListeners(t,r,!1);i&&(i.delete(e),0===i.size)&&(r?this.allAsyncListeners:this.allSyncListeners).delete(t)},o.prototype.addGlobalListener=function(t,e){void 0===e&&(e=!1),(e?this.globalAsyncListeners:this.globalSyncListeners).add(t)},o.prototype.removeGlobalListener=function(t,e){void 0===e&&(e=!1),(e?this.globalAsyncListeners:this.globalSyncListeners).delete(t)},o.prototype.dispatchEvent=function(t){var e=t;if(this.gridOptionsService){var r=this.gridOptionsService,i=r.api,n=r.columnApi,u=r.context;e.api=i,e.columnApi=n,e.context=u}this.dispatchToListeners(e,!0),this.dispatchToListeners(e,!1),this.firedEvents[e.type]=!0},o.prototype.dispatchEventOnce=function(t){this.firedEvents[t.type]||this.dispatchEvent(t)},o.prototype.dispatchToListeners=function(t,e){var r=this,i=t.type;if(e&&"event"in t){var n=t.event;n instanceof Event&&(t.eventPath=n.composedPath())}var c=this.getListeners(i,e,!1);c&&c.forEach(function(C){e?r.dispatchAsync(function(){return C(t)}):C(t)}),(e?this.globalAsyncListeners:this.globalSyncListeners).forEach(function(m){e?r.dispatchAsync(function(){return r.frameworkOverrides.dispatchEvent(i,function(){return m(i,t)},!0)}):r.frameworkOverrides.dispatchEvent(i,function(){return m(i,t)},!0)})},o.prototype.dispatchAsync=function(t){this.asyncFunctionsQueue.push(t),this.scheduled||(window.setTimeout(this.flushAsyncQueue.bind(this),0),this.scheduled=!0)},o.prototype.flushAsyncQueue=function(){this.scheduled=!1;var t=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],t.forEach(function(e){return e()})},$n([il(0,Zr("loggerFactory")),il(1,Zr("gridOptionsService")),il(2,Zr("frameworkOverrides")),il(3,Zr("globalEventListener"))],o.prototype,"setBeans",null),o=$n([He("eventService")],o)}();(o=Ne||(Ne={})).CommunityCoreModule="@ag-grid-community/core",o.InfiniteRowModelModule="@ag-grid-community/infinite-row-model",o.ClientSideRowModelModule="@ag-grid-community/client-side-row-model",o.CsvExportModule="@ag-grid-community/csv-export",o.EnterpriseCoreModule="@ag-grid-enterprise/core",o.RowGroupingModule="@ag-grid-enterprise/row-grouping",o.ColumnsToolPanelModule="@ag-grid-enterprise/column-tool-panel",o.FiltersToolPanelModule="@ag-grid-enterprise/filter-tool-panel",o.MenuModule="@ag-grid-enterprise/menu",o.SetFilterModule="@ag-grid-enterprise/set-filter",o.MultiFilterModule="@ag-grid-enterprise/multi-filter",o.StatusBarModule="@ag-grid-enterprise/status-bar",o.SideBarModule="@ag-grid-enterprise/side-bar",o.RangeSelectionModule="@ag-grid-enterprise/range-selection",o.MasterDetailModule="@ag-grid-enterprise/master-detail",o.RichSelectModule="@ag-grid-enterprise/rich-select",o.GridChartsModule="@ag-grid-enterprise/charts",o.ViewportRowModelModule="@ag-grid-enterprise/viewport-row-model",o.ServerSideRowModelModule="@ag-grid-enterprise/server-side-row-model",o.ExcelExportModule="@ag-grid-enterprise/excel-export",o.ClipboardModule="@ag-grid-enterprise/clipboard",o.SparklinesModule="@ag-grid-enterprise/sparklines",o.AngularModule="@ag-grid-community/angular",o.ReactModule="@ag-grid-community/react",o.VueModule="@ag-grid-community/vue";var it=function(){function o(){}return o.register=function(t,e){void 0===e&&(e=!0),o.runVersionChecks(t),o.modulesMap[t.moduleName]=t,o.setModuleBased(e)},o.runVersionChecks=function(t){if(o.currentModuleVersion||(o.currentModuleVersion=t.version),t.version?t.version!==o.currentModuleVersion&&console.error("AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '"+t.moduleName+"' is version "+t.version+" but the other modules are version "+this.currentModuleVersion+". Please update all modules to the same version."):console.error("AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '"+t.moduleName+"' is incompatible. Please update all modules to the same version."),t.validate){var e=t.validate();if(!e.isValid){var r=e;console.error("AG Grid: "+r.message)}}},o.setModuleBased=function(t){void 0===o.moduleBased?o.moduleBased=t:o.moduleBased!==t&&_t(function(){console.warn("AG Grid: You are mixing modules (i.e. @ag-grid-community/core) and packages (ag-grid-community) - you can only use one or the other of these mechanisms."),console.warn("Please see https://www.ag-grid.com/javascript-grid/packages-modules/ for more information.")},"ModulePackageCheck")},o.setIsBundled=function(){o.isBundled=!0},o.registerModules=function(t,e){void 0===e&&(e=!0),o.setModuleBased(e),t&&t.forEach(function(r){return o.register(r,e)})},o.assertRegistered=function(t,e){var r;if(this.isRegistered(t))return!0;var n,i=e+t;if(o.isBundled)n="AG Grid: unable to use "+e+" as 'ag-grid-enterprise' has not been loaded. Check you are using the Enterprise bundle:\n        \n        <script src=\"https://cdn.jsdelivr.net/npm/ag-grid-enterprise@AG_GRID_VERSION/dist/ag-grid-enterprise.min.js\"><\/script>\n        \nFor more info see: https://ag-grid.com/javascript-data-grid/getting-started/#getting-started-with-ag-grid-enterprise";else if(o.moduleBased||void 0===o.moduleBased){var u=null===(r=Object.entries(Ne).find(function(c){var v=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n}(c,2);return v[0],v[1]===t}))||void 0===r?void 0:r[0];n="AG Grid: unable to use "+e+" as the "+u+" is not registered. Check if you have registered the module:\n           \n    import { ModuleRegistry } from '@ag-grid-community/core';\n    import { "+u+" } from '"+t+"';\n    \n    ModuleRegistry.registerModules([ "+u+" ]);\n\nFor more info see: https://www.ag-grid.com/javascript-grid/modules/"}else n="AG Grid: unable to use "+e+" as package 'ag-grid-enterprise' has not been imported. Check that you have imported the package:\n            \n    import 'ag-grid-enterprise';\n            \nFor more info see: https://www.ag-grid.com/javascript-grid/packages/";return _t(function(){console.warn(n)},i),!1},o.isRegistered=function(t){return!!o.modulesMap[t]},o.getRegisteredModules=function(){return Pr(o.modulesMap)},o.isPackageBased=function(){return!o.moduleBased},o.modulesMap={},o}(),nl=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Ff=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},yh=0;function If(){return yh++}var Kt=function(){function o(t,e,r,i){this.instanceId=If(),this.autoHeaderHeight=null,this.moving=!1,this.menuVisible=!1,this.filterActive=!1,this.eventService=new Yn,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.colDef=t,this.userProvidedColDef=e,this.colId=r,this.primary=i,this.setState(t)}return o.prototype.getInstanceId=function(){return this.instanceId},o.prototype.setState=function(t){void 0!==t.sort?("asc"===t.sort||"desc"===t.sort)&&(this.sort=t.sort):("asc"===t.initialSort||"desc"===t.initialSort)&&(this.sort=t.initialSort);var e=$e(t.sortIndex),r=$e(t.initialSortIndex);void 0!==e?null!==e&&(this.sortIndex=e):null!==r&&(this.sortIndex=r);var i=ct(t.hide),n=ct(t.initialHide);this.visible=void 0!==i?!i:!n,void 0!==t.pinned?this.setPinned(t.pinned):this.setPinned(t.initialPinned);var u=$e(t.flex),c=$e(t.initialFlex);void 0!==u?this.flex=u:void 0!==c&&(this.flex=c)},o.prototype.setColDef=function(t,e){this.colDef=t,this.userProvidedColDef=e,this.initMinAndMaxWidths(),this.initDotNotation(),this.eventService.dispatchEvent(this.createColumnEvent("colDefChanged","api"))},o.prototype.getUserProvidedColDef=function(){return this.userProvidedColDef},o.prototype.setParent=function(t){this.parent=t},o.prototype.getParent=function(){return this.parent},o.prototype.setOriginalParent=function(t){this.originalParent=t},o.prototype.getOriginalParent=function(){return this.originalParent},o.prototype.initialise=function(){this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip(),this.validate()},o.prototype.initDotNotation=function(){var t=this.gridOptionsService.is("suppressFieldDotNotation");this.fieldContainsDots=me(this.colDef.field)&&this.colDef.field.indexOf(".")>=0&&!t,this.tooltipFieldContainsDots=me(this.colDef.tooltipField)&&this.colDef.tooltipField.indexOf(".")>=0&&!t},o.prototype.initMinAndMaxWidths=function(){var t=this.colDef;this.minWidth=this.columnUtils.calculateColMinWidth(t),this.maxWidth=this.columnUtils.calculateColMaxWidth(t)},o.prototype.initTooltip=function(){this.tooltipEnabled=me(this.colDef.tooltipField)||me(this.colDef.tooltipValueGetter)||me(this.colDef.tooltipComponent)||me(this.colDef.tooltipComponentFramework)},o.prototype.resetActualWidth=function(t){void 0===t&&(t="api");var e=this.columnUtils.calculateColInitialWidth(this.colDef);this.setActualWidth(e,t,!0)},o.prototype.isEmptyGroup=function(){return!1},o.prototype.isRowGroupDisplayed=function(t){if(Je(this.colDef)||Je(this.colDef.showRowGroup))return!1;var e=!0===this.colDef.showRowGroup,r=this.colDef.showRowGroup===t;return e||r},o.prototype.isPrimary=function(){return this.primary},o.prototype.isFilterAllowed=function(){return!!this.colDef.filter||!!this.colDef.filterFramework},o.prototype.isFieldContainsDots=function(){return this.fieldContainsDots},o.prototype.isTooltipEnabled=function(){return this.tooltipEnabled},o.prototype.isTooltipFieldContainsDots=function(){return this.tooltipFieldContainsDots},o.prototype.validate=function(){var t=this.colDef;function e(m,C,_){_t(function(){_?console.warn(m,_):_t(function(){return console.warn(m)},C)},C)}if(this.gridOptionsService.isRowModelType("clientSide")&&!it.isRegistered(Ne.RowGroupingModule)){(n=["enableRowGroup","rowGroup","rowGroupIndex","enablePivot","enableValue","pivot","pivotIndex","aggFunc"].filter(function(m){return me(t[m])})).length>0&&it.assertRegistered(Ne.RowGroupingModule,n.map(function(m){return"colDef."+m}).join(", "))}if(("agRichSelect"===this.colDef.cellEditor||"agRichSelectCellEditor"===this.colDef.cellEditor)&&it.assertRegistered(Ne.RichSelectModule,this.colDef.cellEditor),this.gridOptionsService.isTreeData()){(n=["rowGroup","rowGroupIndex","pivot","pivotIndex"].filter(function(C){return me(t[C])})).length>0&&e("AG Grid: "+n.join()+" is not possible when doing tree data, your column definition should not have "+n.join(),"TreeDataCannotRowGroup")}if(me(t.menuTabs))if(Array.isArray(t.menuTabs)){var n,c=["filterMenuTab"],v=["columnsMenuTab","generalMenuTab"];(n=v.filter(function(C){return t.menuTabs.includes(C)})).length>0&&it.assertRegistered(Ne.MenuModule,"menuTab(s): "+n.map(function(C){return"'"+C+"'"}).join()),t.menuTabs.forEach(function(C){!v.includes(C)&&!c.includes(C)&&e("AG Grid: '"+C+"' is not valid for 'colDef.menuTabs'. Valid values are: "+function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(Ff(arguments[t]));return o}(c,v).map(function(_){return"'"+_+"'"}).join()+".","wrongValue_menuTabs_"+C)})}else e("AG Grid: The typeof 'colDef.menuTabs' should be an array not:"+typeof t.menuTabs,"wrongType_menuTabs");me(t.columnsMenuParams)&&it.assertRegistered(Ne.MenuModule,"columnsMenuParams"),me(t.columnsMenuParams)&&it.assertRegistered(Ne.ColumnsToolPanelModule,"columnsMenuParams"),me(this.colDef.width)&&"number"!=typeof this.colDef.width&&e("AG Grid: colDef.width should be a number, not "+typeof this.colDef.width,"ColumnCheck"),(t.pinnedRowCellRenderer||t.pinnedRowCellRendererParams||t.pinnedRowCellRendererFramework)&&e("AG Grid: pinnedRowCellRenderer[Params,Framework] no longer exist. Use cellRendererSelector if you want a different Cell Renderer for pinned rows. Check params.node.rowPinned.","colDef.pinnedRowCellRenderer-deprecated"),me(t.columnGroupShow)&&"closed"!==t.columnGroupShow&&"open"!==t.columnGroupShow&&e("AG Grid: '"+t.columnGroupShow+"' is not valid for columnGroupShow. Valid values are 'open', 'closed', undefined, null","columnGroupShow_invalid")},o.prototype.addEventListener=function(t,e){this.eventService.addEventListener(t,e)},o.prototype.removeEventListener=function(t,e){this.eventService.removeEventListener(t,e)},o.prototype.createColumnFunctionCallbackParams=function(t){return{node:t,data:t.data,column:this,colDef:this.colDef,context:this.gridOptionsService.context,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi}},o.prototype.isSuppressNavigable=function(t){if("boolean"==typeof this.colDef.suppressNavigable)return this.colDef.suppressNavigable;if("function"==typeof this.colDef.suppressNavigable){var e=this.createColumnFunctionCallbackParams(t);return(0,this.colDef.suppressNavigable)(e)}return!1},o.prototype.isCellEditable=function(t){return!(t.group&&!this.gridOptionsService.is("enableGroupEdit"))&&this.isColumnFunc(t,this.colDef.editable)},o.prototype.isSuppressFillHandle=function(){return!!ct(this.colDef.suppressFillHandle)},o.prototype.isAutoHeight=function(){return!!ct(this.colDef.autoHeight)},o.prototype.isAutoHeaderHeight=function(){return!!ct(this.colDef.autoHeaderHeight)},o.prototype.isRowDrag=function(t){return this.isColumnFunc(t,this.colDef.rowDrag)},o.prototype.isDndSource=function(t){return this.isColumnFunc(t,this.colDef.dndSource)},o.prototype.isCellCheckboxSelection=function(t){return this.isColumnFunc(t,this.colDef.checkboxSelection)},o.prototype.isSuppressPaste=function(t){return this.isColumnFunc(t,this.colDef?this.colDef.suppressPaste:null)},o.prototype.isResizable=function(){return!!ct(this.colDef.resizable)},o.prototype.isColumnFunc=function(t,e){return"boolean"==typeof e?e:"function"==typeof e&&e(this.createColumnFunctionCallbackParams(t))},o.prototype.setMoving=function(t,e){void 0===e&&(e="api"),this.moving=t,this.eventService.dispatchEvent(this.createColumnEvent("movingChanged",e))},o.prototype.createColumnEvent=function(t,e){return{type:t,column:this,columns:[this],source:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}},o.prototype.isMoving=function(){return this.moving},o.prototype.getSort=function(){return this.sort},o.prototype.setSort=function(t,e){void 0===e&&(e="api"),this.sort!==t&&(this.sort=t,this.eventService.dispatchEvent(this.createColumnEvent("sortChanged",e)))},o.prototype.setMenuVisible=function(t,e){void 0===e&&(e="api"),this.menuVisible!==t&&(this.menuVisible=t,this.eventService.dispatchEvent(this.createColumnEvent("menuVisibleChanged",e)))},o.prototype.isMenuVisible=function(){return this.menuVisible},o.prototype.isSortAscending=function(){return"asc"===this.sort},o.prototype.isSortDescending=function(){return"desc"===this.sort},o.prototype.isSortNone=function(){return Je(this.sort)},o.prototype.isSorting=function(){return me(this.sort)},o.prototype.getSortIndex=function(){return this.sortIndex},o.prototype.setSortIndex=function(t){this.sortIndex=t},o.prototype.setAggFunc=function(t){this.aggFunc=t},o.prototype.getAggFunc=function(){return this.aggFunc},o.prototype.getLeft=function(){return this.left},o.prototype.getOldLeft=function(){return this.oldLeft},o.prototype.getRight=function(){return this.left+this.actualWidth},o.prototype.setLeft=function(t,e){void 0===e&&(e="api"),this.oldLeft=this.left,this.left!==t&&(this.left=t,this.eventService.dispatchEvent(this.createColumnEvent("leftChanged",e)))},o.prototype.isFilterActive=function(){return this.filterActive},o.prototype.setFilterActive=function(t,e,r){void 0===e&&(e="api"),this.filterActive!==t&&(this.filterActive=t,this.eventService.dispatchEvent(this.createColumnEvent("filterActiveChanged",e)));var i=this.createColumnEvent("filterChanged",e);r&&Qr(i,r),this.eventService.dispatchEvent(i)},o.prototype.isHovered=function(){return this.columnHoverService.isHovered(this)},o.prototype.setPinned=function(t){this.pinned=!0===t||"left"===t?"left":"right"===t?"right":null},o.prototype.setFirstRightPinned=function(t,e){void 0===e&&(e="api"),this.firstRightPinned!==t&&(this.firstRightPinned=t,this.eventService.dispatchEvent(this.createColumnEvent("firstRightPinnedChanged",e)))},o.prototype.setLastLeftPinned=function(t,e){void 0===e&&(e="api"),this.lastLeftPinned!==t&&(this.lastLeftPinned=t,this.eventService.dispatchEvent(this.createColumnEvent("lastLeftPinnedChanged",e)))},o.prototype.isFirstRightPinned=function(){return this.firstRightPinned},o.prototype.isLastLeftPinned=function(){return this.lastLeftPinned},o.prototype.isPinned=function(){return"left"===this.pinned||"right"===this.pinned},o.prototype.isPinnedLeft=function(){return"left"===this.pinned},o.prototype.isPinnedRight=function(){return"right"===this.pinned},o.prototype.getPinned=function(){return this.pinned},o.prototype.setVisible=function(t,e){void 0===e&&(e="api");var r=!0===t;this.visible!==r&&(this.visible=r,this.eventService.dispatchEvent(this.createColumnEvent("visibleChanged",e)))},o.prototype.isVisible=function(){return this.visible},o.prototype.isSpanHeaderHeight=function(){return!!this.getColDef().spanHeaderHeight},o.prototype.getColDef=function(){return this.colDef},o.prototype.getColumnGroupShow=function(){return this.colDef.columnGroupShow},o.prototype.getColId=function(){return this.colId},o.prototype.getId=function(){return this.colId},o.prototype.getUniqueId=function(){return this.colId},o.prototype.getDefinition=function(){return this.colDef},o.prototype.getActualWidth=function(){return this.actualWidth},o.prototype.getAutoHeaderHeight=function(){return this.autoHeaderHeight},o.prototype.setAutoHeaderHeight=function(t){var e=t!==this.autoHeaderHeight;return this.autoHeaderHeight=t,e},o.prototype.createBaseColDefParams=function(t){return{node:t,data:t.data,colDef:this.colDef,column:this,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}},o.prototype.getColSpan=function(t){if(Je(this.colDef.colSpan))return 1;var e=this.createBaseColDefParams(t),r=this.colDef.colSpan(e);return Math.max(r,1)},o.prototype.getRowSpan=function(t){if(Je(this.colDef.rowSpan))return 1;var e=this.createBaseColDefParams(t),r=this.colDef.rowSpan(e);return Math.max(r,1)},o.prototype.setActualWidth=function(t,e,r){void 0===e&&(e="api"),void 0===r&&(r=!1),null!=this.minWidth&&(t=Math.max(t,this.minWidth)),null!=this.maxWidth&&(t=Math.min(t,this.maxWidth)),this.actualWidth!==t&&(this.actualWidth=t,this.flex&&"flex"!==e&&"gridInitializing"!==e&&(this.flex=null),r||this.fireColumnWidthChangedEvent(e))},o.prototype.fireColumnWidthChangedEvent=function(t){this.eventService.dispatchEvent(this.createColumnEvent("widthChanged",t))},o.prototype.isGreaterThanMax=function(t){return null!=this.maxWidth&&t>this.maxWidth},o.prototype.getMinWidth=function(){return this.minWidth},o.prototype.getMaxWidth=function(){return this.maxWidth},o.prototype.getFlex=function(){return this.flex||0},o.prototype.setFlex=function(t){this.flex!==t&&(this.flex=t)},o.prototype.setMinimum=function(t){void 0===t&&(t="api"),me(this.minWidth)&&this.setActualWidth(this.minWidth,t)},o.prototype.setRowGroupActive=function(t,e){void 0===e&&(e="api"),this.rowGroupActive!==t&&(this.rowGroupActive=t,this.eventService.dispatchEvent(this.createColumnEvent("columnRowGroupChanged",e)))},o.prototype.isRowGroupActive=function(){return this.rowGroupActive},o.prototype.setPivotActive=function(t,e){void 0===e&&(e="api"),this.pivotActive!==t&&(this.pivotActive=t,this.eventService.dispatchEvent(this.createColumnEvent("columnPivotChanged",e)))},o.prototype.isPivotActive=function(){return this.pivotActive},o.prototype.isAnyFunctionActive=function(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()},o.prototype.isAnyFunctionAllowed=function(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()},o.prototype.setValueActive=function(t,e){void 0===e&&(e="api"),this.aggregationActive!==t&&(this.aggregationActive=t,this.eventService.dispatchEvent(this.createColumnEvent("columnValueChanged",e)))},o.prototype.isValueActive=function(){return this.aggregationActive},o.prototype.isAllowPivot=function(){return!0===this.colDef.enablePivot},o.prototype.isAllowValue=function(){return!0===this.colDef.enableValue},o.prototype.isAllowRowGroup=function(){return!0===this.colDef.enableRowGroup},o.prototype.getMenuTabs=function(t){var e=this.getColDef().menuTabs;return null==e&&(e=t),e},o.EVENT_MOVING_CHANGED="movingChanged",o.EVENT_LEFT_CHANGED="leftChanged",o.EVENT_WIDTH_CHANGED="widthChanged",o.EVENT_LAST_LEFT_PINNED_CHANGED="lastLeftPinnedChanged",o.EVENT_FIRST_RIGHT_PINNED_CHANGED="firstRightPinnedChanged",o.EVENT_VISIBLE_CHANGED="visibleChanged",o.EVENT_FILTER_CHANGED="filterChanged",o.EVENT_FILTER_ACTIVE_CHANGED="filterActiveChanged",o.EVENT_SORT_CHANGED="sortChanged",o.EVENT_COL_DEF_CHANGED="colDefChanged",o.EVENT_MENU_VISIBLE_CHANGED="menuVisibleChanged",o.EVENT_ROW_GROUP_CHANGED="columnRowGroupChanged",o.EVENT_PIVOT_CHANGED="columnPivotChanged",o.EVENT_VALUE_CHANGED="columnValueChanged",nl([D("gridOptionsService")],o.prototype,"gridOptionsService",void 0),nl([D("columnUtils")],o.prototype,"columnUtils",void 0),nl([D("columnHoverService")],o.prototype,"columnHoverService",void 0),nl([Re],o.prototype,"initialise",null),o}(),tr=function(){function o(t,e,r,i){this.localEventService=new Yn,this.expandable=!1,this.instanceId=If(),this.expandableListenerRemoveCallback=null,this.colGroupDef=t,this.groupId=e,this.expanded=!!t&&!!t.openByDefault,this.padding=r,this.level=i}return o.prototype.destroy=function(){this.expandableListenerRemoveCallback&&this.reset(null,void 0)},o.prototype.reset=function(t,e){this.colGroupDef=t,this.level=e,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0},o.prototype.getInstanceId=function(){return this.instanceId},o.prototype.setOriginalParent=function(t){this.originalParent=t},o.prototype.getOriginalParent=function(){return this.originalParent},o.prototype.getLevel=function(){return this.level},o.prototype.isVisible=function(){return!!this.children&&this.children.some(function(t){return t.isVisible()})},o.prototype.isPadding=function(){return this.padding},o.prototype.setExpanded=function(t){this.expanded=void 0!==t&&t;var e={type:o.EVENT_EXPANDED_CHANGED};this.localEventService.dispatchEvent(e)},o.prototype.isExpandable=function(){return this.expandable},o.prototype.isExpanded=function(){return this.expanded},o.prototype.getGroupId=function(){return this.groupId},o.prototype.getId=function(){return this.getGroupId()},o.prototype.setChildren=function(t){this.children=t},o.prototype.getChildren=function(){return this.children},o.prototype.getColGroupDef=function(){return this.colGroupDef},o.prototype.getLeafColumns=function(){var t=[];return this.addLeafColumns(t),t},o.prototype.addLeafColumns=function(t){this.children&&this.children.forEach(function(e){e instanceof Kt?t.push(e):e instanceof o&&e.addLeafColumns(t)})},o.prototype.getColumnGroupShow=function(){var t=this.colGroupDef;if(t)return t.columnGroupShow},o.prototype.setupExpandable=function(){var t=this;this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();var e=this.onColumnVisibilityChanged.bind(this);this.getLeafColumns().forEach(function(r){return r.addEventListener("visibleChanged",e)}),this.expandableListenerRemoveCallback=function(){t.getLeafColumns().forEach(function(r){return r.removeEventListener("visibleChanged",e)}),t.expandableListenerRemoveCallback=null}},o.prototype.setExpandable=function(){if(!this.isPadding()){for(var t=!1,e=!1,r=!1,i=this.findChildrenRemovingPadding(),n=0,u=i.length;n<u;n++){var c=i[n];if(c.isVisible()){var v=c.getColumnGroupShow();"open"===v?(t=!0,r=!0):"closed"===v?(e=!0,r=!0):(t=!0,e=!0)}}var m=t&&e&&r;if(this.expandable!==m){this.expandable=m;var C={type:o.EVENT_EXPANDABLE_CHANGED};this.localEventService.dispatchEvent(C)}}},o.prototype.findChildrenRemovingPadding=function(){var t=[],e=function(r){r.forEach(function(i){i instanceof o&&i.isPadding()?e(i.children):t.push(i)})};return e(this.children),t},o.prototype.onColumnVisibilityChanged=function(){this.setExpandable()},o.prototype.addEventListener=function(t,e){this.localEventService.addEventListener(t,e)},o.prototype.removeEventListener=function(t,e){this.localEventService.removeEventListener(t,e)},o.EVENT_EXPANDED_CHANGED="expandedChanged",o.EVENT_EXPANDABLE_CHANGED="expandableChanged",function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);i>3&&n&&Object.defineProperty(t,e,n)}([Mr],o.prototype,"destroy",null),o}(),ei={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}};function Lu(){for(var o=[],t=0;t<arguments.length;t++)o[t]=arguments[t];for(var e=0;e<o.length;e++){var r=o[e];if(me(r))return r}return null}function Mt(o){if(o&&o.length)return o[o.length-1]}function Xn(o,t,e){return null==o&&null==t||null!=o&&null!=t&&o.length===t.length&&o.every(function(r,i){return e?e(r,t[i]):t[i]===r})}function Nf(o){return o.sort(function(t,e){return t-e})}function Nr(o,t){var e=o.indexOf(t);e>=0&&o.splice(e,1)}function Di(o,t){t.forEach(function(e){return Nr(o,e)})}function wi(o,t,e){o.splice(e,0,t)}function ol(o,t,e){Di(o,t),t.slice().reverse().forEach(function(r){return wi(o,r,e)})}function kr(o,t){return o.indexOf(t)>-1}function kf(o){return[].concat.apply([],o)}function sl(o,t){null==t||null==o||t.forEach(function(e){return o.push(e)})}var Si=Object.freeze({__proto__:null,firstExistingValue:Lu,existsAndNotEmpty:function Mf(o){return null!=o&&o.length>0},last:Mt,areEqual:Xn,shallowCompare:function Ai(o,t){return Xn(o,t)},sortNumerically:Nf,removeRepeatsFromArray:function Ch(o,t){if(o)for(var e=o.length-2;e>=0;e--){var r=o[e]===t,i=o[e+1]===t;r&&i&&o.splice(e+1,1)}},removeFromArray:Nr,removeAllFromArray:Di,insertIntoArray:wi,insertArrayIntoArray:function wh(o,t,e){if(null!=o&&null!=t)for(var r=t.length-1;r>=0;r--){wi(o,t[r],e)}},moveInArray:ol,includes:kr,flatten:kf,pushAll:sl,toStrings:function Gf(o){return o.map(ht)},forEachReverse:function Sh(o,t){if(null!=o)for(var e=o.length-1;e>=0;e--)t(o[e],e)}}),Bi="__ag_Grid_Stop_Propagation",Gs=["touchstart","touchend","touchmove","touchcancel","scroll"],qn={};function Qo(o){o[Bi]=!0}function tn(o){return!0===o[Bi]}var al=function(){var o={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return function(e){if("boolean"==typeof qn[e])return qn[e];var r=document.createElement(o[e]||"div");return qn[e="on"+e]=e in r}}();function ll(o,t,e){for(var r=t;r;){var i=o.getDomData(r,e);if(i)return i;r=r.parentElement}return null}function ul(o,t){return!(!t||!o)&&tt(t).indexOf(o)>=0}function Hf(o){for(var t=[],e=o.target;e;)t.push(e),e=e.parentElement;return t}function tt(o){var t=o;return t.path?t.path:t.composedPath?t.composedPath():Hf(t)}function Dn(o,t,e,r){var n=kr(Gs,e)?{passive:!0}:void 0;o&&o.addEventListener&&o.addEventListener(t,e,r,n)}var ZC=Object.freeze({__proto__:null,stopPropagationForAgGrid:Qo,isStopPropagationForAgGrid:tn,isEventSupported:al,getCtrlForEventTarget:ll,isElementInEventPath:ul,createEventPath:Hf,getEventPath:tt,addSafePassiveEventListener:Dn}),Co=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},we=function(){function o(){var t=this;this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.isAlive=function(){return!t.destroyed}}return o.prototype.getFrameworkOverrides=function(){return this.frameworkOverrides},o.prototype.getContext=function(){return this.context},o.prototype.destroy=function(){this.destroyFunctions.forEach(function(t){return t()}),this.destroyFunctions.length=0,this.destroyed=!0,this.dispatchEvent({type:o.EVENT_DESTROYED})},o.prototype.addEventListener=function(t,e){this.localEventService||(this.localEventService=new Yn),this.localEventService.addEventListener(t,e)},o.prototype.removeEventListener=function(t,e){this.localEventService&&this.localEventService.removeEventListener(t,e)},o.prototype.dispatchEventAsync=function(t){var e=this;window.setTimeout(function(){return e.dispatchEvent(t)},0)},o.prototype.dispatchEvent=function(t){this.localEventService&&this.localEventService.dispatchEvent(t)},o.prototype.addManagedListener=function(t,e,r){var i=this;if(!this.destroyed){t instanceof HTMLElement?Dn(this.getFrameworkOverrides(),t,e,r):t.addEventListener(e,r);var n=function(){return t.removeEventListener(e,r),i.destroyFunctions=i.destroyFunctions.filter(function(u){return u!==n}),null};return this.destroyFunctions.push(n),n}},o.prototype.addManagedPropertyListener=function(t,e){var r=this;if(!this.destroyed){this.gridOptionsService.addEventListener(t,e);var i=function(){return r.gridOptionsService.removeEventListener(t,e),r.destroyFunctions=r.destroyFunctions.filter(function(n){return n!==i}),null};return this.destroyFunctions.push(i),i}},o.prototype.addDestroyFunc=function(t){this.isAlive()?this.destroyFunctions.push(t):t()},o.prototype.createManagedBean=function(t,e){var r=this.createBean(t,e);return this.addDestroyFunc(this.destroyBean.bind(this,t,e)),r},o.prototype.createBean=function(t,e,r){return(e||this.getContext()).createBean(t,r)},o.prototype.destroyBean=function(t,e){return(e||this.getContext()).destroyBean(t)},o.prototype.destroyBeans=function(t,e){var r=this;return t&&t.forEach(function(i){return r.destroyBean(i,e)}),[]},o.EVENT_DESTROYED="destroyed",Co([D("frameworkOverrides")],o.prototype,"frameworkOverrides",void 0),Co([D("context")],o.prototype,"context",void 0),Co([D("eventService")],o.prototype,"eventService",void 0),Co([D("gridOptionsService")],o.prototype,"gridOptionsService",void 0),Co([D("localeService")],o.prototype,"localeService",void 0),Co([D("environment")],o.prototype,"environment",void 0),Co([Mr],o.prototype,"destroy",null),o}(),_h=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),qt=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Bf=function(o,t){return function(e,r){t(e,r,o)}},cl=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return _h(t,o),t.prototype.setBeans=function(e){this.logger=e.create("ColumnFactory")},t.prototype.createColumnTree=function(e,r,i){var n=new Un,u=this.extractExistingTreeData(i),c=u.existingCols,v=u.existingGroups,m=u.existingColKeys;n.addExistingKeys(m);var C=this.recursivelyCreateColumns(e,0,r,c,n,v),_=this.findMaxDept(C,0);this.logger.log("Number of levels for grouped columns is "+_);var O=this.balanceColumnTree(C,0,_,n);return this.columnUtils.depthFirstOriginalTreeSearch(null,O,function(L,z){L instanceof tr&&L.setupExpandable(),L.setOriginalParent(z)}),{columnTree:O,treeDept:_}},t.prototype.extractExistingTreeData=function(e){var r=[],i=[],n=[];return e&&this.columnUtils.depthFirstOriginalTreeSearch(null,e,function(u){if(u instanceof tr){var c=u;i.push(c)}else{var v=u;n.push(v.getId()),r.push(v)}}),{existingCols:r,existingGroups:i,existingColKeys:n}},t.prototype.createForAutoGroups=function(e,r){var i=this;return e.map(function(n){return i.createAutoGroupTreeItem(r,n)})},t.prototype.createAutoGroupTreeItem=function(e,r){for(var n=r,u=this.findDepth(e)-1;u>=0;u--){var c=new tr(null,"FAKE_PATH_"+r.getId()+"}_"+u,!0,u);this.createBean(c),c.setChildren([n]),n.setOriginalParent(c),n=c}return n},t.prototype.findDepth=function(e){for(var r=0,i=e;i&&i[0]&&i[0]instanceof tr;)r++,i=i[0].getChildren();return r},t.prototype.balanceColumnTree=function(e,r,i,n){for(var u=[],c=0;c<e.length;c++){var v=e[c];if(v instanceof tr){var m=v,C=this.balanceColumnTree(m.getChildren(),r+1,i,n);m.setChildren(C),u.push(m)}else{for(var _=void 0,O=void 0,P=i-1;P>=r;P--){var L=n.getUniqueKey(null,null),z=this.createMergedColGroupDef(null),q=new tr(z,L,!0,r);this.createBean(q),O&&O.setChildren([q]),O=q,_||(_=O)}if(_&&O){if(u.push(_),e.some(function(re){return re instanceof tr})){O.setChildren([v]);continue}O.setChildren(e);break}u.push(v)}}return u},t.prototype.findMaxDept=function(e,r){for(var i=r,n=0;n<e.length;n++){var u=e[n];if(u instanceof tr){var c=u,v=this.findMaxDept(c.getChildren(),r+1);i<v&&(i=v)}}return i},t.prototype.recursivelyCreateColumns=function(e,r,i,n,u,c){var v=this;return(e||[]).map(function(m){return v.isColumnGroup(m)?v.createColumnGroup(i,m,r,n,u,c):v.createColumn(i,m,n,u)})},t.prototype.createColumnGroup=function(e,r,i,n,u,c){var v=this.createMergedColGroupDef(r),m=u.getUniqueKey(v.groupId||null,null),C=new tr(v,m,!1,i);this.createBean(C);var _=this.findExistingGroup(r,c);_&&Nr(c,_),_&&_.isExpanded()&&C.setExpanded(!0);var O=this.recursivelyCreateColumns(v.children,i+1,e,n,u,c);return C.setChildren(O),C},t.prototype.createMergedColGroupDef=function(e){var r={};return Object.assign(r,this.gridOptionsService.get("defaultColGroupDef")),Object.assign(r,e),r},t.prototype.createColumn=function(e,r,i,n){var u=this.mergeColDefs(r),c=this.findExistingColumn(r,i);if(i&&c&&Nr(i,c),c)c.setColDef(u,r),this.applyColumnState(c,u);else{var v=n.getUniqueKey(u.colId,u.field);c=new Kt(u,r,v,e),this.context.createBean(c)}return c},t.prototype.applyColumnState=function(e,r){var i=$e(r.flex);if(void 0!==i&&e.setFlex(i),e.getFlex()<=0){var u=$e(r.width);if(null!=u)e.setActualWidth(u);else{var c=e.getActualWidth();e.setActualWidth(c)}}void 0!==r.sort&&("asc"==r.sort||"desc"==r.sort?e.setSort(r.sort):e.setSort(void 0));var v=$e(r.sortIndex);void 0!==v&&e.setSortIndex(v);var m=ct(r.hide);void 0!==m&&e.setVisible(!m),void 0!==r.pinned&&e.setPinned(r.pinned)},t.prototype.findExistingColumn=function(e,r){return(r||[]).find(function(i){var n=i.getUserProvidedColDef();if(!n)return!1;var u=null!=e.colId,c=null!=e.field;return u?i.getId()===e.colId:c?n.field===e.field:n===e})},t.prototype.findExistingGroup=function(e,r){return r.find(function(i){return!!i.getColGroupDef()&&(!!(null!=e.groupId)&&i.getId()===e.groupId)})},t.prototype.mergeColDefs=function(e){var r={},i=this.gridOptionsService.get("defaultColDef");Qr(r,i,!1,!0);var n=e.type;n||(n=i&&i.type),n&&this.assignColumnTypes(n,r),Qr(r,e,!1,!0);var u=this.gridOptionsService.get("autoGroupColumnDef"),c=this.gridOptionsService.isColumnsSortingCoupledToGroup();return e.rowGroup&&u&&c&&Qr(r,{sort:u.sort,initialSort:u.initialSort},!1,!0),r},t.prototype.assignColumnTypes=function(e,r){var i=[];if(e instanceof Array){e.some(function(v){return"string"!=typeof v})?console.warn("AG Grid: if colDef.type is supplied an array it should be of type 'string[]'"):i=e}else{if("string"!=typeof e)return void console.warn("AG Grid: colDef.type should be of type 'string' | 'string[]'");i=e.split(",")}var u=Object.assign({},ei);Xe(this.gridOptionsService.get("columnTypes")||{},function(v,m){v in u?console.warn("AG Grid: the column type '"+v+"' is a default column type and cannot be overridden."):u[v]=m}),i.forEach(function(v){var m=u[v.trim()];m?Qr(r,m,!1,!0):console.warn("AG Grid: colDef.type '"+v+"' does not correspond to defined gridOptions.columnTypes")})},t.prototype.isColumnGroup=function(e){return void 0!==e.children},qt([D("columnUtils")],t.prototype,"columnUtils",void 0),qt([Bf(0,Zr("loggerFactory"))],t.prototype,"setBeans",null),t=qt([He("columnFactory")],t)}(we),Hs=function(){function o(){}return o.ColDefPropertyMap={headerName:void 0,columnGroupShow:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentFramework:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellRendererFramework:void 0,cellEditor:void 0,cellEditorFramework:void 0,cellEditorParams:void 0,filterFramework:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentFramework:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,floatingFilterComponentFramework:void 0,tooltipComponentParams:void 0,tooltipComponentFramework:void 0,refData:void 0,columnsMenuParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressCellFlash:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,stickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressMenu:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,spanHeaderHeight:void 0},o.ALL_PROPERTIES=Object.keys(o.ColDefPropertyMap),o.FRAMEWORK_PROPERTIES=["__ob__","__v_skip","__metadata__","mappedColumnProperties","hasChildColumns","toColDef","createColDefFromGridColumn"],o}(),I=function(){function o(){}return o.EVENT_COLUMN_EVERYTHING_CHANGED="columnEverythingChanged",o.EVENT_NEW_COLUMNS_LOADED="newColumnsLoaded",o.EVENT_COLUMN_PIVOT_MODE_CHANGED="columnPivotModeChanged",o.EVENT_COLUMN_ROW_GROUP_CHANGED="columnRowGroupChanged",o.EVENT_EXPAND_COLLAPSE_ALL="expandOrCollapseAll",o.EVENT_COLUMN_PIVOT_CHANGED="columnPivotChanged",o.EVENT_GRID_COLUMNS_CHANGED="gridColumnsChanged",o.EVENT_COLUMN_VALUE_CHANGED="columnValueChanged",o.EVENT_COLUMN_MOVED="columnMoved",o.EVENT_COLUMN_VISIBLE="columnVisible",o.EVENT_COLUMN_PINNED="columnPinned",o.EVENT_COLUMN_GROUP_OPENED="columnGroupOpened",o.EVENT_COLUMN_RESIZED="columnResized",o.EVENT_DISPLAYED_COLUMNS_CHANGED="displayedColumnsChanged",o.EVENT_VIRTUAL_COLUMNS_CHANGED="virtualColumnsChanged",o.EVENT_ASYNC_TRANSACTIONS_FLUSHED="asyncTransactionsFlushed",o.EVENT_ROW_GROUP_OPENED="rowGroupOpened",o.EVENT_ROW_DATA_CHANGED="rowDataChanged",o.EVENT_ROW_DATA_UPDATED="rowDataUpdated",o.EVENT_PINNED_ROW_DATA_CHANGED="pinnedRowDataChanged",o.EVENT_RANGE_SELECTION_CHANGED="rangeSelectionChanged",o.EVENT_CHART_CREATED="chartCreated",o.EVENT_CHART_RANGE_SELECTION_CHANGED="chartRangeSelectionChanged",o.EVENT_CHART_OPTIONS_CHANGED="chartOptionsChanged",o.EVENT_CHART_DESTROYED="chartDestroyed",o.EVENT_TOOL_PANEL_VISIBLE_CHANGED="toolPanelVisibleChanged",o.EVENT_TOOL_PANEL_SIZE_CHANGED="toolPanelSizeChanged",o.EVENT_INTERNAL_TOOL_PANEL_VISIBLE_CHANGED="internalToolPanelVisibleChanged",o.EVENT_COLUMN_PANEL_ITEM_DRAG_START="columnPanelItemDragStart",o.EVENT_COLUMN_PANEL_ITEM_DRAG_END="columnPanelItemDragEnd",o.EVENT_MODEL_UPDATED="modelUpdated",o.EVENT_PASTE_START="pasteStart",o.EVENT_PASTE_END="pasteEnd",o.EVENT_FILL_START="fillStart",o.EVENT_FILL_END="fillEnd",o.EVENT_UNDO_STARTED="undoStarted",o.EVENT_UNDO_ENDED="undoEnded",o.EVENT_REDO_STARTED="redoStarted",o.EVENT_REDO_ENDED="redoEnded",o.EVENT_KEY_SHORTCUT_CHANGED_CELL_START="keyShortcutChangedCellStart",o.EVENT_KEY_SHORTCUT_CHANGED_CELL_END="keyShortcutChangedCellEnd",o.EVENT_CELL_CLICKED="cellClicked",o.EVENT_CELL_DOUBLE_CLICKED="cellDoubleClicked",o.EVENT_CELL_MOUSE_DOWN="cellMouseDown",o.EVENT_CELL_CONTEXT_MENU="cellContextMenu",o.EVENT_CELL_VALUE_CHANGED="cellValueChanged",o.EVENT_CELL_EDIT_REQUEST="cellEditRequest",o.EVENT_ROW_VALUE_CHANGED="rowValueChanged",o.EVENT_CELL_FOCUSED="cellFocused",o.EVENT_CELL_FOCUS_CLEARED="cellFocusCleared",o.EVENT_FULL_WIDTH_ROW_FOCUSED="fullWidthRowFocused",o.EVENT_ROW_SELECTED="rowSelected",o.EVENT_SELECTION_CHANGED="selectionChanged",o.EVENT_CELL_KEY_DOWN="cellKeyDown",o.EVENT_CELL_KEY_PRESS="cellKeyPress",o.EVENT_CELL_MOUSE_OVER="cellMouseOver",o.EVENT_CELL_MOUSE_OUT="cellMouseOut",o.EVENT_FILTER_CHANGED="filterChanged",o.EVENT_FILTER_MODIFIED="filterModified",o.EVENT_FILTER_OPENED="filterOpened",o.EVENT_SORT_CHANGED="sortChanged",o.EVENT_VIRTUAL_ROW_REMOVED="virtualRowRemoved",o.EVENT_ROW_CLICKED="rowClicked",o.EVENT_ROW_DOUBLE_CLICKED="rowDoubleClicked",o.EVENT_GRID_READY="gridReady",o.EVENT_GRID_SIZE_CHANGED="gridSizeChanged",o.EVENT_VIEWPORT_CHANGED="viewportChanged",o.EVENT_SCROLLBAR_WIDTH_CHANGED="scrollbarWidthChanged",o.EVENT_FIRST_DATA_RENDERED="firstDataRendered",o.EVENT_DRAG_STARTED="dragStarted",o.EVENT_DRAG_STOPPED="dragStopped",o.EVENT_CHECKBOX_CHANGED="checkboxChanged",o.EVENT_ROW_EDITING_STARTED="rowEditingStarted",o.EVENT_ROW_EDITING_STOPPED="rowEditingStopped",o.EVENT_CELL_EDITING_STARTED="cellEditingStarted",o.EVENT_CELL_EDITING_STOPPED="cellEditingStopped",o.EVENT_BODY_SCROLL="bodyScroll",o.EVENT_BODY_SCROLL_END="bodyScrollEnd",o.EVENT_HEIGHT_SCALE_CHANGED="heightScaleChanged",o.EVENT_PAGINATION_CHANGED="paginationChanged",o.EVENT_COMPONENT_STATE_CHANGED="componentStateChanged",o.EVENT_STORE_REFRESHED="storeRefreshed",o.EVENT_BODY_HEIGHT_CHANGED="bodyHeightChanged",o.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED="displayedColumnsWidthChanged",o.EVENT_SCROLL_VISIBILITY_CHANGED="scrollVisibilityChanged",o.EVENT_COLUMN_HOVER_CHANGED="columnHoverChanged",o.EVENT_FLASH_CELLS="flashCells",o.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED="paginationPixelOffsetChanged",o.EVENT_DISPLAYED_ROWS_CHANGED="displayedRowsChanged",o.EVENT_LEFT_PINNED_WIDTH_CHANGED="leftPinnedWidthChanged",o.EVENT_RIGHT_PINNED_WIDTH_CHANGED="rightPinnedWidthChanged",o.EVENT_ROW_CONTAINER_HEIGHT_CHANGED="rowContainerHeightChanged",o.EVENT_HEADER_HEIGHT_CHANGED="headerHeightChanged",o.EVENT_COLUMN_HEADER_HEIGHT_CHANGED="columnHeaderHeightChanged",o.EVENT_ROW_DRAG_ENTER="rowDragEnter",o.EVENT_ROW_DRAG_MOVE="rowDragMove",o.EVENT_ROW_DRAG_LEAVE="rowDragLeave",o.EVENT_ROW_DRAG_END="rowDragEnd",o.EVENT_GRID_STYLES_CHANGED="gridStylesChanged",o.EVENT_POPUP_TO_FRONT="popupToFront",o.EVENT_COLUMN_ROW_GROUP_CHANGE_REQUEST="columnRowGroupChangeRequest",o.EVENT_COLUMN_PIVOT_CHANGE_REQUEST="columnPivotChangeRequest",o.EVENT_COLUMN_VALUE_CHANGE_REQUEST="columnValueChangeRequest",o.EVENT_COLUMN_AGG_FUNC_CHANGE_REQUEST="columnAggFuncChangeRequest",o.EVENT_KEYBOARD_FOCUS="keyboardFocus",o.EVENT_MOUSE_FOCUS="mouseFocus",o.EVENT_STORE_UPDATED="storeUpdated",o.EVENT_FILTER_DESTROYED="filterDestroyed",o}(),fl=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},Cr=function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(fl(arguments[t]));return o},Vi=function(){function o(){}return o.STRING_PROPERTIES=["rowSelection","overlayLoadingTemplate","overlayNoRowsTemplate","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","serverSideStoreType","groupDisplayType","treeDataDisplayType","colResizeDefault"],o.OBJECT_PROPERTIES=["components","frameworkComponents","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","statusBar","sideBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef"],o.ARRAY_PROPERTIES=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass"],o.NUMBER_PROPERTIES=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDelay","cellFadeDelay","tabIndex"],o.BOOLEAN_PROPERTIES=["suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellSelection","suppressCellFocus","suppressHorizontalScroll","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupSelectsChildren","groupIncludeFooter","groupIncludeTotalFooter","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressParentsInRowNodes","suppressColumnMoveAnimation","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","suppressAsyncEvents","allowContextMenuWithControlKey","suppressContextMenu","rememberGroupStateWhenNewData","enableCellChangeFlash","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","suppressAggAtRootLevel","suppressFocusAfterRefresh","functionsPassive","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","excludeHiddenColumnsFromQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","treeData","masterDetail","suppressMultiRangeSelection","enterMovesDownAfterEdit","enterMovesDown","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","enableChartToolPanelsButton","suppressChartToolPanelsButton","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","immutableData","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideFilteringAlwaysResets","serverSideSortingAlwaysResets","serverSideSortAllLevels","serverSideFilterAllLevels","serverSideSortOnServer","serverSideFilterOnServer","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","maintainColumnOrder","groupMaintainOrder","columnHoverHighlight","reactUi","suppressReactUi","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","groupRowsSticky","suppressServerSideInfiniteScroll","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","suppressCutToClipboard"],o.FUNCTIONAL_PROPERTIES=["localeTextFunc","doesExternalFilterPass","groupRowAggNodes","isFullWidthCell","processSecondaryColDef","processSecondaryColGroupDef","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","postSort","defaultGroupOrderComparator","rowDragText","groupRowRenderer","groupRowRendererFramework","fullWidthCellRenderer","fullWidthCellRendererFramework","loadingCellRenderer","loadingCellRendererFramework","loadingOverlayComponent","loadingOverlayComponentFramework","noRowsOverlayComponent","noRowsOverlayComponentFramework","detailCellRenderer","detailCellRendererFramework"],o.CALLBACK_PROPERTIES=["getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","getRowNodeId","isFullWidthRow","sendToClipboard","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideStoreParams","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","loadingCellRendererSelector","getRowId","groupAggFiltering"],o.FUNCTION_PROPERTIES=Cr(o.FUNCTIONAL_PROPERTIES,o.CALLBACK_PROPERTIES),o.ALL_PROPERTIES=Cr(o.ARRAY_PROPERTIES,o.OBJECT_PROPERTIES,o.STRING_PROPERTIES,o.NUMBER_PROPERTIES,o.FUNCTION_PROPERTIES,o.BOOLEAN_PROPERTIES),o.FRAMEWORK_PROPERTIES=["__ob__","__v_skip","__metadata__","mappedColumnProperties","hasChildColumns","toColDef","createColDefFromGridColumn"],o}(),Mu=function(){return Mu=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},Mu.apply(this,arguments)},Vf=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},Jo=function(){function o(){}return o.getCallbackForEvent=function(t){return!t||t.length<2?t:"on"+t[0].toUpperCase()+t.substr(1)},o.getCoercionLookup=function(){var t={};return function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(Vf(arguments[t]));return o}(o.ARRAY_PROPERTIES,o.OBJECT_PROPERTIES,o.STRING_PROPERTIES,o.FUNCTION_PROPERTIES,o.EVENT_CALLBACKS).forEach(function(e){return t[e]="none"}),o.BOOLEAN_PROPERTIES.forEach(function(e){return t[e]="boolean"}),o.NUMBER_PROPERTIES.forEach(function(e){return t[e]="number"}),t},o.getValue=function(t,e){var r=o.coercionLookup[t];if(r){var i=e;switch(r){case"number":i=o.toNumber(e);break;case"boolean":i=o.toBoolean(e);break;case"none":"groupAggFiltering"===t&&"function"!=typeof e&&(i=o.toBoolean(e))}return i}},o.getGridOptionKeys=function(t,e){return Object.keys(e?o.coercionLookup:t)},o.copyAttributesToGridOptions=function(t,e,r){void 0===r&&(r=!1),"object"!=typeof t&&(t={});var i=t;return o.getGridOptionKeys(e,r).forEach(function(u){var c=e[u];if(typeof c<"u"){var v=o.getValue(u,c);void 0!==v&&(i[u]=v)}}),t},o.processOnChange=function(t,e){if(t&&0!==Object.keys(t).length){var r=Mu({},t);r.columnTypes&&(e.setColumnTypes(r.columnTypes.currentValue,"gridOptionsChanged"),delete r.columnTypes),r.autoGroupColumnDef&&(e.setAutoGroupColumnDef(r.autoGroupColumnDef.currentValue,"gridOptionsChanged"),delete r.autoGroupColumnDef),r.defaultColDef&&(e.setDefaultColDef(r.defaultColDef.currentValue,"gridOptionsChanged"),delete r.defaultColDef),r.columnDefs&&(e.setColumnDefs(r.columnDefs.currentValue,"gridOptionsChanged"),delete r.columnDefs),Object.keys(r).forEach(function(n){var u=n,c=o.getValue(u,r[u].currentValue);e.__setProperty(u,c)});var i={type:I.EVENT_COMPONENT_STATE_CHANGED};Xe(t,function(n,u){i[n]=u}),e.dispatchEvent(i)}},o.toBoolean=function(t){return"boolean"==typeof t?t:"string"==typeof t&&("TRUE"===t.toUpperCase()||""==t)},o.toNumber=function(t){return"number"==typeof t?t:"string"==typeof t?Number(t):void 0},o.EVENTS=Pr(I),o.EXCLUDED_INTERNAL_EVENTS=[I.EVENT_SCROLLBAR_WIDTH_CHANGED,I.EVENT_CHECKBOX_CHANGED,I.EVENT_HEIGHT_SCALE_CHANGED,I.EVENT_BODY_HEIGHT_CHANGED,I.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,I.EVENT_SCROLL_VISIBILITY_CHANGED,I.EVENT_COLUMN_HOVER_CHANGED,I.EVENT_FLASH_CELLS,I.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,I.EVENT_DISPLAYED_ROWS_CHANGED,I.EVENT_LEFT_PINNED_WIDTH_CHANGED,I.EVENT_RIGHT_PINNED_WIDTH_CHANGED,I.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,I.EVENT_POPUP_TO_FRONT,I.EVENT_KEYBOARD_FOCUS,I.EVENT_MOUSE_FOCUS,I.EVENT_STORE_UPDATED,I.EVENT_COLUMN_PANEL_ITEM_DRAG_START,I.EVENT_COLUMN_PANEL_ITEM_DRAG_END,I.EVENT_FILL_START,I.EVENT_FILL_END,I.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,I.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,I.EVENT_FULL_WIDTH_ROW_FOCUSED,I.EVENT_HEADER_HEIGHT_CHANGED,I.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,I.EVENT_INTERNAL_TOOL_PANEL_VISIBLE_CHANGED,I.EVENT_CELL_FOCUS_CLEARED,I.EVENT_GRID_STYLES_CHANGED,I.EVENT_FILTER_DESTROYED],o.PUBLIC_EVENTS=o.EVENTS.filter(function(t){return!kr(o.EXCLUDED_INTERNAL_EVENTS,t)}),o.EVENT_CALLBACKS=o.EVENTS.map(function(t){return o.getCallbackForEvent(t)}),o.STRING_PROPERTIES=Vi.STRING_PROPERTIES,o.OBJECT_PROPERTIES=Vi.OBJECT_PROPERTIES,o.ARRAY_PROPERTIES=Vi.ARRAY_PROPERTIES,o.NUMBER_PROPERTIES=Vi.NUMBER_PROPERTIES,o.BOOLEAN_PROPERTIES=Vi.BOOLEAN_PROPERTIES,o.FUNCTION_PROPERTIES=Vi.FUNCTION_PROPERTIES,o.ALL_PROPERTIES=Vi.ALL_PROPERTIES,o.ALL_PROPERTIES_SET=new Set(Vi.ALL_PROPERTIES),o.coercionLookup=o.getCoercionLookup(),o}();function ku(o,t,e){var r={},i=o.filter(function(n){return!t.some(function(u){return u===n})});return i.length>0&&i.forEach(function(n){return r[n]=pl(n,e)}),r}function pl(o,t,e,r){var i=t.map(function(c){return{value:c,relevance:xh(o.toLowerCase(),c.toLocaleLowerCase())}});if(i.sort(function(c,v){return v.relevance-c.relevance}),e&&(i=i.filter(function(c){return 0!==c.relevance})),r&&r>0){var u=i[0].relevance*r;i=i.filter(function(c){return u-c.relevance<0})}return i.map(function(c){return c.value})}function xh(o,t){for(var e=o.replace(/\s/g,""),r=t.replace(/\s/g,""),i=0,n=-1,u=0;u<e.length;u++){var c=r.indexOf(e[u],n+1);-1!==c&&(i+=100-100*(n=c)/1e4*100)}return i}var rr=Object.freeze({__proto__:null,fuzzyCheckStrings:ku,fuzzySuggestions:pl}),rn=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Bt=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},Qt=function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(Bt(arguments[t]));return o};function Vt(o,t,e,r){var i=e?"Please use '"+e+"' instead. ":"";_t(function(){return console.warn("AG Grid: since v"+o+", '"+t+"' is deprecated. "+i+(r??""))},"Deprecated_"+t)}var Eh=function(){function o(){this.deprecatedProperties={serverSideInfiniteScroll:{version:"29",message:"Infinite Scrolling is now the default behaviour. This can be suppressed with `suppressServerSideInfiniteScroll`."},rememberGroupStateWhenNewData:{version:"24",message:"Now that transaction updates are possible and they keep group state, this feature is no longer needed."},suppressEnterpriseResetOnNewColumns:{version:"25",message:"Now that it is possible to dynamically change columns in the grid, this is no longer needed."},suppressColumnStateEvents:{version:"25",message:'Events should be ignored based on the `event.source`, which will be "api" if the event was due to setting column state via the API.'},defaultExportParams:{version:"25.2",message:"The property `defaultExportParams` has been replaced by `defaultCsvExportParams` and `defaultExcelExportParams`"},stopEditingWhenGridLosesFocus:{version:"25.2.2",newProp:"stopEditingWhenCellsLoseFocus",copyToNewProp:!0},applyColumnDefOrder:{version:"26",message:"The property `applyColumnDefOrder` is no longer needed, as this is the default behaviour. To turn this behaviour off, set maintainColumnOrder=true"},groupMultiAutoColumn:{version:"26",newProp:"groupDisplayType",copyToNewProp:!0,newPropValue:"multipleColumns"},groupUseEntireRow:{version:"26",newProp:"groupDisplayType",copyToNewProp:!0,newPropValue:"groupRows"},defaultGroupSortComparator:{version:"26",newProp:"initialGroupOrderComparator"},enableMultiRowDragging:{version:"26.1",newProp:"rowDragMultiRow",copyToNewProp:!0},colWidth:{version:"26.1",newProp:"defaultColDef.width"},minColWidth:{version:"26.1",newProp:"defaultColDef.minWidth"},maxColWidth:{version:"26.1",newProp:"defaultColDef.maxWidth"},reactUi:{version:"26.1",message:"React UI is on by default, so no need for reactUi=true. To turn it off, set suppressReactUi=true."},suppressCellSelection:{version:"27",newProp:"suppressCellFocus",copyToNewProp:!0},clipboardDeliminator:{version:"27.1",newProp:"clipboardDelimiter",copyToNewProp:!0},getRowNodeId:{version:"27.1",newProp:"getRowId",message:"The difference: if getRowId() is implemented then immutable data is enabled by default."},defaultGroupOrderComparator:{version:"27.2",newProp:"initialGroupOrderComparator"},groupRowAggNodes:{version:"27.2",newProp:"getGroupRowAgg"},postSort:{version:"27.2",newProp:"postSortRows"},isFullWidthCell:{version:"27.2",newProp:"isFullWidthRow"},localeTextFunc:{version:"27.2",newProp:"getLocaleText"},serverSideFilteringAlwaysResets:{version:"28.0",newProp:"serverSideFilterAllLevels",copyToNewProp:!0},serverSideSortingAlwaysResets:{version:"28.0",newProp:"serverSideSortAllLevels",copyToNewProp:!0},suppressReactUi:{version:"28",message:"The legacy React rendering engine is deprecated and will be removed in the next major version of the grid."},processSecondaryColDef:{version:"28",newProp:"processPivotResultColDef",copyToNewProp:!0},processSecondaryColGroupDef:{version:"28",newProp:"processPivotResultColGroupDef",copyToNewProp:!0},getServerSideStoreParams:{version:"28",newProp:"getServerSideGroupLevelParams",copyToNewProp:!0},enableChartToolPanelsButton:{version:"29",message:"The Chart Tool Panels button is now enabled by default. To hide the Chart Tool Panels button and display the hamburger button instead, set suppressChartToolPanelsButton=true."},functionsPassive:{version:"29.2"},onColumnRowGroupChangeRequest:{version:"29.2"},onColumnPivotChangeRequest:{version:"29.2"},onColumnValueChangeRequest:{version:"29.2"},onColumnAggFuncChangeRequest:{version:"29.2"}}}return o.prototype.pickOneWarning=function(t,e){console.warn("AG Grid: "+t+" and "+e+" do not work with each other, you need to pick one.")},o.prototype.init=function(){var t=this;if(this.checkForDeprecated(),this.checkForViolations(),!0!==this.gridOptions.suppressPropertyNamesCheck&&(this.checkGridOptionsProperties(),this.checkColumnDefProperties()),this.checkColumnDefViolations(),this.gridOptionsService.is("groupSelectsChildren")&&this.gridOptionsService.is("suppressParentsInRowNodes")&&console.warn("AG Grid: 'groupSelectsChildren' does not work with 'suppressParentsInRowNodes', this selection method needs the part in rowNode to work"),this.gridOptionsService.is("groupSelectsChildren")&&"multiple"!==this.gridOptionsService.get("rowSelection")&&console.warn("AG Grid: rowSelection must be 'multiple' for groupSelectsChildren to make sense"),this.gridOptionsService.is("groupRemoveSingleChildren")&&this.gridOptionsService.is("groupHideOpenParents")&&this.pickOneWarning("groupRemoveSingleChildren","groupHideOpenParents"),"autoHeight"===this.gridOptionsService.get("domLayout")&&!this.gridOptionsService.isRowModelType("clientSide")&&(this.gridOptionsService.is("pagination")||(console.warn("AG Grid: domLayout='autoHeight' was ignored as it is only supported by the Client-Side row model, unless using pagination."),this.gridOptions.domLayout="normal")),this.gridOptionsService.isRowModelType("serverSide")){var e=function(i,n){return"AG Grid: '"+i+"' is not supported on the Server-Side Row Model."+(n?" Please use "+n+" instead.":"")};this.gridOptionsService.exists("groupDefaultExpanded")&&console.warn(e("groupDefaultExpanded","isServerSideGroupOpenByDefault callback")),this.gridOptionsService.exists("groupIncludeFooter")&&console.warn(e("groupIncludeFooter")),this.gridOptionsService.exists("groupIncludeTotalFooter")&&console.warn(e("groupIncludeTotalFooter"))}this.gridOptionsService.is("enableRangeSelection")?it.assertRegistered(Ne.RangeSelectionModule,"enableRangeSelection"):(this.gridOptionsService.is("enableRangeHandle")||this.gridOptionsService.is("enableFillHandle"))&&console.warn("AG Grid: 'enableRangeHandle' or 'enableFillHandle' will not work unless 'enableRangeSelection' is set to true");var r=function(i,n){return t.gridOptionsService.exists(i)&&it.assertRegistered(n,i)};r("sideBar",Ne.SideBarModule),r("statusBar",Ne.StatusBarModule),r("enableCharts",Ne.GridChartsModule),r("getMainMenuItems",Ne.MenuModule),r("getContextMenuItems",Ne.MenuModule),r("allowContextMenuWithControlKey",Ne.MenuModule),this.gridOptionsService.is("groupRowsSticky")&&(this.gridOptionsService.is("groupHideOpenParents")&&this.pickOneWarning("groupRowsSticky","groupHideOpenParents"),this.gridOptionsService.is("masterDetail")&&this.pickOneWarning("groupRowsSticky","masterDetail"),this.gridOptionsService.is("pagination")&&this.pickOneWarning("groupRowsSticky","pagination"))},o.prototype.checkColumnDefProperties=function(){var t=this;if(null!=this.gridOptions.columnDefs){var e=Qt(Hs.ALL_PROPERTIES,Hs.FRAMEWORK_PROPERTIES),r=function(i,n){var u=Object.getOwnPropertyNames(i);t.checkProperties(u,e,e,n,"https://www.ag-grid.com/javascript-data-grid/column-properties/"),i.children&&i.children.forEach(function(c){return r(c,"columnDefs.children")})};this.gridOptions.columnDefs.forEach(function(i){return r(i,"columnDefs")}),this.gridOptions.defaultColDef&&r(this.gridOptions.defaultColDef,"defaultColDef")}},o.prototype.checkColumnDefViolations=function(){var t,e=null!==(t=this.gridOptionsService.get("rowModelType"))&&void 0!==t?t:"clientSide",i={infinite:["headerCheckboxSelection","headerCheckboxSelectionFilteredOnly","headerCheckboxSelectionCurrentPageOnly"],viewport:["headerCheckboxSelection","headerCheckboxSelectionFilteredOnly","headerCheckboxSelectionCurrentPageOnly"],serverSide:["headerCheckboxSelectionFilteredOnly","headerCheckboxSelectionCurrentPageOnly"],clientSide:[]}[e];if(i?.length){var n=function(u){i.forEach(function(c){c in u&&u[c]&&console.warn("AG Grid: Column property "+c+" is not supported with the row model type "+e+".")})};null!=this.gridOptions.columnDefs&&this.gridOptions.columnDefs.forEach(function(u){return n(u)}),null!=this.gridOptions.autoGroupColumnDef&&n(this.gridOptions.autoGroupColumnDef),null!=this.gridOptions.defaultColDef&&n(this.gridOptions.defaultColDef)}},o.prototype.checkGridOptionsProperties=function(){var t=Object.getOwnPropertyNames(this.gridOptions),e=Qt(Vi.ALL_PROPERTIES,Vi.FRAMEWORK_PROPERTIES,Jo.EVENT_CALLBACKS),r=Qt(e,["api","columnApi"],Object.keys(this.deprecatedProperties));this.checkProperties(t,r,e,"gridOptions","https://www.ag-grid.com/javascript-data-grid/grid-options/")},o.prototype.checkProperties=function(t,e,r,i,n){var u=ku(t,e,r);Xe(u,function(c,v){_t(function(){return console.warn("AG Grid: invalid "+i+" property '"+c+"' did you mean any of these: "+v.slice(0,8).join(", "))},"invalidProperty"+i+c)}),Object.keys(u).length>0&&_t(function(){return console.warn("AG Grid: to see all the valid "+i+" properties please check: "+n)},"invalidProperties"+i+n)},o.prototype.checkForDeprecated=function(){var t=this.gridOptions;if(Object.entries(this.deprecatedProperties).forEach(function(r){var i,n=Bt(r,2),u=n[0],c=n[1],v=t[u];v&&(Vt(c.version,u,c.newProp,c.message),c.copyToNewProp&&c.newProp&&null==t[c.newProp]&&(t[c.newProp]=null!==(i=c.newPropValue)&&void 0!==i?i:v))}),t.groupSuppressAutoColumn){var e=t.treeData?"treeDataDisplayType":"groupDisplayType";console.warn("AG Grid: since v26.0, the grid property `groupSuppressAutoColumn` has been replaced by `"+e+" = 'custom'`"),t[e]="custom"}t.immutableData&&(t.getRowId?console.warn("AG Grid: since v27.1, `immutableData` is deprecated. With the `getRowId` callback implemented, immutable data is enabled by default so you can remove `immutableData=true`."):console.warn("AG Grid: since v27.1, `immutableData` is deprecated. To enable immutable data you must implement the `getRowId()` callback.")),t.serverSideStoreType&&(console.warn("AG Grid: since v29.0, `serverSideStoreType` has been replaced by `suppressServerSideInfiniteScroll`. Set to false to use Partial Store, and true to use Full Store."),t.suppressServerSideInfiniteScroll="partial"!==t.serverSideStoreType)},o.prototype.checkForViolations=function(){this.gridOptionsService.is("treeData")&&this.treeDataViolations()},o.prototype.treeDataViolations=function(){this.gridOptionsService.isRowModelType("clientSide")&&(this.gridOptionsService.exists("getDataPath")||console.warn("AG Grid: property usingTreeData=true with rowModel=clientSide, but you did not provide getDataPath function, please provide getDataPath function if using tree data.")),this.gridOptionsService.isRowModelType("serverSide")&&(this.gridOptionsService.exists("isServerSideGroup")||console.warn("AG Grid: property usingTreeData=true with rowModel=serverSide, but you did not provide isServerSideGroup function, please provide isServerSideGroup function if using tree data."),this.gridOptionsService.exists("getServerSideGroupKey")||console.warn("AG Grid: property usingTreeData=true with rowModel=serverSide, but you did not provide getServerSideGroupKey function, please provide getServerSideGroupKey function if using tree data."))},rn([D("gridOptions")],o.prototype,"gridOptions",void 0),rn([D("gridOptionsService")],o.prototype,"gridOptionsService",void 0),rn([Re],o.prototype,"init",null),o=rn([He("gridOptionsValidator")],o)}();function Qn(o,t){var e=["groupRows","multipleColumns","custom","singleColumn"];return e.indexOf(t)<0?(console.warn("AG Grid: '"+t+"' is not a valid groupDisplayType value - possible values are: '"+e.join("', '")+"'"),!1):t===o}var ti=function(){function o(t,e,r,i){this.displayedChildren=[],this.localEventService=new Yn,this.groupId=e,this.partId=r,this.providedColumnGroup=t,this.pinned=i}return o.createUniqueId=function(t,e){return t+"_"+e},o.prototype.reset=function(){this.parent=null,this.children=null,this.displayedChildren=null},o.prototype.getParent=function(){return this.parent},o.prototype.setParent=function(t){this.parent=t},o.prototype.getUniqueId=function(){return o.createUniqueId(this.groupId,this.partId)},o.prototype.isEmptyGroup=function(){return 0===this.displayedChildren.length},o.prototype.isMoving=function(){var t=this.getProvidedColumnGroup().getLeafColumns();return!(!t||0===t.length)&&t.every(function(e){return e.isMoving()})},o.prototype.checkLeft=function(){if(this.displayedChildren.forEach(function(i){i instanceof o&&i.checkLeft()}),this.displayedChildren.length>0)if(this.gridOptionsService.is("enableRtl")){var e=Mt(this.displayedChildren).getLeft();this.setLeft(e)}else{var r=this.displayedChildren[0].getLeft();this.setLeft(r)}else this.setLeft(null)},o.prototype.getLeft=function(){return this.left},o.prototype.getOldLeft=function(){return this.oldLeft},o.prototype.setLeft=function(t){this.oldLeft=t,this.left!==t&&(this.left=t,this.localEventService.dispatchEvent(this.createAgEvent(o.EVENT_LEFT_CHANGED)))},o.prototype.getPinned=function(){return this.pinned},o.prototype.createAgEvent=function(t){return{type:t}},o.prototype.addEventListener=function(t,e){this.localEventService.addEventListener(t,e)},o.prototype.removeEventListener=function(t,e){this.localEventService.removeEventListener(t,e)},o.prototype.getGroupId=function(){return this.groupId},o.prototype.getPartId=function(){return this.partId},o.prototype.isChildInThisGroupDeepSearch=function(t){var e=!1;return this.children.forEach(function(r){t===r&&(e=!0),r instanceof o&&r.isChildInThisGroupDeepSearch(t)&&(e=!0)}),e},o.prototype.getActualWidth=function(){var t=0;return this.displayedChildren&&this.displayedChildren.forEach(function(e){t+=e.getActualWidth()}),t},o.prototype.isResizable=function(){if(!this.displayedChildren)return!1;var t=!1;return this.displayedChildren.forEach(function(e){e.isResizable()&&(t=!0)}),t},o.prototype.getMinWidth=function(){var t=0;return this.displayedChildren.forEach(function(e){t+=e.getMinWidth()||0}),t},o.prototype.addChild=function(t){this.children||(this.children=[]),this.children.push(t)},o.prototype.getDisplayedChildren=function(){return this.displayedChildren},o.prototype.getLeafColumns=function(){var t=[];return this.addLeafColumns(t),t},o.prototype.getDisplayedLeafColumns=function(){var t=[];return this.addDisplayedLeafColumns(t),t},o.prototype.getDefinition=function(){return this.providedColumnGroup.getColGroupDef()},o.prototype.getColGroupDef=function(){return this.providedColumnGroup.getColGroupDef()},o.prototype.isPadding=function(){return this.providedColumnGroup.isPadding()},o.prototype.isExpandable=function(){return this.providedColumnGroup.isExpandable()},o.prototype.isExpanded=function(){return this.providedColumnGroup.isExpanded()},o.prototype.setExpanded=function(t){this.providedColumnGroup.setExpanded(t)},o.prototype.addDisplayedLeafColumns=function(t){this.displayedChildren.forEach(function(e){e instanceof Kt?t.push(e):e instanceof o&&e.addDisplayedLeafColumns(t)})},o.prototype.addLeafColumns=function(t){this.children.forEach(function(e){e instanceof Kt?t.push(e):e instanceof o&&e.addLeafColumns(t)})},o.prototype.getChildren=function(){return this.children},o.prototype.getColumnGroupShow=function(){return this.providedColumnGroup.getColumnGroupShow()},o.prototype.getProvidedColumnGroup=function(){return this.providedColumnGroup},o.prototype.getOriginalColumnGroup=function(){return Vt("27","getOriginalColumnGroup","getProvidedColumnGroup"),this.getProvidedColumnGroup()},o.prototype.getPaddingLevel=function(){var t=this.getParent();return this.isPadding()&&t&&t.isPadding()?1+t.getPaddingLevel():0},o.prototype.calculateDisplayedColumns=function(){var t=this;this.displayedChildren=[];for(var e=this;null!=e&&e.isPadding();)e=e.getParent();if(!(!!e&&e.providedColumnGroup.isExpandable()))return this.displayedChildren=this.children,void this.localEventService.dispatchEvent(this.createAgEvent(o.EVENT_DISPLAYED_CHILDREN_CHANGED));this.children.forEach(function(i){if(!(i instanceof o&&(!i.displayedChildren||!i.displayedChildren.length)))switch(i.getColumnGroupShow()){case"open":e.providedColumnGroup.isExpanded()&&t.displayedChildren.push(i);break;case"closed":e.providedColumnGroup.isExpanded()||t.displayedChildren.push(i);break;default:t.displayedChildren.push(i)}}),this.localEventService.dispatchEvent(this.createAgEvent(o.EVENT_DISPLAYED_CHILDREN_CHANGED))},o.EVENT_LEFT_CHANGED="leftChanged",o.EVENT_DISPLAYED_CHILDREN_CHANGED="displayedChildrenChanged",function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);i>3&&n&&Object.defineProperty(t,e,n)}([D("gridOptionsService")],o.prototype,"gridOptionsService",void 0),o}(),Uf=function(){function o(){this.existingIds={}}return o.prototype.getInstanceIdForKey=function(t){var r,e=this.existingIds[t];return r="number"!=typeof e?0:e+1,this.existingIds[t]=r,r},o}(),bi=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Bs=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Jt="ag-Grid-AutoColumn",_i=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return bi(t,o),t.prototype.createAutoGroupColumns=function(e,r){var i=this,n=[],u=this.gridOptionsService.isTreeData(),c=this.gridOptionsService.isGroupMultiAutoColumn();return u&&c&&(console.warn('AG Grid: you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data'),c=!1),c?r.forEach(function(v,m){n.push(i.createOneAutoGroupColumn(e,v,m))}):n.push(this.createOneAutoGroupColumn(e)),n},t.prototype.createOneAutoGroupColumn=function(e,r,i){var u,n=this.generateDefaultColDef(r);(u=r?Jt+"-"+r.getId():Jt,Qr(n,this.gridOptionsService.get("autoGroupColumnDef")),(n=this.columnFactory.mergeColDefs(n)).colId=u,this.gridOptionsService.isTreeData())||Je(n.field)&&Je(n.valueGetter)&&Je(n.filterValueGetter)&&"agGroupColumnFilter"!==n.filter&&(n.filter=!1);i&&i>0&&(n.headerCheckboxSelection=!1);var m=e.find(function(O){return O.getId()==u});if(m)return m.setColDef(n,null),this.columnFactory.applyColumnState(m,n),m;this.gridOptionsService.isColumnsSortingCoupledToGroup()&&(n.sort||n.initialSort)&&!n.field&&Qr(n,{sort:null,initialSort:null},!0,!0);var _=new Kt(n,null,u,!0);return this.context.createBean(_),_},t.prototype.generateDefaultColDef=function(e){var r=this.gridOptionsService.get("autoGroupColumnDef"),n={headerName:this.localeService.getLocaleTextFunc()("group","Group")};if(r&&(r.cellRenderer||r.cellRendererFramework||r.cellRendererSelector)||(n.cellRenderer="agGroupCellRenderer"),e){var c=e.getColDef();Object.assign(n,{headerName:this.columnModel.getDisplayNameForColumn(e,"header"),headerValueGetter:c.headerValueGetter}),(c.cellRenderer||c.cellRendererFramework)&&Object.assign(n,{cellRendererParams:{innerRenderer:c.cellRenderer,innerRendererFramework:c.cellRendererFramework,innerRendererParams:c.cellRendererParams}}),n.showRowGroup=e.getColId()}else n.showRowGroup=!0;return n},Bs([D("columnModel")],t.prototype,"columnModel",void 0),Bs([D("columnFactory")],t.prototype,"columnFactory",void 0),t=Bs([He("autoGroupColService")],t)}(we),jf=/[&<>"']/g,zf={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function dl(o){return o[0].toUpperCase()+o.substr(1).toLowerCase()}function Wi(o,t){if(null==o)return null;var e=o.toString().toString();return t?e:e.replace(jf,function(r){return zf[r]})}function Zo(o){if(!o||null==o)return null;return o.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z])([a-z])/g,"$1 $2$3").replace(/\./g," ").split(" ").map(function(i){return i.substring(0,1).toUpperCase()+(i.length>1?i.substring(1,i.length):"")}).join(" ")}var sr=Object.freeze({__proto__:null,utf8_encode:function yt(o){var t=String.fromCharCode;function i(_,O){return t(_>>O&63|128)}function n(_){if(_>=0&&_<=31&&10!==_)return"_x"+_.toString(16).toUpperCase().padStart(4,"0")+"_";if(!(4294967168&_))return t(_);var L="";return 4294965248&_?4294901760&_?4292870144&_||(L=t(_>>18&7|240),L+=i(_,12),L+=i(_,6)):(function r(_){if(_>=55296&&_<=57343)throw Error("Lone surrogate U+"+_.toString(16).toUpperCase()+" is not a scalar value")}(_),L=t(_>>12&15|224),L+=i(_,6)):L=t(_>>6&31|192),L+=t(63&_|128)}for(var u=function e(_){var O=[];if(!_)return[];for(var z,q,P=_.length,L=0;L<P;)(z=_.charCodeAt(L++))>=55296&&z<=56319&&L<P?56320==(64512&(q=_.charCodeAt(L++)))?O.push(((1023&z)<<10)+(1023&q)+65536):(O.push(z),L--):O.push(z);return O}(o),c=u.length,v=-1,C="";++v<c;)C+=n(u[v]);return C},capitalise:dl,escapeString:Wi,camelCaseToHumanText:Zo});function bn(o){var t=new Map;return o.forEach(function(e){return t.set(e[0],e[1])}),t}var zr=Object.freeze({__proto__:null,convertToMap:bn,mapById:function Kf(o,t){var e=new Map;return o.forEach(function(r){return e.set(t(r),r)}),e},keys:function Th(o){var t=[];return o.forEach(function(e,r){return t.push(r)}),t}}),Oh=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Gr=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},dt=function(o,t){return function(e,r){t(e,r,o)}},$f=function(o){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&o[t],r=0;if(e)return e.call(o);if(o&&"number"==typeof o.length)return{next:function(){return o&&r>=o.length&&(o=void 0),{value:o&&o[r++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Gu=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},Pt=function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(Gu(arguments[t]));return o},Hu=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.primaryHeaderRowCount=0,e.secondaryHeaderRowCount=0,e.gridHeaderRowCount=0,e.displayedColumnsLeft=[],e.displayedColumnsRight=[],e.displayedColumnsCenter=[],e.displayedColumns=[],e.displayedColumnsAndGroupsMap={},e.viewportColumns=[],e.viewportColumnsHash="",e.headerViewportColumns=[],e.viewportColumnsCenter=[],e.headerViewportColumnsCenter=[],e.autoHeightActiveAtLeastOnce=!1,e.rowGroupColumns=[],e.valueColumns=[],e.pivotColumns=[],e.ready=!1,e.autoGroupsNeedBuilding=!1,e.forceRecreateAutoGroups=!1,e.pivotMode=!1,e.bodyWidth=0,e.leftWidth=0,e.rightWidth=0,e.bodyWidthDirty=!0,e}return Oh(t,o),t.prototype.init=function(){var e=this;this.suppressColumnVirtualisation=this.gridOptionsService.is("suppressColumnVirtualisation");var r=this.gridOptionsService.is("pivotMode");this.isPivotSettingAllowed(r)&&(this.pivotMode=r),this.usingTreeData=this.gridOptionsService.isTreeData(),this.addManagedPropertyListener("groupDisplayType",function(){return e.onAutoGroupColumnDefChanged()}),this.addManagedPropertyListener("autoGroupColumnDef",function(){return e.onAutoGroupColumnDefChanged()}),this.addManagedPropertyListener("defaultColDef",function(i){return e.onSharedColDefChanged(i.source)}),this.addManagedPropertyListener("columnTypes",function(i){return e.onSharedColDefChanged(i.source)})},t.prototype.onAutoGroupColumnDefChanged=function(){this.autoGroupsNeedBuilding=!0,this.forceRecreateAutoGroups=!0,this.updateGridColumns(),this.updateDisplayedColumns("gridOptionsChanged")},t.prototype.onSharedColDefChanged=function(e){void 0===e&&(e="api"),this.forceRecreateAutoGroups=!0,this.createColumnsFromColumnDefs(!0,e)},t.prototype.setColumnDefs=function(e,r){void 0===r&&(r="api");var i=!!this.columnDefs;this.columnDefs=e,this.createColumnsFromColumnDefs(i,r)},t.prototype.destroyOldColumns=function(e,r){var i={};if(e){this.columnUtils.depthFirstOriginalTreeSearch(null,e,function(u){i[u.getInstanceId()]=u}),r&&this.columnUtils.depthFirstOriginalTreeSearch(null,r,function(u){i[u.getInstanceId()]=null});var n=Object.values(i).filter(function(u){return null!=u});this.destroyBeans(n)}},t.prototype.destroyColumns=function(){this.destroyOldColumns(this.primaryColumnTree),this.destroyOldColumns(this.secondaryBalancedTree),this.destroyOldColumns(this.groupAutoColsBalancedTree)},t.prototype.createColumnsFromColumnDefs=function(e,r){var i=this;void 0===r&&(r="api");var n=e?this.compareColumnStatesAndDispatchEvents(r):void 0;this.valueCache.expire(),this.autoGroupsNeedBuilding=!0;var u=this.primaryColumns,c=this.primaryColumnTree,v=this.columnFactory.createColumnTree(this.columnDefs,!0,c);this.destroyOldColumns(this.primaryColumnTree,v.columnTree),this.primaryColumnTree=v.columnTree,this.primaryHeaderRowCount=v.treeDept+1,this.primaryColumns=this.getColumnsFromTree(this.primaryColumnTree),this.primaryColumnsMap={},this.primaryColumns.forEach(function(_){return i.primaryColumnsMap[_.getId()]=_}),this.extractRowGroupColumns(r,u),this.extractPivotColumns(r,u),this.extractValueColumns(r,u),this.ready=!0;var m=void 0===this.gridColsArePrimary;(this.gridColsArePrimary||m)&&(this.updateGridColumns(),e&&!this.gridOptionsService.is("maintainColumnOrder")&&this.orderGridColumnsLikePrimary(),this.updateDisplayedColumns(r),this.checkViewportColumns()),this.dispatchEverythingChanged(r),n&&n(),this.dispatchNewColumnsLoaded()},t.prototype.dispatchNewColumnsLoaded=function(){var e={type:I.EVENT_NEW_COLUMNS_LOADED};this.eventService.dispatchEvent(e)},t.prototype.dispatchEverythingChanged=function(e){void 0===e&&(e="api");var r={type:I.EVENT_COLUMN_EVERYTHING_CHANGED,source:e};this.eventService.dispatchEvent(r)},t.prototype.orderGridColumnsLikePrimary=function(){var e=this,r=this.primaryColumns;r&&(this.gridColumns.sort(function(i,n){var u=r.indexOf(i),c=r.indexOf(n),v=u>=0,m=c>=0;return v&&m?u-c:v?1:m?-1:e.gridColumns.indexOf(i)-e.gridColumns.indexOf(n)}),this.gridColumns=this.placeLockedColumns(this.gridColumns))},t.prototype.getAllDisplayedAutoHeightCols=function(){return this.displayedAutoHeightCols},t.prototype.setViewport=function(){this.gridOptionsService.is("enableRtl")?(this.viewportLeft=this.bodyWidth-this.scrollPosition-this.scrollWidth,this.viewportRight=this.bodyWidth-this.scrollPosition):(this.viewportLeft=this.scrollPosition,this.viewportRight=this.scrollWidth+this.scrollPosition)},t.prototype.getDisplayedColumnsStartingAt=function(e){for(var r=e,i=[];null!=r;)i.push(r),r=this.getDisplayedColAfter(r);return i},t.prototype.checkViewportColumns=function(){if(null!=this.displayedColumnsCenter&&this.extractViewport()){var r={type:I.EVENT_VIRTUAL_COLUMNS_CHANGED};this.eventService.dispatchEvent(r)}},t.prototype.setViewportPosition=function(e,r){(e!==this.scrollWidth||r!==this.scrollPosition||this.bodyWidthDirty)&&(this.scrollWidth=e,this.scrollPosition=r,this.bodyWidthDirty=!0,this.setViewport(),this.ready&&this.checkViewportColumns())},t.prototype.isPivotMode=function(){return this.pivotMode},t.prototype.isPivotSettingAllowed=function(e){return!e||!this.gridOptionsService.isTreeData()||(console.warn("AG Grid: Pivot mode not available in conjunction Tree Data i.e. 'gridOptions.treeData: true'"),!1)},t.prototype.setPivotMode=function(e,r){if(void 0===r&&(r="api"),e!==this.pivotMode&&this.isPivotSettingAllowed(this.pivotMode)){this.pivotMode=e,this.autoGroupsNeedBuilding=!0,this.updateGridColumns(),this.updateDisplayedColumns(r);var i={type:I.EVENT_COLUMN_PIVOT_MODE_CHANGED};this.eventService.dispatchEvent(i)}},t.prototype.getSecondaryPivotColumn=function(e,r){if(Je(this.secondaryColumns))return null;var i=this.getPrimaryColumn(r),n=null;return this.secondaryColumns.forEach(function(u){var c=u.getColDef().pivotKeys,v=u.getColDef().pivotValueColumn;Xn(c,e)&&v===i&&(n=u)}),n},t.prototype.setBeans=function(e){this.logger=e.create("columnModel")},t.prototype.setFirstRightAndLastLeftPinned=function(e){var r,i;this.gridOptionsService.is("enableRtl")?(r=this.displayedColumnsLeft?this.displayedColumnsLeft[0]:null,i=this.displayedColumnsRight?Mt(this.displayedColumnsRight):null):(r=this.displayedColumnsLeft?Mt(this.displayedColumnsLeft):null,i=this.displayedColumnsRight?this.displayedColumnsRight[0]:null),this.gridColumns.forEach(function(n){n.setLastLeftPinned(n===r,e),n.setFirstRightPinned(n===i,e)})},t.prototype.autoSizeColumns=function(e){var r=this,i=e.columns,n=e.skipHeader,u=e.skipHeaderGroups,c=e.stopAtGroup,v=e.source,m=void 0===v?"api":v;this.animationFrameService.flushAllFrames();for(var C=[],_=-1,O=n??this.gridOptionsService.is("skipHeaderOnAutoSize"),P=u??O;0!==_;)_=0,this.actionOnGridColumns(i,function(L){if(C.indexOf(L)>=0)return!1;var z=r.autoWidthCalculator.getPreferredWidthForColumn(L,O);if(z>0){var q=r.normaliseColumnWidth(L,z);L.setActualWidth(q,m),C.push(L),_++}return!0},m);P||this.autoSizeColumnGroupsByColumns(i,m,c),this.dispatchColumnResizedEvent(C,!0,"autosizeColumns")},t.prototype.dispatchColumnResizedEvent=function(e,r,i,n){if(void 0===n&&(n=null),e&&e.length){var u={type:I.EVENT_COLUMN_RESIZED,columns:e,column:1===e.length?e[0]:null,flexColumns:n,finished:r,source:i};this.eventService.dispatchEvent(u)}},t.prototype.dispatchColumnChangedEvent=function(e,r,i){var n={type:e,columns:r,column:r&&1==r.length?r[0]:null,source:i};this.eventService.dispatchEvent(n)},t.prototype.dispatchColumnMovedEvent=function(e){var r=e.movedColumns,i=e.source,n=e.toIndex,u=e.finished,c={type:I.EVENT_COLUMN_MOVED,columns:r,column:r&&1===r.length?r[0]:null,toIndex:n,finished:u,source:i};this.eventService.dispatchEvent(c)},t.prototype.dispatchColumnPinnedEvent=function(e,r){if(e.length){var i=1===e.length?e[0]:null,n=this.getCommonValue(e,function(c){return c.getPinned()}),u={type:I.EVENT_COLUMN_PINNED,pinned:n??null,columns:e,column:i,source:r};this.eventService.dispatchEvent(u)}},t.prototype.dispatchColumnVisibleEvent=function(e,r){if(e.length){var i=1===e.length?e[0]:null,n=this.getCommonValue(e,function(c){return c.isVisible()}),u={type:I.EVENT_COLUMN_VISIBLE,visible:n,columns:e,column:i,source:r};this.eventService.dispatchEvent(u)}},t.prototype.autoSizeColumn=function(e,r,i){void 0===i&&(i="api"),e&&this.autoSizeColumns({columns:[e],skipHeader:r,skipHeaderGroups:!0,source:i})},t.prototype.autoSizeColumnGroupsByColumns=function(e,r,i){var n,u,c,v,m=new Set;this.getGridColumns(e).forEach(function(pe){for(var Ce=pe.getParent();Ce&&Ce!=i;)Ce.isPadding()||m.add(Ce),Ce=Ce.getParent()});var _;try{for(var P=$f(m),L=P.next();!L.done;L=P.next()){var z=L.value;try{for(var q=(c=void 0,$f(this.ctrlsService.getHeaderRowContainerCtrls())),Z=q.next();!Z.done;Z=q.next()){if(_=Z.value.getHeaderCtrlForColumn(z))break}}catch(pe){c={error:pe}}finally{try{Z&&!Z.done&&(v=q.return)&&v.call(q)}finally{if(c)throw c.error}}_&&_.resizeLeafColumnsToFit(r)}}catch(pe){n={error:pe}}finally{try{L&&!L.done&&(u=P.return)&&u.call(P)}finally{if(n)throw n.error}}return[]},t.prototype.autoSizeAllColumns=function(e,r){void 0===r&&(r="api");var i=this.getAllDisplayedColumns();this.autoSizeColumns({columns:i,skipHeader:e,source:r})},t.prototype.getColumnsFromTree=function(e){var r=[],i=function(n){for(var u=0;u<n.length;u++){var c=n[u];c instanceof Kt?r.push(c):c instanceof tr&&i(c.getChildren())}};return i(e),r},t.prototype.getAllDisplayedTrees=function(){return this.displayedTreeLeft&&this.displayedTreeRight&&this.displayedTreeCentre?this.displayedTreeLeft.concat(this.displayedTreeCentre).concat(this.displayedTreeRight):null},t.prototype.getPrimaryColumnTree=function(){return this.primaryColumnTree},t.prototype.getHeaderRowCount=function(){return this.gridHeaderRowCount},t.prototype.getDisplayedTreeLeft=function(){return this.displayedTreeLeft},t.prototype.getDisplayedTreeRight=function(){return this.displayedTreeRight},t.prototype.getDisplayedTreeCentre=function(){return this.displayedTreeCentre},t.prototype.isColumnDisplayed=function(e){return this.getAllDisplayedColumns().indexOf(e)>=0},t.prototype.getAllDisplayedColumns=function(){return this.displayedColumns},t.prototype.getViewportColumns=function(){return this.viewportColumns},t.prototype.getDisplayedLeftColumnsForRow=function(e){return this.colSpanActive?this.getDisplayedColumnsForRow(e,this.displayedColumnsLeft):this.displayedColumnsLeft},t.prototype.getDisplayedRightColumnsForRow=function(e){return this.colSpanActive?this.getDisplayedColumnsForRow(e,this.displayedColumnsRight):this.displayedColumnsRight},t.prototype.isColSpanActive=function(){return this.colSpanActive},t.prototype.getDisplayedColumnsForRow=function(e,r,i,n){for(var m,u=[],c=null,v=function(_){var re,O=r[_],P=r.length-_,L=Math.min(O.getColSpan(e),P),z=[O];if(L>1){for(var q=L-1,Z=1;Z<=q;Z++)z.push(r[_+Z]);_+=q}if(i?(re=!1,z.forEach(function(Ce){i(Ce)&&(re=!0)})):re=!0,re){if(0===u.length&&c)!!n&&n(O)&&u.push(c);u.push(O)}c=O,m=_},C=0;C<r.length;C++)v(C),C=m;return u},t.prototype.getViewportCenterColumnsForRow=function(e){var r=this;if(!this.colSpanActive)return this.viewportColumnsCenter;var n=this.suppressColumnVirtualisation?null:this.isColumnInRowViewport.bind(this);return this.getDisplayedColumnsForRow(e,this.displayedColumnsCenter,n,function(u){var c=u.getLeft();return me(c)&&c>r.viewportLeft})},t.prototype.getAriaColumnIndex=function(e){return this.getAllGridColumns().indexOf(e)+1},t.prototype.isColumnInHeaderViewport=function(e){return!!e.isAutoHeaderHeight()||this.isColumnInRowViewport(e)},t.prototype.isColumnInRowViewport=function(e){if(e.isAutoHeight())return!0;var r=e.getLeft()||0,i=r+e.getActualWidth(),n=this.viewportLeft-200,u=this.viewportRight+200;return!(r<n&&i<n)&&!(r>u&&i>u)},t.prototype.getDisplayedColumnsLeftWidth=function(){return this.getWidthOfColsInList(this.displayedColumnsLeft)},t.prototype.getDisplayedColumnsRightWidth=function(){return this.getWidthOfColsInList(this.displayedColumnsRight)},t.prototype.updatePrimaryColumnList=function(e,r,i,n,u,c){var v=this;if(void 0===c&&(c="api"),e&&!Ve(e)){var m=!1;if(e.forEach(function(_){var O=v.getPrimaryColumn(_);if(O){if(i){if(r.indexOf(O)>=0)return;r.push(O)}else{if(r.indexOf(O)<0)return;Nr(r,O)}n(O),m=!0}}),m){this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(c);var C={type:u,columns:r,column:1===r.length?r[0]:null,source:c};this.eventService.dispatchEvent(C)}}},t.prototype.setRowGroupColumns=function(e,r){void 0===r&&(r="api"),this.autoGroupsNeedBuilding=!0,this.setPrimaryColumnList(e,this.rowGroupColumns,I.EVENT_COLUMN_ROW_GROUP_CHANGED,this.setRowGroupActive.bind(this),r)},t.prototype.setRowGroupActive=function(e,r,i){e!==r.isRowGroupActive()&&(r.setRowGroupActive(e,i),e&&!this.gridOptionsService.is("suppressRowGroupHidesColumns")&&this.setColumnVisible(r,!1,i),!e&&!this.gridOptionsService.is("suppressMakeColumnVisibleAfterUnGroup")&&this.setColumnVisible(r,!0,i))},t.prototype.addRowGroupColumn=function(e,r){void 0===r&&(r="api"),e&&this.addRowGroupColumns([e],r)},t.prototype.addRowGroupColumns=function(e,r){void 0===r&&(r="api"),this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(e,this.rowGroupColumns,!0,this.setRowGroupActive.bind(this,!0),I.EVENT_COLUMN_ROW_GROUP_CHANGED,r)},t.prototype.removeRowGroupColumns=function(e,r){void 0===r&&(r="api"),this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(e,this.rowGroupColumns,!1,this.setRowGroupActive.bind(this,!1),I.EVENT_COLUMN_ROW_GROUP_CHANGED,r)},t.prototype.removeRowGroupColumn=function(e,r){void 0===r&&(r="api"),e&&this.removeRowGroupColumns([e],r)},t.prototype.addPivotColumns=function(e,r){void 0===r&&(r="api"),this.updatePrimaryColumnList(e,this.pivotColumns,!0,function(i){return i.setPivotActive(!0,r)},I.EVENT_COLUMN_PIVOT_CHANGED,r)},t.prototype.setPivotColumns=function(e,r){void 0===r&&(r="api"),this.setPrimaryColumnList(e,this.pivotColumns,I.EVENT_COLUMN_PIVOT_CHANGED,function(i,n){n.setPivotActive(i,r)},r)},t.prototype.addPivotColumn=function(e,r){void 0===r&&(r="api"),this.addPivotColumns([e],r)},t.prototype.removePivotColumns=function(e,r){void 0===r&&(r="api"),this.updatePrimaryColumnList(e,this.pivotColumns,!1,function(i){return i.setPivotActive(!1,r)},I.EVENT_COLUMN_PIVOT_CHANGED,r)},t.prototype.removePivotColumn=function(e,r){void 0===r&&(r="api"),this.removePivotColumns([e],r)},t.prototype.setPrimaryColumnList=function(e,r,i,n,u){var c=this;r.length=0,me(e)&&e.forEach(function(v){var m=c.getPrimaryColumn(v);m&&r.push(m)}),(this.primaryColumns||[]).forEach(function(v){var m=r.indexOf(v)>=0;n(m,v)}),this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(u),this.dispatchColumnChangedEvent(i,r,u)},t.prototype.setValueColumns=function(e,r){void 0===r&&(r="api"),this.setPrimaryColumnList(e,this.valueColumns,I.EVENT_COLUMN_VALUE_CHANGED,this.setValueActive.bind(this),r)},t.prototype.setValueActive=function(e,r,i){if(e!==r.isValueActive()&&(r.setValueActive(e,i),e&&!r.getAggFunc())){var n=this.aggFuncService.getDefaultAggFunc(r);r.setAggFunc(n)}},t.prototype.addValueColumns=function(e,r){void 0===r&&(r="api"),this.updatePrimaryColumnList(e,this.valueColumns,!0,this.setValueActive.bind(this,!0),I.EVENT_COLUMN_VALUE_CHANGED,r)},t.prototype.addValueColumn=function(e,r){void 0===r&&(r="api"),e&&this.addValueColumns([e],r)},t.prototype.removeValueColumn=function(e,r){void 0===r&&(r="api"),this.removeValueColumns([e],r)},t.prototype.removeValueColumns=function(e,r){void 0===r&&(r="api"),this.updatePrimaryColumnList(e,this.valueColumns,!1,this.setValueActive.bind(this,!1),I.EVENT_COLUMN_VALUE_CHANGED,r)},t.prototype.normaliseColumnWidth=function(e,r){var i=e.getMinWidth();me(i)&&r<i&&(r=i);var n=e.getMaxWidth();return me(n)&&e.isGreaterThanMax(r)&&(r=n),r},t.prototype.getPrimaryOrGridColumn=function(e){return this.getPrimaryColumn(e)||this.getGridColumn(e)},t.prototype.setColumnWidths=function(e,r,i,n){var u=this;void 0===n&&(n="api");var c=[];e.forEach(function(v){var m=u.getPrimaryOrGridColumn(v.key);if(m&&(c.push({width:v.newWidth,ratios:[1],columns:[m]}),"shift"===u.gridOptionsService.get("colResizeDefault")&&(r=!r),r)){var _=u.getDisplayedColAfter(m);if(!_)return;var O=m.getActualWidth()-v.newWidth,P=_.getActualWidth()+O;c.push({width:P,ratios:[1],columns:[_]})}}),0!==c.length&&this.resizeColumnSets({resizeSets:c,finished:i,source:n})},t.prototype.checkMinAndMaxWidthsForSet=function(e){var r=e.columns,i=e.width,n=0,u=0,c=!0;return r.forEach(function(C){var _=C.getMinWidth();n+=_||0;var O=C.getMaxWidth();me(O)&&O>0?u+=O:c=!1}),i>=n&&(!c||i<=u)},t.prototype.resizeColumnSets=function(e){var r=this,i=e.resizeSets,n=e.finished,u=e.source;if(!i||i.every(function(L){return r.checkMinAndMaxWidthsForSet(L)})){var m=[],C=[];i.forEach(function(L){var z=L.width,q=L.columns,Z=L.ratios,re={},pe={};q.forEach(function(ze){return C.push(ze)});for(var Ce=!0,be=0,qe=function(){if(++be>1e3)return console.error("AG Grid: infinite loop in resizeColumnSets"),"break";Ce=!1;var ze=[],st=0,nt=z;q.forEach(function(Et,Dr){if(pe[Et.getId()])nt-=re[Et.getId()];else{ze.push(Et);var Yt=Z[Dr];st+=Yt}});var Gt=1/st;ze.forEach(function(Et,Dr){var Yt;Dr===ze.length-1?Yt=nt:(Yt=Math.round(Z[Dr]*z*Gt),nt-=Yt);var Ht=Et.getMinWidth(),gi=Et.getMaxWidth();me(Ht)&&Yt<Ht?(Yt=Ht,pe[Et.getId()]=!0,Ce=!0):me(gi)&&gi>0&&Yt>gi&&(Yt=gi,pe[Et.getId()]=!0,Ce=!0),re[Et.getId()]=Yt})};Ce;){if("break"===qe())break}q.forEach(function(ze){var st=re[ze.getId()];ze.getActualWidth()!==st&&(ze.setActualWidth(st,u),m.push(ze))})});var _=m.length>0,O=[];_&&(O=this.refreshFlexedColumns({resizingCols:C,skipSetLeft:!0}),this.setLeftValues(u),this.updateBodyWidths(),this.checkViewportColumns());var P=C.concat(O);(_||n)&&this.dispatchColumnResizedEvent(P,n,u,O)}else if(n){var v=i&&i.length>0?i[0].columns:null;this.dispatchColumnResizedEvent(v,n,u)}},t.prototype.setColumnAggFunc=function(e,r,i){if(void 0===i&&(i="api"),e){var n=this.getPrimaryColumn(e);n&&(n.setAggFunc(r),this.dispatchColumnChangedEvent(I.EVENT_COLUMN_VALUE_CHANGED,[n],i))}},t.prototype.moveRowGroupColumn=function(e,r,i){void 0===i&&(i="api");var n=this.rowGroupColumns[e];this.rowGroupColumns.splice(e,1),this.rowGroupColumns.splice(r,0,n);var u={type:I.EVENT_COLUMN_ROW_GROUP_CHANGED,columns:this.rowGroupColumns,column:1===this.rowGroupColumns.length?this.rowGroupColumns[0]:null,source:i};this.eventService.dispatchEvent(u)},t.prototype.moveColumns=function(e,r,i,n){if(void 0===i&&(i="api"),void 0===n&&(n=!0),this.columnAnimationService.start(),r>this.gridColumns.length-e.length)return console.warn("AG Grid: tried to insert columns in invalid location, toIndex = "+r),void console.warn("AG Grid: remember that you should not count the moving columns when calculating the new index");var u=this.getGridColumns(e);!this.doesMovePassRules(u,r)||(ol(this.gridColumns,u,r),this.updateDisplayedColumns(i),this.dispatchColumnMovedEvent({movedColumns:u,source:i,toIndex:r,finished:n}),this.columnAnimationService.finish())},t.prototype.doesMovePassRules=function(e,r){var i=this.getProposedColumnOrder(e,r);return this.doesOrderPassRules(i)},t.prototype.doesOrderPassRules=function(e){return!(!this.doesMovePassMarryChildren(e)||!this.doesMovePassLockedPositions(e))},t.prototype.getProposedColumnOrder=function(e,r){var i=this.gridColumns.slice();return ol(i,e,r),i},t.prototype.sortColumnsLikeGridColumns=function(e){var r=this;!e||e.length<=1||(e.filter(function(n){return r.gridColumns.indexOf(n)<0}).length>0||e.sort(function(n,u){return r.gridColumns.indexOf(n)-r.gridColumns.indexOf(u)}))},t.prototype.doesMovePassLockedPositions=function(e){var r=0,i=!0;return e.forEach(function(u){var c=function(u){return u?!0===u||"left"===u?0:2:1}(u.getColDef().lockPosition);c<r&&(i=!1),r=c}),i},t.prototype.doesMovePassMarryChildren=function(e){var r=!0;return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,function(i){if(i instanceof tr){var n=i,u=n.getColGroupDef();if(u&&u.marryChildren){var v=[];n.getLeafColumns().forEach(function(P){var L=e.indexOf(P);v.push(L)}),Math.max.apply(Math,v)-Math.min.apply(Math,v)>n.getLeafColumns().length-1&&(r=!1)}}}),r},t.prototype.moveColumn=function(e,r,i){void 0===i&&(i="api"),this.moveColumns([e],r,i)},t.prototype.moveColumnByIndex=function(e,r,i){void 0===i&&(i="api");var n=this.gridColumns[e];this.moveColumn(n,r,i)},t.prototype.getColumnDefs=function(){var e=this;if(this.primaryColumns){var r=this.primaryColumns.slice();return this.gridColsArePrimary?r.sort(function(i,n){return e.gridColumns.indexOf(i)-e.gridColumns.indexOf(n)}):this.lastPrimaryOrder&&r.sort(function(i,n){return e.lastPrimaryOrder.indexOf(i)-e.lastPrimaryOrder.indexOf(n)}),this.columnDefFactory.buildColumnDefs(r,this.rowGroupColumns,this.pivotColumns)}},t.prototype.getBodyContainerWidth=function(){return this.bodyWidth},t.prototype.getContainerWidth=function(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}},t.prototype.updateBodyWidths=function(){var e=this.getWidthOfColsInList(this.displayedColumnsCenter),r=this.getWidthOfColsInList(this.displayedColumnsLeft),i=this.getWidthOfColsInList(this.displayedColumnsRight);if(this.bodyWidthDirty=this.bodyWidth!==e,this.bodyWidth!==e||this.leftWidth!==r||this.rightWidth!==i){this.bodyWidth=e,this.leftWidth=r,this.rightWidth=i;var u={type:I.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED};this.eventService.dispatchEvent(u)}},t.prototype.getValueColumns=function(){return this.valueColumns?this.valueColumns:[]},t.prototype.getPivotColumns=function(){return this.pivotColumns?this.pivotColumns:[]},t.prototype.isPivotActive=function(){return this.pivotColumns&&this.pivotColumns.length>0&&this.pivotMode},t.prototype.getRowGroupColumns=function(){return this.rowGroupColumns?this.rowGroupColumns:[]},t.prototype.getDisplayedCenterColumns=function(){return this.displayedColumnsCenter},t.prototype.getDisplayedLeftColumns=function(){return this.displayedColumnsLeft},t.prototype.getDisplayedRightColumns=function(){return this.displayedColumnsRight},t.prototype.getDisplayedColumns=function(e){switch(e){case"left":return this.getDisplayedLeftColumns();case"right":return this.getDisplayedRightColumns();default:return this.getDisplayedCenterColumns()}},t.prototype.getAllPrimaryColumns=function(){return this.primaryColumns?this.primaryColumns.slice():null},t.prototype.getSecondaryColumns=function(){return this.secondaryColumns?this.secondaryColumns.slice():null},t.prototype.getAllColumnsForQuickFilter=function(){return this.columnsForQuickFilter},t.prototype.getAllGridColumns=function(){return this.gridColumns},t.prototype.isEmpty=function(){return Ve(this.gridColumns)},t.prototype.isRowGroupEmpty=function(){return Ve(this.rowGroupColumns)},t.prototype.setColumnVisible=function(e,r,i){void 0===i&&(i="api"),this.setColumnsVisible([e],r,i)},t.prototype.setColumnsVisible=function(e,r,i){void 0===r&&(r=!1),void 0===i&&(i="api"),this.applyColumnState({state:e.map(function(n){return{colId:"string"==typeof n?n:n.getColId(),hide:!r}})},i)},t.prototype.setColumnPinned=function(e,r,i){void 0===i&&(i="api"),e&&this.setColumnsPinned([e],r,i)},t.prototype.setColumnsPinned=function(e,r,i){var n;(void 0===i&&(i="api"),this.gridOptionsService.isDomLayout("print"))?console.warn("AG Grid: Changing the column pinning status is not allowed with domLayout='print'"):(this.columnAnimationService.start(),n=!0===r||"left"===r?"left":"right"===r?"right":null,this.actionOnGridColumns(e,function(u){return u.getPinned()!==n&&(u.setPinned(n),!0)},i,function(){return{type:I.EVENT_COLUMN_PINNED,pinned:n,column:null,columns:null,source:i}}),this.columnAnimationService.finish())},t.prototype.actionOnGridColumns=function(e,r,i,n){var u=this;if(!Ve(e)){var c=[];if(e.forEach(function(m){var C=u.getGridColumn(m);C&&(!1!==r(C)&&c.push(C))}),c.length&&(this.updateDisplayedColumns(i),me(n)&&n)){var v=n();v.columns=c,v.column=1===c.length?c[0]:null,this.eventService.dispatchEvent(v)}}},t.prototype.getDisplayedColBefore=function(e){var r=this.getAllDisplayedColumns(),i=r.indexOf(e);return i>0?r[i-1]:null},t.prototype.getDisplayedColAfter=function(e){var r=this.getAllDisplayedColumns(),i=r.indexOf(e);return i<r.length-1?r[i+1]:null},t.prototype.getDisplayedGroupAfter=function(e){return this.getDisplayedGroupAtDirection(e,"After")},t.prototype.getDisplayedGroupBefore=function(e){return this.getDisplayedGroupAtDirection(e,"Before")},t.prototype.getDisplayedGroupAtDirection=function(e,r){for(var i=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),n=e.getDisplayedLeafColumns(),u="After"===r?Mt(n):n[0],c="getDisplayedCol"+r;;){var v=this[c](u);if(!v)return null;var m=this.getColumnGroupAtLevel(v,i);if(m!==e)return m}},t.prototype.getColumnGroupAtLevel=function(e,r){for(var i=e.getParent();;){if(i.getProvidedColumnGroup().getLevel()+i.getPaddingLevel()<=r)break;i=i.getParent()}return i},t.prototype.isPinningLeft=function(){return this.displayedColumnsLeft.length>0},t.prototype.isPinningRight=function(){return this.displayedColumnsRight.length>0},t.prototype.getPrimaryAndSecondaryAndAutoColumns=function(){var e;return(e=[]).concat.apply(e,Pt([this.primaryColumns||[],this.groupAutoColumns||[],this.secondaryColumns||[]]))},t.prototype.createStateItemFromColumn=function(e){var r=e.isRowGroupActive()?this.rowGroupColumns.indexOf(e):null,i=e.isPivotActive()?this.pivotColumns.indexOf(e):null,n=e.isValueActive()?e.getAggFunc():null,u=null!=e.getSort()?e.getSort():null,c=null!=e.getSortIndex()?e.getSortIndex():null,v=null!=e.getFlex()&&e.getFlex()>0?e.getFlex():null;return{colId:e.getColId(),width:e.getActualWidth(),hide:!e.isVisible(),pinned:e.getPinned(),sort:u,sortIndex:c,aggFunc:n,rowGroup:e.isRowGroupActive(),rowGroupIndex:r,pivot:e.isPivotActive(),pivotIndex:i,flex:v}},t.prototype.getColumnState=function(){if(Je(this.primaryColumns)||!this.isAlive())return[];var r=this.getPrimaryAndSecondaryAndAutoColumns().map(this.createStateItemFromColumn.bind(this));return this.orderColumnStateList(r),r},t.prototype.orderColumnStateList=function(e){var r=bn(this.gridColumns.map(function(i,n){return[i.getColId(),n]}));e.sort(function(i,n){return(r.has(i.colId)?r.get(i.colId):-1)-(r.has(n.colId)?r.get(n.colId):-1)})},t.prototype.resetColumnState=function(e){void 0===e&&(e="api");var r=this.getColumnsFromTree(this.primaryColumnTree),i=[],n=1e3,u=1e3,c=[];this.groupAutoColumns&&(c=c.concat(this.groupAutoColumns)),r&&(c=c.concat(r)),c.forEach(function(v){var m=function(et,ze){return et??ze??null},C=v.getColDef(),_=m(C.sort,C.initialSort),O=m(C.sortIndex,C.initialSortIndex),P=m(C.hide,C.initialHide),L=m(C.pinned,C.initialPinned),z=m(C.width,C.initialWidth),q=m(C.flex,C.initialFlex),Z=m(C.rowGroupIndex,C.initialRowGroupIndex),re=m(C.rowGroup,C.initialRowGroup);null==Z&&(null==re||0==re)&&(Z=null,re=null);var pe=m(C.pivotIndex,C.initialPivotIndex),Ce=m(C.pivot,C.initialPivot);null==pe&&(null==Ce||0==Ce)&&(pe=null,Ce=null);var be=m(C.aggFunc,C.initialAggFunc),qe={colId:v.getColId(),sort:_,sortIndex:O,hide:P,pinned:L,width:z,flex:q,rowGroup:re,rowGroupIndex:Z,pivot:Ce,pivotIndex:pe,aggFunc:be};Je(Z)&&re&&(qe.rowGroupIndex=n++),Je(pe)&&Ce&&(qe.pivotIndex=u++),i.push(qe)}),this.applyColumnState({state:i,applyOrder:!0},e)},t.prototype.applyColumnState=function(e,r){var i=this;if(Ve(this.primaryColumns))return!1;if(e&&e.state&&!e.state.forEach)return console.warn("AG Grid: applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state."),!1;var n=function(m,C,_){var O=i.compareColumnStatesAndDispatchEvents(r);i.autoGroupsNeedBuilding=!0;var P=C.slice(),L={},z={},q=[],Z=[],re=0,pe=i.rowGroupColumns.slice(),Ce=i.pivotColumns.slice();m.forEach(function(ze){var st=ze.colId||"";if(st.startsWith(Jt))return q.push(ze),void Z.push(ze);var Gt=_(st);Gt?(i.syncColumnWithStateItem(Gt,ze,e.defaultState,L,z,!1,r),Nr(P,Gt)):(Z.push(ze),re+=1)});var be=function(ze){return i.syncColumnWithStateItem(ze,null,e.defaultState,L,z,!1,r)};P.forEach(be);var qe=function(ze,st,nt,Gt){var Et=ze[nt.getId()],Dr=ze[Gt.getId()],Xr=null!=Et,Yt=null!=Dr;if(Xr&&Yt)return Et-Dr;if(Xr)return-1;if(Yt)return 1;var Ht=st.indexOf(nt),gi=st.indexOf(Gt),jo=Ht>=0;return jo&&gi>=0?Ht-gi:jo?-1:1};i.rowGroupColumns.sort(qe.bind(i,L,pe)),i.pivotColumns.sort(qe.bind(i,z,Ce)),i.updateGridColumns();var et=i.groupAutoColumns?i.groupAutoColumns.slice():[];return q.forEach(function(ze){var st=i.getAutoColumn(ze.colId);Nr(et,st),i.syncColumnWithStateItem(st,ze,e.defaultState,null,null,!0,r)}),et.forEach(be),i.applyOrderAfterApplyState(e),i.updateDisplayedColumns(r),i.dispatchEverythingChanged(r),O(),{unmatchedAndAutoStates:Z,unmatchedCount:re}};this.columnAnimationService.start();var u=n(e.state||[],this.primaryColumns||[],function(m){return i.getPrimaryColumn(m)}),c=u.unmatchedAndAutoStates,v=u.unmatchedCount;return(c.length>0||me(e.defaultState))&&(v=n(c,this.secondaryColumns||[],function(m){return i.getSecondaryColumn(m)}).unmatchedCount),this.columnAnimationService.finish(),0===v},t.prototype.applyOrderAfterApplyState=function(e){var r=this;if(e.applyOrder&&e.state){var i=[],n={};e.state.forEach(function(c){if(c.colId&&!n[c.colId]){var v=r.gridColumnsMap[c.colId];v&&(i.push(v),n[c.colId]=!0)}});var u=0;if(this.gridColumns.forEach(function(c){var v=c.getColId();null!=n[v]||(v.startsWith(Jt)?wi(i,c,u++):i.push(c))}),i=this.placeLockedColumns(i),!this.doesMovePassMarryChildren(i))return void console.warn("AG Grid: Applying column order broke a group where columns should be married together. Applying new order has been discarded.");this.gridColumns=i}},t.prototype.compareColumnStatesAndDispatchEvents=function(e){var r=this,i={rowGroupColumns:this.rowGroupColumns.slice(),pivotColumns:this.pivotColumns.slice(),valueColumns:this.valueColumns.slice()},n=this.getColumnState(),u={};return n.forEach(function(c){u[c.colId]=c}),function(){var c=r.getPrimaryAndSecondaryAndAutoColumns(),v=function(Z,re,pe,Ce){if(!Xn(re.map(Ce),pe.map(Ce))){var ze={type:Z,columns:pe,column:1===pe.length?pe[0]:null,source:e};r.eventService.dispatchEvent(ze)}},m=function(Z){var re=[];return c.forEach(function(pe){var Ce=u[pe.getColId()];Ce&&Z(Ce,pe)&&re.push(pe)}),re},C=function(Z){return Z.getColId()};v(I.EVENT_COLUMN_ROW_GROUP_CHANGED,i.rowGroupColumns,r.rowGroupColumns,C),v(I.EVENT_COLUMN_PIVOT_CHANGED,i.pivotColumns,r.pivotColumns,C);m(function(Z,re){var pe=null!=Z.aggFunc,Ce=pe!=re.isValueActive(),be=pe&&Z.aggFunc!=re.getAggFunc();return Ce||be}).length>0&&r.dispatchColumnChangedEvent(I.EVENT_COLUMN_VALUE_CHANGED,r.valueColumns,e);r.dispatchColumnResizedEvent(m(function(Z,re){return Z.width!=re.getActualWidth()}),!0,e);r.dispatchColumnPinnedEvent(m(function(Z,re){return Z.pinned!=re.getPinned()}),e);r.dispatchColumnVisibleEvent(m(function(Z,re){return Z.hide==re.isVisible()}),e);m(function(Z,re){return Z.sort!=re.getSort()||Z.sortIndex!=re.getSortIndex()}).length>0&&r.sortController.dispatchSortChangedEvents(e),r.normaliseColumnMovedEventForColumnState(n,e)}},t.prototype.getCommonValue=function(e,r){if(e&&0!=e.length){for(var i=r(e[0]),n=1;n<e.length;n++)if(i!==r(e[n]))return;return i}},t.prototype.normaliseColumnMovedEventForColumnState=function(e,r){var i=this,n=this.getColumnState(),u={};n.forEach(function(_){return u[_.colId]=_});var c={};e.forEach(function(_){u[_.colId]&&(c[_.colId]=!0)});var v=e.filter(function(_){return c[_.colId]}),m=n.filter(function(_){return c[_.colId]}),C=[];m.forEach(function(_,O){var P=v&&v[O];if(P&&P.colId!==_.colId){var L=i.getGridColumn(P.colId);L&&C.push(L)}}),C.length&&this.dispatchColumnMovedEvent({movedColumns:C,source:r,finished:!0})},t.prototype.syncColumnWithStateItem=function(e,r,i,n,u,c,v){if(e){var m=function(st,nt){var Gt={value1:void 0,value2:void 0},Et=!1;return r&&(void 0!==r[st]&&(Gt.value1=r[st],Et=!0),me(nt)&&void 0!==r[nt]&&(Gt.value2=r[nt],Et=!0)),!Et&&i&&(void 0!==i[st]&&(Gt.value1=i[st]),me(nt)&&void 0!==i[nt]&&(Gt.value2=i[nt])),Gt},C=m("hide").value1;void 0!==C&&e.setVisible(!C,v);var _=m("pinned").value1;void 0!==_&&e.setPinned(_);var O=this.columnUtils.calculateColMinWidth(e.getColDef()),P=m("flex").value1;if(void 0!==P&&e.setFlex(P),e.getFlex()<=0){var z=m("width").value1;null!=z&&null!=O&&z>=O&&e.setActualWidth(z,v)}var q=m("sort").value1;void 0!==q&&("desc"===q||"asc"===q?e.setSort(q,v):e.setSort(void 0,v));var Z=m("sortIndex").value1;if(void 0!==Z&&e.setSortIndex(Z),!c&&e.isPrimary()){var re=m("aggFunc").value1;void 0!==re&&("string"==typeof re?(e.setAggFunc(re),e.isValueActive()||(e.setValueActive(!0,v),this.valueColumns.push(e))):(me(re)&&console.warn("AG Grid: stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON."),e.isValueActive()&&(e.setValueActive(!1,v),Nr(this.valueColumns,e))));var pe=m("rowGroup","rowGroupIndex"),Ce=pe.value1,be=pe.value2;(void 0!==Ce||void 0!==be)&&("number"==typeof be||Ce?(e.isRowGroupActive()||(e.setRowGroupActive(!0,v),this.rowGroupColumns.push(e)),n&&"number"==typeof be&&(n[e.getId()]=be)):e.isRowGroupActive()&&(e.setRowGroupActive(!1,v),Nr(this.rowGroupColumns,e)));var qe=m("pivot","pivotIndex"),et=qe.value1,ze=qe.value2;(void 0!==et||void 0!==ze)&&("number"==typeof ze||et?(e.isPivotActive()||(e.setPivotActive(!0,v),this.pivotColumns.push(e)),u&&"number"==typeof ze&&(u[e.getId()]=ze)):e.isPivotActive()&&(e.setPivotActive(!1,v),Nr(this.pivotColumns,e)))}}},t.prototype.getGridColumns=function(e){return this.getColumns(e,this.getGridColumn.bind(this))},t.prototype.getColumns=function(e,r){var i=[];return e&&e.forEach(function(n){var u=r(n);u&&i.push(u)}),i},t.prototype.getColumnWithValidation=function(e){if(null==e)return null;var r=this.getGridColumn(e);return r||console.warn("AG Grid: could not find column "+e),r},t.prototype.getPrimaryColumn=function(e){return this.primaryColumns?this.getColumn(e,this.primaryColumns,this.primaryColumnsMap):null},t.prototype.getGridColumn=function(e){return this.getColumn(e,this.gridColumns,this.gridColumnsMap)},t.prototype.getSecondaryColumn=function(e){return this.secondaryColumns?this.getColumn(e,this.secondaryColumns,this.secondaryColumnsMap):null},t.prototype.getColumn=function(e,r,i){if(!e)return null;if("string"==typeof e&&i[e])return i[e];for(var n=0;n<r.length;n++)if(this.columnsMatch(r[n],e))return r[n];return this.getAutoColumn(e)},t.prototype.getSourceColumnsForGroupColumn=function(e){var r=e.getColDef().showRowGroup;if(!r)return null;if(!0===r)return this.rowGroupColumns.slice(0);var i=this.getPrimaryColumn(r);return i?[i]:null},t.prototype.getAutoColumn=function(e){var r=this;return this.groupAutoColumns&&me(this.groupAutoColumns)&&!Je(this.groupAutoColumns)&&this.groupAutoColumns.find(function(i){return r.columnsMatch(i,e)})||null},t.prototype.columnsMatch=function(e,r){var i=e===r,n=e.getColDef()===r,u=e.getColId()==r;return i||n||u},t.prototype.getDisplayNameForColumn=function(e,r,i){if(void 0===i&&(i=!1),!e)return null;var n=this.getHeaderName(e.getColDef(),e,null,null,r);return i?this.wrapHeaderNameWithAggFunc(e,n):n},t.prototype.getDisplayNameForProvidedColumnGroup=function(e,r,i){var n=r?r.getColGroupDef():null;return n?this.getHeaderName(n,null,e,r,i):null},t.prototype.getDisplayNameForColumnGroup=function(e,r){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),r)},t.prototype.getHeaderName=function(e,r,i,n,u){var c=e.headerValueGetter;if(c){var v={colDef:e,column:r,columnGroup:i,providedColumnGroup:n,location:u,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};return"function"==typeof c?c(v):"string"==typeof c?this.expressionService.evaluate(c,v):(console.warn("AG Grid: headerValueGetter must be a function or a string"),"")}return null!=e.headerName?e.headerName:e.field?Zo(e.field):""},t.prototype.wrapHeaderNameWithAggFunc=function(e,r){if(this.gridOptionsService.is("suppressAggFuncInHeader"))return r;var c,i=e.getColDef().pivotValueColumn,u=null;if(me(i)){var v=this.gridOptionsService.is("removePivotHeaderRowWhenSingleValueColumn")&&1===this.valueColumns.length,m=void 0!==e.getColDef().pivotTotalColumnIds;if(v&&!m)return r;u=i?i.getAggFunc():null,c=!0}else{var C=e.isValueActive(),_=this.pivotMode||!this.isRowGroupEmpty();C&&_?(u=e.getAggFunc(),c=!0):c=!1}if(c){var O="string"==typeof u?u:"func";return this.localeService.getLocaleTextFunc()(O,O)+"("+r+")"}return r},t.prototype.getColumnGroup=function(e,r){if(!e)return null;if(e instanceof ti)return e;var i=this.getAllDisplayedTrees(),n="number"==typeof r,u=null;return this.columnUtils.depthFirstAllColumnTreeSearch(i,function(c){if(c instanceof ti){var v=c;(n?e===v.getGroupId()&&r===v.getPartId():e===v.getGroupId())&&(u=v)}}),u},t.prototype.isReady=function(){return this.ready},t.prototype.extractValueColumns=function(e,r){this.valueColumns=this.extractColumns(r,this.valueColumns,function(i,n){return i.setValueActive(n,e)},function(){},function(){},function(i){var n=i.aggFunc;return null===n||""===n?null:void 0!==n?!!n:void 0},function(i){return null!=i.initialAggFunc&&""!=i.initialAggFunc}),this.valueColumns.forEach(function(i){var n=i.getColDef();null!=n.aggFunc&&""!=n.aggFunc?i.setAggFunc(n.aggFunc):i.getAggFunc()||i.setAggFunc(n.initialAggFunc)})},t.prototype.extractRowGroupColumns=function(e,r){this.rowGroupColumns=this.extractColumns(r,this.rowGroupColumns,function(i,n){return i.setRowGroupActive(n,e)},function(i){return i.rowGroupIndex},function(i){return i.initialRowGroupIndex},function(i){return i.rowGroup},function(i){return i.initialRowGroup})},t.prototype.extractColumns=function(e,r,i,n,u,c,v){void 0===e&&(e=[]),void 0===r&&(r=[]);var m=[],C=[];(this.primaryColumns||[]).forEach(function(P){var L=e.indexOf(P)<0,z=P.getColDef(),q=ct(c(z)),Z=ct(v(z)),re=$e(n(z)),pe=$e(u(z));(void 0!==q?q:void 0!==re?null!==re&&re>=0:L?void 0!==Z?Z:!!(void 0!==pe)&&(null!=pe&&pe>=0):r.indexOf(P)>=0)&&((L?null!=re||null!=pe:null!=re)?m.push(P):C.push(P))});var _=function(P){var L=n(P.getColDef()),z=u(P.getColDef());return L??z};m.sort(function(P,L){var z=_(P),q=_(L);return z===q?0:z<q?-1:1});var O=[].concat(m);return r.forEach(function(P){C.indexOf(P)>=0&&O.push(P)}),C.forEach(function(P){O.indexOf(P)<0&&O.push(P)}),r.forEach(function(P){O.indexOf(P)<0&&i(P,!1)}),O.forEach(function(P){r.indexOf(P)<0&&i(P,!0)}),O},t.prototype.extractPivotColumns=function(e,r){this.pivotColumns=this.extractColumns(r,this.pivotColumns,function(i,n){return i.setPivotActive(n,e)},function(i){return i.pivotIndex},function(i){return i.initialPivotIndex},function(i){return i.pivot},function(i){return i.initialPivot})},t.prototype.resetColumnGroupState=function(e){void 0===e&&(e="api");var r=[];this.columnUtils.depthFirstOriginalTreeSearch(null,this.primaryColumnTree,function(i){if(i instanceof tr){var n=i.getColGroupDef(),u={groupId:i.getGroupId(),open:n?n.openByDefault:void 0};r.push(u)}}),this.setColumnGroupState(r,e)},t.prototype.getColumnGroupState=function(){var e=[];return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,function(r){r instanceof tr&&e.push({groupId:r.getGroupId(),open:r.isExpanded()})}),e},t.prototype.setColumnGroupState=function(e,r){var i=this;void 0===r&&(r="api"),this.columnAnimationService.start();var n=[];e.forEach(function(u){var c=u.groupId,v=u.open,m=i.getProvidedColumnGroup(c);m&&m.isExpanded()!==v&&(i.logger.log("columnGroupOpened("+m.getGroupId()+","+v+")"),m.setExpanded(v),n.push(m))}),this.updateGroupsAndDisplayedColumns(r),this.setFirstRightAndLastLeftPinned(r),n.forEach(function(u){var c={type:I.EVENT_COLUMN_GROUP_OPENED,columnGroup:u};i.eventService.dispatchEvent(c)}),this.columnAnimationService.finish()},t.prototype.setColumnGroupOpened=function(e,r,i){var n;void 0===i&&(i="api"),n=e instanceof tr?e.getId():e||"",this.setColumnGroupState([{groupId:n,open:r}],i)},t.prototype.getProvidedColumnGroup=function(e){"string"!=typeof e&&console.error("AG Grid: group key must be a string");var r=null;return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,function(i){i instanceof tr&&i.getId()===e&&(r=i)}),r},t.prototype.calculateColumnsForDisplay=function(){var e=this;return this.pivotMode&&Je(this.secondaryColumns)?this.gridColumns.filter(function(i){var n=e.groupAutoColumns&&kr(e.groupAutoColumns,i),u=e.valueColumns&&kr(e.valueColumns,i);return n||u}):this.gridColumns.filter(function(i){return e.groupAutoColumns&&kr(e.groupAutoColumns,i)||i.isVisible()})},t.prototype.checkColSpanActiveInCols=function(e){var r=!1;return e.forEach(function(i){me(i.getColDef().colSpan)&&(r=!0)}),r},t.prototype.calculateColumnsForGroupDisplay=function(){var e=this;this.groupDisplayColumns=[],this.groupDisplayColumnsMap={};var r=function(i){var n=i.getColDef(),u=n.showRowGroup;n&&me(u)&&(e.groupDisplayColumns.push(i),"string"==typeof u?e.groupDisplayColumnsMap[u]=i:!0===u&&e.getRowGroupColumns().forEach(function(c){e.groupDisplayColumnsMap[c.getId()]=i}))};this.gridColumns.forEach(r),this.groupAutoColumns&&this.groupAutoColumns.forEach(r)},t.prototype.getGroupDisplayColumns=function(){return this.groupDisplayColumns},t.prototype.getGroupDisplayColumnForGroup=function(e){return this.groupDisplayColumnsMap[e]},t.prototype.updateDisplayedColumns=function(e){var r=this.calculateColumnsForDisplay();this.buildDisplayedTrees(r),this.calculateColumnsForGroupDisplay(),this.updateGroupsAndDisplayedColumns(e),this.setFirstRightAndLastLeftPinned(e)},t.prototype.isSecondaryColumnsPresent=function(){return me(this.secondaryColumns)},t.prototype.setSecondaryColumns=function(e,r){var i=this;void 0===r&&(r="api");var n=e&&e.length>0;if(n||!Je(this.secondaryColumns)){if(n){this.processSecondaryColumnDefinitions(e);var u=this.columnFactory.createColumnTree(e,!1,this.secondaryBalancedTree||this.previousSecondaryColumns||void 0);this.destroyOldColumns(this.secondaryBalancedTree,u.columnTree),this.secondaryBalancedTree=u.columnTree,this.secondaryHeaderRowCount=u.treeDept+1,this.secondaryColumns=this.getColumnsFromTree(this.secondaryBalancedTree),this.secondaryColumnsMap={},this.secondaryColumns.forEach(function(c){return i.secondaryColumnsMap[c.getId()]=c}),this.previousSecondaryColumns=null}else this.previousSecondaryColumns=this.secondaryBalancedTree,this.secondaryBalancedTree=null,this.secondaryHeaderRowCount=-1,this.secondaryColumns=null,this.secondaryColumnsMap={};this.updateGridColumns(),this.updateDisplayedColumns(r)}},t.prototype.processSecondaryColumnDefinitions=function(e){var r=this.gridOptionsService.get("processPivotResultColDef")||this.gridOptionsService.get("processSecondaryColDef"),i=this.gridOptionsService.get("processPivotResultColGroupDef")||this.gridOptionsService.get("processSecondaryColGroupDef");if(r||i){var n=function(u){u.forEach(function(c){if(me(c.children)){var m=c;i&&i(m),n(m.children)}else{r&&r(c)}})};e&&n(e)}},t.prototype.updateGridColumns=function(){var i,e=this,r=this.gridBalancedTree;if(this.gridColsArePrimary?this.lastPrimaryOrder=this.gridColumns:this.lastSecondaryOrder=this.gridColumns,this.secondaryColumns&&this.secondaryBalancedTree){var n=this.secondaryColumns.every(function(m){return void 0!==e.gridColumnsMap[m.getColId()]});this.gridBalancedTree=this.secondaryBalancedTree.slice(),this.gridHeaderRowCount=this.secondaryHeaderRowCount,this.gridColumns=this.secondaryColumns.slice(),this.gridColsArePrimary=!1,n&&(i=this.lastSecondaryOrder)}else this.primaryColumns&&(this.gridBalancedTree=this.primaryColumnTree.slice(),this.gridHeaderRowCount=this.primaryHeaderRowCount,this.gridColumns=this.primaryColumns.slice(),this.gridColsArePrimary=!0,i=this.lastPrimaryOrder);if(this.createGroupAutoColumnsIfNeeded()&&i){var c=bn(this.groupAutoColumns.map(function(m){return[m,!0]}));i=i.filter(function(m){return!c.has(m)}),i=Pt(this.groupAutoColumns,i)}if(this.addAutoGroupToGridColumns(),this.orderGridColsLike(i),this.gridColumns=this.placeLockedColumns(this.gridColumns),this.refreshQuickFilterColumns(),this.clearDisplayedAndViewportColumns(),this.colSpanActive=this.checkColSpanActiveInCols(this.gridColumns),this.gridColumnsMap={},this.gridColumns.forEach(function(m){return e.gridColumnsMap[m.getId()]=m}),this.setAutoHeightActive(),!Xn(r,this.gridBalancedTree)){var v={type:I.EVENT_GRID_COLUMNS_CHANGED};this.eventService.dispatchEvent(v)}},t.prototype.setAutoHeightActive=function(){if((this.autoHeightActive=this.gridColumns.filter(function(i){return i.isAutoHeight()}).length>0,this.autoHeightActive)&&(this.autoHeightActiveAtLeastOnce=!0,!(this.gridOptionsService.isRowModelType("clientSide")||this.gridOptionsService.isRowModelType("serverSide")))){_t(function(){return console.warn("AG Grid - autoHeight columns only work with Client Side Row Model and Server Side Row Model.")},"autoHeightActive.wrongRowModel")}},t.prototype.orderGridColsLike=function(e){if(!Je(e)){var r=bn(e.map(function(C,_){return[C,_]})),i=!0;if(this.gridColumns.forEach(function(C){r.has(C)&&(i=!1)}),!i){var n=bn(this.gridColumns.map(function(C){return[C,!0]})),u=e.filter(function(C){return n.has(C)}),c=bn(u.map(function(C){return[C,!0]})),v=this.gridColumns.filter(function(C){return!c.has(C)}),m=u.slice();v.forEach(function(C){var _=C.getOriginalParent();if(_){for(var O=[];!O.length&&_;){_.getLeafColumns().forEach(function(q){var Z=m.indexOf(q)>=0,re=O.indexOf(q)<0;Z&&re&&O.push(q)}),_=_.getOriginalParent()}if(O.length){var L=O.map(function(q){return m.indexOf(q)}),z=Math.max.apply(Math,Pt(L));wi(m,C,z+1)}else m.push(C)}else m.push(C)}),this.gridColumns=m}}},t.prototype.isPrimaryColumnGroupsPresent=function(){return this.primaryHeaderRowCount>1},t.prototype.refreshQuickFilterColumns=function(){var e,r;this.groupAutoColumns?r=(null!==(e=this.primaryColumns)&&void 0!==e?e:[]).concat(this.groupAutoColumns):this.primaryColumns&&(r=this.primaryColumns),r=r??[],this.columnsForQuickFilter=this.gridOptionsService.is("excludeHiddenColumnsFromQuickFilter")?r.filter(function(i){return i.isVisible()||i.isRowGroupActive()}):r},t.prototype.placeLockedColumns=function(e){var r=[],i=[],n=[];return e.forEach(function(u){var c=u.getColDef().lockPosition;"right"===c?n.push(u):"left"===c||!0===c?r.push(u):i.push(u)}),Pt(r,i,n)},t.prototype.addAutoGroupToGridColumns=function(){if(Je(this.groupAutoColumns))return this.destroyOldColumns(this.groupAutoColsBalancedTree),void(this.groupAutoColsBalancedTree=null);this.gridColumns=this.groupAutoColumns?this.groupAutoColumns.concat(this.gridColumns):this.gridColumns;var e=this.columnFactory.createForAutoGroups(this.groupAutoColumns,this.gridBalancedTree);this.destroyOldColumns(this.groupAutoColsBalancedTree,e),this.groupAutoColsBalancedTree=e,this.gridBalancedTree=e.concat(this.gridBalancedTree)},t.prototype.clearDisplayedAndViewportColumns=function(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={},this.displayedColumnsLeft=[],this.displayedColumnsRight=[],this.displayedColumnsCenter=[],this.displayedColumns=[],this.viewportColumns=[],this.headerViewportColumns=[],this.viewportColumnsHash=""},t.prototype.updateGroupsAndDisplayedColumns=function(e){this.updateOpenClosedVisibilityInColumnGroups(),this.deriveDisplayedColumns(e),this.refreshFlexedColumns(),this.extractViewport(),this.updateBodyWidths();var r={type:I.EVENT_DISPLAYED_COLUMNS_CHANGED};this.eventService.dispatchEvent(r)},t.prototype.deriveDisplayedColumns=function(e){this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeLeft,this.displayedColumnsLeft),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeCentre,this.displayedColumnsCenter),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeRight,this.displayedColumnsRight),this.joinDisplayedColumns(),this.setLeftValues(e),this.displayedAutoHeightCols=this.displayedColumns.filter(function(r){return r.isAutoHeight()})},t.prototype.isAutoRowHeightActive=function(){return this.autoHeightActive},t.prototype.wasAutoRowHeightEverActive=function(){return this.autoHeightActiveAtLeastOnce},t.prototype.joinDisplayedColumns=function(){this.gridOptionsService.is("enableRtl")?this.displayedColumns=this.displayedColumnsRight.concat(this.displayedColumnsCenter).concat(this.displayedColumnsLeft):this.displayedColumns=this.displayedColumnsLeft.concat(this.displayedColumnsCenter).concat(this.displayedColumnsRight)},t.prototype.setLeftValues=function(e){this.setLeftValuesOfColumns(e),this.setLeftValuesOfGroups()},t.prototype.setLeftValuesOfColumns=function(e){var r=this;if(this.primaryColumns){var i=this.primaryColumns.slice(0),n=this.gridOptionsService.is("enableRtl");[this.displayedColumnsLeft,this.displayedColumnsRight,this.displayedColumnsCenter].forEach(function(u){if(n){var c=r.getWidthOfColsInList(u);u.forEach(function(m){c-=m.getActualWidth(),m.setLeft(c,e)})}else{var v=0;u.forEach(function(m){m.setLeft(v,e),v+=m.getActualWidth()})}Di(i,u)}),i.forEach(function(u){u.setLeft(null,e)})}},t.prototype.setLeftValuesOfGroups=function(){[this.displayedTreeLeft,this.displayedTreeRight,this.displayedTreeCentre].forEach(function(e){e.forEach(function(r){r instanceof ti&&r.checkLeft()})})},t.prototype.derivedDisplayedColumnsFromDisplayedTree=function(e,r){r.length=0,this.columnUtils.depthFirstDisplayedColumnTreeSearch(e,function(i){i instanceof Kt&&r.push(i)})},t.prototype.extractViewportColumns=function(){this.suppressColumnVirtualisation?(this.viewportColumnsCenter=this.displayedColumnsCenter,this.headerViewportColumnsCenter=this.displayedColumnsCenter):(this.viewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInRowViewport.bind(this)),this.headerViewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInHeaderViewport.bind(this))),this.viewportColumns=this.viewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight),this.headerViewportColumns=this.headerViewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight)},t.prototype.getVirtualHeaderGroupRow=function(e,r){var i;switch(e){case"left":i=this.viewportRowLeft[r];break;case"right":i=this.viewportRowRight[r];break;default:i=this.viewportRowCenter[r]}return Je(i)&&(i=[]),i},t.prototype.calculateHeaderRows=function(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={};var e={};this.headerViewportColumns.forEach(function(i){return e[i.getId()]=!0});var r=function(i,n,u){for(var c=!1,v=0;v<i.length;v++){var m=i[v],C=!1;if(m instanceof Kt)C=!0===e[m.getId()];else{var O=m.getDisplayedChildren();O&&(C=r(O,n,u+1))}C&&(c=!0,n[u]||(n[u]=[]),n[u].push(m))}return c};r(this.displayedTreeLeft,this.viewportRowLeft,0),r(this.displayedTreeRight,this.viewportRowRight,0),r(this.displayedTreeCentre,this.viewportRowCenter,0)},t.prototype.extractViewport=function(){this.extractViewportColumns();var r=this.viewportColumns.map(function(n){return n.getId()+"-"+(n.getPinned()||"normal")}).join("#"),i=this.viewportColumnsHash!==r;return i&&(this.viewportColumnsHash=r,this.calculateHeaderRows()),i},t.prototype.refreshFlexedColumns=function(e){var r=this;void 0===e&&(e={});var i=e.source?e.source:"flex";if(null!=e.viewportWidth&&(this.flexViewportWidth=e.viewportWidth),!this.flexViewportWidth)return[];var n=-1;e.resizingCols&&e.resizingCols.forEach(function(Ce){var be=r.displayedColumnsCenter.indexOf(Ce);n<be&&(n=be)});var u=function(Ce){var be=r.displayedColumnsCenter.indexOf(Ce)>n;return Ce.getFlex()&&be},c=this.displayedColumnsCenter.filter(function(Ce){return!u(Ce)}),v=this.displayedColumnsCenter.filter(function(Ce){return u(Ce)}),m=[];if(!v.length)return[];var _,C=[];e:for(;;){var O=v.reduce(function(Ce,be){return Ce+be.getFlex()},0);_=this.flexViewportWidth-this.getWidthOfColsInList(c);for(var P=0;P<v.length;P++){var L=v[P],z=_*L.getFlex()/O,q=0,Z=L.getMinWidth(),re=L.getMaxWidth();if(me(Z)&&z<Z?q=Z:me(re)&&z>re&&(q=re),q){L.setActualWidth(q,i),Nr(v,L),m.push(L),c.push(L);continue e}C[P]=Math.round(z)}break}var pe=_;return v.forEach(function(Ce,be){Ce.setActualWidth(Math.min(C[be],pe),i),m.push(Ce),pe-=C[be]}),e.skipSetLeft||this.setLeftValues(i),e.updateBodyWidths&&this.updateBodyWidths(),e.fireResizedEvent&&this.dispatchColumnResizedEvent(m,!0,i,v),v},t.prototype.sizeColumnsToFit=function(e,r,i,n){var u,c,v,m,C;void 0===r&&(r="sizeColumnsToFit");var _={};n&&(null===(u=n?.columnLimits)||void 0===u||u.forEach(function(Ht){var gi=Ht.key,jo=function(o,t){var e={};for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&t.indexOf(r)<0&&(e[r]=o[r]);if(null!=o&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(o);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(o,r[i])&&(e[r[i]]=o[r[i]])}return e}(Ht,["key"]);_["string"==typeof gi?gi:gi.getColId()]=jo}));var O=this.getAllDisplayedColumns(),P=e===this.getWidthOfColsInList(O);if(!(e<=0||!O.length||P)){var L=[],z=[];O.forEach(function(Ht){!0===Ht.getColDef().suppressSizeToFit?z.push(Ht):L.push(Ht)});var q=L.slice(0),Z=!1,re=function(Ht){Nr(L,Ht),z.push(Ht)};for(L.forEach(function(Ht){return Ht.resetActualWidth(r)});!Z;){Z=!0;var pe=e-this.getWidthOfColsInList(z);if(pe<=0)L.forEach(function(Ht){var gi,jo,qa=null!==(jo=null===(gi=_?.[Ht.getId()])||void 0===gi?void 0:gi.minWidth)&&void 0!==jo?jo:n?.defaultMinWidth;"number"!=typeof qa?Ht.setMinimum(r):Ht.setActualWidth(qa)});else for(var Ce=pe/this.getWidthOfColsInList(L),be=pe,qe=L.length-1;qe>=0;qe--){var et=L[qe],ze=_?.[et.getId()],st=null!==(c=ze?.minWidth)&&void 0!==c?c:n?.defaultMinWidth,nt=null!==(v=ze?.maxWidth)&&void 0!==v?v:n?.defaultMaxWidth,Gt=null!==(m=et.getMinWidth())&&void 0!==m?m:0,Et=null!==(C=et.getMaxWidth())&&void 0!==C?C:Number.MAX_VALUE,Dr="number"==typeof st&&st>Gt?st:et.getMinWidth(),Xr="number"==typeof nt&&nt<Et?nt:et.getMaxWidth(),Yt=Math.round(et.getActualWidth()*Ce);me(Dr)&&Yt<Dr?(Yt=Dr,re(et),Z=!1):me(Xr)&&Yt>Xr?(Yt=Xr,re(et),Z=!1):0===qe&&(Yt=be),et.setActualWidth(Yt,r,!0),be-=Yt}}q.forEach(function(Ht){Ht.fireColumnWidthChangedEvent(r)}),this.setLeftValues(r),this.updateBodyWidths(),!i&&this.dispatchColumnResizedEvent(q,!0,r)}},t.prototype.buildDisplayedTrees=function(e){var r=[],i=[],n=[];e.forEach(function(c){switch(c.getPinned()){case"left":r.push(c);break;case"right":i.push(c);break;default:n.push(c)}});var u=new Uf;this.displayedTreeLeft=this.displayedGroupCreator.createDisplayedGroups(r,this.gridBalancedTree,u,"left",this.displayedTreeLeft),this.displayedTreeRight=this.displayedGroupCreator.createDisplayedGroups(i,this.gridBalancedTree,u,"right",this.displayedTreeRight),this.displayedTreeCentre=this.displayedGroupCreator.createDisplayedGroups(n,this.gridBalancedTree,u,null,this.displayedTreeCentre),this.updateDisplayedMap()},t.prototype.updateDisplayedMap=function(){var e=this;this.displayedColumnsAndGroupsMap={};var r=function(i){e.displayedColumnsAndGroupsMap[i.getUniqueId()]=i};this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeCentre,r),this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeLeft,r),this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeRight,r)},t.prototype.isDisplayed=function(e){return this.displayedColumnsAndGroupsMap[e.getUniqueId()]===e},t.prototype.updateOpenClosedVisibilityInColumnGroups=function(){var e=this.getAllDisplayedTrees();this.columnUtils.depthFirstAllColumnTreeSearch(e,function(r){r instanceof ti&&r.calculateDisplayedColumns()})},t.prototype.getGroupAutoColumns=function(){return this.groupAutoColumns},t.prototype.createGroupAutoColumnsIfNeeded=function(){if(!this.autoGroupsNeedBuilding)return!1;this.autoGroupsNeedBuilding=!1;var e=this.gridOptionsService.isGroupUseEntireRow(this.pivotMode),r=this.pivotMode?this.gridOptionsService.is("pivotSuppressAutoColumn"):this.isGroupSuppressAutoColumn();if((this.rowGroupColumns.length>0||this.usingTreeData)&&!r&&!e){var u=this.groupAutoColumns||[],c=this.autoGroupColService.createAutoGroupColumns(u,this.rowGroupColumns);if(!this.autoColsEqual(c,this.groupAutoColumns)||this.forceRecreateAutoGroups)return this.groupAutoColumns=c,!0}else this.groupAutoColumns=null;return!1},t.prototype.isGroupSuppressAutoColumn=function(){var e=this.gridOptionsService.get("groupDisplayType");if(!!e&&Qn("custom",e))return!0;var i=this.gridOptionsService.get("treeDataDisplayType");return!!i&&function Rh(o,t){var e=["auto","custom"];return e.indexOf(t)<0?(console.warn("AG Grid: '"+t+"' is not a valid treeDataDisplayType value - possible values are: '"+e.join("', '")+"'"),!1):t===o}("custom",i)},t.prototype.autoColsEqual=function(e,r){return Xn(e,r,function(i,n){return i.getColId()===n.getColId()})},t.prototype.getWidthOfColsInList=function(e){return e.reduce(function(r,i){return r+i.getActualWidth()},0)},t.prototype.getGridBalancedTree=function(){return this.gridBalancedTree},t.prototype.hasFloatingFilters=function(){return!!this.gridColumns&&this.gridColumns.some(function(r){return r.getColDef().floatingFilter})},t.prototype.getFirstDisplayedColumn=function(){var e=this.gridOptionsService.is("enableRtl"),r=["getDisplayedLeftColumns","getDisplayedCenterColumns","getDisplayedRightColumns"];e&&r.reverse();for(var i=0;i<r.length;i++){var n=this[r[i]]();if(n.length)return e?Mt(n):n[0]}return null},t.prototype.setColumnHeaderHeight=function(e,r){if(e.setAutoHeaderHeight(r)){var n={type:I.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,column:e,columns:[e],source:"autosizeColumnHeaderHeight"};this.eventService.dispatchEvent(n)}},t.prototype.getColumnGroupHeaderRowHeight=function(){return this.isPivotMode()?this.getPivotGroupHeaderHeight():this.getGroupHeaderHeight()},t.prototype.getColumnHeaderRowHeight=function(){var e=this.isPivotMode()?this.getPivotHeaderHeight():this.getHeaderHeight(),r=this.getAllDisplayedColumns().filter(function(i){return i.isAutoHeaderHeight()}).map(function(i){return i.getAutoHeaderHeight()||0});return Math.max.apply(Math,Pt([e],r))},t.prototype.getHeaderHeight=function(){var e;return null!==(e=this.gridOptionsService.getNum("headerHeight"))&&void 0!==e?e:this.environment.getFromTheme(25,"headerHeight")},t.prototype.getFloatingFiltersHeight=function(){var e;return null!==(e=this.gridOptionsService.getNum("floatingFiltersHeight"))&&void 0!==e?e:this.getHeaderHeight()},t.prototype.getGroupHeaderHeight=function(){var e;return null!==(e=this.gridOptionsService.getNum("groupHeaderHeight"))&&void 0!==e?e:this.getHeaderHeight()},t.prototype.getPivotHeaderHeight=function(){var e;return null!==(e=this.gridOptionsService.getNum("pivotHeaderHeight"))&&void 0!==e?e:this.getHeaderHeight()},t.prototype.getPivotGroupHeaderHeight=function(){var e;return null!==(e=this.gridOptionsService.getNum("pivotGroupHeaderHeight"))&&void 0!==e?e:this.getGroupHeaderHeight()},Gr([D("expressionService")],t.prototype,"expressionService",void 0),Gr([D("columnFactory")],t.prototype,"columnFactory",void 0),Gr([D("displayedGroupCreator")],t.prototype,"displayedGroupCreator",void 0),Gr([D("ctrlsService")],t.prototype,"ctrlsService",void 0),Gr([D("autoWidthCalculator")],t.prototype,"autoWidthCalculator",void 0),Gr([D("columnUtils")],t.prototype,"columnUtils",void 0),Gr([D("columnAnimationService")],t.prototype,"columnAnimationService",void 0),Gr([D("autoGroupColService")],t.prototype,"autoGroupColService",void 0),Gr([Ft("aggFuncService")],t.prototype,"aggFuncService",void 0),Gr([Ft("valueCache")],t.prototype,"valueCache",void 0),Gr([Ft("animationFrameService")],t.prototype,"animationFrameService",void 0),Gr([D("sortController")],t.prototype,"sortController",void 0),Gr([D("columnDefFactory")],t.prototype,"columnDefFactory",void 0),Gr([Re],t.prototype,"init",null),Gr([Mr],t.prototype,"destroyColumns",null),Gr([dt(0,Zr("loggerFactory"))],t.prototype,"setBeans",null),t=Gr([He("columnModel")],t)}(we),Ah=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Yf=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return Ah(t,o),t.prototype.calculateColMinWidth=function(e){return null!=e.minWidth?e.minWidth:this.environment.getMinColWidth()},t.prototype.calculateColMaxWidth=function(e){return null!=e.maxWidth?e.maxWidth:Number.MAX_SAFE_INTEGER},t.prototype.calculateColInitialWidth=function(e){var n,r=this.calculateColMinWidth(e),i=this.calculateColMaxWidth(e),u=$e(e.width),c=$e(e.initialWidth);return n=null!=u?u:null!=c?c:200,Math.max(Math.min(n,i),r)},t.prototype.getOriginalPathForColumn=function(e,r){var i=[],n=!1,u=function(c,v){for(var m=0;m<c.length;m++){if(n)return;var C=c[m];if(C instanceof tr)u(C.getChildren(),v+1),i[v]=C;else C===e&&(n=!0)}};return u(r,0),n?i:null},t.prototype.depthFirstOriginalTreeSearch=function(e,r,i){var n=this;r&&r.forEach(function(u){u instanceof tr&&n.depthFirstOriginalTreeSearch(u,u.getChildren(),i),i(u,e)})},t.prototype.depthFirstAllColumnTreeSearch=function(e,r){var i=this;e&&e.forEach(function(n){n instanceof ti&&i.depthFirstAllColumnTreeSearch(n.getChildren(),r),r(n)})},t.prototype.depthFirstDisplayedColumnTreeSearch=function(e,r){var i=this;e&&e.forEach(function(n){n instanceof ti&&i.depthFirstDisplayedColumnTreeSearch(n.getDisplayedChildren(),r),r(n)})},t=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n}([He("columnUtils")],t),t}(we),Xf=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Dh=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return Xf(t,o),t.prototype.createDisplayedGroups=function(e,r,i,n,u){var m,C,c=this,v=[],_=this.mapOldGroupsById(u);return e.forEach(function(O){for(var P=c.getOriginalPathForColumn(r,O),L=[],z=!C,q=0;q<P.length;q++)if(z||P[q]!==C[q]){var Z=c.createColumnGroup(P[q],i,_,n);L[q]=Z,0==q?v.push(Z):L[q-1].addChild(Z)}else L[q]=m[q];0===L.length?v.push(O):Mt(L).addChild(O);m=L,C=P}),this.setupParentsIntoColumns(v,null),v},t.prototype.createColumnGroup=function(e,r,i,n){var u=e.getGroupId(),c=r.getInstanceIdForKey(u),m=i[ti.createUniqueId(u,c)];return m&&m.getProvidedColumnGroup()!==e&&(m=null),me(m)?m.reset():(m=new ti(e,u,c,n),this.context.createBean(m)),m},t.prototype.mapOldGroupsById=function(e){var r={},i=function(n){n.forEach(function(u){if(u instanceof ti){var c=u;r[u.getUniqueId()]=c,i(c.getChildren())}})};return e&&i(e),r},t.prototype.setupParentsIntoColumns=function(e,r){var i=this;e.forEach(function(n){if(n.setParent(r),n instanceof ti){var u=n;i.setupParentsIntoColumns(u.getChildren(),u)}})},t.prototype.getOriginalPathForColumn=function(e,r){var i=[],n=!1,u=function(c,v){for(var m=0;m<c.length;m++){if(n)return;var C=c[m];C instanceof tr?(u(C.getChildren(),v+1),i[v]=C):C===r&&(n=!0)}};return u(e,0),n?i:(console.warn("AG Grid: could not get path"),null)},t=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n}([He("displayedGroupCreator")],t),t}(we),Qf=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Zt=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.componentsMappedByName={},e}return Qf(t,o),t.prototype.setupComponents=function(e){var r=this;e&&e.forEach(function(i){return r.addComponent(i)})},t.prototype.addComponent=function(e){var i=e.componentName.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase().toUpperCase();this.componentsMappedByName[i]=e.componentClass},t.prototype.getComponentClass=function(e){return this.componentsMappedByName[e]},t=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n}([He("agStackComponentsRegistry")],t),t}(we);function Ui(o,t,e){null==e||""==e?hl(o,t):xi(o,t,e)}function xi(o,t,e){o.setAttribute(Vs(t),e.toString())}function hl(o,t){o.removeAttribute(Vs(t))}function Vs(o){return"aria-"+o}function vt(o,t){t?o.setAttribute("role",t):o.removeAttribute("role")}function ji(o){return"asc"===o?"ascending":"desc"===o?"descending":"mixed"===o?"other":"none"}function Jf(o){return parseInt(o.getAttribute("aria-level"),10)}function Bu(o){return parseInt(o.getAttribute("aria-posinset"),10)}function wo(o,t){Ui(o,"label",t)}function Vu(o,t){Ui(o,"labelledby",t)}function Wu(o,t){Ui(o,"description",t)}function Uu(o,t){Ui(o,"describedby",t)}function es(o,t){Ui(o,"level",t)}function Ae(o,t){Ui(o,"disabled",t)}function ts(o,t){Ui(o,"hidden",t)}function zi(o,t){xi(o,"expanded",t)}function vl(o){hl(o,"expanded")}function So(o,t){xi(o,"setsize",t)}function ar(o,t){xi(o,"posinset",t)}function Fn(o,t){xi(o,"multiselectable",t)}function ai(o,t){xi(o,"rowcount",t)}function ju(o,t){xi(o,"rowindex",t)}function Zf(o,t){xi(o,"colcount",t)}function gl(o,t){xi(o,"colindex",t)}function zu(o,t){xi(o,"colspan",t)}function Ku(o,t){xi(o,"sort",t)}function Ws(o){hl(o,"sort")}function _o(o,t){Ui(o,"selected",t)}function $u(o,t){xi(o,"checked",void 0===t?"mixed":t)}var Jn,Us,js,ml,zs,yl,Ks,Cl,ep=Object.freeze({__proto__:null,setAriaRole:vt,getAriaSortState:ji,getAriaLevel:Jf,getAriaPosInSet:Bu,getAriaDescribedBy:function Fh(o){return o.getAttribute("aria-describedby")||""},setAriaLabel:wo,setAriaLabelledBy:Vu,setAriaDescription:Wu,setAriaDescribedBy:Uu,setAriaLive:function Hr(o,t){Ui(o,"live",t)},setAriaLevel:es,setAriaDisabled:Ae,setAriaHidden:ts,setAriaExpanded:zi,removeAriaExpanded:vl,setAriaSetSize:So,setAriaPosInSet:ar,setAriaMultiSelectable:Fn,setAriaRowCount:ai,setAriaRowIndex:ju,setAriaColCount:Zf,setAriaColIndex:gl,setAriaColSpan:zu,setAriaSort:Ku,removeAriaSort:Ws,setAriaSelected:_o,setAriaChecked:$u});function Fi(){return void 0===Jn&&(Jn=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),Jn}function wl(){if(void 0===Us)if(Fi()){var o=navigator.userAgent.match(/version\/(\d+)/i);o&&(Us=null!=o[1]?parseFloat(o[1]):0)}else Us=0;return Us}function xo(){if(void 0===js){var o=window;js=!!o.chrome&&(!!o.chrome.webstore||!!o.chrome.runtime)||/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}return js}function Sl(){return void 0===ml&&(ml=/(firefox)/i.test(navigator.userAgent)),ml}function rs(){return void 0===zs&&(zs=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),zs}function on(){return void 0===yl&&(yl=/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1),yl}function $s(){return!Fi()||wl()>=15}function Pn(o){if(!o)return null;var t=o.tabIndex,e=o.getAttribute("tabIndex");return-1!==t||null!==e&&(""!==e||Sl())?t.toString():null}function sn(){if(!document.body)return-1;var o=1e6,t=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,e=document.createElement("div");for(document.body.appendChild(e);;){var r=2*o;if(e.style.height=r+"px",r>t||e.clientHeight!==r)break;o=r}return document.body.removeChild(e),o}function tp(){var o,t,e;return null!==(t=null===(o=document.body)||void 0===o?void 0:o.clientWidth)&&void 0!==t?t:window.innerHeight||(null===(e=document.documentElement)||void 0===e?void 0:e.clientWidth)||-1}function wr(){var o,t,e;return null!==(t=null===(o=document.body)||void 0===o?void 0:o.clientHeight)&&void 0!==t?t:window.innerHeight||(null===(e=document.documentElement)||void 0===e?void 0:e.clientHeight)||-1}function Zn(){return null==Cl&&rp(),Cl}function rp(){var o=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",o.appendChild(t);var e=t.offsetWidth-t.clientWidth;0===e&&0===t.clientWidth&&(e=null),t.parentNode&&t.parentNode.removeChild(t),null!=e&&(Cl=e,Ks=0===e)}function an(){return null==Ks&&rp(),Ks}var Ph=Object.freeze({__proto__:null,isBrowserSafari:Fi,getSafariVersion:wl,isBrowserChrome:xo,isBrowserFirefox:Sl,isMacOsUserAgent:rs,isIOSUserAgent:on,browserSupportsPreventScroll:$s,getTabIndex:Pn,getMaxDivHeight:sn,getBodyWidth:tp,getBodyHeight:wr,getScrollbarWidth:Zn,isInvisibleScrollbar:an});function is(o,t){return o.toString().padStart(t,"0")}function ip(o,t){for(var e=[],r=o;r<=t;r++)e.push(r);return e}function Er(o,t,e){return"number"!=typeof o?"":o.toString().replace(".",e).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+t)}var _e=Object.freeze({__proto__:null,padStartWidthZeros:is,createArrayOfNumbers:ip,cleanNumber:function Ih(o){return"string"==typeof o&&(o=parseInt(o,10)),"number"==typeof o?Math.floor(o):null},decToHex:function np(o,t){for(var e="",r=0;r<t;r++)e+=String.fromCharCode(255&o),o>>>=8;return e},formatNumberTwoDecimalPlacesAndCommas:function Br(o,t,e){return"number"!=typeof o?"":Er(Math.round(100*o)/100,t,e)},formatNumberCommas:Er,sum:function de(o){return null==o?null:o.reduce(function(t,e){return t+e},0)},zeroOrGreater:function In(o,t){return o>=0?o:t},oneOrGreater:function ri(o,t){var e=parseInt(o,10);return!isNaN(e)&&isFinite(e)&&e>0?e:t}}),Eo=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n};function ns(o,t,e){if(void 0===t&&(t=!0),void 0===e&&(e="-"),!o)return null;var r=[o.getFullYear(),o.getMonth()+1,o.getDate()].map(function(i){return is(i,2)}).join(e);return t&&(r+=" "+[o.getHours(),o.getMinutes(),o.getSeconds()].map(function(i){return is(i,2)}).join(":")),r}var Ro=function(o){if(o>3&&o<21)return"th";switch(o%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"};function os(o,t){void 0===t&&(t="YYYY-MM-DD");var e=is(o.getFullYear(),4),r=["January","February","March","April","May","June","July","August","September","October","November","December"],i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],n={YYYY:function(){return e.slice(e.length-4,e.length)},YY:function(){return e.slice(e.length-2,e.length)},Y:function(){return""+o.getFullYear()},MMMM:function(){return r[o.getMonth()]},MMM:function(){return r[o.getMonth()].slice(0,3)},MM:function(){return is(o.getMonth()+1,2)},Mo:function(){return""+(o.getMonth()+1)+Ro(o.getMonth()+1)},M:function(){return""+(o.getMonth()+1)},Do:function(){return""+o.getDate()+Ro(o.getDate())},DD:function(){return is(o.getDate(),2)},D:function(){return""+o.getDate()},dddd:function(){return i[o.getDay()]},ddd:function(){return i[o.getDay()].slice(0,3)},dd:function(){return i[o.getDay()].slice(0,2)},do:function(){return""+o.getDay()+Ro(o.getDay())},d:function(){return""+o.getDay()}},u=new RegExp(Object.keys(n).join("|"),"g");return t.replace(u,function(c){return c in n?n[c]():c})}function ln(o){if(!o)return null;var t=Eo(o.split(" "),2),e=t[0],r=t[1];if(!e)return null;var i=e.split("-").map(function(L){return parseInt(L,10)});if(3!==i.filter(function(L){return!isNaN(L)}).length)return null;var n=Eo(i,3),u=n[0],c=n[1],v=n[2],m=new Date(u,c-1,v);if(m.getFullYear()!==u||m.getMonth()!==c-1||m.getDate()!==v)return null;if(!r||"00:00:00"===r)return m;var C=Eo(r.split(":").map(function(L){return parseInt(L,10)}),3),_=C[0],O=C[1],P=C[2];return _>=0&&_<24&&m.setHours(_),O>=0&&O<60&&m.setMinutes(O),P>=0&&P<60&&m.setSeconds(P),m}var ss,lr=Object.freeze({__proto__:null,serialiseDate:ns,dateToFormattedString:os,parseDateTimeFromString:ln}),Lh=function(o){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&o[t],r=0;if(e)return e.call(o);if(o&&"number"==typeof o.length)return{next:function(){return o&&r>=o.length&&(o=void 0),{value:o&&o[r++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Mh=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n};var op="[tabindex], input, select, button, textarea, [href]",Yu=".ag-hidden, .ag-hidden *, [disabled], .ag-disabled, .ag-disabled *";function Xu(o){var t=Element.prototype.matches||Element.prototype.msMatchesSelector,r=t.call(o,"input, select, button, textarea"),i=t.call(o,Yu),n=ls(o);return r&&!i&&n}function Ze(o,t,e){void 0===e&&(e={});var r=e.skipAriaHidden;o.classList.toggle("ag-hidden",!t),r||ts(o,!t)}function at(o,t,e){void 0===e&&(e={});var r=e.skipAriaHidden;o.classList.toggle("ag-invisible",!t),r||ts(o,!t)}function mr(o,t){var e="disabled",r=t?function(i){return i.setAttribute(e,"")}:function(i){return i.removeAttribute(e)};r(o),Tr(o.querySelectorAll("input"),function(i){return r(i)})}function lt(o,t,e){for(var r=0;o;){if(o.classList.contains(t))return!0;if(o=o.parentElement,"number"==typeof e){if(++r>e)break}else if(o===e)break}return!1}function Ct(o){var t=window.getComputedStyle(o),e=t.height,r=t.width,i=t.borderTopWidth,n=t.borderRightWidth,u=t.borderBottomWidth,c=t.borderLeftWidth,v=t.paddingTop,m=t.paddingRight,C=t.paddingBottom,_=t.paddingLeft,O=t.marginTop,P=t.marginRight,L=t.marginBottom,z=t.marginLeft,q=t.boxSizing;return{height:parseFloat(e),width:parseFloat(r),borderTopWidth:parseFloat(i),borderRightWidth:parseFloat(n),borderBottomWidth:parseFloat(u),borderLeftWidth:parseFloat(c),paddingTop:parseFloat(v),paddingRight:parseFloat(m),paddingBottom:parseFloat(C),paddingLeft:parseFloat(_),marginTop:parseFloat(O),marginRight:parseFloat(P),marginBottom:parseFloat(L),marginLeft:parseFloat(z),boxSizing:q}}function as(o){var t=Ct(o);return"border-box"===t.boxSizing?t.height-t.paddingTop-t.paddingBottom:t.height}function Ei(o){var t=Ct(o);return"border-box"===t.boxSizing?t.width-t.paddingLeft-t.paddingRight:t.width}function un(o){var t=Ct(o),e=t.marginBottom+t.marginTop;return Math.ceil(o.offsetHeight+e)}function Ys(o){var t=Ct(o),e=t.marginLeft+t.marginRight;return Math.ceil(o.offsetWidth+e)}function cn(){if("boolean"==typeof ss)return ss;var o=document.createElement("div");return o.style.direction="rtl",o.style.width="1px",o.style.height="1px",o.style.position="fixed",o.style.top="0px",o.style.overflow="hidden",o.dir="rtl",o.innerHTML='<div style="width: 2px">\n            <span style="display: inline-block; width: 1px"></span>\n            <span style="display: inline-block; width: 1px"></span>\n        </div>',document.body.appendChild(o),o.scrollLeft=1,ss=0===Math.floor(o.scrollLeft),document.body.removeChild(o),ss}function Xs(o,t){var e=o.scrollLeft;return t&&(e=Math.abs(e),xo()&&!cn()&&(e=o.scrollWidth-o.clientWidth-e)),e}function li(o,t,e){e&&(cn()?t*=-1:(Fi()||xo())&&(t=o.scrollWidth-o.clientWidth-t)),o.scrollLeft=t}function Wt(o){for(;o&&o.firstChild;)o.removeChild(o.firstChild)}function Ln(o){o&&o.parentNode&&o.parentNode.removeChild(o)}function ls(o){return null!==o.offsetParent}function Sr(o){var t=document.createElement("div");return t.innerHTML=(o||"").trim(),t.firstChild}function qu(o){return o&&o.clientHeight?o.clientHeight:0}function ui(o){return o&&o.clientWidth?o.clientWidth:0}function Mn(o,t,e){if(!e||e.nextSibling!==t){var r=document.activeElement,i=t.contains(r);e?e.nextSibling?o.insertBefore(t,e.nextSibling):o.appendChild(t):o.firstChild&&o.firstChild!==t&&o.insertAdjacentElement("afterbegin",t),i&&r&&$s()&&r.focus({preventScroll:!0})}}function Nn(o,t){for(var e=0;e<t.length;e++){var r=t[e],i=o.children[e];i!==r&&o.insertBefore(r,i)}}function eo(o,t,e){e?e.insertAdjacentElement("afterend",t):o.firstChild?o.insertAdjacentElement("afterbegin",t):o.appendChild(t)}function _l(o,t){var e,r;if(t)try{for(var i=Lh(Object.entries(t)),n=i.next();!n.done;n=i.next()){var u=Mh(n.value,2),c=u[0],v=u[1];if(c&&c.length&&null!=v){var m=c.replace(/[A-Z]/g,function(P){return"-"+P.toLocaleLowerCase()}),C=v.toString(),O=C.replace(/\s*!important/g,"").length!=C.length?"important":void 0;o.style.setProperty(m,v,O)}}}catch(P){e={error:P}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}}function xl(o){return o.clientWidth<o.scrollWidth}function qs(o){return o.clientHeight<o.scrollHeight}function Qs(o,t){"flex"===t?(o.style.removeProperty("width"),o.style.removeProperty("minWidth"),o.style.removeProperty("maxWidth"),o.style.flex="1 1 auto"):ci(o,t)}function ci(o,t){t=El(t),o.style.width=t.toString(),o.style.maxWidth=t.toString(),o.style.minWidth=t.toString()}function kn(o,t){t=El(t),o.style.height=t.toString(),o.style.maxHeight=t.toString(),o.style.minHeight=t.toString()}function El(o){return"number"==typeof o?o+"px":o}function us(o){return o instanceof Node||o instanceof HTMLElement}function sp(o){if(null==o)return[];var t=[];return Tr(o,function(e){return t.push(e)}),t}function to(o,t){if(o)for(var e=0;e<o.length;e++){var r=o[e];t(r.name,r.value)}}function fn(o,t,e){null==e?o.removeAttribute(t):o.setAttribute(t,e.toString())}function Tr(o,t){if(null!=o)for(var e=0;e<o.length;e++)t(o[e])}var To=Object.freeze({__proto__:null,radioCssClass:function $t(o,t,e){for(var r=o.parentElement,i=r&&r.firstChild;i;)t&&i.classList.toggle(t,i===o),e&&i.classList.toggle(e,i!==o),i=i.nextSibling},FOCUSABLE_SELECTOR:op,FOCUSABLE_EXCLUDE:Yu,isFocusableFormField:Xu,setDisplayed:Ze,setVisible:at,setDisabled:mr,isElementChildOfClass:lt,getElementSize:Ct,getInnerHeight:as,getInnerWidth:Ei,getAbsoluteHeight:un,getAbsoluteWidth:Ys,isRtlNegativeScroll:cn,getScrollLeft:Xs,setScrollLeft:li,clearElement:Wt,removeElement:function Rr(o,t){Ln(o.querySelector(t))},removeFromParent:Ln,isVisible:ls,loadTemplate:Sr,appendHtml:function Nh(o,t){o.lastChild?o.insertAdjacentHTML("afterbegin",t):o.innerHTML=t},getElementAttribute:function kh(o,t){return o.attributes&&o.attributes[t]?o.attributes[t].value:null},offsetHeight:qu,offsetWidth:ui,ensureDomOrder:Mn,setDomChildOrder:Nn,insertWithDomOrder:eo,prependDC:function Gh(o,t){me(o.firstChild)?o.insertBefore(t,o.firstChild):o.appendChild(t)},addStylesToElement:_l,isHorizontalScrollShowing:xl,isVerticalScrollShowing:qs,setElementWidth:Qs,setFixedWidth:ci,setElementHeight:function Qu(o,t){"flex"===t?(o.style.removeProperty("height"),o.style.removeProperty("minHeight"),o.style.removeProperty("maxHeight"),o.style.flex="1 1 auto"):kn(o,t)},setFixedHeight:kn,formatSize:El,isNodeOrElement:us,copyNodeList:sp,iterateNamedNodeMap:to,addOrRemoveAttribute:fn,nodeListForEach:Tr}),ap={columnGroupOpened:"expanded",columnGroupClosed:"contracted",columnSelectClosed:"tree-closed",columnSelectOpen:"tree-open",columnSelectIndeterminate:"tree-indeterminate",columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",groupContracted:"tree-closed",groupExpanded:"tree-open",setFilterGroupClosed:"tree-closed",setFilterGroupOpen:"tree-open",setFilterGroupIndeterminate:"tree-indeterminate",chart:"chart",close:"cross",cancel:"cancel",check:"tick",first:"first",previous:"previous",next:"next",last:"last",linked:"linked",unlinked:"unlinked",colorPicker:"color-picker",groupLoading:"loading",menu:"menu",filter:"filter",columns:"columns",maximize:"maximize",minimize:"minimize",menuPin:"pin",menuValue:"aggregation",menuAddRowGroup:"group",menuRemoveRowGroup:"group",clipboardCopy:"copy",clipboardCut:"cut",clipboardPaste:"paste",pivotPanel:"pivot",rowGroupPanel:"group",valuePanel:"aggregation",columnDrag:"grip",rowDrag:"grip",save:"save",csvExport:"csv",excelExport:"excel",smallDown:"small-down",smallLeft:"small-left",smallRight:"small-right",smallUp:"small-up",sortAscending:"asc",sortDescending:"desc",sortUnSort:"none"};function ii(o,t,e){var r=pr(o,t,e);if(r){var i=r.className;if("string"==typeof i&&i.indexOf("ag-icon")>-1||"object"==typeof i&&i["ag-icon"])return r}var n=document.createElement("span");return n.appendChild(r),n}function pr(o,t,e,r){var i=null,n=e&&e.getColDef().icons;if(n&&(i=n[o]),t&&!i){var u=t.get("icons");u&&(i=u[o])}if(!i){var v=document.createElement("span"),m=ap[o];return m||(r?m=o:(console.warn("AG Grid: Did not find icon "+o),m="")),v.setAttribute("class","ag-icon ag-icon-"+m),v.setAttribute("unselectable","on"),vt(v,"presentation"),v}var c=void 0;if("function"==typeof i)c=i();else{if("string"!=typeof i)throw new Error("icon from grid options needs to be a string or a function");c=i}return"string"==typeof c?Sr(c):us(c)?c:void console.warn("AG Grid: iconRenderer should return back a string or a dom object")}var Hh=Object.freeze({__proto__:null,iconNameClassMap:ap,createIcon:ii,createIconNoSpan:pr}),ve=function(){function o(){}return o.BACKSPACE="Backspace",o.TAB="Tab",o.ENTER="Enter",o.ESCAPE="Escape",o.SPACE=" ",o.LEFT="ArrowLeft",o.UP="ArrowUp",o.RIGHT="ArrowRight",o.DOWN="ArrowDown",o.DELETE="Delete",o.F2="F2",o.PAGE_UP="PageUp",o.PAGE_DOWN="PageDown",o.PAGE_HOME="Home",o.PAGE_END="End",o.A="KeyA",o.C="KeyC",o.D="KeyD",o.V="KeyV",o.X="KeyX",o.Y="KeyY",o.Z="KeyZ",o}(),Bh=65,Vh=67,Ju=86,fi=68,Rl=90,lp=89;function Js(o){return!(o.altKey||o.ctrlKey||o.metaKey)&&1===o.key.length}function Zu(o,t,e,r,i){var n=r?r.getColDef().suppressKeyboardEvent:void 0;if(!n)return!1;var u={event:t,editing:i,column:r,api:o.api,node:e,data:e.data,colDef:r.getColDef(),context:o.context,columnApi:o.columnApi};if(n&&n(u))return!0;return!1}function Zs(o,t,e,r){var i=r.getDefinition(),n=i&&i.suppressHeaderKeyboardEvent;return!!me(n)&&!!n({api:o.api,columnApi:o.columnApi,context:o.context,colDef:i,column:r,headerRowIndex:e,event:t})}function up(o){var e;switch(o.keyCode){case Bh:e=ve.A;break;case Vh:e=ve.C;break;case Ju:e=ve.V;break;case fi:e=ve.D;break;case Rl:e=ve.Z;break;case lp:e=ve.Y;break;default:e=o.code}return e}function cp(o,t){return void 0===t&&(t=!1),o===ve.DELETE||!t&&o===ve.BACKSPACE&&rs()}var ew=Object.freeze({__proto__:null,isEventFromPrintableCharacter:Js,isUserSuppressingKeyboardEvent:Zu,isUserSuppressingHeaderKeyboardEvent:Zs,normaliseQwertyAzerty:up,isDeleteKey:cp});function ec(o,t,e){if(0===e)return!1;var r=Math.abs(o.clientX-t.clientX),i=Math.abs(o.clientY-t.clientY);return Math.max(r,i)<=e}var Wh=Object.freeze({__proto__:null,areEventsNear:ec});var Uh=Object.freeze({__proto__:null,sortRowNodesByOrder:function Or(o,t){if(!o)return!1;for(var e=function(c,v){var m=t[c.id],C=t[v.id],_=void 0!==m,O=void 0!==C;return _&&O?m-C:!_&&!O?c.__objectId-v.__objectId:_?1:-1},n=!1,u=0;u<o.length-1;u++)if(e(o[u],o[u+1])>0){n=!0;break}return!!n&&(o.sort(e),!0)},traverseNodesWithKey:function fp(o,t){var e=[];!function r(i){i&&i.forEach(function(n){if(n.group||n.hasChildren()){e.push(n.key);var u=e.join("|");t(n,u),r(n.childrenAfterGroup),e.pop()}})}(o)}});function ea(o){var t=new Set;return o.forEach(function(e){return t.add(e)}),t}var Pi,tc=Object.freeze({__proto__:null,convertToSet:ea}),dr=function(){return dr=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},dr.apply(this,arguments)},rt=dr(dr(dr(dr(dr(dr(dr(dr(dr(dr(dr(dr(dr(dr(dr(dr(dr(dr({},ep),Si),Ph),lr),To),ZC),Af),rr),Tn),Hh),ew),zr),Wh),_e),gh),Uh),tc),sr),cs=function(){function o(t,e){void 0===t&&(t=0),void 0===e&&(e=1),this.nextValue=t,this.step=e}return o.prototype.next=function(){var t=this.nextValue;return this.nextValue+=this.step,t},o.prototype.peek=function(){return this.nextValue},o.prototype.skip=function(t){this.nextValue+=t},o}();!function(o){o[o.IN_PROGRESS=0]="IN_PROGRESS",o[o.RESOLVED=1]="RESOLVED"}(Pi||(Pi={}));var Ki,ir=function(){function o(t){var e=this;this.status=Pi.IN_PROGRESS,this.resolution=null,this.waiters=[],t(function(r){return e.onDone(r)},function(r){return e.onReject(r)})}return o.all=function(t){return new o(function(e){var r=t.length,i=new Array(r);t.forEach(function(n,u){n.then(function(c){i[u]=c,0===--r&&e(i)})})})},o.resolve=function(t){return void 0===t&&(t=null),new o(function(e){return e(t)})},o.prototype.then=function(t){var e=this;return new o(function(r){e.status===Pi.RESOLVED?r(t(e.resolution)):e.waiters.push(function(i){return r(t(i))})})},o.prototype.resolveNow=function(t,e){return this.status===Pi.RESOLVED?e(this.resolution):t},o.prototype.onDone=function(t){this.status=Pi.RESOLVED,this.resolution=t,this.waiters.forEach(function(e){return e(t)})},o.prototype.onReject=function(t){console.warn("TBI")},o}(),rc=(function(){function o(){this.timestamp=(new Date).getTime()}o.prototype.print=function(t){var e=(new Date).getTime()-this.timestamp;console.info(t+" = "+e),this.timestamp=(new Date).getTime()}}(),function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}()),fs=function(){return fs=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},fs.apply(this,arguments)},ta=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n};!function(o){o[o.NOTHING=0]="NOTHING",o[o.WAITING_TO_SHOW=1]="WAITING_TO_SHOW",o[o.SHOWING=2]="SHOWING"}(Ki||(Ki={}));var Tl=function(o){function t(e){var r=o.call(this)||this;return r.DEFAULT_SHOW_TOOLTIP_DELAY=2e3,r.DEFAULT_HIDE_TOOLTIP_DELAY=1e4,r.SHOW_QUICK_TOOLTIP_DIFF=1e3,r.FADE_OUT_TOOLTIP_TIMEOUT=1e3,r.state=Ki.NOTHING,r.tooltipInstanceCount=0,r.tooltipMouseTrack=!1,r.parentComp=e,r}return rc(t,o),t.prototype.postConstruct=function(){this.tooltipShowDelay=this.getTooltipDelay("show")||this.DEFAULT_SHOW_TOOLTIP_DELAY,this.tooltipHideDelay=this.getTooltipDelay("hide")||this.DEFAULT_HIDE_TOOLTIP_DELAY,this.tooltipMouseTrack=this.gridOptionsService.is("tooltipMouseTrack");var e=this.parentComp.getGui();this.addManagedListener(e,"mouseenter",this.onMouseEnter.bind(this)),this.addManagedListener(e,"mouseleave",this.onMouseLeave.bind(this)),this.addManagedListener(e,"mousemove",this.onMouseMove.bind(this)),this.addManagedListener(e,"mousedown",this.onMouseDown.bind(this)),this.addManagedListener(e,"keydown",this.onKeyDown.bind(this))},t.prototype.destroy=function(){this.setToDoNothing(),o.prototype.destroy.call(this)},t.prototype.onMouseEnter=function(e){if(!on()&&this.state==Ki.NOTHING){var r=this.isLastTooltipHiddenRecently()?200:this.tooltipShowDelay;this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),r),this.lastMouseEvent=e,this.state=Ki.WAITING_TO_SHOW}},t.prototype.onMouseLeave=function(){this.setToDoNothing()},t.prototype.onKeyDown=function(){this.setToDoNothing()},t.prototype.setToDoNothing=function(){this.state===Ki.SHOWING&&this.hideTooltip(),this.clearTimeouts(),this.state=Ki.NOTHING},t.prototype.onMouseMove=function(e){this.lastMouseEvent=e,this.tooltipMouseTrack&&this.state===Ki.SHOWING&&this.tooltipComp&&this.positionTooltipUnderLastMouseEvent()},t.prototype.onMouseDown=function(){this.setToDoNothing()},t.prototype.getTooltipDelay=function(e){var r=this.gridOptionsService.getNum("tooltipShowDelay"),i=this.gridOptionsService.getNum("tooltipHideDelay"),n="show"===e?r:i,u=dl(e);return me(n)?(n<0&&_t(function(){return console.warn("AG Grid: tooltip"+u+"Delay should not be lower than 0")},"tooltip"+u+"DelayWarn"),Math.max(200,n)):null},t.prototype.hideTooltip=function(){this.tooltipComp&&(this.destroyTooltipComp(),t.lastTooltipHideTime=(new Date).getTime()),this.state=Ki.NOTHING},t.prototype.destroyTooltipComp=function(){var e=this;this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");var r=this.tooltipPopupDestroyFunc,i=this.tooltipComp;window.setTimeout(function(){r(),e.getContext().destroyBean(i)},this.FADE_OUT_TOOLTIP_TIMEOUT),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0},t.prototype.isLastTooltipHiddenRecently=function(){return(new Date).getTime()-t.lastTooltipHideTime<this.SHOW_QUICK_TOOLTIP_DIFF},t.prototype.showTooltip=function(){var e=fs({},this.parentComp.getTooltipParams());if(me(e.value)){this.state=Ki.SHOWING,this.tooltipInstanceCount++;var r=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.userComponentFactory.getTooltipCompDetails(e).newAgStackInstance().then(r)}else this.setToDoNothing()},t.prototype.newTooltipComponentCallback=function(e,r){if(this.state!==Ki.SHOWING||this.tooltipInstanceCount!==e)this.getContext().destroyBean(r);else{var n=r.getGui();this.tooltipComp=r,n.classList.contains("ag-tooltip")||n.classList.add("ag-tooltip-custom");var u=this.localeService.getLocaleTextFunc(),c=this.popupService.addPopup({eChild:n,ariaLabel:u("ariaLabelTooltip","Tooltip")});c&&(this.tooltipPopupDestroyFunc=c.hideFunc),this.positionTooltipUnderLastMouseEvent(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.tooltipHideDelay)}},t.prototype.positionTooltipUnderLastMouseEvent=function(){this.popupService.positionPopupUnderMouseEvent({type:"tooltip",mouseEvent:this.lastMouseEvent,ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack})},t.prototype.clearTimeouts=function(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0),this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)},ta([D("popupService")],t.prototype,"popupService",void 0),ta([D("userComponentFactory")],t.prototype,"userComponentFactory",void 0),ta([Re],t.prototype,"postConstruct",null),t}(we),gt=function(){function o(t){this.cssClassStates={},this.getGui=t}return o.prototype.addCssClass=function(t){var e=this,r=(t||"").split(" ");if(r.length>1)r.forEach(function(u){return e.addCssClass(u)});else if(!0!==this.cssClassStates[t]&&t.length){var n=this.getGui();n&&n.classList.add(t),this.cssClassStates[t]=!0}},o.prototype.removeCssClass=function(t){var e=this,r=(t||"").split(" ");if(r.length>1)r.forEach(function(u){return e.removeCssClass(u)});else if(!1!==this.cssClassStates[t]&&t.length){var n=this.getGui();n&&n.classList.remove(t),this.cssClassStates[t]=!1}},o.prototype.containsCssClass=function(t){var e=this.getGui();return!!e&&e.classList.contains(t)},o.prototype.addOrRemoveCssClass=function(t,e){var r=this;if(t){if(t.indexOf(" ")>=0){var i=(t||"").split(" ");if(i.length>1)return void i.forEach(function(c){return r.addOrRemoveCssClass(c,e)})}if(this.cssClassStates[t]!==e&&t.length){var u=this.getGui();u&&u.classList.toggle(t,e),this.cssClassStates[t]=e}}},o}(),ra=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Oo=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},ps=new cs,Ue=function(o){function t(e){var r=o.call(this)||this;return r.displayed=!0,r.visible=!0,r.compId=ps.next(),r.cssClassManager=new gt(function(){return r.eGui}),e&&r.setTemplate(e),r}return ra(t,o),t.prototype.preConstructOnComponent=function(){this.usingBrowserTooltips=this.gridOptionsService.is("enableBrowserTooltips")},t.prototype.getCompId=function(){return this.compId},t.prototype.getTooltipParams=function(){return{value:this.tooltipText,location:"UNKNOWN"}},t.prototype.setTooltip=function(e){var r=this;this.tooltipText!=e&&(this.tooltipText&&(r.usingBrowserTooltips?r.getGui().removeAttribute("title"):r.tooltipFeature=r.destroyBean(r.tooltipFeature)),null!=e&&(this.tooltipText=e,this.tooltipText&&(r.usingBrowserTooltips?r.getGui().setAttribute("title",r.tooltipText):r.tooltipFeature=r.createBean(new Tl(r)))))},t.prototype.createChildComponentsFromTags=function(e,r){var i=this;sp(e.childNodes).forEach(function(u){if(u instanceof HTMLElement){var c=i.createComponentFromElement(u,function(m){m.getGui()&&i.copyAttributesFromNode(u,m.getGui())},r);if(c){if(c.addItems&&u.children.length){i.createChildComponentsFromTags(u,r);var v=Array.prototype.slice.call(u.children);c.addItems(v)}i.swapComponentForNode(c,e,u)}else u.childNodes&&i.createChildComponentsFromTags(u,r)}})},t.prototype.createComponentFromElement=function(e,r,i){var n=e.nodeName,u=i?i[e.getAttribute("ref")]:void 0,c=this.agStackComponentsRegistry.getComponentClass(n);if(c){t.elementGettingCreated=e;var v=new c(u);return v.setParentComponent(this),this.createBean(v,null,r),v}return null},t.prototype.copyAttributesFromNode=function(e,r){to(e.attributes,function(i,n){return r.setAttribute(i,n)})},t.prototype.swapComponentForNode=function(e,r,i){var n=e.getGui();r.replaceChild(n,i),r.insertBefore(document.createComment(i.nodeName),n),this.addDestroyFunc(this.destroyBean.bind(this,e)),this.swapInComponentForQuerySelectors(e,i)},t.prototype.swapInComponentForQuerySelectors=function(e,r){var i=this;this.iterateOverQuerySelectors(function(n){i[n.attributeName]===r&&(i[n.attributeName]=e)})},t.prototype.iterateOverQuerySelectors=function(e){for(var r=Object.getPrototypeOf(this);null!=r;){var i=r.__agComponentMetaData,n=An(r.constructor);i&&i[n]&&i[n].querySelectors&&i[n].querySelectors.forEach(function(u){return e(u)}),r=Object.getPrototypeOf(r)}},t.prototype.setTemplate=function(e,r){var i=Sr(e);this.setTemplateFromElement(i,r)},t.prototype.setTemplateFromElement=function(e,r){this.eGui=e,this.eGui.__agComponent=this,this.wireQuerySelectors(),this.getContext()&&this.createChildComponentsFromTags(this.getGui(),r)},t.prototype.createChildComponentsPreConstruct=function(){this.getGui()&&this.createChildComponentsFromTags(this.getGui())},t.prototype.wireQuerySelectors=function(){var e=this;if(this.eGui){var r=this;this.iterateOverQuerySelectors(function(i){var n=function(v){return r[i.attributeName]=v};if(i.refSelector&&e.eGui.getAttribute("ref")===i.refSelector)n(e.eGui);else{var c=e.eGui.querySelector(i.querySelector);c&&n(c.__agComponent||c)}})}},t.prototype.getGui=function(){return this.eGui},t.prototype.getFocusableElement=function(){return this.eGui},t.prototype.setParentComponent=function(e){this.parentComponent=e},t.prototype.getParentComponent=function(){return this.parentComponent},t.prototype.setGui=function(e){this.eGui=e},t.prototype.queryForHtmlElement=function(e){return this.eGui.querySelector(e)},t.prototype.queryForHtmlInputElement=function(e){return this.eGui.querySelector(e)},t.prototype.appendChild=function(e,r){if(null!=e)if(r||(r=this.eGui),us(e))r.appendChild(e);else{var i=e;r.appendChild(i.getGui())}},t.prototype.isDisplayed=function(){return this.displayed},t.prototype.setVisible=function(e,r){if(void 0===r&&(r={}),e!==this.visible){this.visible=e;var i=r.skipAriaHidden;at(this.eGui,e,{skipAriaHidden:i})}},t.prototype.setDisplayed=function(e,r){if(void 0===r&&(r={}),e!==this.displayed){this.displayed=e;var i=r.skipAriaHidden;Ze(this.eGui,e,{skipAriaHidden:i});var n={type:t.EVENT_DISPLAYED_CHANGED,visible:this.displayed};this.dispatchEvent(n)}},t.prototype.destroy=function(){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),this.parentComponent&&(this.parentComponent=void 0);var e=this.eGui;e&&e.__agComponent&&(e.__agComponent=void 0),o.prototype.destroy.call(this)},t.prototype.addGuiEventListener=function(e,r,i){var n=this;this.eGui.addEventListener(e,r,i),this.addDestroyFunc(function(){return n.eGui.removeEventListener(e,r)})},t.prototype.addCssClass=function(e){this.cssClassManager.addCssClass(e)},t.prototype.removeCssClass=function(e){this.cssClassManager.removeCssClass(e)},t.prototype.containsCssClass=function(e){return this.cssClassManager.containsCssClass(e)},t.prototype.addOrRemoveCssClass=function(e,r){this.cssClassManager.addOrRemoveCssClass(e,r)},t.prototype.getAttribute=function(e){var r=this.eGui;return r?r.getAttribute(e):null},t.prototype.getRefElement=function(e){return this.queryForHtmlElement('[ref="'+e+'"]')},t.EVENT_DISPLAYED_CHANGED="displayedChanged",Oo([D("agStackComponentsRegistry")],t.prototype,"agStackComponentsRegistry",void 0),Oo([Iu],t.prototype,"preConstructOnComponent",null),Oo([Iu],t.prototype,"createChildComponentsPreConstruct",null),t}(we);function Te(o){return pp.bind(this,"[ref="+o+"]",o)}function pp(o,t,e,r,i){null!==o?"number"!=typeof i?function dp(o,t,e){var r=function zh(o,t){return o.__agComponentMetaData||(o.__agComponentMetaData={}),o.__agComponentMetaData[t]||(o.__agComponentMetaData[t]={}),o.__agComponentMetaData[t]}(o,An(o.constructor));r[t]||(r[t]=[]),r[t].push(e)}(e,"querySelectors",{attributeName:r,querySelector:o,refSelector:t}):console.error("AG Grid: QuerySelector should be on an attribute"):console.error("AG Grid: QuerySelector selector should not be null")}var Kh=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ic=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Gn=function(o){function t(){return o.call(this,'\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eFloatingFilterText"></ag-input-text-field>\n            </div>')||this}return Kh(t,o),t.prototype.destroy=function(){o.prototype.destroy.call(this)},t.prototype.init=function(e){this.params=e;var r=this.columnModel.getDisplayNameForColumn(e.column,"header",!0),i=this.localeService.getLocaleTextFunc();this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(r+" "+i("ariaFilterInput","Filter Input"))},t.prototype.onParentModelChanged=function(e){var r=this;e?this.params.parentFilterInstance(function(i){if(i.getModelAsString){var n=i.getModelAsString(e);r.eFloatingFilterText.setValue(n)}}):this.eFloatingFilterText.setValue("")},ic([Te("eFloatingFilterText")],t.prototype,"eFloatingFilterText",void 0),ic([D("columnModel")],t.prototype,"columnModel",void 0),t}(Ue),hp=function(){function o(t,e,r,i){var n=this;this.alive=!0,this.context=t,this.eParent=i,e.getDateCompDetails(r).newAgStackInstance().then(function(v){n.alive?(n.dateComp=v,v&&(i.appendChild(v.getGui()),v.afterGuiAttached&&v.afterGuiAttached(),n.tempValue&&v.setDate(n.tempValue),null!=n.disabled&&n.setDateCompDisabled(n.disabled))):t.destroyBean(v)})}return o.prototype.destroy=function(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)},o.prototype.getDate=function(){return this.dateComp?this.dateComp.getDate():this.tempValue},o.prototype.setDate=function(t){this.dateComp?this.dateComp.setDate(t):this.tempValue=t},o.prototype.setDisabled=function(t){this.dateComp?this.setDateCompDisabled(t):this.disabled=t},o.prototype.setDisplayed=function(t){Ze(this.eParent,t)},o.prototype.setInputPlaceholder=function(t){this.dateComp&&this.dateComp.setInputPlaceholder&&this.dateComp.setInputPlaceholder(t)},o.prototype.setInputAriaLabel=function(t){this.dateComp&&this.dateComp.setInputAriaLabel&&this.dateComp.setInputAriaLabel(t)},o.prototype.afterGuiAttached=function(t){this.dateComp&&"function"==typeof this.dateComp.afterGuiAttached&&this.dateComp.afterGuiAttached(t)},o.prototype.setDateCompDisabled=function(t){null!=this.dateComp&&null!=this.dateComp.setDisabled&&this.dateComp.setDisabled(t)},o}(),Ol=function(){return Ol=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},Ol.apply(this,arguments)},Al=function(){function o(){this.customFilterOptions={}}return o.prototype.init=function(t,e){this.filterOptions=t.filterOptions||e,this.mapCustomOptions(),this.selectDefaultItem(t),this.checkForDeprecatedParams()},o.prototype.checkForDeprecatedParams=function(){this.filterOptions.some(function(t){return"string"!=typeof t&&null!=t.test})&&console.warn("AG Grid: [IFilterOptionDef] since v26.2.0, test() has been replaced with predicate()."),this.filterOptions.some(function(t){return"string"!=typeof t&&null!=t.hideFilterInput})&&console.warn("AG Grid: [IFilterOptionDef] since v26.2.0, useOfHideFilterInput has been replaced with numberOfInputs.")},o.prototype.getFilterOptions=function(){return this.filterOptions},o.prototype.mapCustomOptions=function(){var t=this;this.filterOptions&&this.filterOptions.forEach(function(e){if("string"!=typeof e){if(![["displayKey"],["displayName"],["predicate","test"]].every(function(c){return!!c.some(function(v){return null!=e[v]})||(console.warn("AG Grid: ignoring FilterOptionDef as it doesn't contain one of '"+c+"'"),!1)}))return void(t.filterOptions=t.filterOptions.filter(function(c){return c===e})||[]);var n=e.test,u=Ol({},e);null!=n&&null==e.predicate&&(u.predicate=function(c,v){return n(c[0],v)},delete u.test),u.hideFilterInput&&null==u.numberOfInputs&&(u.numberOfInputs=0,delete u.hideFilterInput),t.customFilterOptions[e.displayKey]=u}})},o.prototype.selectDefaultItem=function(t){if(t.defaultOption)this.defaultOption=t.defaultOption;else if(this.filterOptions.length>=1){var e=this.filterOptions[0];"string"==typeof e?this.defaultOption=e:e.displayKey?this.defaultOption=e.displayKey:console.warn("AG Grid: invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'")}else console.warn("AG Grid: no filter options for filter")},o.prototype.getDefaultOption=function(){return this.defaultOption},o.prototype.getCustomOption=function(t){return this.customFilterOptions[t]},o}(),nc={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose One",equals:"Equals",notEqual:"Not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"In range",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equals",greaterThanOrEqual:"Greater than or equals",contains:"Contains",notContains:"Not contains",startsWith:"Starts with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd"},Ao=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Dl=function(){return Dl=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},Dl.apply(this,arguments)},oc=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},ro=function(o){function t(e,r){void 0===r&&(r={});var i=o.call(this)||this;return i.eFocusableElement=e,i.callbacks=r,i.callbacks=Dl({shouldStopEventPropagation:function(){return!1},onTabKeyDown:function(n){if(!n.defaultPrevented){var u=i.focusService.findNextFocusableElement(i.eFocusableElement,!1,n.shiftKey);u&&(u.focus(),n.preventDefault())}}},r),i}return Ao(t,o),t.prototype.postConstruct=function(){this.eFocusableElement.classList.add(t.FOCUS_MANAGED_CLASS),this.addKeyDownListeners(this.eFocusableElement),this.callbacks.onFocusIn&&this.addManagedListener(this.eFocusableElement,"focusin",this.callbacks.onFocusIn),this.callbacks.onFocusOut&&this.addManagedListener(this.eFocusableElement,"focusout",this.callbacks.onFocusOut)},t.prototype.addKeyDownListeners=function(e){var r=this;this.addManagedListener(e,"keydown",function(i){if(!i.defaultPrevented&&!tn(i)){if(r.callbacks.shouldStopEventPropagation(i))return void Qo(i);i.key===ve.TAB?r.callbacks.onTabKeyDown(i):r.callbacks.handleKeyDown&&r.callbacks.handleKeyDown(i)}})},t.FOCUS_MANAGED_CLASS="ag-focus-managed",oc([D("focusService")],t.prototype,"focusService",void 0),oc([Re],t.prototype,"postConstruct",null),t}(we),vp=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),sc=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},gp="ag-resizer-wrapper",mp='<div class="'+gp+'">\n        <div ref="eTopLeftResizer" class="ag-resizer ag-resizer-topLeft"></div>\n        <div ref="eTopResizer" class="ag-resizer ag-resizer-top"></div>\n        <div ref="eTopRightResizer" class="ag-resizer ag-resizer-topRight"></div>\n        <div ref="eRightResizer" class="ag-resizer ag-resizer-right"></div>\n        <div ref="eBottomRightResizer" class="ag-resizer ag-resizer-bottomRight"></div>\n        <div ref="eBottomResizer" class="ag-resizer ag-resizer-bottom"></div>\n        <div ref="eBottomLeftResizer" class="ag-resizer ag-resizer-bottomLeft"></div>\n        <div ref="eLeftResizer" class="ag-resizer ag-resizer-left"></div>\n    </div>',bl=function(o){function t(e,r){var i=o.call(this)||this;return i.element=e,i.dragStartPosition={x:0,y:0},i.position={x:0,y:0},i.lastSize={width:-1,height:-1},i.positioned=!1,i.resizersAdded=!1,i.resizeListeners=[],i.boundaryEl=null,i.isResizing=!1,i.isMoving=!1,i.resizable={},i.movable=!1,i.currentResizer=null,i.config=Object.assign({},{popup:!1},r),i}return vp(t,o),t.prototype.center=function(){var e=this.offsetParent,r=e.clientHeight,n=e.clientWidth/2-this.getWidth()/2,u=r/2-this.getHeight()/2;this.offsetElement(n,u)},t.prototype.initialisePosition=function(){if(!this.positioned){var e=this.config,r=e.centered,i=e.forcePopupParentAsOffsetParent,n=e.minWidth,u=e.width,c=e.minHeight,v=e.height,m=e.x,C=e.y;this.offsetParent||this.setOffsetParent();var _=0,O=0,P=!!this.element.offsetParent;if(P){var L=this.findBoundaryElement(),z=window.getComputedStyle(L);if(null!=z.minWidth){var q=L.offsetWidth-this.element.offsetWidth;O=parseInt(z.minWidth,10)-q}if(null!=z.minHeight){var Z=L.offsetHeight-this.element.offsetHeight;_=parseInt(z.minHeight,10)-Z}}if(this.minHeight=c||_,this.minWidth=n||O,u&&this.setWidth(u),v&&this.setHeight(v),(!u||!v)&&this.refreshSize(),r)this.center();else if(m||C)this.offsetElement(m,C);else if(P&&i&&this.boundaryEl){var re=parseFloat(this.boundaryEl.style.top),pe=parseFloat(this.boundaryEl.style.left);this.offsetElement(isNaN(pe)?0:pe,isNaN(re)?0:re)}this.positioned=!!this.offsetParent}},t.prototype.isPositioned=function(){return this.positioned},t.prototype.getPosition=function(){return this.position},t.prototype.setMovable=function(e,r){if(this.config.popup&&e!==this.movable){this.movable=e;var i=this.moveElementDragListener||{eElement:r,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragService.addDragSource(i),this.moveElementDragListener=i):(this.dragService.removeDragSource(i),this.moveElementDragListener=void 0)}},t.prototype.setResizable=function(e){var r=this;if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),"boolean"==typeof e){if(!1===e)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}Object.keys(e).forEach(function(i){var u=!!e[i],c=r.getResizerElement(i),v={dragStartPixels:0,eElement:c,onDragStart:function(m){return r.onResizeStart(m,i)},onDragging:r.onResize.bind(r),onDragStop:function(m){return r.onResizeEnd(m,i)}};(u||!r.isAlive()&&!u)&&(u?(r.dragService.addDragSource(v),r.resizeListeners.push(v),c.style.pointerEvents="all"):c.style.pointerEvents="none",r.resizable[i]=u)})},t.prototype.removeSizeFromEl=function(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")},t.prototype.restoreLastSize=function(){this.element.style.flex="0 0 auto";var e=this.lastSize,r=e.height,i=e.width;-1!==i&&(this.element.style.width=i+"px"),-1!==r&&(this.element.style.height=r+"px")},t.prototype.getHeight=function(){return this.element.offsetHeight},t.prototype.setHeight=function(e){var r=this.config.popup,i=this.element,n=!1;if("string"==typeof e&&-1!==e.indexOf("%"))kn(i,e),e=un(i),n=!0;else if(this.positioned){e=Math.max(this.minHeight,e);var u=this.getAvailableHeight();u&&e>u&&(e=u)}this.getHeight()!==e&&(n?(i.style.maxHeight="unset",i.style.minHeight="unset"):r?kn(i,e):(i.style.height=e+"px",i.style.flex="0 0 auto",this.lastSize.height="number"==typeof e?e:parseFloat(e)))},t.prototype.getAvailableHeight=function(){var e=this.config,r=e.popup,i=e.forcePopupParentAsOffsetParent;this.positioned||this.initialisePosition();var n=this.offsetParent.clientHeight;if(!n)return null;var u=this.element.getBoundingClientRect(),c=this.offsetParent.getBoundingClientRect(),v=r?this.position.y:u.top,m=r?0:c.top,C=0;if(i){var _=this.element.parentElement;if(_)C=_.getBoundingClientRect().bottom-u.bottom}return n+m-v-C},t.prototype.getWidth=function(){return this.element.offsetWidth},t.prototype.setWidth=function(e){var r=this.element,i=this.config.popup,n=!1;if("string"==typeof e&&-1!==e.indexOf("%"))ci(r,e),e=Ys(r),n=!0;else if(this.positioned){e=Math.max(this.minWidth,e);var u=this.offsetParent.clientWidth,c=i?this.position.x:this.element.getBoundingClientRect().left;u&&e+c>u&&(e=u-c)}this.getWidth()!==e&&(n?(r.style.maxWidth="unset",r.style.minWidth="unset"):this.config.popup?ci(r,e):(r.style.width=e+"px",r.style.flex=" unset",this.lastSize.width="number"==typeof e?e:parseFloat(e)))},t.prototype.offsetElement=function(e,r){void 0===e&&(e=0),void 0===r&&(r=0);var i=this.config.forcePopupParentAsOffsetParent?this.boundaryEl:this.element;this.popupService.positionPopup({ePopup:i,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:function(){return{x:e,y:r}}}),this.setPosition(parseFloat(i.style.left),parseFloat(i.style.top))},t.prototype.constrainSizeToAvailableHeight=function(e){var r=this;if(this.config.forcePopupParentAsOffsetParent){e?this.resizeObserverSubscriber=this.resizeObserverService.observeResize(this.popupService.getPopupParent(),function(){var n=r.getAvailableHeight();r.element.style.setProperty("max-height",n+"px")}):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}},t.prototype.setPosition=function(e,r){this.position.x=e,this.position.y=r},t.prototype.updateDragStartPosition=function(e,r){this.dragStartPosition={x:e,y:r}},t.prototype.calculateMouseMovement=function(e){var r=e.e,i=e.isLeft,n=e.isTop,u=e.anywhereWithin,c=e.topBuffer,v=r.clientX-this.dragStartPosition.x,m=r.clientY-this.dragStartPosition.y;return{movementX:this.shouldSkipX(r,!!i,!!u,v)?0:v,movementY:this.shouldSkipY(r,!!n,c,m)?0:m}},t.prototype.shouldSkipX=function(e,r,i,n){var u=this.element.getBoundingClientRect(),c=this.offsetParent.getBoundingClientRect(),v=this.boundaryEl.getBoundingClientRect(),m=this.config.popup?this.position.x:u.left,C=m<=0&&c.left>=e.clientX||c.right<=e.clientX&&c.right<=v.right;return!!C||(C=r?n<0&&e.clientX>m+c.left||n>0&&e.clientX<m+c.left:i?n<0&&e.clientX>v.right||n>0&&e.clientX<m+c.left:n<0&&e.clientX>v.right||n>0&&e.clientX<v.right)},t.prototype.shouldSkipY=function(e,r,i,n){void 0===i&&(i=0);var u=this.element.getBoundingClientRect(),c=this.offsetParent.getBoundingClientRect(),v=this.boundaryEl.getBoundingClientRect(),m=this.config.popup?this.position.y:u.top,C=m<=0&&c.top>=e.clientY||c.bottom<=e.clientY&&c.bottom<=v.bottom;return!!C||(C=r?n<0&&e.clientY>m+c.top+i||n>0&&e.clientY<m+c.top:n<0&&e.clientY>v.bottom||n>0&&e.clientY<v.bottom)},t.prototype.createResizeMap=function(){var e=this.element;this.resizerMap={topLeft:{element:e.querySelector("[ref=eTopLeftResizer]")},top:{element:e.querySelector("[ref=eTopResizer]")},topRight:{element:e.querySelector("[ref=eTopRightResizer]")},right:{element:e.querySelector("[ref=eRightResizer]")},bottomRight:{element:e.querySelector("[ref=eBottomRightResizer]")},bottom:{element:e.querySelector("[ref=eBottomResizer]")},bottomLeft:{element:e.querySelector("[ref=eBottomLeftResizer]")},left:{element:e.querySelector("[ref=eLeftResizer]")}}},t.prototype.addResizers=function(){if(!this.resizersAdded){var e=this.element;if(e){var i=(new DOMParser).parseFromString(mp,"text/html").body;e.appendChild(i.firstChild),this.createResizeMap(),this.resizersAdded=!0}}},t.prototype.removeResizers=function(){this.resizerMap=void 0;var e=this.element.querySelector("."+gp);e&&this.element.removeChild(e),this.resizersAdded=!1},t.prototype.getResizerElement=function(e){return this.resizerMap[e].element},t.prototype.onResizeStart=function(e,r){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!r.match(/top/i),isRight:!!r.match(/right/i),isBottom:!!r.match(/bottom/i),isLeft:!!r.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[r].element.classList.add("ag-active");var i=this.config,n=i.popup,u=i.forcePopupParentAsOffsetParent;!n&&!u&&this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)},t.prototype.getSiblings=function(){var r=this.element.parentElement;return r?Array.prototype.slice.call(r.children).filter(function(i){return!i.classList.contains("ag-hidden")}):null},t.prototype.getMinSizeOfSiblings=function(){for(var e=this.getSiblings()||[],r=0,i=0,n=0;n<e.length;n++){var u=e[n],c=!!u.style.flex&&"0 0 auto"!==u.style.flex;if(u!==this.element){var v=this.minHeight||0,m=this.minWidth||0;if(c){var C=window.getComputedStyle(u);C.minHeight&&(v=parseInt(C.minHeight,10)),C.minWidth&&(m=parseInt(C.minWidth,10))}else v=u.offsetHeight,m=u.offsetWidth;r+=v,i+=m}}return{height:r,width:i}},t.prototype.applySizeToSiblings=function(e){var r=null,i=this.getSiblings();if(i){for(var n=0;n<i.length;n++){var u=i[n];u!==r&&(e?u.style.height=u.offsetHeight+"px":u.style.width=u.offsetWidth+"px",u.style.flex="0 0 auto",u===this.element&&(r=i[n+1]))}r&&(r.style.removeProperty("height"),r.style.removeProperty("min-height"),r.style.removeProperty("max-height"),r.style.flex="1 1 auto")}},t.prototype.isResizable=function(){return Object.values(this.resizable).some(function(e){return e})},t.prototype.onResize=function(e){if(this.isResizing&&this.currentResizer){var r=this.config,i=r.popup,n=r.forcePopupParentAsOffsetParent,u=this.currentResizer,c=u.isTop,v=u.isRight,m=u.isBottom,C=u.isLeft,_=v||C,O=m||c,P=this.calculateMouseMovement({e,isLeft:C,isTop:c}),L=P.movementX,z=P.movementY,q=this.position.x,Z=this.position.y,re=0,pe=0;if(_&&L){var Ce=C?-1:1,be=this.getWidth(),qe=be+L*Ce,et=!1;C&&((q+(re=be-qe)<=0||qe<=this.minWidth)&&(et=!0,re=0)),et||this.setWidth(qe)}if(O&&z){Ce=c?-1:1;var ze=this.getHeight(),st=ze+z*Ce,nt=!1;c?(Z+(pe=ze-st)<=0||st<=this.minHeight)&&(nt=!0,pe=0):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&ze<st&&this.getMinSizeOfSiblings().height+st>this.element.parentElement.offsetHeight&&(nt=!0),nt||this.setHeight(st)}this.updateDragStartPosition(e.clientX,e.clientY),((i||n)&&re||pe)&&this.offsetElement(q+re,Z+pe)}},t.prototype.onResizeEnd=function(e,r){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null;var i={type:"resize",api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi};this.element.classList.remove("ag-resizing"),this.resizerMap[r].element.classList.remove("ag-active"),this.dispatchEvent(i)},t.prototype.refreshSize=function(){var e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))},t.prototype.onMoveStart=function(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)},t.prototype.onMove=function(e){if(this.isMoving){var u,r=this.position,i=r.x,n=r.y;this.config.calculateTopBuffer&&(u=this.config.calculateTopBuffer());var c=this.calculateMouseMovement({e,isTop:!0,anywhereWithin:!0,topBuffer:u}),v=c.movementX,m=c.movementY;this.offsetElement(i+v,n+m),this.updateDragStartPosition(e.clientX,e.clientY)}},t.prototype.onMoveEnd=function(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")},t.prototype.setOffsetParent=function(){this.config.forcePopupParentAsOffsetParent?this.offsetParent=this.popupService.getPopupParent():this.offsetParent=this.element.offsetParent},t.prototype.findBoundaryElement=function(){for(var e=this.element;e;){if("static"!==window.getComputedStyle(e).position)return e;e=e.parentElement}return this.element},t.prototype.clearResizeListeners=function(){for(;this.resizeListeners.length;){var e=this.resizeListeners.pop();this.dragService.removeDragSource(e)}},t.prototype.destroy=function(){o.prototype.destroy.call(this),this.moveElementDragListener&&this.dragService.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()},sc([D("popupService")],t.prototype,"popupService",void 0),sc([D("resizeObserverService")],t.prototype,"resizeObserverService",void 0),sc([D("dragService")],t.prototype,"dragService",void 0),t}(we),ac=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),lc=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Fl=function(o){function t(e){var r=o.call(this)||this;return r.filterNameKey=e,r.applyActive=!1,r.hidePopup=null,r.debouncePending=!1,r.appliedModel=null,r}return ac(t,o),t.prototype.postConstruct=function(){this.resetTemplate(),this.createManagedBean(new ro(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=new bl(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)},t.prototype.handleKeyDown=function(e){},t.prototype.getFilterTitle=function(){return this.translate(this.filterNameKey)},t.prototype.isFilterActive=function(){return!!this.appliedModel},t.prototype.resetTemplate=function(e){var r=this.getGui();r&&r.removeEventListener("submit",this.onFormSubmit);var i='\n            <form class="ag-filter-wrapper">\n                <div class="ag-filter-body-wrapper ag-'+this.getCssIdentifier()+'-body-wrapper" ref="eFilterBody">\n                    '+this.createBodyTemplate()+"\n                </div>\n            </form>";this.setTemplate(i,e),(r=this.getGui())&&r.addEventListener("submit",this.onFormSubmit)},t.prototype.isReadOnly=function(){return!!this.providedFilterParams.readOnly},t.prototype.init=function(e){var r=this;this.setParams(e),this.resetUiToDefaults(!0).then(function(){r.updateUiVisibility(),r.setupOnBtApplyDebounce()})},t.prototype.setParams=function(e){this.providedFilterParams=e,this.applyActive=t.isUseApplyButton(e),this.createButtonPanel()},t.prototype.createButtonPanel=function(){var e=this,r=this.providedFilterParams.buttons;if(!(!r||r.length<1||this.isReadOnly())){var i=document.createElement("div");i.classList.add("ag-filter-apply-panel");ea(r).forEach(function(u){return function(u){var c,v;switch(u){case"apply":c=e.translate("applyFilter"),v=function(_){return e.onBtApply(!1,!1,_)};break;case"clear":c=e.translate("clearFilter"),v=function(){return e.onBtClear()};break;case"reset":c=e.translate("resetFilter"),v=function(){return e.onBtReset()};break;case"cancel":c=e.translate("cancelFilter"),v=function(_){e.onBtCancel(_)};break;default:return void console.warn("AG Grid: Unknown button type specified")}var C=Sr('<button\n                    type="'+("apply"===u?"submit":"button")+'"\n                    ref="'+u+'FilterButton"\n                    class="ag-standard-button ag-filter-apply-panel-button"\n                >'+c+"\n                </button>");i.appendChild(C),e.addManagedListener(C,"click",v)}(u)}),this.getGui().appendChild(i)}},t.prototype.getDefaultDebounceMs=function(){return 0},t.prototype.setupOnBtApplyDebounce=function(){var e=this,r=t.getDebounceMs(this.providedFilterParams,this.getDefaultDebounceMs()),i=Jr(this.checkApplyDebounce.bind(this),r);this.onBtApplyDebounce=function(){e.debouncePending=!0,i()}},t.prototype.checkApplyDebounce=function(){this.debouncePending&&(this.debouncePending=!1,this.onBtApply())},t.prototype.getModel=function(){return this.appliedModel?this.appliedModel:null},t.prototype.setModel=function(e){var r=this;return(null!=e?this.setModelIntoUi(e):this.resetUiToDefaults()).then(function(){r.updateUiVisibility(),r.applyModel("api")})},t.prototype.onBtCancel=function(e){var r=this;this.resetUiToActiveModel(this.getModel(),function(){r.handleCancelEnd(e)})},t.prototype.handleCancelEnd=function(e){this.providedFilterParams.closeOnApply&&this.close(e)},t.prototype.resetUiToActiveModel=function(e,r){var i=this,n=function(){i.onUiChanged(!1,"prevent"),r?.()};null!=e?this.setModelIntoUi(e).then(n):this.resetUiToDefaults().then(n)},t.prototype.onBtClear=function(){var e=this;this.resetUiToDefaults().then(function(){return e.onUiChanged()})},t.prototype.onBtReset=function(){this.onBtClear(),this.onBtApply()},t.prototype.applyModel=function(e){var r=this.getModelFromUi();if(!this.isModelValid(r))return!1;var i=this.appliedModel;return this.appliedModel=r,!this.areModelsEqual(i,r)},t.prototype.isModelValid=function(e){return!0},t.prototype.onFormSubmit=function(e){e.preventDefault()},t.prototype.onBtApply=function(e,r,i){void 0===e&&(e=!1),void 0===r&&(r=!1),i&&i.preventDefault(),this.applyModel(r?"rowDataUpdated":"ui")&&this.providedFilterParams.filterChangedCallback({afterFloatingFilter:e,afterDataChange:r}),this.providedFilterParams.closeOnApply&&this.applyActive&&!e&&!r&&this.close(i)},t.prototype.onNewRowsLoaded=function(){},t.prototype.close=function(e){if(this.hidePopup){var n,r=e,i=r&&r.key;("Enter"===i||"Space"===i)&&(n={keyboardEvent:r}),this.hidePopup(n),this.hidePopup=null}},t.prototype.onUiChanged=function(e,r){if(void 0===e&&(e=!1),this.updateUiVisibility(),this.providedFilterParams.filterModifiedCallback(),this.applyActive&&!this.isReadOnly()){var i=this.isModelValid(this.getModelFromUi());mr(this.getRefElement("applyFilterButton"),!i)}e&&!r||"immediately"===r?this.onBtApply(e):(!this.applyActive&&!r||"debounce"===r)&&this.onBtApplyDebounce()},t.prototype.afterGuiAttached=function(e){e&&(this.hidePopup=e.hidePopup),this.refreshFilterResizer(e?.container)},t.prototype.refreshFilterResizer=function(e){if(this.positionableFeature&&"toolPanel"!==e){var r="floatingFilter"===e,n=this.positionableFeature,u=this.gridOptionsService;r?(n.restoreLastSize(),n.setResizable(u.is("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(this.positionableFeature.removeSizeFromEl(),this.positionableFeature.setResizable(!1)),this.positionableFeature.constrainSizeToAvailableHeight(!0)}},t.prototype.afterGuiDetached=function(){this.checkApplyDebounce(),this.positionableFeature&&this.positionableFeature.constrainSizeToAvailableHeight(!1)},t.getDebounceMs=function(e,r){return t.isUseApplyButton(e)?(null!=e.debounceMs&&console.warn("AG Grid: debounceMs is ignored when apply button is present"),0):null!=e.debounceMs?e.debounceMs:r},t.isUseApplyButton=function(e){return!!e.buttons&&e.buttons.indexOf("apply")>=0},t.prototype.destroy=function(){var e=this.getGui();e&&e.removeEventListener("submit",this.onFormSubmit),this.hidePopup=null,this.positionableFeature&&(this.positionableFeature=this.destroyBean(this.positionableFeature)),o.prototype.destroy.call(this)},t.prototype.translate=function(e){return this.localeService.getLocaleTextFunc()(e,nc[e])},t.prototype.getCellValue=function(e){var r=this.providedFilterParams,i=r.api,n=r.colDef,u=r.column,c=r.columnApi,v=r.context;return this.providedFilterParams.valueGetter({api:i,colDef:n,column:u,columnApi:c,context:v,data:e.data,getValue:function(m){return e.data[m]},node:e})},t.prototype.getPositionableElement=function(){return this.eFilterBody},lc([D("rowModel")],t.prototype,"rowModel",void 0),lc([Te("eFilterBody")],t.prototype,"eFilterBody",void 0),lc([Re],t.prototype,"postConstruct",null),t}(Ue),$h=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),yp=function(o){function t(e,r){var i=o.call(this,r)||this;return i.labelSeparator="",i.labelAlignment="left",i.disabled=!1,i.label="",i.config=e||{},i}return $h(t,o),t.prototype.postConstruct=function(){this.addCssClass("ag-labeled"),this.eLabel.classList.add("ag-label");var e=this.config,r=e.labelSeparator,i=e.label,n=e.labelWidth,u=e.labelAlignment;null!=r&&this.setLabelSeparator(r),null!=i&&this.setLabel(i),null!=n&&this.setLabelWidth(n),this.setLabelAlignment(u||this.labelAlignment),this.refreshLabel()},t.prototype.refreshLabel=function(){Wt(this.eLabel),"string"==typeof this.label?this.eLabel.innerText=this.label+this.labelSeparator:this.label&&this.eLabel.appendChild(this.label),""===this.label?(Ze(this.eLabel,!1),vt(this.eLabel,"presentation")):(Ze(this.eLabel,!0),vt(this.eLabel,null))},t.prototype.setLabelSeparator=function(e){return this.labelSeparator===e||(this.labelSeparator=e,null!=this.label&&this.refreshLabel()),this},t.prototype.getLabelId=function(){return this.eLabel.id=this.eLabel.id||"ag-"+this.getCompId()+"-label",this.eLabel.id},t.prototype.getLabel=function(){return this.label},t.prototype.setLabel=function(e){return this.label===e||(this.label=e,this.refreshLabel()),this},t.prototype.setLabelAlignment=function(e){var i=this.getGui().classList;return i.toggle("ag-label-align-left","left"===e),i.toggle("ag-label-align-right","right"===e),i.toggle("ag-label-align-top","top"===e),this},t.prototype.setLabelEllipsis=function(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this},t.prototype.setLabelWidth=function(e){return null==this.label||Qs(this.eLabel,e),this},t.prototype.setDisabled=function(e){e=!!e;var r=this.getGui();return mr(r,e),r.classList.toggle("ag-disabled",e),this.disabled=e,this},t.prototype.isDisabled=function(){return!!this.disabled},function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);i>3&&n&&Object.defineProperty(t,e,n)}([Re],t.prototype,"postConstruct",null),t}(Ue),Cp=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Do=function(o){function t(e,r,i){var n=o.call(this,e,r)||this;return n.className=i,n}return Cp(t,o),t.prototype.postConstruct=function(){o.prototype.postConstruct.call(this),this.className&&this.addCssClass(this.className)},t.prototype.onValueChange=function(e){var r=this;return this.addManagedListener(this,t.EVENT_CHANGED,function(){return e(r.getValue())}),this},t.prototype.getWidth=function(){return this.getGui().clientWidth},t.prototype.setWidth=function(e){return ci(this.getGui(),e),this},t.prototype.getPreviousValue=function(){return this.previousValue},t.prototype.getValue=function(){return this.value},t.prototype.setValue=function(e,r){return this.value===e||(this.previousValue=this.value,this.value=e,r||this.dispatchEvent({type:t.EVENT_CHANGED})),this},t.EVENT_CHANGED="valueChange",t}(yp),wp=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ds=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Yh=function(o){function t(e,r,i,n){var u=o.call(this,e,'<div class="ag-picker-field" role="presentation">\n                <div ref="eLabel"></div>\n                <div ref="eWrapper"\n                    class="ag-wrapper ag-picker-field-wrapper"\n                    tabIndex="-1"\n                    aria-expanded="false"\n                    '+(n?'role="'+n+'"':"")+'\n                >\n                    <div ref="eDisplayField" class="ag-picker-field-display"></div>\n                    <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>\n                </div>\n            </div>',r)||this;return u.pickerIcon=i,u.isPickerDisplayed=!1,u.isDestroyingPicker=!1,u.skipClick=!1,u}return wp(t,o),t.prototype.postConstruct=function(){var e=this;o.prototype.postConstruct.call(this);var r=this.getCompId()+"-display";this.eDisplayField.setAttribute("id",r),Uu(this.eWrapper,r);var i=function(){e.skipClick?e.skipClick=!1:e.isDisabled()||(e.pickerComponent=e.showPicker())},n=this.getGui();if(this.addManagedListener(n,"mousedown",function(c){!e.skipClick&&e.pickerComponent&&e.pickerComponent.isAlive()&&ls(e.pickerComponent.getGui())&&n.contains(c.target)&&(e.skipClick=!0)}),this.addManagedListener(n,"keydown",function(c){switch(c.key){case ve.UP:case ve.DOWN:case ve.ENTER:case ve.SPACE:i();case ve.ESCAPE:e.isPickerDisplayed&&c.preventDefault()}}),this.addManagedListener(this.eWrapper,"click",i),this.addManagedListener(this.eLabel,"click",i),this.pickerIcon){var u=pr(this.pickerIcon,this.gridOptionsService);u&&this.eIcon.appendChild(u)}},t.prototype.refreshLabel=function(){me(this.getLabel())?Vu(this.eWrapper,this.getLabelId()):this.eWrapper.removeAttribute("aria-labelledby"),o.prototype.refreshLabel.call(this)},t.prototype.setAriaLabel=function(e){return wo(this.eWrapper,e),this},t.prototype.setInputWidth=function(e){return Qs(this.eWrapper,e),this},t.prototype.getFocusableElement=function(){return this.eWrapper},ds([Te("eLabel")],t.prototype,"eLabel",void 0),ds([Te("eWrapper")],t.prototype,"eWrapper",void 0),ds([Te("eDisplayField")],t.prototype,"eDisplayField",void 0),ds([Te("eIcon")],t.prototype,"eIcon",void 0),t}(Do),Xh=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Sp=function(o){function t(e){void 0===e&&(e="default");var r=o.call(this,'<div class="ag-list ag-'+e+'-list" role="listbox"></div>')||this;return r.cssIdentifier=e,r.options=[],r.itemEls=[],r}return Xh(t,o),t.prototype.init=function(){this.addManagedListener(this.getGui(),"keydown",this.handleKeyDown.bind(this))},t.prototype.handleKeyDown=function(e){var r=e.key;switch(r){case ve.ENTER:if(this.highlightedEl){var i=this.itemEls.indexOf(this.highlightedEl);this.setValueByIndex(i)}else this.setValue(this.getValue());break;case ve.DOWN:case ve.UP:var n=r===ve.DOWN,u=void 0;if(e.preventDefault(),this.highlightedEl){var v=this.itemEls.indexOf(this.highlightedEl)+(n?1:-1);v=Math.min(Math.max(v,0),this.itemEls.length-1),u=this.itemEls[v]}else u=this.itemEls[n?0:this.itemEls.length-1];this.highlightItem(u)}},t.prototype.addOptions=function(e){var r=this;return e.forEach(function(i){return r.addOption(i)}),this},t.prototype.addOption=function(e){var r=e.value,n=Wi(e.text||r);return this.options.push({value:r,text:n}),this.renderOption(r,n),this.updateIndices(),this},t.prototype.updateIndices=function(){var e=this.getGui().querySelectorAll(".ag-list-item");e.forEach(function(r,i){ar(r,i+1),So(r,e.length)})},t.prototype.renderOption=function(e,r){var i=this,n=document.createElement("div");vt(n,"option"),n.classList.add("ag-list-item","ag-"+this.cssIdentifier+"-list-item"),n.innerHTML="<span>"+r+"</span>",n.tabIndex=-1,this.itemEls.push(n),this.addManagedListener(n,"mouseover",function(){return i.highlightItem(n)}),this.addManagedListener(n,"mouseleave",function(){return i.clearHighlighted()}),this.addManagedListener(n,"click",function(){return i.setValue(e)}),this.getGui().appendChild(n)},t.prototype.setValue=function(e,r){if(this.value===e)return this.fireItemSelected(),this;if(null==e)return this.reset(),this;var i=this.options.findIndex(function(u){return u.value===e});if(-1!==i){var n=this.options[i];this.value=n.value,this.displayValue=null!=n.text?n.text:n.value,this.highlightItem(this.itemEls[i]),r||this.fireChangeEvent()}return this},t.prototype.setValueByIndex=function(e){return this.setValue(this.options[e].value)},t.prototype.getValue=function(){return this.value},t.prototype.getDisplayValue=function(){return this.displayValue},t.prototype.refreshHighlighted=function(){var e=this;this.clearHighlighted();var r=this.options.findIndex(function(i){return i.value===e.value});-1!==r&&this.highlightItem(this.itemEls[r])},t.prototype.reset=function(){this.value=null,this.displayValue=null,this.clearHighlighted(),this.fireChangeEvent()},t.prototype.highlightItem=function(e){e.offsetParent&&(this.clearHighlighted(),this.highlightedEl=e,this.highlightedEl.classList.add(t.ACTIVE_CLASS),_o(this.highlightedEl,!0),this.highlightedEl.focus())},t.prototype.clearHighlighted=function(){!this.highlightedEl||!this.highlightedEl.offsetParent||(this.highlightedEl.classList.remove(t.ACTIVE_CLASS),_o(this.highlightedEl,!1),this.highlightedEl=null)},t.prototype.fireChangeEvent=function(){this.dispatchEvent({type:Do.EVENT_CHANGED}),this.fireItemSelected()},t.prototype.fireItemSelected=function(){this.dispatchEvent({type:t.EVENT_ITEM_SELECTED})},t.EVENT_ITEM_SELECTED="selectedItem",t.ACTIVE_CLASS="ag-active-item",function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);i>3&&n&&Object.defineProperty(t,e,n)}([Re],t.prototype,"init",null),t}(Ue),Qh=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),cc=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},ia=function(o){function t(e){return o.call(this,e,"ag-select","smallDown","listbox")||this}return Qh(t,o),t.prototype.init=function(){var e=this;this.listComponent=this.createBean(new Sp("select")),this.listComponent.setParentComponent(this),this.eWrapper.tabIndex=0,this.listComponent.addManagedListener(this.listComponent,Sp.EVENT_ITEM_SELECTED,function(){e.hideList&&e.hideList(),e.dispatchEvent({type:t.EVENT_ITEM_SELECTED})}),this.listComponent.addManagedListener(this.listComponent,Do.EVENT_CHANGED,function(){e.setValue(e.listComponent.getValue(),!1,!0),e.hideList&&e.hideList()})},t.prototype.showPicker=function(){var e=this,r=this.listComponent.getGui(),i=this.gridOptionsService.getDocument(),n=this.addManagedListener(i.body,"wheel",function(m){!r.contains(m.target)&&e.hideList&&e.hideList()}),u=this.addManagedListener(r,"focusout",function(m){!r.contains(m.relatedTarget)&&e.hideList&&e.hideList()}),c=this.localeService.getLocaleTextFunc(),v=this.popupService.addPopup({modal:!0,eChild:r,closeOnEsc:!0,closedCallback:function(){e.hideList=null,e.isPickerDisplayed=!1,u(),n(),e.isAlive()&&(zi(e.eWrapper,!1),e.getFocusableElement().focus())},ariaLabel:c("ariaLabelSelectField","Select Field")});return v&&(this.hideList=v.hideFunc),this.isPickerDisplayed=!0,Qs(r,Ys(this.eWrapper)),zi(this.eWrapper,!0),r.style.maxHeight=as(this.popupService.getPopupParent())+"px",r.style.position="absolute",this.popupService.positionPopupByComponent({type:"ag-list",eventSource:this.eWrapper,ePopup:r,position:"under",keepWithinBounds:!0}),this.listComponent.refreshHighlighted(),this.listComponent},t.prototype.addOptions=function(e){var r=this;return e.forEach(function(i){return r.addOption(i)}),this},t.prototype.addOption=function(e){return this.listComponent.addOption(e),this},t.prototype.setValue=function(e,r,i){return this.value===e?this:(i||this.listComponent.setValue(e,!0),this.listComponent.getValue()===this.getValue()?this:(this.eDisplayField.innerHTML=this.listComponent.getDisplayValue(),o.prototype.setValue.call(this,e,r)))},t.prototype.destroy=function(){this.hideList&&this.hideList(),this.destroyBean(this.listComponent),o.prototype.destroy.call(this)},t.EVENT_ITEM_SELECTED="selectedItem",cc([D("popupService")],t.prototype,"popupService",void 0),cc([Re],t.prototype,"init",null),t}(Yh),Jh=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),hs=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},pn=function(o){function t(e,r,i,n){void 0===i&&(i="text"),void 0===n&&(n="input");var u=o.call(this,e,'\n            <div role="presentation">\n                <div ref="eLabel" class="ag-input-field-label"></div>\n                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper" role="presentation">\n                    <'+n+' ref="eInput" class="ag-input-field-input"></'+n+">\n                </div>\n            </div>",r)||this;return u.inputType=i,u.displayFieldTag=n,u}return Jh(t,o),t.prototype.postConstruct=function(){o.prototype.postConstruct.call(this),this.setInputType(),this.eLabel.classList.add(this.className+"-label"),this.eWrapper.classList.add(this.className+"-input-wrapper"),this.eInput.classList.add(this.className+"-input"),this.addCssClass("ag-input-field"),this.eInput.id=this.eInput.id||"ag-"+this.getCompId()+"-input";var e=this.config,r=e.width,i=e.value;null!=r&&this.setWidth(r),null!=i&&this.setValue(i),this.addInputListeners()},t.prototype.refreshLabel=function(){me(this.getLabel())?Vu(this.eInput,this.getLabelId()):this.eInput.removeAttribute("aria-labelledby"),o.prototype.refreshLabel.call(this)},t.prototype.addInputListeners=function(){var e=this;this.addManagedListener(this.eInput,"input",function(r){return e.setValue(r.target.value)})},t.prototype.setInputType=function(){"input"===this.displayFieldTag&&this.eInput.setAttribute("type",this.inputType)},t.prototype.getInputElement=function(){return this.eInput},t.prototype.setInputWidth=function(e){return Qs(this.eWrapper,e),this},t.prototype.setInputName=function(e){return this.getInputElement().setAttribute("name",e),this},t.prototype.getFocusableElement=function(){return this.eInput},t.prototype.setMaxLength=function(e){return this.eInput.maxLength=e,this},t.prototype.setInputPlaceholder=function(e){return fn(this.eInput,"placeholder",e),this},t.prototype.setInputAriaLabel=function(e){return wo(this.eInput,e),this},t.prototype.setDisabled=function(e){return mr(this.eInput,e),o.prototype.setDisabled.call(this,e)},hs([Te("eLabel")],t.prototype,"eLabel",void 0),hs([Te("eWrapper")],t.prototype,"eWrapper",void 0),hs([Te("eInput")],t.prototype,"eInput",void 0),t}(Do),_p=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),vs=function(o){function t(e,r,i){void 0===r&&(r="ag-checkbox"),void 0===i&&(i="checkbox");var n=o.call(this,e,r,i)||this;return n.labelAlignment="right",n.selected=!1,n.readOnly=!1,n.passive=!1,n}return _p(t,o),t.prototype.addInputListeners=function(){this.addManagedListener(this.eInput,"click",this.onCheckboxClick.bind(this)),this.addManagedListener(this.eLabel,"click",this.toggle.bind(this))},t.prototype.getNextValue=function(){return void 0===this.selected||!this.selected},t.prototype.setPassive=function(e){this.passive=e},t.prototype.isReadOnly=function(){return this.readOnly},t.prototype.setReadOnly=function(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e},t.prototype.setDisabled=function(e){return this.eWrapper.classList.toggle("ag-disabled",e),o.prototype.setDisabled.call(this,e)},t.prototype.toggle=function(){if(!this.eInput.disabled){var e=this.isSelected(),r=this.getNextValue();this.passive?this.dispatchChange(r,e):this.setValue(r)}},t.prototype.getValue=function(){return this.isSelected()},t.prototype.setValue=function(e,r){return this.refreshSelectedClass(e),this.setSelected(e,r),this},t.prototype.setName=function(e){return this.getInputElement().name=e,this},t.prototype.isSelected=function(){return this.selected},t.prototype.setSelected=function(e,r){this.isSelected()!==e&&(this.previousValue=this.isSelected(),e=this.selected="boolean"==typeof e?e:void 0,this.eInput.checked=e,this.eInput.indeterminate=void 0===e,r||this.dispatchChange(this.selected,this.previousValue))},t.prototype.dispatchChange=function(e,r,i){this.dispatchEvent({type:t.EVENT_CHANGED,selected:e,previousValue:r,event:i});var n=this.getInputElement(),u={type:I.EVENT_CHECKBOX_CHANGED,id:n.id,name:n.name,selected:e,previousValue:r};this.eventService.dispatchEvent(u)},t.prototype.onCheckboxClick=function(e){if(!this.passive&&!this.eInput.disabled){var r=this.isSelected(),i=this.selected=e.target.checked;this.refreshSelectedClass(i),this.dispatchChange(i,r,e)}},t.prototype.refreshSelectedClass=function(e){this.eWrapper.classList.toggle("ag-checked",!0===e),this.eWrapper.classList.toggle("ag-indeterminate",null==e)},t}(pn),Zh=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),fc=function(o){function t(e){return o.call(this,e,"ag-radio-button","radio")||this}return Zh(t,o),t.prototype.isSelected=function(){return this.eInput.checked},t.prototype.toggle=function(){this.eInput.disabled||this.isSelected()||this.setValue(!0)},t.prototype.addInputListeners=function(){o.prototype.addInputListeners.call(this),this.addManagedListener(this.eventService,I.EVENT_CHECKBOX_CHANGED,this.onChange.bind(this))},t.prototype.onChange=function(e){e.selected&&e.name&&this.eInput.name&&this.eInput.name===e.name&&e.id&&this.eInput.id!==e.id&&this.setValue(!1,!0)},t}(vs),xp=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ep=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},pc=function(){function o(t,e){this.localeService=t,this.optionsFactory=e}return o.prototype.getModelAsString=function(t){var e=this;if(!t)return null;var r=null!=t.operator,i=this.localeService.getLocaleTextFunc();if(r){var n=t,u=n.conditions;if(!u)u=[n.condition1,n.condition2];var m=u.map(function(Z){return e.getModelAsString(Z)}),C="AND"===n.operator?"andCondition":"orCondition";return m.join(" "+i(C,nc[C])+" ")}if(t.type===er.BLANK||t.type===er.NOT_BLANK)return i(t.type,t.type);var _=t,O=this.optionsFactory.getCustomOption(_.type),P=O||{},L=P.displayKey,z=P.displayName,q=P.numberOfInputs;return L&&z&&0===q?(i(L,z),z):this.conditionToString(_,O)},o}(),er=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.eTypes=[],e.eJoinOperatorPanels=[],e.eJoinOperatorsAnd=[],e.eJoinOperatorsOr=[],e.eConditionBodies=[],e.listener=function(){return e.onUiChanged()},e.lastUiCompletePosition=null,e.joinOperatorId=0,e}return xp(t,o),t.prototype.getNumberOfInputs=function(e){var r=this.optionsFactory.getCustomOption(e);if(r)return r.numberOfInputs??1;var n=[t.EMPTY,t.NOT_BLANK,t.BLANK];return e&&n.indexOf(e)>=0?0:e===t.IN_RANGE?2:1},t.prototype.onFloatingFilterChanged=function(e,r){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(r),this.onUiChanged(!0)},t.prototype.setTypeFromFloatingFilter=function(e){var r=this;this.eTypes.forEach(function(i,n){0===n?i.setValue(e,!0):i.setValue(r.optionsFactory.getDefaultOption(),!0)})},t.prototype.getModelFromUi=function(){var e=this.getUiCompleteConditions();return 0===e.length?null:this.maxNumConditions>1&&e.length>1?{filterType:this.getFilterType(),operator:this.getJoinOperator(),condition1:e[0],condition2:e[1],conditions:e}:e[0]},t.prototype.getConditionTypes=function(){return this.eTypes.map(function(e){return e.getValue()})},t.prototype.getConditionType=function(e){return this.eTypes[e].getValue()},t.prototype.getJoinOperator=function(){return 0===this.eJoinOperatorsOr.length?this.defaultJoinOperator:!0===this.eJoinOperatorsOr[0].getValue()?"OR":"AND"},t.prototype.areModelsEqual=function(e,r){var i=this;if(!e&&!r)return!0;if(!e&&r||e&&!r)return!1;var v,n=!e.operator,u=!r.operator;if(!n&&u||n&&!u)return!1;if(n){var m=e,C=r;v=this.areSimpleModelsEqual(m,C)}else{var _=e,O=r;v=_.operator===O.operator&&Xn(_.conditions,O.conditions,function(P,L){return i.areSimpleModelsEqual(P,L)})}return v},t.prototype.setModelIntoUi=function(e){var r=this;if(e.operator){var n=e;n.conditions||(n.conditions=[n.condition1,n.condition2]);var u=this.validateAndUpdateConditions(n.conditions),c=this.getNumConditions();if(u<c)this.removeConditionsAndOperators(u);else if(u>c)for(var v=c;v<u;v++)this.createJoinOperatorPanel(),this.createOption();var m="OR"===n.operator;this.eJoinOperatorsAnd.forEach(function(_){return _.setValue(!m,!0)}),this.eJoinOperatorsOr.forEach(function(_){return _.setValue(m,!0)}),n.conditions.forEach(function(_,O){r.eTypes[O].setValue(_.type,!0),r.setConditionIntoUi(_,O)})}else{var C=e;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(C.type,!0),this.setConditionIntoUi(C,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.onUiChanged(),ir.resolve()},t.prototype.validateAndUpdateConditions=function(e){var r=e.length;return r>this.maxNumConditions&&(e.splice(this.maxNumConditions),_t(function(){return console.warn('AG Grid: Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.')},"simpleFilterSetModelMaxNumConditions"),r=this.maxNumConditions),r},t.prototype.doesFilterPass=function(e){var i,r=this,n=this.getModel();if(null==n)return!0;var u=n.operator,c=[];if(u){var v=n;c.push.apply(c,function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(Ep(arguments[t]));return o}(null!==(i=v.conditions)&&void 0!==i?i:[]))}else c.push(n);return c[u&&"OR"===u?"some":"every"](function(C){return r.individualConditionPasses(e,C)})},t.prototype.setParams=function(e){o.prototype.setParams.call(this,e),this.setNumConditions(e),this.defaultJoinOperator=this.getDefaultJoinOperator(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.optionsFactory=new Al,this.optionsFactory.init(e,this.getDefaultFilterOptions()),this.createOption(),this.createMissingConditionsAndOperators()},t.prototype.setNumConditions=function(e){var r,i;null!=e.suppressAndOrCondition&&_t(function(){return console.warn('AG Grid: Since v29.2 "filterParams.suppressAndOrCondition" is deprecated. Use "filterParams.maxNumConditions = 1" instead.')},"simpleFilterSuppressAndOrCondition"),null!=e.alwaysShowBothConditions&&_t(function(){return console.warn('AG Grid: Since v29.2 "filterParams.alwaysShowBothConditions" is deprecated. Use "filterParams.numAlwaysVisibleConditions = 2" instead.')},"simpleFilterAlwaysShowBothConditions"),this.maxNumConditions=null!==(r=e.maxNumConditions)&&void 0!==r?r:e.suppressAndOrCondition?1:2,this.maxNumConditions<1&&(_t(function(){return console.warn('AG Grid: "filterParams.maxNumConditions" must be greater than or equal to zero.')},"simpleFilterMaxNumConditions"),this.maxNumConditions=1),this.numAlwaysVisibleConditions=null!==(i=e.numAlwaysVisibleConditions)&&void 0!==i?i:e.alwaysShowBothConditions?2:1,this.numAlwaysVisibleConditions<1&&(_t(function(){return console.warn('AG Grid: "filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.')},"simpleFilterNumAlwaysVisibleConditions"),this.numAlwaysVisibleConditions=1),this.numAlwaysVisibleConditions>this.maxNumConditions&&(_t(function(){return console.warn('AG Grid: "filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".')},"simpleFilterNumAlwaysVisibleGreaterThanMaxNumConditions"),this.numAlwaysVisibleConditions=this.maxNumConditions)},t.prototype.createOption=function(){var e=this,r=this.createManagedBean(new ia);this.eTypes.push(r),r.addCssClass("ag-filter-select"),this.eFilterBody.appendChild(r.getGui());var i=this.createValueElement();this.eConditionBodies.push(i),this.eFilterBody.appendChild(i),this.putOptionsIntoDropdown(r),this.resetType(r);var n=this.getNumConditions()-1;this.forEachPositionInput(n,function(u){return e.resetInput(u)}),this.addChangedListeners(r,n)},t.prototype.createJoinOperatorPanel=function(){var e=document.createElement("div");this.eJoinOperatorPanels.push(e),e.classList.add("ag-filter-condition");var r=this.createJoinOperator(this.eJoinOperatorsAnd,e,"and"),i=this.createJoinOperator(this.eJoinOperatorsOr,e,"or");this.eFilterBody.appendChild(e);var n=this.eJoinOperatorPanels.length-1,u=this.joinOperatorId++;this.resetJoinOperatorAnd(r,n,u),this.resetJoinOperatorOr(i,n,u),this.isReadOnly()||(r.onValueChange(this.listener),i.onValueChange(this.listener))},t.prototype.createJoinOperator=function(e,r,i){var n=this.createManagedBean(new fc);return e.push(n),n.addCssClass("ag-filter-condition-operator"),n.addCssClass("ag-filter-condition-operator-"+i),r.appendChild(n.getGui()),n},t.prototype.getDefaultJoinOperator=function(e){return"AND"===e||"OR"===e?e:"AND"},t.prototype.putOptionsIntoDropdown=function(e){var r=this,i=this.optionsFactory.getFilterOptions();i.forEach(function(n){var u="string"==typeof n?r.createBoilerplateListOption(n):r.createCustomListOption(n);e.addOption(u)}),e.setDisabled(i.length<=1)},t.prototype.createBoilerplateListOption=function(e){return{value:e,text:this.translate(e)}},t.prototype.createCustomListOption=function(e){var r=e.displayKey,i=this.optionsFactory.getCustomOption(e.displayKey);return{value:r,text:i?this.localeService.getLocaleTextFunc()(i.displayKey,i.displayName):this.translate(r)}},t.prototype.isAllowTwoConditions=function(){return this.maxNumConditions>=2},t.prototype.createBodyTemplate=function(){return""},t.prototype.getCssIdentifier=function(){return"simple-filter"},t.prototype.updateUiVisibility=function(){var e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)},t.prototype.updateNumConditions=function(){for(var e,r=-1,i=!0,n=0;n<this.getNumConditions();n++)this.isConditionUiComplete(n)?r=n:i=!1;if(this.shouldAddNewConditionAtEnd(i))this.createJoinOperatorPanel(),this.createOption();else{var u=null!==(e=this.lastUiCompletePosition)&&void 0!==e?e:this.getNumConditions()-2;if(r<u){this.removeConditionsAndOperators(u+1);var c=r+1,v=u-c;v>0&&this.removeConditionsAndOperators(c,v),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=r},t.prototype.updateConditionStatusesAndValues=function(e,r){var i=this;this.eTypes.forEach(function(u,c){var v=i.isConditionDisabled(c,e);(1===c?[u,i.eJoinOperatorPanels[0],i.eJoinOperatorsAnd[0],i.eJoinOperatorsOr[0]]:[u]).forEach(function(C){C instanceof pn||C instanceof ia?C.setDisabled(v):mr(C,v)})}),this.eConditionBodies.forEach(function(u,c){Ze(u,i.isConditionBodyVisible(c))});var n="OR"===(r??this.getJoinOperator());this.eJoinOperatorsAnd.forEach(function(u,c){u.setValue(!n,!0)}),this.eJoinOperatorsOr.forEach(function(u,c){u.setValue(n,!0)}),this.forEachInput(function(u,c,v,m){i.setElementDisplayed(u,c<m),i.setElementDisabled(u,i.isConditionDisabled(v,e))}),this.resetPlaceholder()},t.prototype.shouldAddNewConditionAtEnd=function(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()},t.prototype.removeConditionsAndOperators=function(e,r){if(!(e>=this.getNumConditions())){this.removeComponents(this.eTypes,e,r),this.removeElements(this.eConditionBodies,e,r),this.removeValueElements(e,r);var i=Math.max(e-1,0);this.removeElements(this.eJoinOperatorPanels,i,r),this.removeComponents(this.eJoinOperatorsAnd,i,r),this.removeComponents(this.eJoinOperatorsOr,i,r)}},t.prototype.removeElements=function(e,r,i){this.removeItems(e,r,i).forEach(function(u){return Ln(u)})},t.prototype.removeComponents=function(e,r,i){var n=this;this.removeItems(e,r,i).forEach(function(c){Ln(c.getGui()),n.destroyBean(c)})},t.prototype.removeItems=function(e,r,i){return null==i?e.splice(r):e.splice(r,i)},t.prototype.afterGuiAttached=function(e){if(o.prototype.afterGuiAttached.call(this,e),this.resetPlaceholder(),!e||!e.suppressFocus&&!this.isReadOnly()){var r=this.getInputs(0)[0];if(!r)return;r instanceof pn&&r.getInputElement().focus()}},t.prototype.afterGuiDetached=function(){o.prototype.afterGuiDetached.call(this);var e=this.getModel();this.areModelsEqual(e,this.getModelFromUi())||this.resetUiToActiveModel(e);for(var r=-1,i=-1,n=!1,u=this.getJoinOperator(),c=this.getNumConditions()-1;c>=0;c--)if(this.isConditionUiComplete(c))-1===r&&(r=c,i=c);else{var m=c<r;(c>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(c-1)||m)&&(this.removeConditionsAndOperators(c,1),n=!0,m&&i--)}var C=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),C=!0),this.shouldAddNewConditionAtEnd(i===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),C=!0),C&&this.updateConditionStatusesAndValues(i,u),n&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=i},t.prototype.getPlaceholderText=function(e,r){var i=this.translate(e);if(si(this.filterPlaceholder)){var n=this.filterPlaceholder,u=this.eTypes[r].getValue();i=n({filterOptionKey:u,filterOption:this.translate(u),placeholder:i})}else"string"==typeof this.filterPlaceholder&&(i=this.filterPlaceholder);return i},t.prototype.resetPlaceholder=function(){var e=this,r=this.localeService.getLocaleTextFunc();this.forEachInput(function(i,n,u,c){if(i instanceof pn){var v=0===n&&c>1?"inRangeStart":0===n?"filterOoo":"inRangeEnd",m=0===n&&c>1?r("ariaFilterFromValue","Filter from value"):0===n?r("ariaFilterValue","Filter Value"):r("ariaFilterToValue","Filter to Value");i.setInputPlaceholder(e.getPlaceholderText(v,u)),i.setInputAriaLabel(m)}})},t.prototype.setElementValue=function(e,r){e instanceof pn&&e.setValue(null!=r?String(r):null,!0)},t.prototype.setElementDisplayed=function(e,r){e instanceof Ue&&Ze(e.getGui(),r)},t.prototype.setElementDisabled=function(e,r){e instanceof Ue&&mr(e.getGui(),r)},t.prototype.attachElementOnChange=function(e,r){e instanceof pn&&e.onValueChange(r)},t.prototype.forEachInput=function(e){var r=this;this.getConditionTypes().forEach(function(i,n){r.forEachPositionTypeInput(n,i,e)})},t.prototype.forEachPositionInput=function(e,r){var i=this.getConditionType(e);this.forEachPositionTypeInput(e,i,r)},t.prototype.forEachPositionTypeInput=function(e,r,i){for(var n=this.getNumberOfInputs(r),u=this.getInputs(e),c=0;c<u.length;c++){var v=u[c];null!=v&&i(v,c,e,n)}},t.prototype.isConditionDisabled=function(e,r){return!!this.isReadOnly()||0!==e&&e>r+1},t.prototype.isConditionBodyVisible=function(e){var r=this.getConditionType(e);return this.getNumberOfInputs(r)>0},t.prototype.isConditionUiComplete=function(e){return!(e>=this.getNumConditions())&&!(this.getConditionType(e)===t.EMPTY||this.getValues(e).some(function(i){return null==i}))},t.prototype.getNumConditions=function(){return this.eTypes.length},t.prototype.getUiCompleteConditions=function(){for(var e=[],r=0;r<this.getNumConditions();r++)this.isConditionUiComplete(r)&&e.push(this.createCondition(r));return e},t.prototype.createMissingConditionsAndOperators=function(){if(!this.isReadOnly())for(var e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()},t.prototype.resetUiToDefaults=function(e){var r=this;return this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(function(i){return r.resetType(i)}),this.eJoinOperatorsAnd.forEach(function(i,n){return r.resetJoinOperatorAnd(i,n,r.joinOperatorId+n)}),this.eJoinOperatorsOr.forEach(function(i,n){return r.resetJoinOperatorOr(i,n,r.joinOperatorId+n)}),this.joinOperatorId++,this.forEachInput(function(i){return r.resetInput(i)}),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,e||this.onUiChanged(),ir.resolve()},t.prototype.resetType=function(e){var i=this.localeService.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.getDefaultOption(),!0).setAriaLabel(i).setDisabled(this.isReadOnly())},t.prototype.resetJoinOperatorAnd=function(e,r,i){this.resetJoinOperator(e,r,this.isDefaultOperator("AND"),this.translate("andCondition"),i)},t.prototype.resetJoinOperatorOr=function(e,r,i){this.resetJoinOperator(e,r,this.isDefaultOperator("OR"),this.translate("orCondition"),i)},t.prototype.resetJoinOperator=function(e,r,i,n,u){this.updateJoinOperatorDisabled(e.setValue(i,!0).setName("ag-simple-filter-and-or-"+this.getCompId()+"-"+u).setLabel(n),r)},t.prototype.updateJoinOperatorsDisabled=function(){var e=this;this.eJoinOperatorsAnd.forEach(function(r,i){return e.updateJoinOperatorDisabled(r,i)}),this.eJoinOperatorsOr.forEach(function(r,i){return e.updateJoinOperatorDisabled(r,i)})},t.prototype.updateJoinOperatorDisabled=function(e,r){e.setDisabled(this.isReadOnly()||r>0)},t.prototype.resetInput=function(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())},t.prototype.setConditionIntoUi=function(e,r){var i=this,n=this.mapValuesFromModel(e);this.forEachInput(function(u,c,v,m){v===r&&i.setElementValue(u,null!=n[c]?n[c]:null)})},t.prototype.setValueFromFloatingFilter=function(e){var r=this;this.forEachInput(function(i,n,u,c){r.setElementValue(i,0===n&&0===u?e:null)})},t.prototype.isDefaultOperator=function(e){return e===this.defaultJoinOperator},t.prototype.addChangedListeners=function(e,r){var i=this;this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(r,function(n){i.attachElementOnChange(n,i.listener)}))},t.prototype.individualConditionPasses=function(e,r){var i=this.getCellValue(e.node),n=this.mapValuesFromModel(r),u=this.optionsFactory.getCustomOption(r.type);return this.evaluateCustomFilter(u,n,i)??(null==i?this.evaluateNullValue(r.type):this.evaluateNonNullValue(n,i,r,e))},t.prototype.evaluateCustomFilter=function(e,r,i){if(null!=e){var n=e.predicate;if(null!=n&&!r.some(function(u){return null==u}))return n(r,i)}},t.prototype.isBlank=function(e){return null==e||"string"==typeof e&&0===e.trim().length},t.EMPTY="empty",t.BLANK="blank",t.NOT_BLANK="notBlank",t.EQUALS="equals",t.NOT_EQUAL="notEqual",t.LESS_THAN="lessThan",t.LESS_THAN_OR_EQUAL="lessThanOrEqual",t.GREATER_THAN="greaterThan",t.GREATER_THAN_OR_EQUAL="greaterThanOrEqual",t.IN_RANGE="inRange",t.CONTAINS="contains",t.NOT_CONTAINS="notContains",t.STARTS_WITH="startsWith",t.ENDS_WITH="endsWith",t}(Fl),hr=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),It=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return hr(t,o),t.prototype.setParams=function(e){o.prototype.setParams.call(this,e),this.scalarFilterParams=e},t.prototype.evaluateNullValue=function(e){switch(e){case t.EQUALS:case t.NOT_EQUAL:if(this.scalarFilterParams.includeBlanksInEquals)return!0;break;case t.GREATER_THAN:case t.GREATER_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInGreaterThan)return!0;break;case t.LESS_THAN:case t.LESS_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInLessThan)return!0;break;case t.IN_RANGE:if(this.scalarFilterParams.includeBlanksInRange)return!0;break;case t.BLANK:return!0;case t.NOT_BLANK:return!1}return!1},t.prototype.evaluateNonNullValue=function(e,r,i){var n=this.comparator(),u=null!=e[0]?n(e[0],r):0;switch(i.type){case t.EQUALS:return 0===u;case t.NOT_EQUAL:return 0!==u;case t.GREATER_THAN:return u>0;case t.GREATER_THAN_OR_EQUAL:return u>=0;case t.LESS_THAN:return u<0;case t.LESS_THAN_OR_EQUAL:return u<=0;case t.IN_RANGE:var c=n(e[1],r);return this.scalarFilterParams.inRangeInclusive?u>=0&&c<=0:u>0&&c<0;case t.BLANK:return this.isBlank(r);case t.NOT_BLANK:return!this.isBlank(r);default:return console.warn('AG Grid: Unexpected type of filter "'+i.type+'", it looks like the filter was configured with incorrect Filter Options'),!0}},t}(er),vr=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),pi=function(){return pi=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},pi.apply(this,arguments)},Tp=1e3,dc=1/0,gs=function(o){function t(e,r,i){var n=o.call(this,r,i)||this;return n.dateFilterParams=e,n}return vr(t,o),t.prototype.conditionToString=function(e,r){var i=e.type,n=(r||{}).numberOfInputs,u=i==er.IN_RANGE||2===n,c=ln(e.dateFrom),v=ln(e.dateTo),m=this.dateFilterParams.inRangeFloatingFilterDateFormat;return u?(null!==c?os(c,m):"null")+"-"+(null!==v?os(v,m):"null"):null!=c?os(c,m):""+i},t}(pc),Op=function(o){function t(){var e=o.call(this,"dateFilter")||this;return e.eConditionPanelsFrom=[],e.eConditionPanelsTo=[],e.dateConditionFromComps=[],e.dateConditionToComps=[],e.minValidYear=Tp,e.maxValidYear=dc,e}return vr(t,o),t.prototype.afterGuiAttached=function(e){o.prototype.afterGuiAttached.call(this,e),this.dateConditionFromComps[0].afterGuiAttached(e)},t.prototype.mapValuesFromModel=function(e){var r=e||{},i=r.dateFrom,n=r.dateTo,u=r.type;return[i&&ln(i)||null,n&&ln(n)||null].slice(0,this.getNumberOfInputs(u))},t.prototype.comparator=function(){return this.dateFilterParams.comparator?this.dateFilterParams.comparator:this.defaultComparator.bind(this)},t.prototype.defaultComparator=function(e,r){return null==r||r<e?-1:r>e?1:0},t.prototype.setParams=function(e){this.dateFilterParams=e,o.prototype.setParams.call(this,e);var r=function(i,n){if(null!=e[i]){if(!isNaN(e[i]))return null==e[i]?n:Number(e[i]);console.warn("AG Grid: DateFilter "+i+" is not a number")}return n};this.minValidYear=r("minValidYear",Tp),this.maxValidYear=r("maxValidYear",dc),this.minValidYear>this.maxValidYear&&console.warn("AG Grid: DateFilter minValidYear should be <= maxValidYear"),this.filterModelFormatter=new gs(this.dateFilterParams,this.localeService,this.optionsFactory)},t.prototype.createDateCompWrapper=function(e){var r=this,i=new hp(this.getContext(),this.userComponentFactory,{onDateChanged:function(){return r.onUiChanged()},filterParams:this.dateFilterParams},e);return this.addDestroyFunc(function(){return i.destroy()}),i},t.prototype.setElementValue=function(e,r){e.setDate(r)},t.prototype.setElementDisplayed=function(e,r){e.setDisplayed(r)},t.prototype.setElementDisabled=function(e,r){e.setDisabled(r)},t.prototype.getDefaultFilterOptions=function(){return t.DEFAULT_FILTER_OPTIONS},t.prototype.createValueElement=function(){var e=document.createElement("div");return e.classList.add("ag-filter-body"),this.createFromToElement(e,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(e,this.eConditionPanelsTo,this.dateConditionToComps,"to"),e},t.prototype.createFromToElement=function(e,r,i,n){var u=document.createElement("div");u.classList.add("ag-filter-"+n),u.classList.add("ag-filter-date-"+n),r.push(u),e.appendChild(u),i.push(this.createDateCompWrapper(u))},t.prototype.removeValueElements=function(e,r){this.removeDateComps(this.dateConditionFromComps,e,r),this.removeDateComps(this.dateConditionToComps,e,r),this.removeItems(this.eConditionPanelsFrom,e,r),this.removeItems(this.eConditionPanelsTo,e,r)},t.prototype.removeDateComps=function(e,r,i){this.removeItems(e,r,i).forEach(function(u){return u.destroy()})},t.prototype.isConditionUiComplete=function(e){var r=this;if(!o.prototype.isConditionUiComplete.call(this,e))return!1;var n=!0;return this.forEachInput(function(u,c,v,m){v!==e||!n||c>=m||(n=n&&function(u){return null!=u&&u.getUTCFullYear()>=r.minValidYear&&u.getUTCFullYear()<=r.maxValidYear}(u.getDate()))}),n},t.prototype.areSimpleModelsEqual=function(e,r){return e.dateFrom===r.dateFrom&&e.dateTo===r.dateTo&&e.type===r.type},t.prototype.getFilterType=function(){return"date"},t.prototype.createCondition=function(e){var r=this.getConditionType(e),i={},n=this.getValues(e);return n.length>0&&(i.dateFrom=ns(n[0])),n.length>1&&(i.dateTo=ns(n[1])),pi({dateFrom:null,dateTo:null,filterType:this.getFilterType(),type:r},i)},t.prototype.resetPlaceholder=function(){var e=this.localeService.getLocaleTextFunc(),r=this.translate("dateFormatOoo"),i=e("ariaFilterValue","Filter Value");this.forEachInput(function(n){n.setInputPlaceholder(r),n.setInputAriaLabel(i)})},t.prototype.getInputs=function(e){return e>=this.dateConditionFromComps.length?[null,null]:[this.dateConditionFromComps[e],this.dateConditionToComps[e]]},t.prototype.getValues=function(e){var r=[];return this.forEachPositionInput(e,function(i,n,u,c){n<c&&r.push(i.getDate())}),r},t.prototype.getModelAsString=function(e){var r;return null!==(r=this.filterModelFormatter.getModelAsString(e))&&void 0!==r?r:""},t.DEFAULT_FILTER_OPTIONS=[It.EQUALS,It.GREATER_THAN,It.LESS_THAN,It.NOT_EQUAL,It.IN_RANGE,It.BLANK,It.NOT_BLANK],function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);i>3&&n&&Object.defineProperty(t,e,n)}([D("userComponentFactory")],t.prototype,"userComponentFactory",void 0),t}(It),ev=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),no=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return ev(t,o),t.prototype.getDefaultDebounceMs=function(){return 0},t.prototype.destroy=function(){o.prototype.destroy.call(this)},t.prototype.isEventFromFloatingFilter=function(e){return e&&e.afterFloatingFilter},t.prototype.isEventFromDataChange=function(e){return e?.afterDataChange},t.prototype.getLastType=function(){return this.lastType},t.prototype.isReadOnly=function(){return this.readOnly},t.prototype.setLastTypeFromModel=function(e){if(e){var i;if(e.operator)i=e.conditions[0];else i=e;this.lastType=i.type}else this.lastType=this.optionsFactory.getDefaultOption()},t.prototype.canWeEditAfterModelFromParentFilter=function(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;var i=e;return this.isTypeEditable(i.type)},t.prototype.init=function(e){this.optionsFactory=new Al,this.optionsFactory.init(e.filterParams,this.getDefaultFilterOptions()),this.lastType=this.optionsFactory.getDefaultOption(),this.readOnly=!!e.filterParams.readOnly;var r=this.isTypeEditable(this.lastType);this.setEditable(r)},t.prototype.doesFilterHaveSingleInput=function(e){var i=(this.optionsFactory.getCustomOption(e)||{}).numberOfInputs;return null==i||1==i},t.prototype.isTypeEditable=function(e){var r=[er.IN_RANGE,er.EMPTY,er.BLANK,er.NOT_BLANK];return!!e&&!this.isReadOnly()&&this.doesFilterHaveSingleInput(e)&&r.indexOf(e)<0},t}(Ue),na=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Hn=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Ap=function(o){function t(){return o.call(this,'\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eReadOnlyText"></ag-input-text-field>\n                <div ref="eDateWrapper" style="display: flex;"></div>\n            </div>')||this}return na(t,o),t.prototype.getDefaultFilterOptions=function(){return Op.DEFAULT_FILTER_OPTIONS},t.prototype.init=function(e){o.prototype.init.call(this,e),this.params=e,this.filterParams=e.filterParams,this.createDateComponent();var r=this.localeService.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(r("ariaDateFilterInput","Date Filter Input")),this.filterModelFormatter=new gs(this.filterParams,this.localeService,this.optionsFactory)},t.prototype.setEditable=function(e){Ze(this.eDateWrapper,e),Ze(this.eReadOnlyText.getGui(),!e)},t.prototype.onParentModelChanged=function(e,r){if(!this.isEventFromFloatingFilter(r)&&!this.isEventFromDataChange(r)){o.prototype.setLastTypeFromModel.call(this,e);var i=!this.isReadOnly()&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(i),i){if(e){var n=e;this.dateComp.setDate(ln(n.dateFrom))}else this.dateComp.setDate(null);this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}},t.prototype.onDateChanged=function(){var e=this,i=ns(this.dateComp.getDate());this.params.parentFilterInstance(function(n){if(n){var u=ln(i);n.onFloatingFilterChanged(e.getLastType()||null,u)}})},t.prototype.createDateComponent=function(){var e=this,r=Fl.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs()),i={onDateChanged:Jr(this.onDateChanged.bind(this),r),filterParams:this.params.column.getColDef().filterParams};this.dateComp=new hp(this.getContext(),this.userComponentFactory,i,this.eDateWrapper),this.addDestroyFunc(function(){return e.dateComp.destroy()})},t.prototype.getFilterModelFormatter=function(){return this.filterModelFormatter},Hn([D("userComponentFactory")],t.prototype,"userComponentFactory",void 0),Hn([Te("eReadOnlyText")],t.prototype,"eReadOnlyText",void 0),Hn([Te("eDateWrapper")],t.prototype,"eDateWrapper",void 0),t}(no),tv=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),iv=function(o){function t(){return o.call(this,'\n            <div class="ag-filter-filter">\n                <ag-input-text-field class="ag-date-filter" ref="eDateInput"></ag-input-text-field>\n            </div>')||this}return tv(t,o),t.prototype.destroy=function(){o.prototype.destroy.call(this)},t.prototype.init=function(e){var r=this,i=this.gridOptionsService.getDocument(),n=this.eDateInput.getInputElement(),u=this.shouldUseBrowserDatePicker(e);u&&(n.type="date");var c=u&&Fi();this.addManagedListener(n,"mousedown",function(){r.eDateInput.isDisabled()||c||n.focus()}),this.addManagedListener(n,"input",function(_){_.target===i.activeElement&&(r.eDateInput.isDisabled()||e.onDateChanged())});var v=e.filterParams||{},m=v.minValidYear,C=v.maxValidYear;m&&(n.min=m+"-01-01"),C&&(n.max=C+"-12-31")},t.prototype.getDate=function(){return ln(this.eDateInput.getValue())},t.prototype.setDate=function(e){this.eDateInput.setValue(ns(e,!1))},t.prototype.setInputPlaceholder=function(e){this.eDateInput.setInputPlaceholder(e)},t.prototype.setDisabled=function(e){this.eDateInput.setDisabled(e)},t.prototype.afterGuiAttached=function(e){(!e||!e.suppressFocus)&&this.eDateInput.getInputElement().focus()},t.prototype.shouldUseBrowserDatePicker=function(e){return e.filterParams&&null!=e.filterParams.browserDatePicker?e.filterParams.browserDatePicker:xo()||Sl()||Fi()&&wl()>=14.1},function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);i>3&&n&&Object.defineProperty(t,e,n)}([Te("eDateInput")],t.prototype,"eDateInput",void 0),t}(Ue),nv=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Bn=function(o){function t(e,r,i){return void 0===r&&(r="ag-text-field"),void 0===i&&(i="text"),o.call(this,e,r,i)||this}return nv(t,o),t.prototype.postConstruct=function(){o.prototype.postConstruct.call(this),this.config.allowedCharPattern&&this.preventDisallowedCharacters()},t.prototype.setValue=function(e,r){var i=o.prototype.setValue.call(this,e,r);return this.eInput.value!==e&&(this.eInput.value=me(e)?e:""),i},t.prototype.preventDisallowedCharacters=function(){var e=new RegExp("["+this.config.allowedCharPattern+"]");this.addManagedListener(this.eInput,"keypress",function(i){i.ctrlKey||i.metaKey||i.key&&!e.test(i.key)&&i.preventDefault()}),this.addManagedListener(this.eInput,"paste",function(i){var n,u=null===(n=i.clipboardData)||void 0===n?void 0:n.getData("text");u&&u.split("").some(function(c){return!e.test(c)})&&i.preventDefault()})},t}(pn),Dp=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),hc=function(o){function t(e){return o.call(this,e,"ag-number-field","number")||this}return Dp(t,o),t.prototype.postConstruct=function(){var e=this;o.prototype.postConstruct.call(this),this.addManagedListener(this.eInput,"blur",function(){var r=parseFloat(e.eInput.value),i=isNaN(r)?"":e.normalizeValue(r.toString());e.value!==i&&e.setValue(i)}),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this)),this.eInput.step="any"},t.prototype.onWheel=function(e){document.activeElement===this.eInput&&e.preventDefault()},t.prototype.normalizeValue=function(e){if(""===e)return"";this.precision&&(e=this.adjustPrecision(e));var r=parseFloat(e);return null!=this.min&&r<this.min?e=this.min.toString():null!=this.max&&r>this.max&&(e=this.max.toString()),e},t.prototype.adjustPrecision=function(e){if(this.precision){var r=parseFloat(e).toFixed(this.precision);e=parseFloat(r).toString()}return e},t.prototype.setMin=function(e){return this.min===e||(this.min=e,fn(this.eInput,"min",e)),this},t.prototype.setMax=function(e){return this.max===e||(this.max=e,fn(this.eInput,"max",e)),this},t.prototype.setPrecision=function(e){return this.precision=e,this},t.prototype.setStep=function(e){return this.step===e||(this.step=e,fn(this.eInput,"step",e)),this},t.prototype.setValue=function(e,r){if(null!=e&&(e=this.adjustPrecision(e))!=this.normalizeValue(e))return this;return o.prototype.setValue.call(this,e,r)},t}(Bn),bp=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),vc=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return bp(t,o),t.prototype.conditionToString=function(e,r){var i=(r||{}).numberOfInputs;return e.type==er.IN_RANGE||2===i?e.filter+"-"+e.filterTo:null!=e.filter?""+e.filter:""+e.type},t}(pc);function gc(o){return(o??{}).allowedCharPattern||(xo()?null:"\\d\\-\\.")}var ni,Po,dn,$i=function(o){function t(){var e=o.call(this,"numberFilter")||this;return e.eValuesFrom=[],e.eValuesTo=[],e}return bp(t,o),t.prototype.mapValuesFromModel=function(e){var r=e||{},i=r.filter,n=r.filterTo,u=r.type;return[this.processValue(i),this.processValue(n)].slice(0,this.getNumberOfInputs(u))},t.prototype.getDefaultDebounceMs=function(){return 500},t.prototype.comparator=function(){return function(e,r){return e===r?0:e<r?1:-1}},t.prototype.setParams=function(e){this.numberFilterParams=e,o.prototype.setParams.call(this,e),this.filterModelFormatter=new vc(this.localeService,this.optionsFactory)},t.prototype.getDefaultFilterOptions=function(){return t.DEFAULT_FILTER_OPTIONS},t.prototype.createValueElement=function(){var e=gc(this.numberFilterParams),r=document.createElement("div");return r.classList.add("ag-filter-body"),vt(r,"presentation"),this.createFromToElement(r,this.eValuesFrom,"from",e),this.createFromToElement(r,this.eValuesTo,"to",e),r},t.prototype.createFromToElement=function(e,r,i,n){var u=this.createManagedBean(n?new Bn({allowedCharPattern:n}):new hc);u.addCssClass("ag-filter-"+i),u.addCssClass("ag-filter-filter"),r.push(u),e.appendChild(u.getGui())},t.prototype.removeValueElements=function(e,r){this.removeComponents(this.eValuesFrom,e,r),this.removeComponents(this.eValuesTo,e,r)},t.prototype.getValues=function(e){var r=this,i=[];return this.forEachPositionInput(e,function(n,u,c,v){u<v&&i.push(r.processValue(r.stringToFloat(n.getValue())))}),i},t.prototype.areSimpleModelsEqual=function(e,r){return e.filter===r.filter&&e.filterTo===r.filterTo&&e.type===r.type},t.prototype.getFilterType=function(){return"number"},t.prototype.processValue=function(e){return null==e||isNaN(e)?null:e},t.prototype.stringToFloat=function(e){if("number"==typeof e)return e;var r=Xt(e);return null!=r&&""===r.trim()&&(r=null),this.numberFilterParams.numberParser?this.numberFilterParams.numberParser(r):null==r||"-"===r.trim()?null:parseFloat(r)},t.prototype.createCondition=function(e){var r=this.getConditionType(e),i={filterType:this.getFilterType(),type:r},n=this.getValues(e);return n.length>0&&(i.filter=n[0]),n.length>1&&(i.filterTo=n[1]),i},t.prototype.getInputs=function(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]},t.prototype.getModelAsString=function(e){var r;return null!==(r=this.filterModelFormatter.getModelAsString(e))&&void 0!==r?r:""},t.DEFAULT_FILTER_OPTIONS=[It.EQUALS,It.NOT_EQUAL,It.LESS_THAN,It.LESS_THAN_OR_EQUAL,It.GREATER_THAN,It.GREATER_THAN_OR_EQUAL,It.IN_RANGE,It.BLANK,It.NOT_BLANK],t}(It),oo=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Pl=function(){return Pl=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},Pl.apply(this,arguments)},Fp=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return oo(t,o),t.prototype.conditionToString=function(e,r){var i=(r||{}).numberOfInputs;return e.type==er.IN_RANGE||2===i?e.filter+"-"+e.filterTo:null!=e.filter?""+e.filter:""+e.type},t}(pc),mc=function(o){function t(){var e=o.call(this,"textFilter")||this;return e.eValuesFrom=[],e.eValuesTo=[],e}return oo(t,o),t.trimInput=function(e){var r=e&&e.trim();return""===r?e:r},t.prototype.getDefaultDebounceMs=function(){return 500},t.prototype.setParams=function(e){this.textFilterParams=e,o.prototype.setParams.call(this,e),this.matcher=this.getTextMatcher(),this.formatter=this.textFilterParams.textFormatter||(this.textFilterParams.caseSensitive?t.DEFAULT_FORMATTER:t.DEFAULT_LOWERCASE_FORMATTER),this.filterModelFormatter=new Fp(this.localeService,this.optionsFactory)},t.prototype.getTextMatcher=function(){var e=this.textFilterParams.textCustomComparator;return e?(rt.doOnce(function(){return console.warn("AG Grid - textCustomComparator is deprecated, use textMatcher instead.")},"textCustomComparator.deprecated"),function(r){var i=r.filterOption,n=r.value,u=r.filterText;return e(i,n,u)}):this.textFilterParams.textMatcher||t.DEFAULT_MATCHER},t.prototype.createCondition=function(e){var r=this.getConditionType(e),i={filterType:this.getFilterType(),type:r},n=this.getValues(e);return n.length>0&&(i.filter=n[0]),n.length>1&&(i.filterTo=n[1]),i},t.prototype.getFilterType=function(){return"text"},t.prototype.areSimpleModelsEqual=function(e,r){return e.filter===r.filter&&e.filterTo===r.filterTo&&e.type===r.type},t.prototype.getInputs=function(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]},t.prototype.getValues=function(e){var r=this,i=[];return this.forEachPositionInput(e,function(n,u,c,v){if(u<v){var m=Xt(n.getValue()),C=(r.textFilterParams.trimInput?t.trimInput(m):m)||null;i.push(C),n.setValue(C,!0)}}),i},t.prototype.getDefaultFilterOptions=function(){return t.DEFAULT_FILTER_OPTIONS},t.prototype.createValueElement=function(){var e=document.createElement("div");return e.classList.add("ag-filter-body"),vt(e,"presentation"),this.createFromToElement(e,this.eValuesFrom,"from"),this.createFromToElement(e,this.eValuesTo,"to"),e},t.prototype.createFromToElement=function(e,r,i){var n=this.createManagedBean(new Bn);n.addCssClass("ag-filter-"+i),n.addCssClass("ag-filter-filter"),r.push(n),e.appendChild(n.getGui())},t.prototype.removeValueElements=function(e,r){this.removeComponents(this.eValuesFrom,e,r),this.removeComponents(this.eValuesTo,e,r)},t.prototype.mapValuesFromModel=function(e){var r=e||{},i=r.filter,n=r.filterTo,u=r.type;return[i||null,n||null].slice(0,this.getNumberOfInputs(u))},t.prototype.evaluateNullValue=function(e){var r=[er.NOT_EQUAL,er.NOT_CONTAINS,er.BLANK];return!!e&&r.indexOf(e)>=0},t.prototype.evaluateNonNullValue=function(e,r,i,n){var u=this,c=e.map(function(Z){return u.formatter(Z)})||[],v=this.formatter(r),m=this.textFilterParams,C=m.api,_=m.colDef,O=m.column,P=m.columnApi,L=m.context,z=m.textFormatter;if(i.type===er.BLANK)return this.isBlank(r);if(i.type===er.NOT_BLANK)return!this.isBlank(r);var q={api:C,colDef:_,column:O,columnApi:P,context:L,node:n.node,data:n.data,filterOption:i.type,value:v,textFormatter:z};return c.some(function(Z){return u.matcher(Pl(Pl({},q),{filterText:Z}))})},t.prototype.getModelAsString=function(e){var r;return null!==(r=this.filterModelFormatter.getModelAsString(e))&&void 0!==r?r:""},t.DEFAULT_FILTER_OPTIONS=[er.CONTAINS,er.NOT_CONTAINS,er.EQUALS,er.NOT_EQUAL,er.STARTS_WITH,er.ENDS_WITH,er.BLANK,er.NOT_BLANK],t.DEFAULT_FORMATTER=function(e){return e},t.DEFAULT_LOWERCASE_FORMATTER=function(e){return null==e?null:e.toString().toLowerCase()},t.DEFAULT_MATCHER=function(e){var r=e.filterOption,i=e.value,n=e.filterText;if(null==n)return!1;switch(r){case t.CONTAINS:return i.indexOf(n)>=0;case t.NOT_CONTAINS:return i.indexOf(n)<0;case t.EQUALS:return i===n;case t.NOT_EQUAL:return i!=n;case t.STARTS_WITH:return 0===i.indexOf(n);case t.ENDS_WITH:var u=i.lastIndexOf(n);return u>=0&&u===i.length-n.length;default:return!1}},t}(er),yc=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Cc=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},oa=function(o){function t(e){var r=o.call(this)||this;return r.params=e,r}return yc(t,o),t.prototype.setupGui=function(e){this.eFloatingFilterTextInput=this.createManagedBean(new Bn(this.params.config)),this.eFloatingFilterTextInput.setInputAriaLabel(this.params.ariaLabel),e.appendChild(this.eFloatingFilterTextInput.getGui())},t.prototype.setEditable=function(e){this.eFloatingFilterTextInput.setDisabled(!e)},t.prototype.getValue=function(){return this.eFloatingFilterTextInput.getValue()},t.prototype.setValue=function(e,r){this.eFloatingFilterTextInput.setValue(e,r)},t.prototype.addValueChangedListener=function(e){var r=this.eFloatingFilterTextInput.getGui();this.addManagedListener(r,"input",e),this.addManagedListener(r,"keypress",e),this.addManagedListener(r,"keydown",e)},t}(we),wc=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return yc(t,o),t.prototype.postConstruct=function(){this.setTemplate('\n            <div class="ag-floating-filter-input" role="presentation" ref="eFloatingFilterInputContainer"></div>\n        ')},t.prototype.getDefaultDebounceMs=function(){return 500},t.prototype.onParentModelChanged=function(e,r){this.isEventFromFloatingFilter(r)||this.isEventFromDataChange(r)||(this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.floatingFilterInputService.setValue(this.getFilterModelFormatter().getModelAsString(e)))},t.prototype.init=function(e){this.params=e;var n=this.columnModel.getDisplayNameForColumn(e.column,"header",!0)+" "+this.localeService.getLocaleTextFunc()("ariaFilterInput","Filter Input");if(this.floatingFilterInputService=this.createFloatingFilterInputService(n),this.floatingFilterInputService.setupGui(this.eFloatingFilterInputContainer),o.prototype.init.call(this,e),this.applyActive=Fl.isUseApplyButton(this.params.filterParams),!this.isReadOnly()){var u=Fl.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs()),c=Jr(this.syncUpWithParentFilter.bind(this),u);this.floatingFilterInputService.addValueChangedListener(c)}},t.prototype.syncUpWithParentFilter=function(e){var r=this,i=e.key===ve.ENTER;if(!this.applyActive||i){var n=this.floatingFilterInputService.getValue();this.params.filterParams.trimInput&&(n=mc.trimInput(n),this.floatingFilterInputService.setValue(n,!0)),this.params.parentFilterInstance(function(u){u&&u.onFloatingFilterChanged(r.getLastType()||null,n||null)})}},t.prototype.setEditable=function(e){this.floatingFilterInputService.setEditable(e)},Cc([D("columnModel")],t.prototype,"columnModel",void 0),Cc([Te("eFloatingFilterInputContainer")],t.prototype,"eFloatingFilterInputContainer",void 0),Cc([Re],t.prototype,"postConstruct",null),t}(no),Sc=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ov=function(o){function t(e){var r=o.call(this)||this;return r.params=e,r.numberInputActive=!0,r}return Sc(t,o),t.prototype.setupGui=function(e){this.eFloatingFilterNumberInput=this.createManagedBean(new hc),this.eFloatingFilterTextInput=this.createManagedBean(new Bn),this.eFloatingFilterTextInput.setDisabled(!0),this.eFloatingFilterNumberInput.setInputAriaLabel(this.params.ariaLabel),this.eFloatingFilterTextInput.setInputAriaLabel(this.params.ariaLabel),e.appendChild(this.eFloatingFilterNumberInput.getGui()),e.appendChild(this.eFloatingFilterTextInput.getGui())},t.prototype.setEditable=function(e){this.numberInputActive=e,this.eFloatingFilterNumberInput.setDisplayed(this.numberInputActive),this.eFloatingFilterTextInput.setDisplayed(!this.numberInputActive)},t.prototype.getValue=function(){return this.getActiveInputElement().getValue()},t.prototype.setValue=function(e,r){this.getActiveInputElement().setValue(e,r)},t.prototype.getActiveInputElement=function(){return this.numberInputActive?this.eFloatingFilterNumberInput:this.eFloatingFilterTextInput},t.prototype.addValueChangedListener=function(e){this.setupListeners(this.eFloatingFilterNumberInput.getGui(),e),this.setupListeners(this.eFloatingFilterTextInput.getGui(),e)},t.prototype.setupListeners=function(e,r){this.addManagedListener(e,"input",r),this.addManagedListener(e,"keypress",r),this.addManagedListener(e,"keydown",r)},t}(we),Pp=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return Sc(t,o),t.prototype.init=function(e){o.prototype.init.call(this,e),this.filterModelFormatter=new vc(this.localeService,this.optionsFactory)},t.prototype.getDefaultFilterOptions=function(){return $i.DEFAULT_FILTER_OPTIONS},t.prototype.getFilterModelFormatter=function(){return this.filterModelFormatter},t.prototype.createFloatingFilterInputService=function(e){var r=gc(this.params.filterParams);return r?this.createManagedBean(new oa({config:{allowedCharPattern:r},ariaLabel:e})):this.createManagedBean(new ov({ariaLabel:e}))},t}(wc),sv=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),av=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return sv(t,o),t.prototype.init=function(e){o.prototype.init.call(this,e),this.filterModelFormatter=new Fp(this.localeService,this.optionsFactory)},t.prototype.getDefaultFilterOptions=function(){return mc.DEFAULT_FILTER_OPTIONS},t.prototype.getFilterModelFormatter=function(){return this.filterModelFormatter},t.prototype.createFloatingFilterInputService=function(e){return this.createManagedBean(new oa({ariaLabel:e}))},t}(wc),Ut=function(){function o(t,e){var r=this;void 0===e&&(e=!1),this.destroyFuncs=[],this.touching=!1,this.eventService=new Yn,this.eElement=t,this.preventMouseClick=e;var i=this.onTouchStart.bind(this),n=this.onTouchMove.bind(this),u=this.onTouchEnd.bind(this);this.eElement.addEventListener("touchstart",i,{passive:!0}),this.eElement.addEventListener("touchmove",n,{passive:!0}),this.eElement.addEventListener("touchend",u,{passive:!1}),this.destroyFuncs.push(function(){r.eElement.removeEventListener("touchstart",i,{passive:!0}),r.eElement.removeEventListener("touchmove",n,{passive:!0}),r.eElement.removeEventListener("touchend",u,{passive:!1})})}return o.prototype.getActiveTouch=function(t){for(var e=0;e<t.length;e++){if(t[e].identifier===this.touchStart.identifier)return t[e]}return null},o.prototype.addEventListener=function(t,e){this.eventService.addEventListener(t,e)},o.prototype.removeEventListener=function(t,e){this.eventService.removeEventListener(t,e)},o.prototype.onTouchStart=function(t){var e=this;if(!this.touching){this.touchStart=t.touches[0],this.touching=!0,this.moved=!1;var r=this.touchStart;window.setTimeout(function(){var i=e.touchStart===r;if(e.touching&&i&&!e.moved){e.moved=!0;var n={type:o.EVENT_LONG_TAP,touchStart:e.touchStart,touchEvent:t};e.eventService.dispatchEvent(n)}},500)}},o.prototype.onTouchMove=function(t){if(this.touching){var e=this.getActiveTouch(t.touches);if(e)!ec(e,this.touchStart,4)&&(this.moved=!0)}},o.prototype.onTouchEnd=function(t){if(this.touching){if(!this.moved){var e={type:o.EVENT_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(e),this.checkForDoubleTap()}this.preventMouseClick&&t.cancelable&&t.preventDefault(),this.touching=!1}},o.prototype.checkForDoubleTap=function(){var t=(new Date).getTime();if(this.lastTapTime&&this.lastTapTime>0)if(t-this.lastTapTime>o.DOUBLE_TAP_MILLIS){var r={type:o.EVENT_DOUBLE_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(r),this.lastTapTime=null}else this.lastTapTime=t;else this.lastTapTime=t},o.prototype.destroy=function(){this.destroyFuncs.forEach(function(t){return t()})},o.EVENT_TAP="tap",o.EVENT_DOUBLE_TAP="doubleTap",o.EVENT_LONG_TAP="longTap",o.DOUBLE_TAP_MILLIS=500,o}(),lv=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),bo=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},ms=function(o){function t(e){var r=o.call(this)||this;return e||r.setTemplate(t.TEMPLATE),r}return lv(t,o),t.prototype.attachCustomElements=function(e,r,i,n,u){this.eSortOrder=e,this.eSortAsc=r,this.eSortDesc=i,this.eSortMixed=n,this.eSortNone=u},t.prototype.setupSort=function(e,r){var i=this;void 0===r&&(r=!1),this.column=e,this.suppressOrder=r,this.setupMultiSortIndicator(),!!this.column.getColDef().sortable&&(this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e),this.addManagedListener(this.eventService,I.EVENT_SORT_CHANGED,function(){return i.onSortChanged()}),this.addManagedListener(this.eventService,I.EVENT_COLUMN_ROW_GROUP_CHANGED,function(){return i.onSortChanged()}),this.onSortChanged())},t.prototype.addInIcon=function(e,r,i){if(null!=r){var n=pr(e,this.gridOptionsService,i);n&&r.appendChild(n)}},t.prototype.onSortChanged=function(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()},t.prototype.updateIcons=function(){var e=this.sortController.getDisplaySortForColumn(this.column);if(this.eSortAsc){var r="asc"===e;Ze(this.eSortAsc,r,{skipAriaHidden:!0})}if(this.eSortDesc){var i="desc"===e;Ze(this.eSortDesc,i,{skipAriaHidden:!0})}if(this.eSortNone){var n=!this.column.getColDef().unSortIcon&&!this.gridOptionsService.is("unSortIcon"),u=null==e;Ze(this.eSortNone,!n&&u,{skipAriaHidden:!0})}},t.prototype.setupMultiSortIndicator=function(){var e=this;this.addInIcon("sortUnSort",this.eSortMixed,this.column);var r=this.column.getColDef().showRowGroup;this.gridOptionsService.isColumnsSortingCoupledToGroup()&&r&&(this.addManagedListener(this.eventService,I.EVENT_SORT_CHANGED,function(){return e.updateMultiSortIndicator()}),this.addManagedListener(this.eventService,I.EVENT_COLUMN_ROW_GROUP_CHANGED,function(){return e.updateMultiSortIndicator()}),this.updateMultiSortIndicator())},t.prototype.updateMultiSortIndicator=function(){if(this.eSortMixed){var e="mixed"===this.sortController.getDisplaySortForColumn(this.column);Ze(this.eSortMixed,e,{skipAriaHidden:!0})}},t.prototype.updateSortOrder=function(){var r,e=this;if(this.eSortOrder){var i=this.sortController.getColumnsWithSortingOrdered(),n=null!==(r=this.sortController.getDisplaySortIndexForColumn(this.column))&&void 0!==r?r:-1,u=i.some(function(v){var m;return null!==(m=e.sortController.getDisplaySortIndexForColumn(v))&&void 0!==m&&m}),c=n>=0&&u;Ze(this.eSortOrder,c,{skipAriaHidden:!0}),n>=0?this.eSortOrder.innerHTML=(n+1).toString():Wt(this.eSortOrder)}},t.TEMPLATE='<span class="ag-sort-indicator-container">\n            <span ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"></span>\n        </span>',bo([Te("eSortOrder")],t.prototype,"eSortOrder",void 0),bo([Te("eSortAsc")],t.prototype,"eSortAsc",void 0),bo([Te("eSortDesc")],t.prototype,"eSortDesc",void 0),bo([Te("eSortMixed")],t.prototype,"eSortMixed",void 0),bo([Te("eSortNone")],t.prototype,"eSortNone",void 0),bo([D("columnModel")],t.prototype,"columnModel",void 0),bo([D("sortController")],t.prototype,"sortController",void 0),t}(Ue),_c=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ri=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},uv=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.lastMovingChanged=0,e}return _c(t,o),t.prototype.destroy=function(){o.prototype.destroy.call(this)},t.prototype.refresh=function(e){return this.params=e,this.workOutTemplate()==this.currentTemplate&&this.workOutShowMenu()==this.currentShowMenu&&this.workOutSort()==this.currentSort&&(this.setDisplayName(e),!0)},t.prototype.workOutTemplate=function(){var e=Lu(this.params.template,t.TEMPLATE);return e=e&&e.trim?e.trim():e},t.prototype.init=function(e){this.params=e,this.currentTemplate=this.workOutTemplate(),this.setTemplate(this.currentTemplate),this.setupTap(),this.setupIcons(e.column),this.setMenu(),this.setupSort(),this.setupFilterIcon(),this.setDisplayName(e)},t.prototype.setDisplayName=function(e){if(this.currentDisplayName!=e.displayName){this.currentDisplayName=e.displayName;var r=Wi(this.currentDisplayName);this.eText&&(this.eText.innerHTML=r)}},t.prototype.setupIcons=function(e){this.addInIcon("menu",this.eMenu,e),this.addInIcon("filter",this.eFilter,e)},t.prototype.addInIcon=function(e,r,i){if(null!=r){var n=pr(e,this.gridOptionsService,i);n&&r.appendChild(n)}},t.prototype.setupTap=function(){var e=this,r=this.gridOptionsService;if(!r.is("suppressTouch")){var i=new Ut(this.getGui(),!0),n=r.is("suppressMenuHide"),u=n&&me(this.eMenu),c=u?new Ut(this.eMenu,!0):i;if(this.params.enableMenu){var v=u?"EVENT_TAP":"EVENT_LONG_TAP";this.addManagedListener(c,Ut[v],function(_){r.api.showColumnMenuAfterMouseClick(e.params.column,_.touchStart)})}if(this.params.enableSorting){this.addManagedListener(i,Ut.EVENT_TAP,function(_){var O=_.touchStart.target;n&&e.eMenu.contains(O)||e.sortController.progressSort(e.params.column,!1,"uiColumnSorted")})}this.addDestroyFunc(function(){return i.destroy()}),u&&this.addDestroyFunc(function(){return c.destroy()})}},t.prototype.workOutShowMenu=function(){var e=!this.gridOptionsService.is("suppressMenuHide"),r=on()&&e;return this.params.enableMenu&&!r},t.prototype.setMenu=function(){var e=this;if(this.eMenu){if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu)return void Ln(this.eMenu);var r=this.gridOptionsService.is("suppressMenuHide");this.addManagedListener(this.eMenu,"click",function(){return e.showMenu(e.eMenu)}),this.eMenu.classList.toggle("ag-header-menu-always-show",r)}},t.prototype.showMenu=function(e){e||(e=this.eMenu),this.menuFactory.showMenuAfterButtonClick(this.params.column,e,"columnMenu")},t.prototype.workOutSort=function(){return this.params.enableSorting},t.prototype.setupSort=function(){var e=this;if(this.currentSort=this.params.enableSorting,this.eSortIndicator||(this.eSortIndicator=this.context.createBean(new ms(!0)),this.eSortIndicator.attachCustomElements(this.eSortOrder,this.eSortAsc,this.eSortDesc,this.eSortMixed,this.eSortNone)),this.eSortIndicator.setupSort(this.params.column),this.currentSort){var r="ctrl"===this.gridOptionsService.get("multiSortKey");this.addManagedListener(this.params.column,Kt.EVENT_MOVING_CHANGED,function(){e.lastMovingChanged=(new Date).getTime()}),this.eLabel&&this.addManagedListener(this.eLabel,"click",function(n){var u=e.params.column.isMoving(),v=(new Date).getTime()-e.lastMovingChanged<50;if(!(u||v)){var C=r?n.ctrlKey||n.metaKey:n.shiftKey;e.params.progressSort(C)}});var i=function(){if(e.addOrRemoveCssClass("ag-header-cell-sorted-asc",e.params.column.isSortAscending()),e.addOrRemoveCssClass("ag-header-cell-sorted-desc",e.params.column.isSortDescending()),e.addOrRemoveCssClass("ag-header-cell-sorted-none",e.params.column.isSortNone()),e.params.column.getColDef().showRowGroup){var u=e.columnModel.getSourceColumnsForGroupColumn(e.params.column)?.every(function(v){return e.params.column.getSort()==v.getSort()}),c=!u;e.addOrRemoveCssClass("ag-header-cell-sorted-mixed",c)}};this.addManagedListener(this.eventService,I.EVENT_SORT_CHANGED,i),this.addManagedListener(this.eventService,I.EVENT_COLUMN_ROW_GROUP_CHANGED,i)}},t.prototype.setupFilterIcon=function(){this.eFilter&&(this.addManagedListener(this.params.column,Kt.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.onFilterChanged())},t.prototype.onFilterChanged=function(){var e=this.params.column.isFilterActive();Ze(this.eFilter,e,{skipAriaHidden:!0})},t.TEMPLATE='<div class="ag-cell-label-container" role="presentation">\n            <span ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>\n            <div ref="eLabel" class="ag-header-cell-label" role="presentation">\n                <span ref="eText" class="ag-header-cell-text"></span>\n                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon" aria-hidden="true"></span>\n                <ag-sort-indicator ref="eSortIndicator"></ag-sort-indicator>\n            </div>\n        </div>',Ri([D("sortController")],t.prototype,"sortController",void 0),Ri([D("menuFactory")],t.prototype,"menuFactory",void 0),Ri([D("columnModel")],t.prototype,"columnModel",void 0),Ri([Te("eFilter")],t.prototype,"eFilter",void 0),Ri([Te("eSortIndicator")],t.prototype,"eSortIndicator",void 0),Ri([Te("eMenu")],t.prototype,"eMenu",void 0),Ri([Te("eLabel")],t.prototype,"eLabel",void 0),Ri([Te("eText")],t.prototype,"eText",void 0),Ri([Te("eSortOrder")],t.prototype,"eSortOrder",void 0),Ri([Te("eSortAsc")],t.prototype,"eSortAsc",void 0),Ri([Te("eSortDesc")],t.prototype,"eSortDesc",void 0),Ri([Te("eSortMixed")],t.prototype,"eSortMixed",void 0),Ri([Te("eSortNone")],t.prototype,"eSortNone",void 0),t}(Ue),cv=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),xc=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},fv=function(o){function t(){return o.call(this,t.TEMPLATE)||this}return cv(t,o),t.prototype.destroy=function(){o.prototype.destroy.call(this)},t.prototype.init=function(e){this.params=e,this.checkWarnings(),this.setupLabel(),this.addGroupExpandIcon(),this.setupExpandIcons()},t.prototype.checkWarnings=function(){if(this.params.template){_t(function(){return console.warn("AG Grid: A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)")},"HeaderGroupComp.templateNotSupported")}},t.prototype.setupExpandIcons=function(){var e=this;this.addInIcon("columnGroupOpened","agOpened"),this.addInIcon("columnGroupClosed","agClosed");var r=function(u){if(!tn(u)){var c=!e.params.columnGroup.isExpanded();e.columnModel.setColumnGroupOpened(e.params.columnGroup.getProvidedColumnGroup(),c,"uiColumnExpanded")}};this.addTouchAndClickListeners(this.eCloseIcon,r),this.addTouchAndClickListeners(this.eOpenIcon,r);var i=function(u){Qo(u)};this.addManagedListener(this.eCloseIcon,"dblclick",i),this.addManagedListener(this.eOpenIcon,"dblclick",i),this.addManagedListener(this.getGui(),"dblclick",r),this.updateIconVisibility();var n=this.params.columnGroup.getProvidedColumnGroup();this.addManagedListener(n,tr.EVENT_EXPANDED_CHANGED,this.updateIconVisibility.bind(this)),this.addManagedListener(n,tr.EVENT_EXPANDABLE_CHANGED,this.updateIconVisibility.bind(this))},t.prototype.addTouchAndClickListeners=function(e,r){var i=new Ut(e,!0);this.addManagedListener(i,Ut.EVENT_TAP,r),this.addDestroyFunc(function(){return i.destroy()}),this.addManagedListener(e,"click",r)},t.prototype.updateIconVisibility=function(){if(this.params.columnGroup.isExpandable()){var r=this.params.columnGroup.isExpanded();Ze(this.eOpenIcon,r),Ze(this.eCloseIcon,!r)}else Ze(this.eOpenIcon,!1),Ze(this.eCloseIcon,!1)},t.prototype.addInIcon=function(e,r){var i=pr(e,this.gridOptionsService,null);i&&this.getRefElement(r).appendChild(i)},t.prototype.addGroupExpandIcon=function(){if(!this.params.columnGroup.isExpandable())return Ze(this.eOpenIcon,!1),void Ze(this.eCloseIcon,!1)},t.prototype.setupLabel=function(){var e,r=this.params,i=r.displayName,n=r.columnGroup;if(me(i)){var u=Wi(i);this.getRefElement("agLabel").innerHTML=u}this.addOrRemoveCssClass("ag-sticky-label",!(null===(e=n.getColGroupDef())||void 0===e||!e.stickyLabel))},t.TEMPLATE='<div class="ag-header-group-cell-label" ref="agContainer" role="presentation">\n            <span ref="agLabel" class="ag-header-group-text" role="presentation"></span>\n            <span ref="agOpened" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"></span>\n            <span ref="agClosed" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"></span>\n        </div>',xc([D("columnModel")],t.prototype,"columnModel",void 0),xc([Te("agOpened")],t.prototype,"eOpenIcon",void 0),xc([Te("agClosed")],t.prototype,"eCloseIcon",void 0),t}(Ue),pv=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),sa=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return pv(t,o),t.prototype.isPopup=function(){return!0},t.prototype.setParentComponent=function(e){e.addCssClass("ag-has-popup"),o.prototype.setParentComponent.call(this,e)},t.prototype.destroy=function(){var e=this.parentComponent;e&&e.isAlive()&&e.getGui().classList.remove("ag-has-popup"),o.prototype.destroy.call(this)},t}(Ue),dv=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),vv=function(o){function t(){return o.call(this,t.TEMPLATE)||this}return dv(t,o),t.prototype.init=function(e){this.params=e,this.focusAfterAttached=e.cellStartedEdit,this.eTextArea.setMaxLength(e.maxLength||200).setCols(e.cols||60).setRows(e.rows||10),me(e.value,!0)&&this.eTextArea.setValue(e.value.toString(),!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this))},t.prototype.onKeyDown=function(e){var r=e.key;(r===ve.LEFT||r===ve.UP||r===ve.RIGHT||r===ve.DOWN||e.shiftKey&&r===ve.ENTER)&&e.stopPropagation()},t.prototype.afterGuiAttached=function(){var e=this.localeService.getLocaleTextFunc();this.eTextArea.setInputAriaLabel(e("ariaInputEditor","Input Editor")),this.focusAfterAttached&&this.eTextArea.getFocusableElement().focus()},t.prototype.getValue=function(){return this.params.parseValue(this.eTextArea.getValue())},t.TEMPLATE='<div class="ag-large-text" tabindex="0">\n            <ag-input-text-area ref="eTextArea" class="ag-large-text-input"></ag-input-text-area>\n        </div>',function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);i>3&&n&&Object.defineProperty(t,e,n)}([Te("eTextArea")],t.prototype,"eTextArea",void 0),t}(sa),gv=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ip=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Lp=function(o){function t(){var e=o.call(this,'<div class="ag-cell-edit-wrapper"><ag-select class="ag-cell-editor" ref="eSelect"></ag-select></div>')||this;return e.startedByEnter=!1,e}return gv(t,o),t.prototype.init=function(e){var r=this;if(this.focusAfterAttached=e.cellStartedEdit,Je(e.values))console.warn("AG Grid: no values found for select cellEditor");else{this.startedByEnter=null!=e.eventKey&&e.eventKey===ve.ENTER;var i=!1;e.values.forEach(function(n){var u={value:n},c=r.valueFormatterService.formatValue(e.column,null,n),v=null!=c;u.text=v?c:n,r.eSelect.addOption(u),i=i||e.value===n}),i?this.eSelect.setValue(e.value,!0):e.values.length&&this.eSelect.setValue(e.values[0],!0),"fullRow"!==this.gridOptionsService.get("editType")&&this.addManagedListener(this.eSelect,ia.EVENT_ITEM_SELECTED,function(){return e.stopEditing()})}},t.prototype.afterGuiAttached=function(){this.focusAfterAttached&&this.eSelect.getFocusableElement().focus(),this.startedByEnter&&this.eSelect.showPicker()},t.prototype.focusIn=function(){this.eSelect.getFocusableElement().focus()},t.prototype.getValue=function(){return this.eSelect.getValue()},t.prototype.isPopup=function(){return!1},Ip([D("valueFormatterService")],t.prototype,"valueFormatterService",void 0),Ip([Te("eSelect")],t.prototype,"eSelect",void 0),t}(sa),mv=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Mp=function(o){function t(){return o.call(this,t.TEMPLATE)||this}return mv(t,o),t.prototype.init=function(e){this.params=e;var i,r=this.eInput;e.cellStartedEdit?(this.focusAfterAttached=!0,e.eventKey===ve.BACKSPACE||e.eventKey===ve.DELETE?i="":e.charPress?i=e.charPress:(i=this.getStartValue(e),e.eventKey!==ve.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,i=this.getStartValue(e)),null!=i&&r.setValue(i,!0),null!=e.maxLength&&r.setMaxLength(e.maxLength),this.addManagedListener(r.getGui(),"keydown",function(n){var u=n.key;(u===ve.PAGE_UP||u===ve.PAGE_DOWN)&&n.preventDefault()})},t.prototype.afterGuiAttached=function(){var e=this.localeService.getLocaleTextFunc(),r=this.eInput;if(r.setInputAriaLabel(e("ariaInputEditor","Input Editor")),this.focusAfterAttached){Fi()||r.getFocusableElement().focus();var i=r.getInputElement();if(this.highlightAllOnFocus)i.select();else{var n=r.getValue(),u=me(n)&&n.length||0;u&&i.setSelectionRange(u,u)}}},t.prototype.focusIn=function(){var e=this.eInput,r=e.getFocusableElement(),i=e.getInputElement();r.focus(),i.select()},t.prototype.getValue=function(){var e=this.eInput;return this.params.parseValue(e.getValue())},t.prototype.getStartValue=function(e){return e.useFormatter||e.column.getColDef().refData?e.formatValue(e.value):e.value},t.prototype.isPopup=function(){return!1},t.TEMPLATE='<div class="ag-cell-edit-wrapper">\n            <ag-input-text-field class="ag-cell-editor" ref="eInput"></ag-input-text-field>\n        </div>',function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);i>3&&n&&Object.defineProperty(t,e,n)}([Te("eInput")],t.prototype,"eInput",void 0),t}(sa),Cv=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),xv=function(o){function t(){var e=o.call(this,t.TEMPLATE)||this;return e.refreshCount=0,e}return Cv(t,o),t.prototype.init=function(e){this.eValue=this.queryForHtmlElement(".ag-value-change-value"),this.eDelta=this.queryForHtmlElement(".ag-value-change-delta"),this.refresh(e)},t.prototype.showDelta=function(e,r){var i=Math.abs(r),n=e.formatValue(i),u=me(n)?n:i,c=r>=0;this.eDelta.innerHTML=c?"\u2191"+u:"\u2193"+u,this.eDelta.classList.toggle("ag-value-change-delta-up",c),this.eDelta.classList.toggle("ag-value-change-delta-down",!c)},t.prototype.setTimerToRemoveDelta=function(){var e=this;this.refreshCount++;var r=this.refreshCount;window.setTimeout(function(){r===e.refreshCount&&e.hideDeltaValue()},2e3)},t.prototype.hideDeltaValue=function(){this.eValue.classList.remove("ag-value-change-value-highlight"),Wt(this.eDelta)},t.prototype.refresh=function(e){var r=e.value;if(r===this.lastValue||(me(e.valueFormatted)?this.eValue.innerHTML=e.valueFormatted:me(e.value)?this.eValue.innerHTML=r:Wt(this.eValue),this.filterManager.isSuppressFlashingCellsBecauseFiltering()))return!1;if("number"==typeof r&&"number"==typeof this.lastValue){var i=r-this.lastValue;this.showDelta(e,i)}return this.lastValue&&this.eValue.classList.add("ag-value-change-value-highlight"),this.setTimerToRemoveDelta(),this.lastValue=r,!0},t.TEMPLATE='<span><span class="ag-value-change-delta"></span><span class="ag-value-change-value"></span></span>',function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);i>3&&n&&Object.defineProperty(t,e,n)}([D("filterManager")],t.prototype,"filterManager",void 0),t}(Ue),Ev=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Tv=function(o){function t(){var e=o.call(this,t.TEMPLATE)||this;return e.refreshCount=0,e.eCurrent=e.queryForHtmlElement(".ag-value-slide-current"),e}return Ev(t,o),t.prototype.init=function(e){this.refresh(e)},t.prototype.addSlideAnimation=function(){var e=this;this.refreshCount++;var r=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious),this.ePrevious=Sr('<span class="ag-value-slide-previous ag-value-slide-out"></span>'),this.ePrevious.innerHTML=this.eCurrent.innerHTML,this.getGui().insertBefore(this.ePrevious,this.eCurrent),window.setTimeout(function(){r===e.refreshCount&&e.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(function(){r===e.refreshCount&&(e.getGui().removeChild(e.ePrevious),e.ePrevious=null)},3e3)},t.prototype.refresh=function(e){var r=e.value;return Je(r)&&(r=""),r!==this.lastValue&&!this.filterManager.isSuppressFlashingCellsBecauseFiltering()&&(this.addSlideAnimation(),this.lastValue=r,me(e.valueFormatted)?this.eCurrent.innerHTML=e.valueFormatted:me(e.value)?this.eCurrent.innerHTML=r:Wt(this.eCurrent),!0)},t.TEMPLATE='<span>\n            <span class="ag-value-slide-current"></span>\n        </span>',function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);i>3&&n&&Object.defineProperty(t,e,n)}([D("filterManager")],t.prototype,"filterManager",void 0),t}(Ue),ys=function(){return ys=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},ys.apply(this,arguments)},wt=function(){function o(t){this.rowIndex=null,this.key=null,this.childrenMapped={},this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=o.OBJECT_ID_SEQUENCE++,this.__autoHeights={},this.alreadyRendered=!1,this.highlighted=null,this.hovered=!1,this.selected=!1,this.beans=t}return o.prototype.setData=function(t){this.setDataCommon(t,!1)},o.prototype.updateData=function(t){this.setDataCommon(t,!0)},o.prototype.setDataCommon=function(t,e){var r=this.data;this.data=t,this.beans.valueCache.onDataChanged(),this.updateDataOnDetailNode(),this.checkRowSelectable(),this.resetQuickFilterAggregateText();var i=this.createDataChangedEvent(t,r,e);this.dispatchLocalEvent(i)},o.prototype.updateDataOnDetailNode=function(){this.detailNode&&(this.detailNode.data=this.data)},o.prototype.createDataChangedEvent=function(t,e,r){return{type:o.EVENT_DATA_CHANGED,node:this,oldData:e,newData:t,update:r}},o.prototype.createLocalRowEvent=function(t){return{type:t,node:this}},o.prototype.getRowIndexString=function(){return"top"===this.rowPinned?"t-"+this.rowIndex:"bottom"===this.rowPinned?"b-"+this.rowIndex:this.rowIndex.toString()},o.prototype.createDaemonNode=function(){var t=new o(this.beans);return t.id=this.id,t.data=this.data,t.__daemon=!0,t.selected=this.selected,t.level=this.level,t},o.prototype.setDataAndId=function(t,e){var r=me(this.id)?this.createDaemonNode():null,i=this.data;this.data=t,this.updateDataOnDetailNode(),this.setId(e),this.beans.selectionService.syncInRowNode(this,r),this.checkRowSelectable();var n=this.createDataChangedEvent(t,i,!1);this.dispatchLocalEvent(n)},o.prototype.checkRowSelectable=function(){var t=this.beans.gridOptionsService.get("isRowSelectable");this.setRowSelectable(!t||t(this))},o.prototype.setRowSelectable=function(t){if(this.selectable!==t&&(this.selectable=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(o.EVENT_SELECTABLE_CHANGED)),this.beans.gridOptionsService.is("groupSelectsChildren"))){var r=this.calculateSelectedFromChildren();this.setSelectedParams({newValue:r??!1,source:"selectableChanged"})}},o.prototype.setId=function(t){var e=this.beans.gridOptionsService.getRowIdFunc();if(e)if(this.data){var r=this.getGroupKeys(!0);this.id=e({data:this.data,parentKeys:r.length>0?r:void 0,level:this.level}),null!==this.id&&"string"==typeof this.id&&this.id.startsWith(o.ID_PREFIX_ROW_GROUP)&&console.error("AG Grid: Row IDs cannot start with "+o.ID_PREFIX_ROW_GROUP+", this is a reserved prefix for AG Grid's row grouping feature."),null!==this.id&&"string"!=typeof this.id&&(this.id=""+this.id)}else this.id=void 0;else this.id=t},o.prototype.getGroupKeys=function(t){void 0===t&&(t=!1);var e=[],r=this;for(t&&(r=r.parent);r&&r.level>=0;)e.push(r.key),r=r.parent;return e.reverse(),e},o.prototype.isPixelInRange=function(t){return!(!me(this.rowTop)||!me(this.rowHeight))&&(t>=this.rowTop&&t<this.rowTop+this.rowHeight)},o.prototype.setFirstChild=function(t){this.firstChild!==t&&(this.firstChild=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(o.EVENT_FIRST_CHILD_CHANGED)))},o.prototype.setLastChild=function(t){this.lastChild!==t&&(this.lastChild=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(o.EVENT_LAST_CHILD_CHANGED)))},o.prototype.setChildIndex=function(t){this.childIndex!==t&&(this.childIndex=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(o.EVENT_CHILD_INDEX_CHANGED)))},o.prototype.setRowTop=function(t){this.oldRowTop=this.rowTop,this.rowTop!==t&&(this.rowTop=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(o.EVENT_TOP_CHANGED)),this.setDisplayed(null!==t))},o.prototype.clearRowTopAndRowIndex=function(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)},o.prototype.setDisplayed=function(t){this.displayed!==t&&(this.displayed=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(o.EVENT_DISPLAYED_CHANGED)))},o.prototype.setDragging=function(t){this.dragging!==t&&(this.dragging=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(o.EVENT_DRAGGING_CHANGED)))},o.prototype.setHighlighted=function(t){t!==this.highlighted&&(this.highlighted=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(o.EVENT_HIGHLIGHT_CHANGED)))},o.prototype.setHovered=function(t){this.hovered!==t&&(this.hovered=t)},o.prototype.isHovered=function(){return this.hovered},o.prototype.setAllChildrenCount=function(t){this.allChildrenCount!==t&&(this.allChildrenCount=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(o.EVENT_ALL_CHILDREN_COUNT_CHANGED)))},o.prototype.setMaster=function(t){this.master!==t&&(this.master&&!t&&(this.expanded=!1),this.master=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(o.EVENT_MASTER_CHANGED)))},o.prototype.setGroup=function(t){this.group!==t&&(this.group&&!t&&(this.expanded=!1),this.group=t,this.updateHasChildren(),this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(o.EVENT_GROUP_CHANGED)))},o.prototype.setRowHeight=function(t,e){void 0===e&&(e=!1),this.rowHeight=t,this.rowHeightEstimated=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(o.EVENT_HEIGHT_CHANGED))},o.prototype.setRowAutoHeight=function(t,e){this.__autoHeights||(this.__autoHeights={}),this.__autoHeights[e.getId()]=t,null!=t&&(null==this.checkAutoHeightsDebounced&&(this.checkAutoHeightsDebounced=Jr(this.checkAutoHeights.bind(this),1)),this.checkAutoHeightsDebounced())},o.prototype.checkAutoHeights=function(){var t=this,e=!1,r=!0,i=0,n=this.__autoHeights;if(null!=n&&(this.beans.columnModel.getAllDisplayedAutoHeightCols().forEach(function(v){var m=n[v.getId()];if(null==m){if(!t.beans.columnModel.isColSpanActive())return void(e=!0);var C=[];switch(v.getPinned()){case"left":C=t.beans.columnModel.getDisplayedLeftColumnsForRow(t);break;case"right":C=t.beans.columnModel.getDisplayedRightColumnsForRow(t);break;case null:C=t.beans.columnModel.getViewportCenterColumnsForRow(t)}if(C.includes(v))return void(e=!0);m=-1}else r=!1;m>i&&(i=m)}),!e&&((r||i<10)&&(i=this.beans.gridOptionsService.getRowHeightForNode(this).height),i!=this.rowHeight))){this.setRowHeight(i);var c=this.beans.rowModel;c.onRowHeightChangedDebounced&&c.onRowHeightChangedDebounced()}},o.prototype.setRowIndex=function(t){this.rowIndex!==t&&(this.rowIndex=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(o.EVENT_ROW_INDEX_CHANGED)))},o.prototype.setUiLevel=function(t){this.uiLevel!==t&&(this.uiLevel=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(o.EVENT_UI_LEVEL_CHANGED)))},o.prototype.setExpanded=function(t,e){if(this.expanded!==t){this.expanded=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(o.EVENT_EXPANDED_CHANGED));var r=Object.assign({},this.createGlobalRowEvent(I.EVENT_ROW_GROUP_OPENED),{expanded:t,event:e||null});this.beans.rowNodeEventThrottle.dispatchExpanded(r),this.beans.gridOptionsService.is("groupIncludeFooter")&&this.beans.rowRenderer.refreshCells({rowNodes:[this]})}},o.prototype.createGlobalRowEvent=function(t){return{type:t,node:this,data:this.data,rowIndex:this.rowIndex,rowPinned:this.rowPinned,context:this.beans.gridOptionsService.context,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi}},o.prototype.dispatchLocalEvent=function(t){this.eventService&&this.eventService.dispatchEvent(t)},o.prototype.setDataValue=function(t,e,r){var m,i=this,u="string"!=typeof t?t:null!==(m=i.beans.columnModel.getGridColumn(t))&&void 0!==m?m:i.beans.columnModel.getPrimaryColumn(t),c=this.getValueFromValueService(u);if(this.beans.gridOptionsService.is("readOnlyEdit"))return this.dispatchEventForSaveValueReadOnly(u,c,e,r),!1;var v=this.beans.valueService.setValue(this,u,e,r);return this.dispatchCellChangedEvent(u,e,c),this.checkRowSelectable(),v},o.prototype.getValueFromValueService=function(t){var e=this.leafGroup&&this.beans.columnModel.isPivotMode(),r=this.group&&this.expanded&&!this.footer&&!e,i=this.beans.gridOptionsService.is("groupIncludeFooter"),n=this.beans.gridOptionsService.is("groupSuppressBlankHeader"),u=r&&i&&!n;return this.beans.valueService.getValue(t,this,!1,u)},o.prototype.dispatchEventForSaveValueReadOnly=function(t,e,r,i){var n={type:I.EVENT_CELL_EDIT_REQUEST,event:null,rowIndex:this.rowIndex,rowPinned:this.rowPinned,column:t,colDef:t.getColDef(),context:this.beans.gridOptionsService.context,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,data:this.data,node:this,oldValue:e,newValue:r,value:r,source:i};this.beans.eventService.dispatchEvent(n)},o.prototype.setGroupValue=function(t,e){var r=this.beans.columnModel.getGridColumn(t);Je(this.groupData)&&(this.groupData={});var i=r.getColId(),n=this.groupData[i];n!==e&&(this.groupData[i]=e,this.dispatchCellChangedEvent(r,e,n))},o.prototype.setAggData=function(t){var e=this,r=en([this.aggData,t]),i=this.aggData;this.aggData=t,this.eventService&&r.forEach(function(n){var u=e.beans.columnModel.getGridColumn(n),c=e.aggData?e.aggData[n]:void 0,v=i?i[n]:void 0;e.dispatchCellChangedEvent(u,c,v)})},o.prototype.updateHasChildren=function(){var t=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0;if(this.beans.gridOptionsService.isRowModelType("serverSide")){var r=this.beans.gridOptionsService.isTreeData(),i=this.beans.gridOptionsService.get("isServerSideGroup");t=!this.stub&&!this.footer&&(r?!!i&&i(this.data):!!this.group)}t!==this.__hasChildren&&(this.__hasChildren=!!t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(o.EVENT_HAS_CHILDREN_CHANGED)))},o.prototype.hasChildren=function(){return null==this.__hasChildren&&this.updateHasChildren(),this.__hasChildren},o.prototype.isEmptyRowGroupNode=function(){return this.group&&Ve(this.childrenAfterGroup)},o.prototype.dispatchCellChangedEvent=function(t,e,r){var i={type:o.EVENT_CELL_CHANGED,node:this,column:t,newValue:e,oldValue:r};this.dispatchLocalEvent(i)},o.prototype.resetQuickFilterAggregateText=function(){this.quickFilterAggregateText=null},o.prototype.isExpandable=function(){return!!(this.hasChildren()&&!this.footer||this.master)},o.prototype.isSelected=function(){return this.footer?this.sibling.isSelected():this.selected},o.prototype.depthFirstSearch=function(t){this.childrenAfterGroup&&this.childrenAfterGroup.forEach(function(e){return e.depthFirstSearch(t)}),t(this)},o.prototype.calculateSelectedFromChildren=function(){var t,e=!1,r=!1,i=!1;if(null===(t=this.childrenAfterGroup)||void 0===t||!t.length)return this.selectable?this.selected:null;for(var n=0;n<this.childrenAfterGroup.length;n++){var u=this.childrenAfterGroup[n],c=u.isSelected();if(!u.selectable){var v=u.calculateSelectedFromChildren();if(null===v)continue;c=v}switch(c){case!0:e=!0;break;case!1:r=!0;break;default:i=!0}}return i||e&&r?void 0:!!e||!r&&(this.selectable?this.selected:null)},o.prototype.setSelectedInitialValue=function(t){this.selected=t},o.prototype.selectThisNode=function(t,e,r){void 0===r&&(r="api");var i=!this.selectable&&t,n=this.selected===t;if(i||n)return!1;this.selected=t,this.eventService&&this.dispatchLocalEvent(this.createLocalRowEvent(o.EVENT_ROW_SELECTED));var u=ys(ys({},this.createGlobalRowEvent(I.EVENT_ROW_SELECTED)),{event:e||null,source:r});return this.beans.eventService.dispatchEvent(u),!0},o.prototype.setSelected=function(t,e,r,i){void 0===e&&(e=!1),void 0===r&&(r=!1),void 0===i&&(i="api"),this.setSelectedParams({newValue:t,clearSelection:e,suppressFinishActions:r,rangeSelect:!1,source:i})},o.prototype.setSelectedParams=function(t){return this.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),0):void 0===this.id?(console.warn("AG Grid: cannot select node until id for node is known"),0):this.beans.selectionService.setNodeSelected(ys(ys({},t),{node:this.footer?this.sibling:this}))},o.prototype.isRowPinned=function(){return"top"===this.rowPinned||"bottom"===this.rowPinned},o.prototype.isParentOfNode=function(t){for(var e=this.parent;e;){if(e===t)return!0;e=e.parent}return!1},o.prototype.addEventListener=function(t,e){this.eventService||(this.eventService=new Yn),this.eventService.addEventListener(t,e)},o.prototype.removeEventListener=function(t,e){this.eventService&&(this.eventService.removeEventListener(t,e),this.eventService.noRegisteredListenersExist()&&(this.eventService=null))},o.prototype.onMouseEnter=function(){this.dispatchLocalEvent(this.createLocalRowEvent(o.EVENT_MOUSE_ENTER))},o.prototype.onMouseLeave=function(){this.dispatchLocalEvent(this.createLocalRowEvent(o.EVENT_MOUSE_LEAVE))},o.prototype.getFirstChildOfFirstChild=function(t){for(var e=this,r=!0,i=!1,n=null;r&&!i;){var u=e.parent;me(u)&&e.firstChild?u.rowGroupColumn===t&&(i=!0,n=u):r=!1,e=u}return i?n:null},o.prototype.isFullWidthCell=function(){var t=this.getIsFullWidthCellFunc();return!!t&&t({rowNode:this})},o.prototype.getIsFullWidthCellFunc=function(){var t=this.beans.gridOptionsService.getCallback("isFullWidthRow");if(t)return t;var e=this.beans.gridOptionsService.get("isFullWidthCell");return e?function(r){return e(r.rowNode)}:void 0},o.prototype.getRoute=function(){if(null!=this.key){for(var t=[],e=this;null!=e.key;)t.push(e.key),e=e.parent;return t.reverse()}},o.prototype.createFooter=function(){var t=this;if(!this.sibling){var e=new o(this.beans);Object.keys(this).forEach(function(r){e[r]=t[r]}),e.footer=!0,e.setRowTop(null),e.setRowIndex(null),e.oldRowTop=null,e.id="rowGroupFooter_"+this.id,e.sibling=this,this.sibling=e}},o.ID_PREFIX_ROW_GROUP="row-group-",o.ID_PREFIX_TOP_PINNED="t-",o.ID_PREFIX_BOTTOM_PINNED="b-",o.OBJECT_ID_SEQUENCE=0,o.EVENT_ROW_SELECTED="rowSelected",o.EVENT_DATA_CHANGED="dataChanged",o.EVENT_CELL_CHANGED="cellChanged",o.EVENT_ALL_CHILDREN_COUNT_CHANGED="allChildrenCountChanged",o.EVENT_MASTER_CHANGED="masterChanged",o.EVENT_GROUP_CHANGED="groupChanged",o.EVENT_MOUSE_ENTER="mouseEnter",o.EVENT_MOUSE_LEAVE="mouseLeave",o.EVENT_HEIGHT_CHANGED="heightChanged",o.EVENT_TOP_CHANGED="topChanged",o.EVENT_DISPLAYED_CHANGED="displayedChanged",o.EVENT_FIRST_CHILD_CHANGED="firstChildChanged",o.EVENT_LAST_CHILD_CHANGED="lastChildChanged",o.EVENT_CHILD_INDEX_CHANGED="childIndexChanged",o.EVENT_ROW_INDEX_CHANGED="rowIndexChanged",o.EVENT_EXPANDED_CHANGED="expandedChanged",o.EVENT_HAS_CHILDREN_CHANGED="hasChildrenChanged",o.EVENT_SELECTABLE_CHANGED="selectableChanged",o.EVENT_UI_LEVEL_CHANGED="uiLevelChanged",o.EVENT_HIGHLIGHT_CHANGED="rowHighlightChanged",o.EVENT_DRAGGING_CHANGED="draggingChanged",o}(),Ov=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),aa=function(){return aa=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},aa.apply(this,arguments)},Np=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},kp=function(o){function t(){return o.call(this,'\n            <div class="ag-selection-checkbox" role="presentation">\n                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n            </div>')||this}return Ov(t,o),t.prototype.postConstruct=function(){this.eCheckbox.setPassive(!0)},t.prototype.getCheckboxId=function(){return this.eCheckbox.getInputElement().id},t.prototype.onDataChanged=function(){this.onSelectionChanged()},t.prototype.onSelectableChanged=function(){this.showOrHideSelect()},t.prototype.onSelectionChanged=function(){var e=this.localeService.getLocaleTextFunc(),r=this.rowNode.isSelected(),i=void 0===r?e("ariaIndeterminate","indeterminate"):!0===r?e("ariaChecked","checked"):e("ariaUnchecked","unchecked"),n=e("ariaRowToggleSelection","Press Space to toggle row selection");this.eCheckbox.setValue(r,!0),this.eCheckbox.setInputAriaLabel(n+" ("+i+")")},t.prototype.onCheckedClicked=function(e){var r=this.gridOptionsService.is("groupSelectsFiltered");return this.rowNode.setSelectedParams({newValue:!1,rangeSelect:e.shiftKey,groupSelectsFiltered:r,event:e,source:"checkboxSelected"})},t.prototype.onUncheckedClicked=function(e){var r=this.gridOptionsService.is("groupSelectsFiltered");return this.rowNode.setSelectedParams({newValue:!0,rangeSelect:e.shiftKey,groupSelectsFiltered:r,event:e,source:"checkboxSelected"})},t.prototype.init=function(e){var r=this;if(this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListener(this.eCheckbox.getInputElement(),"dblclick",function(c){Qo(c)}),this.addManagedListener(this.eCheckbox.getInputElement(),"click",function(c){Qo(c),r.eCheckbox.getValue()?r.onCheckedClicked(c):r.onUncheckedClicked(c||{})}),this.addManagedListener(this.rowNode,wt.EVENT_ROW_SELECTED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.rowNode,wt.EVENT_DATA_CHANGED,this.onDataChanged.bind(this)),this.addManagedListener(this.rowNode,wt.EVENT_SELECTABLE_CHANGED,this.onSelectableChanged.bind(this)),this.gridOptionsService.get("isRowSelectable")||"function"==typeof this.getIsVisible()){var u=this.showOrHideSelect.bind(this);this.addManagedListener(this.eventService,I.EVENT_DISPLAYED_COLUMNS_CHANGED,u),this.addManagedListener(this.rowNode,wt.EVENT_DATA_CHANGED,u),this.addManagedListener(this.rowNode,wt.EVENT_CELL_CHANGED,u),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")},t.prototype.showOrHideSelect=function(){var e,r,i,n,u=this.rowNode.selectable,c=this.getIsVisible();if(u)if("function"==typeof c){var v=null===(e=this.overrides)||void 0===e?void 0:e.callbackParams,m=null===(r=this.column)||void 0===r?void 0:r.createColumnFunctionCallbackParams(this.rowNode);u=!!m&&c(aa(aa({},v),m))}else u=c??!1;if(null===(i=this.column)||void 0===i?void 0:i.getColDef().showDisabledCheckboxes)return this.eCheckbox.setDisabled(!u),this.setVisible(!0),void this.setDisplayed(!0);null!==(n=this.overrides)&&void 0!==n&&n.removeHidden?this.setDisplayed(u):this.setVisible(u)},t.prototype.getIsVisible=function(){var e,r;return this.overrides?this.overrides.isVisible:null===(r=null===(e=this.column)||void 0===e?void 0:e.getColDef())||void 0===r?void 0:r.checkboxSelection},Np([Te("eCheckbox")],t.prototype,"eCheckbox",void 0),Np([Re],t.prototype,"postConstruct",null),t}(Ue),Av=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Fo=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Il=function(o){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&o[t],r=0;if(e)return e.call(o);if(o&&"number"==typeof o.length)return{next:function(){return o&&r>=o.length&&(o=void 0),{value:o&&o[r++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(o){o[o.ToolPanel=0]="ToolPanel",o[o.HeaderCell=1]="HeaderCell",o[o.RowDrag=2]="RowDrag",o[o.ChartPanel=3]="ChartPanel"}(ni||(ni={})),function(o){o[o.Up=0]="Up",o[o.Down=1]="Down"}(Po||(Po={})),function(o){o[o.Left=0]="Left",o[o.Right=1]="Right"}(dn||(dn={}));var Nl,Vr=function(o){function t(){var r=null!==o&&o.apply(this,arguments)||this;return r.dragSourceAndParamsList=[],r.dropTargets=[],r}var e;return Av(t,o),e=t,t.prototype.init=function(){this.ePinnedIcon=ii("columnMovePin",this.gridOptionsService,null),this.eHideIcon=ii("columnMoveHide",this.gridOptionsService,null),this.eMoveIcon=ii("columnMoveMove",this.gridOptionsService,null),this.eLeftIcon=ii("columnMoveLeft",this.gridOptionsService,null),this.eRightIcon=ii("columnMoveRight",this.gridOptionsService,null),this.eGroupIcon=ii("columnMoveGroup",this.gridOptionsService,null),this.eAggregateIcon=ii("columnMoveValue",this.gridOptionsService,null),this.ePivotIcon=ii("columnMovePivot",this.gridOptionsService,null),this.eDropNotAllowedIcon=ii("dropNotAllowed",this.gridOptionsService,null)},t.prototype.addDragSource=function(r,i){void 0===i&&(i=!1);var n={eElement:r.eElement,dragStartPixels:r.dragStartPixels,onDragStart:this.onDragStart.bind(this,r),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this)};this.dragSourceAndParamsList.push({params:n,dragSource:r}),this.dragService.addDragSource(n,i)},t.prototype.removeDragSource=function(r){var i=this.dragSourceAndParamsList.find(function(n){return n.dragSource===r});i&&(this.dragService.removeDragSource(i.params),Nr(this.dragSourceAndParamsList,i))},t.prototype.clearDragSourceParamsList=function(){var r=this;this.dragSourceAndParamsList.forEach(function(i){return r.dragService.removeDragSource(i.params)}),this.dragSourceAndParamsList.length=0,this.dropTargets.length=0},t.prototype.nudge=function(){this.dragging&&this.onDragging(this.eventLastTime,!0)},t.prototype.onDragStart=function(r,i){this.dragging=!0,this.dragSource=r,this.eventLastTime=i,this.dragItem=this.dragSource.getDragItem(),this.lastDropTarget=this.dragSource.dragSourceDropTarget,this.dragSource.onDragStarted&&this.dragSource.onDragStarted(),this.createGhost()},t.prototype.onDragStop=function(r){if(this.eventLastTime=null,this.dragging=!1,this.dragSource.onDragStopped&&this.dragSource.onDragStopped(),this.lastDropTarget&&this.lastDropTarget.onDragStop){var i=this.createDropTargetEvent(this.lastDropTarget,r,null,null,!1);this.lastDropTarget.onDragStop(i)}this.lastDropTarget=null,this.dragItem=null,this.removeGhost()},t.prototype.onDragging=function(r,i){var u,c,v,m,n=this,C=this.getHorizontalDirection(r),_=this.getVerticalDirection(r);this.eventLastTime=r,this.positionGhost(r);var O=this.dropTargets.filter(function(z){return n.isMouseOnDropTarget(r,z)}),P=this.findCurrentDropTarget(r,O);if(P!==this.lastDropTarget)this.leaveLastTargetIfExists(r,C,_,i),null!==this.lastDropTarget&&null===P&&(null===(c=(u=this.dragSource).onGridExit)||void 0===c||c.call(u,this.dragItem)),null===this.lastDropTarget&&null!==P&&(null===(m=(v=this.dragSource).onGridEnter)||void 0===m||m.call(v,this.dragItem)),this.enterDragTargetIfExists(P,r,C,_,i),this.lastDropTarget=P;else if(P&&P.onDragging){var L=this.createDropTargetEvent(P,r,C,_,i);P.onDragging(L)}},t.prototype.getAllContainersFromDropTarget=function(r){var i=r.getSecondaryContainers?r.getSecondaryContainers():null,n=[[r.getContainer()]];return i?n.concat(i):n},t.prototype.allContainersIntersect=function(r,i){var n,u;try{for(var c=Il(i),v=c.next();!v.done;v=c.next()){var C=v.value.getBoundingClientRect();if(0===C.width||0===C.height)return!1;var _=r.clientX>=C.left&&r.clientX<C.right,O=r.clientY>=C.top&&r.clientY<C.bottom;if(!_||!O)return!1}}catch(P){n={error:P}}finally{try{v&&!v.done&&(u=c.return)&&u.call(c)}finally{if(n)throw n.error}}return!0},t.prototype.isMouseOnDropTarget=function(r,i){var n,u,c=this.getAllContainersFromDropTarget(i),v=!1;try{for(var m=Il(c),C=m.next();!C.done;C=m.next()){var _=C.value;if(this.allContainersIntersect(r,_)){v=!0;break}}}catch(O){n={error:O}}finally{try{C&&!C.done&&(u=m.return)&&u.call(m)}finally{if(n)throw n.error}}return!(i.targetContainsSource&&!i.getContainer().contains(this.dragSource.eElement))&&(v&&i.isInterestedIn(this.dragSource.type,this.dragSource.eElement))},t.prototype.findCurrentDropTarget=function(r,i){var n,u,c,v,m=i.length;if(0===m)return null;if(1===m)return i[0];var _=this.gridOptionsService.getRootNode().elementsFromPoint(r.clientX,r.clientY);try{for(var O=Il(_),P=O.next();!P.done;P=O.next()){var L=P.value;try{for(var z=(c=void 0,Il(i)),q=z.next();!q.done;q=z.next()){var Z=q.value;if(-1!==kf(this.getAllContainersFromDropTarget(Z)).indexOf(L))return Z}}catch(pe){c={error:pe}}finally{try{q&&!q.done&&(v=z.return)&&v.call(z)}finally{if(c)throw c.error}}}}catch(pe){n={error:pe}}finally{try{P&&!P.done&&(u=O.return)&&u.call(O)}finally{if(n)throw n.error}}return null},t.prototype.enterDragTargetIfExists=function(r,i,n,u,c){if(r){if(r.onDragEnter){var v=this.createDropTargetEvent(r,i,n,u,c);r.onDragEnter(v)}this.setGhostIcon(r.getIconName?r.getIconName():null)}},t.prototype.leaveLastTargetIfExists=function(r,i,n,u){if(this.lastDropTarget){if(this.lastDropTarget.onDragLeave){var c=this.createDropTargetEvent(this.lastDropTarget,r,i,n,u);this.lastDropTarget.onDragLeave(c)}this.setGhostIcon(null)}},t.prototype.addDropTarget=function(r){this.dropTargets.push(r)},t.prototype.removeDropTarget=function(r){this.dropTargets=this.dropTargets.filter(function(i){return i.getContainer()!==r.getContainer()})},t.prototype.hasExternalDropZones=function(){return this.dropTargets.some(function(r){return r.external})},t.prototype.findExternalZone=function(r){return this.dropTargets.filter(function(n){return n.external}).find(function(n){return n.getContainer()===r.getContainer()})||null},t.prototype.getHorizontalDirection=function(r){var i=this.eventLastTime&&this.eventLastTime.clientX,n=r.clientX;return i===n?null:i>n?dn.Left:dn.Right},t.prototype.getVerticalDirection=function(r){var i=this.eventLastTime&&this.eventLastTime.clientY,n=r.clientY;return i===n?null:i>n?Po.Up:Po.Down},t.prototype.createDropTargetEvent=function(r,i,n,u,c){var v=r.getContainer(),m=v.getBoundingClientRect(),C=this,_=C.gridApi,O=C.columnApi,P=C.dragItem,L=C.dragSource;return{event:i,x:i.clientX-m.left,y:i.clientY-m.top,vDirection:u,hDirection:n,dragSource:L,fromNudge:c,dragItem:P,api:_,columnApi:O,dropZoneTarget:v}},t.prototype.positionGhost=function(r){var i=this.eGhost;if(i){var u=i.getBoundingClientRect().height,c=tp()-2,v=wr()-2,m=r.pageY-u/2,C=r.pageX-10,_=this.gridOptionsService.getDocument(),O=_.defaultView||window,P=O.pageYOffset||_.documentElement.scrollTop,L=O.pageXOffset||_.documentElement.scrollLeft;c>0&&C+i.clientWidth>c+L&&(C=c+L-i.clientWidth),C<0&&(C=0),v>0&&m+i.clientHeight>v+P&&(m=v+P-i.clientHeight),m<0&&(m=0),i.style.left=C+"px",i.style.top=m+"px"}},t.prototype.removeGhost=function(){this.eGhost&&this.eGhostParent&&this.eGhostParent.removeChild(this.eGhost),this.eGhost=null},t.prototype.createGhost=function(){this.eGhost=Sr(e.GHOST_TEMPLATE),this.mouseEventService.stampTopLevelGridCompWithGridInstance(this.eGhost);var r=this.environment.getTheme().theme;r&&this.eGhost.classList.add(r),this.eGhostIcon=this.eGhost.querySelector(".ag-dnd-ghost-icon"),this.setGhostIcon(null);var i=this.eGhost.querySelector(".ag-dnd-ghost-label"),n=this.dragSource.dragItemName;si(n)&&(n=n()),i.innerHTML=Wi(n)||"",this.eGhost.style.height="25px",this.eGhost.style.top="20px",this.eGhost.style.left="20px";var u=this.gridOptionsService.getDocument(),c=null;try{c=u.fullscreenElement}catch{}finally{if(!c){var v=this.gridOptionsService.getRootNode(),m=v.querySelector("body");c=m||(v instanceof ShadowRoot?v:v?.documentElement)}}this.eGhostParent=c,this.eGhostParent?this.eGhostParent.appendChild(this.eGhost):console.warn("AG Grid: could not find document body, it is needed for dragging columns")},t.prototype.setGhostIcon=function(r,i){void 0===i&&(i=!1),Wt(this.eGhostIcon);var n=null;switch(r||(r=this.dragSource.defaultIconName||e.ICON_NOT_ALLOWED),r){case e.ICON_PINNED:n=this.ePinnedIcon;break;case e.ICON_MOVE:n=this.eMoveIcon;break;case e.ICON_LEFT:n=this.eLeftIcon;break;case e.ICON_RIGHT:n=this.eRightIcon;break;case e.ICON_GROUP:n=this.eGroupIcon;break;case e.ICON_AGGREGATE:n=this.eAggregateIcon;break;case e.ICON_PIVOT:n=this.ePivotIcon;break;case e.ICON_NOT_ALLOWED:n=this.eDropNotAllowedIcon;break;case e.ICON_HIDE:n=this.eHideIcon}this.eGhostIcon.classList.toggle("ag-shake-left-to-right",i),(n!==this.eHideIcon||!this.gridOptionsService.is("suppressDragLeaveHidesColumns"))&&n&&this.eGhostIcon.appendChild(n)},t.ICON_PINNED="pinned",t.ICON_MOVE="move",t.ICON_LEFT="left",t.ICON_RIGHT="right",t.ICON_GROUP="group",t.ICON_AGGREGATE="aggregate",t.ICON_PIVOT="pivot",t.ICON_NOT_ALLOWED="notAllowed",t.ICON_HIDE="hide",t.GHOST_TEMPLATE='<div class="ag-dnd-ghost ag-unselectable">\n            <span class="ag-dnd-ghost-icon ag-shake-left-to-right"></span>\n            <div class="ag-dnd-ghost-label"></div>\n        </div>',Fo([D("dragService")],t.prototype,"dragService",void 0),Fo([D("mouseEventService")],t.prototype,"mouseEventService",void 0),Fo([D("columnApi")],t.prototype,"columnApi",void 0),Fo([D("gridApi")],t.prototype,"gridApi",void 0),Fo([Re],t.prototype,"init",null),Fo([Mr],t.prototype,"clearDragSourceParamsList",null),t=e=Fo([He("dragAndDropService")],t)}(we),la=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ua=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Ll=function(o){function t(e,r,i,n,u,c){var v=o.call(this)||this;return v.cellValueFn=e,v.rowNode=r,v.column=i,v.customGui=n,v.dragStartPixels=u,v.suppressVisibilityChange=c,v.dragSource=null,v}return la(t,o),t.prototype.isCustomGui=function(){return null!=this.customGui},t.prototype.postConstruct=function(){if(this.customGui?this.setDragElement(this.customGui,this.dragStartPixels):(this.setTemplate('<div class="ag-drag-handle ag-row-drag" aria-hidden="true"></div>'),this.getGui().appendChild(pr("rowDrag",this.beans.gridOptionsService,null)),this.addDragSource()),this.checkCompatibility(),!this.suppressVisibilityChange){var e=this.beans.gridOptionsService.is("rowDragManaged")?new Dv(this,this.beans,this.rowNode,this.column):new Hp(this,this.beans,this.rowNode,this.column);this.createManagedBean(e,this.beans.context)}},t.prototype.setDragElement=function(e,r){this.setTemplateFromElement(e),this.addDragSource(r)},t.prototype.getSelectedNodes=function(){if(!this.beans.gridOptionsService.is("rowDragMultiRow"))return[this.rowNode];var r=this.beans.selectionService.getSelectedNodes();return-1!==r.indexOf(this.rowNode)?r:[this.rowNode]},t.prototype.checkCompatibility=function(){var e=this.beans.gridOptionsService.is("rowDragManaged");this.beans.gridOptionsService.isTreeData()&&e&&_t(function(){return console.warn("AG Grid: If using row drag with tree data, you cannot have rowDragManaged=true")},"RowDragComp.managedAndTreeData")},t.prototype.getDragItem=function(){return{rowNode:this.rowNode,rowNodes:this.getSelectedNodes(),columns:this.column?[this.column]:void 0,defaultTextValue:this.cellValueFn()}},t.prototype.getRowDragText=function(e){if(e){var r=e.getColDef();if(r.rowDragText)return r.rowDragText}return this.gridOptionsService.get("rowDragText")},t.prototype.addDragSource=function(e){var r=this;void 0===e&&(e=4),this.dragSource&&this.removeDragSource();var i=this.getRowDragText(this.column),n=this.localeService.getLocaleTextFunc();this.dragSource={type:ni.RowDrag,eElement:this.getGui(),dragItemName:function(){var u,c=r.getDragItem(),v=(null===(u=c.rowNodes)||void 0===u?void 0:u.length)||1;return i?i(c,v):1===v?r.cellValueFn():v+" "+n("rowDragRows","rows")},getDragItem:function(){return r.getDragItem()},dragStartPixels:e,dragSourceDomDataKey:this.beans.gridOptionsService.getDomDataKey()},this.beans.dragAndDropService.addDragSource(this.dragSource,!0)},t.prototype.removeDragSource=function(){this.dragSource&&this.beans.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null},ua([D("beans")],t.prototype,"beans",void 0),ua([Re],t.prototype,"postConstruct",null),ua([Mr],t.prototype,"removeDragSource",null),t}(Ue),Gp=function(o){function t(e,r,i){var n=o.call(this)||this;return n.parent=e,n.rowNode=r,n.column=i,n}return la(t,o),t.prototype.setDisplayedOrVisible=function(e){var r={skipAriaHidden:!0};if(e)this.parent.setDisplayed(!1,r);else{var i=!0,n=!1;this.column&&(i=this.column.isRowDrag(this.rowNode)||this.parent.isCustomGui(),n=si(this.column.getColDef().rowDrag)),n?(this.parent.setDisplayed(!0,r),this.parent.setVisible(i,r)):(this.parent.setDisplayed(i,r),this.parent.setVisible(!0,r))}},t}(we),Hp=function(o){function t(e,r,i,n){var u=o.call(this,e,i,n)||this;return u.beans=r,u}return la(t,o),t.prototype.postConstruct=function(){this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.addManagedListener(this.rowNode,wt.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,wt.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,wt.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,I.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.workOutVisibility()},t.prototype.onSuppressRowDrag=function(){this.workOutVisibility()},t.prototype.workOutVisibility=function(){var e=this.beans.gridOptionsService.is("suppressRowDrag");this.setDisplayedOrVisible(e)},ua([Re],t.prototype,"postConstruct",null),t}(Gp),Dv=function(o){function t(e,r,i,n){var u=o.call(this,e,i,n)||this;return u.beans=r,u}return la(t,o),t.prototype.postConstruct=function(){this.addManagedListener(this.beans.eventService,I.EVENT_SORT_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,I.EVENT_FILTER_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,I.EVENT_COLUMN_ROW_GROUP_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,I.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,wt.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,wt.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.workOutVisibility()},t.prototype.onSuppressRowDrag=function(){this.workOutVisibility()},t.prototype.workOutVisibility=function(){var r=this.beans.ctrlsService.getGridBodyCtrl().getRowDragFeature(),i=r&&r.shouldPreventRowMove(),n=this.beans.gridOptionsService.is("suppressRowDrag"),u=this.beans.dragAndDropService.hasExternalDropZones(),c=i&&!u||n;this.setDisplayedOrVisible(c)},ua([Re],t.prototype,"postConstruct",null),t}(Gp),Bp=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ml=function(){return Ml=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},Ml.apply(this,arguments)},Cs=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Vp=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return Bp(t,o),t.prototype.init=function(e,r,i,n,u,c,v){this.params=v,this.eGui=r,this.eCheckbox=i,this.eExpanded=n,this.eContracted=u,this.comp=e,this.compClass=c;var m=this.isTopLevelFooter(),C=this.isEmbeddedRowMismatch(),_=null==v.value&&!v.node.master,O=!1;if(this.gridOptionsService.is("groupIncludeFooter")&&this.gridOptionsService.is("groupHideOpenParents")){var P=v.node;if(P.footer)O=(v.colDef&&v.colDef.showRowGroup)!==(P.rowGroupColumn&&P.rowGroupColumn.getColId())}this.cellIsBlank=!m&&(C||_&&!v.node.master||O),!this.cellIsBlank&&(this.setupShowingValueForOpenedParent(),this.findDisplayedGroupNode(),this.addFullWidthRowDraggerIfNeeded(),this.addExpandAndContract(),this.addCheckboxIfNeeded(),this.addValueElement(),this.setupIndent(),this.refreshAriaExpanded())},t.prototype.destroy=function(){o.prototype.destroy.call(this),this.expandListener=null},t.prototype.refreshAriaExpanded=function(){var e=this.params,r=e.node,i=e.eParentOfValue;if(this.expandListener&&(this.expandListener=this.expandListener()),this.isExpandable()){var n=function(){zi(i,!!r.expanded)};this.expandListener=this.addManagedListener(r,wt.EVENT_EXPANDED_CHANGED,n)||null,n()}else vl(i)},t.prototype.isTopLevelFooter=function(){if(!this.gridOptionsService.is("groupIncludeTotalFooter")||null!=this.params.value||-1!=this.params.node.level)return!1;var e=this.params.colDef;if(null==e||!0===e.showRowGroup)return!0;var i=this.columnModel.getRowGroupColumns();return!i||0===i.length||i[0].getId()===e.showRowGroup},t.prototype.isEmbeddedRowMismatch=function(){if(!this.params.fullWidth||!this.gridOptionsService.is("embedFullWidthRows"))return!1;var e="left"===this.params.pinned,r="right"===this.params.pinned,i=!e&&!r;return this.gridOptionsService.is("enableRtl")?this.columnModel.isPinningLeft()?!r:!i:this.columnModel.isPinningLeft()?!e:!i},t.prototype.findDisplayedGroupNode=function(){var e=this.params.column,r=this.params.node;if(this.showingValueForOpenedParent)for(var i=r.parent;null!=i;){if(i.rowGroupColumn&&e.isRowGroupDisplayed(i.rowGroupColumn.getId())){this.displayedGroupNode=i;break}i=i.parent}Je(this.displayedGroupNode)&&(this.displayedGroupNode=r)},t.prototype.setupShowingValueForOpenedParent=function(){var e=this.params.node,r=this.params.column;if(this.gridOptionsService.is("groupHideOpenParents"))if(e.groupData){if(null!=e.rowGroupColumn){var n=e.rowGroupColumn.getId();if(r.isRowGroupDisplayed(n))return void(this.showingValueForOpenedParent=!1)}var c=null!=e.groupData[r.getId()];this.showingValueForOpenedParent=c}else this.showingValueForOpenedParent=!1;else this.showingValueForOpenedParent=!1},t.prototype.addValueElement=function(){this.displayedGroupNode.footer?this.addFooterValue():(this.addGroupValue(),this.addChildCount())},t.prototype.addGroupValue=function(){var e=this.adjustParamsWithDetailsFromRelatedColumn(),r=this.getInnerCompDetails(e),i=e.valueFormatted,n=e.value,u=i;if(null==u)if(""===n&&this.params.node.group){u=this.localeService.getLocaleTextFunc()("blanks","(Blanks)")}else u=n??null;this.comp.setInnerRenderer(r,u)},t.prototype.adjustParamsWithDetailsFromRelatedColumn=function(){var e=this.displayedGroupNode.rowGroupColumn,r=this.params.column;if(!e)return this.params;if(null!=r&&!r.isRowGroupDisplayed(e.getId()))return this.params;var u=this.params,c=this.params,v=c.value,m=c.node,C=this.valueFormatterService.formatValue(e,m,v);return Ml(Ml({},u),{valueFormatted:C})},t.prototype.addFooterValue=function(){var e=this.params.footerValueGetter,r="";if(e){var i=Tf(this.params);i.value=this.params.value,"function"==typeof e?r=e(i):"string"==typeof e?r=this.expressionService.evaluate(e,i):console.warn("AG Grid: footerValueGetter should be either a function or a string (expression)")}else r="Total "+(null!=this.params.value?this.params.value:"");var n=this.getInnerCompDetails(this.params);this.comp.setInnerRenderer(n,r)},t.prototype.getInnerCompDetails=function(e){var r=this;if(e.fullWidth)return this.userComponentFactory.getFullWidthGroupRowInnerCellRenderer(this.gridOptionsService.get("groupRowRendererParams"),e);var i=this.userComponentFactory.getInnerRendererDetails(e,e),n=function(C){return C&&C.componentClass==r.compClass};if(i&&!n(i))return i;var u=this.displayedGroupNode.rowGroupColumn,c=u?u.getColDef():void 0;if(c){var v=this.userComponentFactory.getCellRendererDetails(c,e);if(v&&!n(v))return v;if(n(v)&&c.cellRendererParams&&c.cellRendererParams.innerRenderer)return this.userComponentFactory.getInnerRendererDetails(c.cellRendererParams,e)}},t.prototype.addChildCount=function(){this.params.suppressCount||(this.addManagedListener(this.displayedGroupNode,wt.EVENT_ALL_CHILDREN_COUNT_CHANGED,this.updateChildCount.bind(this)),this.updateChildCount())},t.prototype.updateChildCount=function(){var e=this.displayedGroupNode.allChildrenCount,n=this.isShowRowGroupForThisRow()&&null!=e&&e>=0?"("+e+")":"";this.comp.setChildCount(n)},t.prototype.isShowRowGroupForThisRow=function(){if(this.gridOptionsService.isTreeData())return!0;var e=this.displayedGroupNode.rowGroupColumn;if(!e)return!1;var r=this.params.column;return null==r||r.isRowGroupDisplayed(e.getId())},t.prototype.addExpandAndContract=function(){var e,r=this.params,i=pr("groupExpanded",this.gridOptionsService,null),n=pr("groupContracted",this.gridOptionsService,null);i&&this.eExpanded.appendChild(i),n&&this.eContracted.appendChild(n);var u=r.eGridCell;!((null===(e=this.params.column)||void 0===e?void 0:e.isCellEditable(r.node))&&this.gridOptionsService.is("enableGroupEdit"))&&this.isExpandable()&&!r.suppressDoubleClickExpand&&this.addManagedListener(u,"dblclick",this.onCellDblClicked.bind(this)),this.addManagedListener(this.eExpanded,"click",this.onExpandClicked.bind(this)),this.addManagedListener(this.eContracted,"click",this.onExpandClicked.bind(this)),this.addManagedListener(u,"keydown",this.onKeyDown.bind(this)),this.addManagedListener(r.node,wt.EVENT_EXPANDED_CHANGED,this.showExpandAndContractIcons.bind(this)),this.showExpandAndContractIcons();var v=this.onRowNodeIsExpandableChanged.bind(this);this.addManagedListener(this.displayedGroupNode,wt.EVENT_ALL_CHILDREN_COUNT_CHANGED,v),this.addManagedListener(this.displayedGroupNode,wt.EVENT_MASTER_CHANGED,v),this.addManagedListener(this.displayedGroupNode,wt.EVENT_GROUP_CHANGED,v),this.addManagedListener(this.displayedGroupNode,wt.EVENT_HAS_CHILDREN_CHANGED,v)},t.prototype.onExpandClicked=function(e){tn(e)||(Qo(e),this.onExpandOrContract(e))},t.prototype.onExpandOrContract=function(e){var r=this.displayedGroupNode,i=!r.expanded;!i&&r.sticky&&this.scrollToStickyNode(r),r.setExpanded(i,e)},t.prototype.scrollToStickyNode=function(e){this.ctrlsService.getGridBodyCtrl().getScrollFeature().setVerticalScrollPosition(e.rowTop-e.stickyRowTop)},t.prototype.isExpandable=function(){if(this.showingValueForOpenedParent)return!0;var e=this.displayedGroupNode,r=this.columnModel.isPivotMode()&&e.leafGroup;if(!(e.isExpandable()&&!e.footer&&!r))return!1;var n=this.params.column;return null==n||"string"!=typeof n.getColDef().showRowGroup||this.isShowRowGroupForThisRow()},t.prototype.showExpandAndContractIcons=function(){var e=this,r=e.params,i=e.displayedGroupNode,n=e.columnModel,u=r.node,c=this.isExpandable();if(c){var v=!!this.showingValueForOpenedParent||u.expanded;this.comp.setExpandedDisplayed(v),this.comp.setContractedDisplayed(!v)}else this.comp.setExpandedDisplayed(!1),this.comp.setContractedDisplayed(!1);var m=n.isPivotMode(),C=m&&i.leafGroup,_=c&&!C,O=u.footer&&-1===u.level;this.comp.addOrRemoveCssClass("ag-cell-expandable",_),this.comp.addOrRemoveCssClass("ag-row-group",_),m?this.comp.addOrRemoveCssClass("ag-pivot-leaf-group",C):O||this.comp.addOrRemoveCssClass("ag-row-group-leaf-indent",!_)},t.prototype.onRowNodeIsExpandableChanged=function(){this.showExpandAndContractIcons(),this.setIndent(),this.refreshAriaExpanded()},t.prototype.setupIndent=function(){var e=this.params.node;this.params.suppressPadding||(this.addManagedListener(e,wt.EVENT_UI_LEVEL_CHANGED,this.setIndent.bind(this)),this.setIndent())},t.prototype.setIndent=function(){if(!this.gridOptionsService.is("groupHideOpenParents")){var e=this.params,r=e.node,i=!!e.colDef,n=this.gridOptionsService.isTreeData(),c=!i||n||!0===e.colDef.showRowGroup?r.uiLevel:0;this.indentClass&&this.comp.addOrRemoveCssClass(this.indentClass,!1),this.indentClass="ag-row-group-indent-"+c,this.comp.addOrRemoveCssClass(this.indentClass,!0)}},t.prototype.addFullWidthRowDraggerIfNeeded=function(){var e=this;if(this.params.fullWidth&&this.params.rowDrag){var r=new Ll(function(){return e.params.value},this.params.node);this.createManagedBean(r,this.context),this.eGui.insertAdjacentElement("afterbegin",r.getGui())}},t.prototype.isUserWantsSelected=function(){var e=this.params.checkbox;return"function"==typeof e||!0===e},t.prototype.addCheckboxIfNeeded=function(){var e=this,r=this.displayedGroupNode,i=this.isUserWantsSelected()&&!r.footer&&!r.rowPinned&&!r.detail;if(i){var n=new kp;this.getContext().createBean(n),n.init({rowNode:r,column:this.params.column,overrides:{isVisible:this.params.checkbox,callbackParams:this.params,removeHidden:!0}}),this.eCheckbox.appendChild(n.getGui()),this.addDestroyFunc(function(){return e.getContext().destroyBean(n)})}this.comp.setCheckboxVisible(i)},t.prototype.onKeyDown=function(e){e.key!==ve.ENTER||this.params.suppressEnterExpand||(this.params.column&&this.params.column.isCellEditable(this.params.node)||this.onExpandOrContract(e))},t.prototype.onCellDblClicked=function(e){tn(e)||(ul(this.eExpanded,e)||ul(this.eContracted,e)||this.onExpandOrContract(e))},Cs([D("expressionService")],t.prototype,"expressionService",void 0),Cs([D("valueFormatterService")],t.prototype,"valueFormatterService",void 0),Cs([D("columnModel")],t.prototype,"columnModel",void 0),Cs([D("userComponentFactory")],t.prototype,"userComponentFactory",void 0),Cs([D("ctrlsService")],t.prototype,"ctrlsService",void 0),t}(we),bv=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ca=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Wp=function(o){function t(){return o.call(this,t.TEMPLATE)||this}return bv(t,o),t.prototype.init=function(e){var r=this,i={setInnerRenderer:function(v,m){return r.setRenderDetails(v,m)},setChildCount:function(v){return r.eChildCount.innerHTML=v},addOrRemoveCssClass:function(v,m){return r.addOrRemoveCssClass(v,m)},setContractedDisplayed:function(v){return Ze(r.eContracted,v)},setExpandedDisplayed:function(v){return Ze(r.eExpanded,v)},setCheckboxVisible:function(v){return r.eCheckbox.classList.toggle("ag-invisible",!v)}},n=this.createManagedBean(new Vp),u=!e.colDef,c=this.getGui();n.init(i,c,this.eCheckbox,this.eExpanded,this.eContracted,this.constructor,e),u&&vt(c,"gridcell")},t.prototype.setRenderDetails=function(e,r){var i=this;if(e){var n=e.newAgStackInstance();if(!n)return;n.then(function(u){if(u){var c=function(){return i.context.destroyBean(u)};i.isAlive()?(i.eValue.appendChild(u.getGui()),i.addDestroyFunc(c)):c()}})}else this.eValue.innerText=r},t.prototype.destroy=function(){this.getContext().destroyBean(this.innerCellRenderer),o.prototype.destroy.call(this)},t.prototype.refresh=function(){return!1},t.TEMPLATE='<span class="ag-cell-wrapper">\n            <span class="ag-group-expanded" ref="eExpanded"></span>\n            <span class="ag-group-contracted" ref="eContracted"></span>\n            <span class="ag-group-checkbox ag-invisible" ref="eCheckbox"></span>\n            <span class="ag-group-value" ref="eValue"></span>\n            <span class="ag-group-child-count" ref="eChildCount"></span>\n        </span>',ca([Te("eExpanded")],t.prototype,"eExpanded",void 0),ca([Te("eContracted")],t.prototype,"eContracted",void 0),ca([Te("eCheckbox")],t.prototype,"eCheckbox",void 0),ca([Te("eValue")],t.prototype,"eValue",void 0),ca([Te("eChildCount")],t.prototype,"eChildCount",void 0),t}(Ue),Up=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),jp=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Fv=function(o){function t(){return o.call(this,t.TEMPLATE)||this}return Up(t,o),t.prototype.init=function(e){e.node.failedLoad?this.setupFailed():this.setupLoading()},t.prototype.setupFailed=function(){var e=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=e("loadingError","ERR")},t.prototype.setupLoading=function(){var e=pr("groupLoading",this.gridOptionsService,null);e&&this.eLoadingIcon.appendChild(e);var r=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=r("loadingOoo","Loading")},t.prototype.refresh=function(e){return!1},t.prototype.destroy=function(){o.prototype.destroy.call(this)},t.TEMPLATE='<div class="ag-loading">\n            <span class="ag-loading-icon" ref="eLoadingIcon"></span>\n            <span class="ag-loading-text" ref="eLoadingText"></span>\n        </div>',jp([Te("eLoadingIcon")],t.prototype,"eLoadingIcon",void 0),jp([Te("eLoadingText")],t.prototype,"eLoadingText",void 0),t}(Ue),Pv=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Iv=function(o){function t(){return o.call(this)||this}return Pv(t,o),t.prototype.destroy=function(){o.prototype.destroy.call(this)},t.prototype.init=function(e){var r,i=null!==(r=this.gridOptionsService.get("overlayLoadingTemplate"))&&void 0!==r?r:t.DEFAULT_LOADING_OVERLAY_TEMPLATE,n=this.localeService.getLocaleTextFunc(),u=i.replace("[LOADING...]",n("loadingOoo","Loading..."));this.setTemplate(u)},t.DEFAULT_LOADING_OVERLAY_TEMPLATE='<span class="ag-overlay-loading-center">[LOADING...]</span>',t}(Ue),Lv=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Mv=function(o){function t(){return o.call(this)||this}return Lv(t,o),t.prototype.destroy=function(){o.prototype.destroy.call(this)},t.prototype.init=function(e){var r,i=null!==(r=this.gridOptionsService.get("overlayNoRowsTemplate"))&&void 0!==r?r:t.DEFAULT_NO_ROWS_TEMPLATE,n=this.localeService.getLocaleTextFunc(),u=i.replace("[NO_ROWS_TO_SHOW]",n("noRowsToShow","No Rows To Show"));this.setTemplate(u)},t.DEFAULT_NO_ROWS_TEMPLATE='<span class="ag-overlay-no-rows-center">[NO_ROWS_TO_SHOW]</span>',t}(Ue),Nv=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),kv=function(o){function t(){return o.call(this,'<div class="ag-tooltip"></div>')||this}return Nv(t,o),t.prototype.init=function(e){var r=e.value;this.getGui().innerHTML=Wi(r)},t}(sa),Gv=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ec=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Hv=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},Vv=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.agGridDefaults={agDateInput:iv,agColumnHeader:uv,agColumnGroupHeader:fv,agSortIndicator:ms,agTextColumnFloatingFilter:av,agNumberColumnFloatingFilter:Pp,agDateColumnFloatingFilter:Ap,agReadOnlyFloatingFilter:Gn,agAnimateShowChangeCellRenderer:xv,agAnimateSlideCellRenderer:Tv,agGroupCellRenderer:Wp,agGroupRowRenderer:Wp,agLoadingCellRenderer:Fv,agCellEditor:Mp,agTextCellEditor:Mp,agSelectCellEditor:Lp,agLargeTextCellEditor:vv,agTextColumnFilter:mc,agNumberColumnFilter:$i,agDateColumnFilter:Op,agLoadingOverlay:Iv,agNoRowsOverlay:Mv,agTooltipComponent:kv},e.enterpriseAgDefaultCompsModule={agSetColumnFilter:Ne.SetFilterModule,agSetColumnFloatingFilter:Ne.SetFilterModule,agMultiColumnFilter:Ne.MultiFilterModule,agMultiColumnFloatingFilter:Ne.MultiFilterModule,agGroupColumnFilter:Ne.RowGroupingModule,agGroupColumnFloatingFilter:Ne.RowGroupingModule,agRichSelect:Ne.RichSelectModule,agRichSelectCellEditor:Ne.RichSelectModule,agDetailCellRenderer:Ne.MasterDetailModule,agSparklineCellRenderer:Ne.SparklinesModule},e.deprecatedAgGridDefaults={agPopupTextCellEditor:'AG Grid: Since v27.1 The agPopupTextCellEditor is deprecated. Instead use { cellEditor: "agTextCellEditor", cellEditorPopup: true }',agPopupSelectCellEditor:'AG Grid: Since v27.1 the agPopupSelectCellEditor is deprecated. Instead use { cellEditor: "agSelectCellEditor", cellEditorPopup: true }'},e.jsComps={},e.fwComps={},e}return Gv(t,o),t.prototype.init=function(){var e=this;null!=this.gridOptions.components&&Xe(this.gridOptions.components,function(r,i){return e.registerJsComponent(r,i)}),null!=this.gridOptions.frameworkComponents&&Xe(this.gridOptions.frameworkComponents,function(r,i){return e.registerFwComponent(r,i)})},t.prototype.registerDefaultComponent=function(e,r){this.agGridDefaults[e]?console.error("Trying to overwrite a default component. You should call registerComponent"):this.agGridDefaults[e]=r},t.prototype.registerJsComponent=function(e,r){this.fwComps[e]?console.error("Trying to register a component that you have already registered for frameworks: "+e):this.jsComps[e]=r},t.prototype.registerFwComponent=function(e,r){_t(function(){return console.warn("AG Grid: As of v27, registering components via grid property frameworkComponents is deprecated. Instead register both JavaScript AND Framework Components via the components property.")},"UserComponentRegistry.frameworkComponentsDeprecated"),this.fwComps[e]=r},t.prototype.retrieve=function(e,r){var i=this,n=function(O,P){return{componentFromFramework:P,component:O}},u=this.getFrameworkOverrides().frameworkComponent(r,this.gridOptions.components);if(null!=u)return n(u,!0);var c=this.fwComps[r];if(c)return n(c,!0);var v=this.jsComps[r];if(v)return n(v,this.getFrameworkOverrides().isFrameworkComponent(v));var C=this.agGridDefaults[r];if(C)return n(C,!1);var _=this.enterpriseAgDefaultCompsModule[r];return _?it.assertRegistered(_,"AG Grid '"+e+"' component: "+r):this.deprecatedAgGridDefaults[r]?_t(function(){return console.warn(i.deprecatedAgGridDefaults[r])},r):_t(function(){i.warnAboutMissingComponent(e,r)},"MissingComp"+r),null},t.prototype.warnAboutMissingComponent=function(e,r){var i=function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(Hv(arguments[t]));return o}(Object.keys(this.agGridDefaults).filter(function(u){return!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(u)}),Object.keys(this.jsComps),Object.keys(this.fwComps)),n=pl(r,i,!0,.8);console.warn("AG Grid: Could not find '"+r+"' component. It was configured as \""+e+": '"+r+"'\" but it wasn't found in the list of registered components."),n.length>0&&console.warn("         Did you mean: ["+n.slice(0,3)+"]?"),console.warn("If using a custom component check it has been registered as described in: https://ag-grid.com/javascript-data-grid/components/")},Ec([D("gridOptions")],t.prototype,"gridOptions",void 0),Ec([Re],t.prototype,"init",null),t=Ec([He("userComponentRegistry")],t)}(we),Wv={propertyName:"dateComponent",cellRenderer:!1},Uv={propertyName:"headerComponent",cellRenderer:!1},jv={propertyName:"headerGroupComponent",cellRenderer:!1},zp={propertyName:"cellRenderer",cellRenderer:!0},zv={propertyName:"cellEditor",cellRenderer:!1},Rc={propertyName:"innerRenderer",cellRenderer:!0},Kv={propertyName:"loadingOverlayComponent",cellRenderer:!1},$v={propertyName:"noRowsOverlayComponent",cellRenderer:!1},Yv={propertyName:"tooltipComponent",cellRenderer:!1},Tc={propertyName:"filter",cellRenderer:!1},Xv={propertyName:"floatingFilterComponent",cellRenderer:!1},qv={propertyName:"toolPanel",cellRenderer:!1},Qv={propertyName:"statusPanel",cellRenderer:!1},Jv={propertyName:"fullWidthCellRenderer",cellRenderer:!0},Zv={propertyName:"loadingCellRenderer",cellRenderer:!0},eg={propertyName:"groupRowRenderer",cellRenderer:!0},tg={propertyName:"detailCellRenderer",cellRenderer:!0},rg=function(){function o(){}return o.getFloatingFilterType=function(t){return this.filterToFloatingFilterMapping[t]},o.filterToFloatingFilterMapping={set:"agSetColumnFloatingFilter",agSetColumnFilter:"agSetColumnFloatingFilter",multi:"agMultiColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",group:"agGroupColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",number:"agNumberColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",date:"agDateColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",text:"agTextColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"},o}(),ig=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ws=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},ng=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return ig(t,o),t.prototype.getHeaderCompDetails=function(e,r){return this.getCompDetails(e,Uv,"agColumnHeader",r)},t.prototype.getHeaderGroupCompDetails=function(e){var r=e.columnGroup.getColGroupDef();return this.getCompDetails(r,jv,"agColumnGroupHeader",e)},t.prototype.getFullWidthCellRendererDetails=function(e){return this.getCompDetails(this.gridOptions,Jv,null,e,!0)},t.prototype.getFullWidthLoadingCellRendererDetails=function(e){return this.getCompDetails(this.gridOptions,Zv,"agLoadingCellRenderer",e,!0)},t.prototype.getFullWidthGroupCellRendererDetails=function(e){return this.getCompDetails(this.gridOptions,eg,"agGroupRowRenderer",e,!0)},t.prototype.getFullWidthDetailCellRendererDetails=function(e){return this.getCompDetails(this.gridOptions,tg,"agDetailCellRenderer",e,!0)},t.prototype.getInnerRendererDetails=function(e,r){return this.getCompDetails(e,Rc,null,r)},t.prototype.getFullWidthGroupRowInnerCellRenderer=function(e,r){return this.getCompDetails(e,Rc,null,r)},t.prototype.getCellRendererDetails=function(e,r){return this.getCompDetails(e,zp,null,r)},t.prototype.getCellEditorDetails=function(e,r){return this.getCompDetails(e,zv,"agCellEditor",r,!0)},t.prototype.getFilterDetails=function(e,r,i){return this.getCompDetails(e,Tc,i,r,!0)},t.prototype.getDateCompDetails=function(e){return this.getCompDetails(this.gridOptions,Wv,"agDateInput",e,!0)},t.prototype.getLoadingOverlayCompDetails=function(e){return this.getCompDetails(this.gridOptions,Kv,"agLoadingOverlay",e,!0)},t.prototype.getNoRowsOverlayCompDetails=function(e){return this.getCompDetails(this.gridOptions,$v,"agNoRowsOverlay",e,!0)},t.prototype.getTooltipCompDetails=function(e){return this.getCompDetails(e.colDef,Yv,"agTooltipComponent",e,!0)},t.prototype.getSetFilterCellRendererDetails=function(e,r){return this.getCompDetails(e,zp,null,r)},t.prototype.getFloatingFilterCompDetails=function(e,r,i){return this.getCompDetails(e,Xv,i,r)},t.prototype.getToolPanelCompDetails=function(e,r){return this.getCompDetails(e,qv,null,r,!0)},t.prototype.getStatusPanelCompDetails=function(e,r){return this.getCompDetails(e,Qv,null,r,!0)},t.prototype.getCompDetails=function(e,r,i,n,u){var c=this;void 0===u&&(u=!1);var v=r.propertyName,m=r.cellRenderer,C=this.getCompKeys(e,r,n),_=C.compName,O=C.jsComp,P=C.fwComp,L=C.paramsFromSelector,z=C.popupFromSelector,q=C.popupPositionFromSelector,Z=function(be){var qe=c.userComponentRegistry.retrieve(v,be);qe&&(O=qe.componentFromFramework?void 0:qe.component,P=qe.componentFromFramework?qe.component:void 0)};if(null!=_&&Z(_),null==O&&null==P&&null!=i&&Z(i),O&&m&&!this.agComponentUtils.doesImplementIComponent(O)&&(O=this.agComponentUtils.adaptFunction(v,O)),O||P){var re=this.mergeParamsWithApplicationProvidedParams(e,r,n,L),pe=null==O,Ce=O||P;return{componentFromFramework:pe,componentClass:Ce,params:re,type:r,popupFromSelector:z,popupPositionFromSelector:q,newAgStackInstance:function(){return c.newAgStackInstance(Ce,pe,re,r)}}}u&&console.error("AG Grid: Could not find component "+_+", did you forget to configure this component?")},t.prototype.getCompKeys=function(e,r,i){var c,v,m,C,_,O,n=this,u=r.propertyName;if(e){var P=e,L=P[u+"Selector"],z=L?L(i):null,q=function(re,pe){var Ce=function(){var qe="AG Grid: As of v27, the property "+u+"Framework is deprecated. The property "+u+" can now be used for JavaScript AND Framework Components.";_t(function(){return console.warn(qe)},"UserComponentFactory."+u+"FrameworkDeprecated")};if("string"==typeof re)c=re;else if("string"==typeof pe)Ce(),c=pe;else if(null!=re&&!0!==re){n.getFrameworkOverrides().isFrameworkComponent(re)?m=re:v=re}else null!=pe&&(Ce(),m=pe)};if(z){if(null!=z.frameworkComponent){var Z="AG Grid: As of v27, the return for "+u+"Selector has attributes [component, params] only. The attribute frameworkComponent is deprecated. You should now return back Framework Components using the 'component' attribute and the grid works out if it's a framework component or not.";_t(function(){return console.warn(Z)},"UserComponentFactory."+u+"FrameworkSelectorDeprecated"),q(z.frameworkComponent,void 0)}else q(z.component,void 0);C=z.params,_=z.popup,O=z.popupPosition}else q(P[u],P[u+"Framework"])}return{compName:c,jsComp:v,fwComp:m,paramsFromSelector:C,popupFromSelector:_,popupPositionFromSelector:O}},t.prototype.newAgStackInstance=function(e,r,i,n){var v,u=n.propertyName;if(!r)v=new e;else{var m=this.componentMetadataProvider.retrieve(u);v=this.frameworkComponentWrapper.wrap(e,m.mandatoryMethodList,m.optionalMethodList,n)}var C=this.initComponent(v,i);return null==C?ir.resolve(v):C.then(function(){return v})},t.prototype.mergeParamsWithApplicationProvidedParams=function(e,r,i,n){void 0===n&&(n=null);var u={context:this.gridOptionsService.context,columnApi:this.gridOptionsService.columnApi,api:this.gridOptionsService.api};Qr(u,i);var v=e&&e[r.propertyName+"Params"];"function"==typeof v?Qr(u,v(i)):"object"==typeof v&&Qr(u,v);return Qr(u,n),u},t.prototype.initComponent=function(e,r){if(this.context.createBean(e),null!=e.init)return e.init(r)},t.prototype.getDefaultFloatingFilterType=function(e){if(null==e)return null;var r=null,i=this.getCompKeys(e,Tc),n=i.compName,u=i.jsComp,c=i.fwComp;n?r=rg.getFloatingFilterType(n):null==u&&null==c&&!0===e.filter&&(r=it.isRegistered(Ne.SetFilterModule)?"agSetColumnFloatingFilter":"agTextColumnFloatingFilter");return r},ws([D("gridOptions")],t.prototype,"gridOptions",void 0),ws([D("agComponentUtils")],t.prototype,"agComponentUtils",void 0),ws([D("componentMetadataProvider")],t.prototype,"componentMetadataProvider",void 0),ws([D("userComponentRegistry")],t.prototype,"userComponentRegistry",void 0),ws([Ft("frameworkComponentWrapper")],t.prototype,"frameworkComponentWrapper",void 0),t=ws([He("userComponentFactory")],t)}(we);!function(o){o[o.SINGLE_SHEET=0]="SINGLE_SHEET",o[o.MULTI_SHEET=1]="MULTI_SHEET"}(Nl||(Nl={}));var hn,bt,og=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),fa=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Kp=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.dragEndFunctions=[],e.dragSources=[],e}return og(t,o),t.prototype.removeAllListeners=function(){this.dragSources.forEach(this.removeListener.bind(this)),this.dragSources.length=0},t.prototype.removeListener=function(e){var r=e.dragSource.eElement,i=e.mouseDownListener;if(r.removeEventListener("mousedown",i),e.touchEnabled){var n=e.touchStartListener;r.removeEventListener("touchstart",n,{passive:!0})}},t.prototype.removeDragSource=function(e){var r=this.dragSources.find(function(i){return i.dragSource===e});r&&(this.removeListener(r),Nr(this.dragSources,r))},t.prototype.isDragging=function(){return this.dragging},t.prototype.addDragSource=function(e,r){var i=this;void 0===r&&(r=!1);var n=this.onMouseDown.bind(this,e);e.eElement.addEventListener("mousedown",n);var u=null,c=this.gridOptionsService.is("suppressTouch");r&&!c&&(u=function(v){Xu(v.target)||(v.cancelable&&(v.preventDefault(),v.stopPropagation()),i.onTouchStart(e,v))},e.eElement.addEventListener("touchstart",u,{passive:!1})),this.dragSources.push({dragSource:e,mouseDownListener:n,touchStartListener:u,touchEnabled:r})},t.prototype.getStartTarget=function(){return this.startTarget},t.prototype.onTouchStart=function(e,r){var i=this;this.currentDragParams=e,this.dragging=!1;var n=r.touches[0];this.touchLastTime=n,this.touchStart=n;var c=function(_){return i.onTouchUp(_,e.eElement)},m=r.target,C=[{target:this.gridOptionsService.getRootNode(),type:"touchmove",listener:function(_){_.cancelable&&_.preventDefault()},options:{passive:!1}},{target:m,type:"touchmove",listener:function(_){return i.onTouchMove(_,e.eElement)},options:{passive:!0}},{target:m,type:"touchend",listener:c,options:{passive:!0}},{target:m,type:"touchcancel",listener:c,options:{passive:!0}}];this.addTemporaryEvents(C),0===e.dragStartPixels&&this.onCommonMove(n,this.touchStart,e.eElement)},t.prototype.onMouseDown=function(e,r){var i=this,n=r;if(!(e.skipMouseEvent&&e.skipMouseEvent(r)||n._alreadyProcessedByDragService||(n._alreadyProcessedByDragService=!0,0!==r.button))){this.currentDragParams=e,this.dragging=!1,this.mouseStartEvent=r,this.startTarget=r.target;var m=this.gridOptionsService.getRootNode(),C=[{target:m,type:"mousemove",listener:function(_){return i.onMouseMove(_,e.eElement)}},{target:m,type:"mouseup",listener:function(_){return i.onMouseUp(_,e.eElement)}},{target:m,type:"contextmenu",listener:function(_){return _.preventDefault()}}];this.addTemporaryEvents(C),0===e.dragStartPixels&&this.onMouseMove(r,e.eElement)}},t.prototype.addTemporaryEvents=function(e){e.forEach(function(r){var i=r.target,n=r.type,u=r.listener,c=r.options;i.addEventListener(n,u,c)}),this.dragEndFunctions.push(function(){e.forEach(function(r){var i=r.target,n=r.type,u=r.listener,c=r.options;i.removeEventListener(n,u,c)})})},t.prototype.isEventNearStartEvent=function(e,r){var i=this.currentDragParams.dragStartPixels;return ec(e,r,me(i)?i:4)},t.prototype.getFirstActiveTouch=function(e){for(var r=0;r<e.length;r++)if(e[r].identifier===this.touchStart.identifier)return e[r];return null},t.prototype.onCommonMove=function(e,r,i){if(!this.dragging){if(!this.dragging&&this.isEventNearStartEvent(e,r))return;this.dragging=!0;var n={type:I.EVENT_DRAG_STARTED,target:i};this.eventService.dispatchEvent(n),this.currentDragParams.onDragStart(r),this.currentDragParams.onDragging(r)}this.currentDragParams.onDragging(e)},t.prototype.onTouchMove=function(e,r){var i=this.getFirstActiveTouch(e.touches);i&&this.onCommonMove(i,this.touchStart,r)},t.prototype.onMouseMove=function(e,r){(this.gridOptionsService.is("enableCellTextSelection")||Fi())&&"mousemove"===e.type&&e.cancelable&&this.mouseEventService.isEventFromThisGrid(e)&&!this.isOverFormFieldElement(e)&&e.preventDefault(),this.onCommonMove(e,this.mouseStartEvent,r)},t.prototype.isOverFormFieldElement=function(e){var i=e.target?.tagName.toLocaleLowerCase();return!!i?.match("^a$|textarea|input|select|button")},t.prototype.onTouchUp=function(e,r){var i=this.getFirstActiveTouch(e.changedTouches);i||(i=this.touchLastTime),this.onUpCommon(i,r)},t.prototype.onMouseUp=function(e,r){this.onUpCommon(e,r)},t.prototype.onUpCommon=function(e,r){if(this.dragging){this.dragging=!1,this.currentDragParams.onDragStop(e);var i={type:I.EVENT_DRAG_STOPPED,target:r};this.eventService.dispatchEvent(i)}this.mouseStartEvent=null,this.startTarget=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null,this.dragEndFunctions.forEach(function(n){return n()}),this.dragEndFunctions.length=0},fa([D("mouseEventService")],t.prototype,"mouseEventService",void 0),fa([Mr],t.prototype,"removeAllListeners",null),t=fa([He("dragService")],t)}(we);!function(o){o[o.Above=0]="Above",o[o.Below=1]="Below"}(hn||(hn={})),function(o){o.EVERYTHING="group",o.FILTER="filter",o.SORT="sort",o.MAP="map",o.AGGREGATE="aggregate",o.FILTER_AGGREGATES="filter_aggregates",o.PIVOT="pivot",o.NOTHING="nothing"}(bt||(bt={}));var xt=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n};function Io(o){var t=o;return null!=t&&null!=t.getFrameworkComponentInstance?t.getFrameworkComponentInstance():o}var yr,Lo=function(){function o(){this.detailGridInfoMap={},this.destroyCalled=!1}return o.prototype.registerOverlayWrapperComp=function(t){this.overlayWrapperComp=t},o.prototype.registerSideBarComp=function(t){this.sideBarComp=t},o.prototype.init=function(){var t=this;switch(this.rowModel.getType()){case"clientSide":this.clientSideRowModel=this.rowModel;break;case"infinite":this.infiniteRowModel=this.rowModel;break;case"serverSide":this.serverSideRowModel=this.rowModel}this.ctrlsService.whenReady(function(){t.gridBodyCtrl=t.ctrlsService.getGridBodyCtrl()})},o.prototype.__getAlignedGridService=function(){return this.alignedGridsService},o.prototype.__getContext=function(){return this.context},o.prototype.getSetterMethod=function(t){return"set"+t.charAt(0).toUpperCase()+t.substring(1)},o.prototype.__setProperty=function(t,e){this.gridOptionsService.set(t,e);var r=this.getSetterMethod(t);this[r]&&this[r](e)},o.prototype.addDetailGridInfo=function(t,e){this.detailGridInfoMap[t]=e},o.prototype.removeDetailGridInfo=function(t){this.detailGridInfoMap[t]=void 0},o.prototype.getDetailGridInfo=function(t){return this.detailGridInfoMap[t]},o.prototype.forEachDetailGridInfo=function(t){var e=0;Xe(this.detailGridInfoMap,function(r,i){me(i)&&(t(i,e),e++)})},o.prototype.getDataAsCsv=function(t){if(it.assertRegistered(Ne.CsvExportModule,"api.getDataAsCsv"))return this.csvCreator.getDataAsCsv(t)},o.prototype.exportDataAsCsv=function(t){it.assertRegistered(Ne.CsvExportModule,"api.exportDataAsCSv")&&this.csvCreator.exportDataAsCsv(t)},o.prototype.getExcelExportMode=function(t){var e=this.gridOptionsService.get("defaultExcelExportParams");return Object.assign({exportMode:"xlsx"},e,t).exportMode},o.prototype.assertNotExcelMultiSheet=function(t,e){if(!it.assertRegistered(Ne.ExcelExportModule,"api."+t))return!1;var r=this.getExcelExportMode(e);return this.excelCreator.getFactoryMode(r)!==Nl.MULTI_SHEET||(console.warn("AG Grid: The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'"),!1)},o.prototype.getDataAsExcel=function(t){if(this.assertNotExcelMultiSheet("getDataAsExcel",t))return this.excelCreator.getDataAsExcel(t)},o.prototype.exportDataAsExcel=function(t){this.assertNotExcelMultiSheet("exportDataAsExcel",t)&&this.excelCreator.exportDataAsExcel(t)},o.prototype.getSheetDataForExcel=function(t){if(it.assertRegistered(Ne.ExcelExportModule,"api.getSheetDataForExcel")){var e=this.getExcelExportMode(t);return this.excelCreator.setFactoryMode(Nl.MULTI_SHEET,e),this.excelCreator.getSheetDataForExcel(t)}},o.prototype.getMultipleSheetsAsExcel=function(t){if(it.assertRegistered(Ne.ExcelExportModule,"api.getMultipleSheetsAsExcel"))return this.excelCreator.getMultipleSheetsAsExcel(t)},o.prototype.exportMultipleSheetsAsExcel=function(t){if(it.assertRegistered(Ne.ExcelExportModule,"api.exportMultipleSheetsAsExcel"))return this.excelCreator.exportMultipleSheetsAsExcel(t)},o.prototype.setGridAriaProperty=function(t,e){if(t){var r=this.ctrlsService.getGridBodyCtrl().getGui(),i="aria-"+t;null===e?r.removeAttribute(i):r.setAttribute(i,e)}},o.prototype.logMissingRowModel=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];console.error("AG Grid: api."+t+" can only be called when gridOptions.rowModelType is "+e.join(" or "))},o.prototype.setServerSideDatasource=function(t){this.serverSideRowModel?this.serverSideRowModel.setDatasource(t):this.logMissingRowModel("setServerSideDatasource","serverSide")},o.prototype.setCacheBlockSize=function(t){this.serverSideRowModel?(this.gridOptionsService.set("cacheBlockSize",t),this.serverSideRowModel.resetRootStore()):this.logMissingRowModel("setCacheBlockSize","serverSide")},o.prototype.setDatasource=function(t){this.gridOptionsService.isRowModelType("infinite")?this.rowModel.setDatasource(t):this.logMissingRowModel("setDatasource","infinite")},o.prototype.setViewportDatasource=function(t){this.gridOptionsService.isRowModelType("viewport")?this.rowModel.setViewportDatasource(t):this.logMissingRowModel("setViewportDatasource","viewport")},o.prototype.setRowData=function(t){null==this.immutableService?this.logMissingRowModel("setRowData","clientSide"):this.immutableService.isActive()?this.immutableService.setRowData(t):(this.selectionService.reset(),this.clientSideRowModel.setRowData(t))},o.prototype.setPinnedTopRowData=function(t){this.pinnedRowModel.setPinnedTopRowData(t)},o.prototype.setPinnedBottomRowData=function(t){this.pinnedRowModel.setPinnedBottomRowData(t)},o.prototype.getPinnedTopRowCount=function(){return this.pinnedRowModel.getPinnedTopRowCount()},o.prototype.getPinnedBottomRowCount=function(){return this.pinnedRowModel.getPinnedBottomRowCount()},o.prototype.getPinnedTopRow=function(t){return this.pinnedRowModel.getPinnedTopRow(t)},o.prototype.getPinnedBottomRow=function(t){return this.pinnedRowModel.getPinnedBottomRow(t)},o.prototype.setColumnDefs=function(t,e){void 0===e&&(e="api"),this.columnModel.setColumnDefs(t,e),this.gridOptionsService.set("columnDefs",t,!0,{source:e})},o.prototype.setAutoGroupColumnDef=function(t,e){void 0===e&&(e="api"),this.gridOptionsService.set("autoGroupColumnDef",t,!0,{source:e})},o.prototype.setDefaultColDef=function(t,e){void 0===e&&(e="api"),this.gridOptionsService.set("defaultColDef",t,!0,{source:e})},o.prototype.setColumnTypes=function(t,e){void 0===e&&(e="api"),this.gridOptionsService.set("columnTypes",t,!0,{source:e})},o.prototype.expireValueCache=function(){this.valueCache.expire()},o.prototype.getVerticalPixelRange=function(){return this.gridBodyCtrl.getScrollFeature().getVScrollPosition()},o.prototype.getHorizontalPixelRange=function(){return this.gridBodyCtrl.getScrollFeature().getHScrollPosition()},o.prototype.setAlwaysShowHorizontalScroll=function(t){this.gridOptionsService.set("alwaysShowHorizontalScroll",t)},o.prototype.setAlwaysShowVerticalScroll=function(t){this.gridOptionsService.set("alwaysShowVerticalScroll",t)},o.prototype.refreshCells=function(t){void 0===t&&(t={}),this.rowRenderer.refreshCells(t)},o.prototype.flashCells=function(t){void 0===t&&(t={}),this.rowRenderer.flashCells(t)},o.prototype.redrawRows=function(t){void 0===t&&(t={});var e=t?t.rowNodes:void 0;this.rowRenderer.redrawRows(e)},o.prototype.setFunctionsReadOnly=function(t){this.gridOptionsService.set("functionsReadOnly",t)},o.prototype.refreshHeader=function(){this.ctrlsService.getHeaderRowContainerCtrls().forEach(function(t){return t.refresh()})},o.prototype.isAnyFilterPresent=function(){return this.filterManager.isAnyFilterPresent()},o.prototype.isColumnFilterPresent=function(){return this.filterManager.isColumnFilterPresent()||this.filterManager.isAggregateFilterPresent()},o.prototype.isQuickFilterPresent=function(){return this.filterManager.isQuickFilterPresent()},o.prototype.getModel=function(){return this.rowModel},o.prototype.setRowNodeExpanded=function(t,e,r){t&&(r&&t.parent&&-1!==t.parent.level&&this.setRowNodeExpanded(t.parent,e,r),t.setExpanded(e))},o.prototype.onGroupExpandedOrCollapsed=function(){Je(this.clientSideRowModel)?this.logMissingRowModel("onGroupExpandedOrCollapsed","clientSide"):this.clientSideRowModel.refreshModel({step:bt.MAP})},o.prototype.refreshClientSideRowModel=function(t){Je(this.clientSideRowModel)?this.logMissingRowModel("refreshClientSideRowModel","clientSide"):this.clientSideRowModel.refreshModel(t)},o.prototype.isAnimationFrameQueueEmpty=function(){return this.animationFrameService.isQueueEmpty()},o.prototype.flushAllAnimationFrames=function(){this.animationFrameService.flushAllFrames()},o.prototype.getRowNode=function(t){return this.rowModel.getRowNode(t)},o.prototype.getSizesForCurrentTheme=function(){return{rowHeight:this.gridOptionsService.getRowHeightAsNumber(),headerHeight:this.columnModel.getHeaderHeight()}},o.prototype.expandAll=function(){this.clientSideRowModel?this.clientSideRowModel.expandOrCollapseAll(!0):this.serverSideRowModel?this.serverSideRowModel.expandAll(!0):this.logMissingRowModel("expandAll","clientSide","serverSide")},o.prototype.collapseAll=function(){this.clientSideRowModel?this.clientSideRowModel.expandOrCollapseAll(!1):this.serverSideRowModel?this.serverSideRowModel.expandAll(!1):this.logMissingRowModel("expandAll","clientSide","serverSide")},o.prototype.addRenderedRowListener=function(t,e,r){this.rowRenderer.addRenderedRowListener(t,e,r)},o.prototype.getQuickFilter=function(){return this.gridOptionsService.get("quickFilterText")},o.prototype.setQuickFilter=function(t){this.gridOptionsService.set("quickFilterText",t)},o.prototype.setExcludeHiddenColumnsFromQuickFilter=function(t){this.gridOptionsService.set("excludeHiddenColumnsFromQuickFilter",t)},o.prototype.selectAll=function(t){void 0===t&&(t="apiSelectAll"),this.selectionService.selectAllRowNodes({source:t})},o.prototype.deselectAll=function(t){void 0===t&&(t="apiSelectAll"),this.selectionService.deselectAllRowNodes({source:t})},o.prototype.selectAllFiltered=function(t){void 0===t&&(t="apiSelectAllFiltered"),this.selectionService.selectAllRowNodes({source:t,justFiltered:!0})},o.prototype.deselectAllFiltered=function(t){void 0===t&&(t="apiSelectAllFiltered"),this.selectionService.deselectAllRowNodes({source:t,justFiltered:!0})},o.prototype.getServerSideSelectionState=function(){return Je(this.serverSideRowModel)?(this.logMissingRowModel("getServerSideSelectionState","serverSide"),null):this.selectionService.getServerSideSelectionState()},o.prototype.setServerSideSelectionState=function(t){Je(this.serverSideRowModel)?this.logMissingRowModel("setServerSideSelectionState","serverSide"):this.selectionService.setServerSideSelectionState(t)},o.prototype.selectAllOnCurrentPage=function(t){void 0===t&&(t="apiSelectAllCurrentPage"),this.selectionService.selectAllRowNodes({source:t,justCurrentPage:!0})},o.prototype.deselectAllOnCurrentPage=function(t){void 0===t&&(t="apiSelectAllCurrentPage"),this.selectionService.deselectAllRowNodes({source:t,justCurrentPage:!0})},o.prototype.sizeColumnsToFit=function(t){this.gridBodyCtrl.sizeColumnsToFit(t)},o.prototype.showLoadingOverlay=function(){this.overlayWrapperComp.showLoadingOverlay()},o.prototype.showNoRowsOverlay=function(){this.overlayWrapperComp.showNoRowsOverlay()},o.prototype.hideOverlay=function(){this.overlayWrapperComp.hideOverlay()},o.prototype.getSelectedNodes=function(){return this.selectionService.getSelectedNodes()},o.prototype.getSelectedRows=function(){return this.selectionService.getSelectedRows()},o.prototype.getBestCostNodeSelection=function(){if(!Je(this.clientSideRowModel))return this.selectionService.getBestCostNodeSelection();this.logMissingRowModel("getBestCostNodeSelection","clientSide")},o.prototype.getRenderedNodes=function(){return this.rowRenderer.getRenderedNodes()},o.prototype.ensureColumnVisible=function(t,e){void 0===e&&(e="auto"),this.gridBodyCtrl.getScrollFeature().ensureColumnVisible(t,e)},o.prototype.ensureIndexVisible=function(t,e){this.gridBodyCtrl.getScrollFeature().ensureIndexVisible(t,e)},o.prototype.ensureNodeVisible=function(t,e){void 0===e&&(e=null),this.gridBodyCtrl.getScrollFeature().ensureNodeVisible(t,e)},o.prototype.forEachLeafNode=function(t){Je(this.clientSideRowModel)?this.logMissingRowModel("forEachLeafNode","clientSide"):this.clientSideRowModel.forEachLeafNode(t)},o.prototype.forEachNode=function(t,e){this.rowModel.forEachNode(t,e)},o.prototype.forEachNodeAfterFilter=function(t){Je(this.clientSideRowModel)?this.logMissingRowModel("forEachNodeAfterFilter","clientSide"):this.clientSideRowModel.forEachNodeAfterFilter(t)},o.prototype.forEachNodeAfterFilterAndSort=function(t){Je(this.clientSideRowModel)?this.logMissingRowModel("forEachNodeAfterFilterAndSort","clientSide"):this.clientSideRowModel.forEachNodeAfterFilterAndSort(t)},o.prototype.getFilterInstance=function(t,e){var r=this.getFilterInstanceImpl(t,function(n){if(e){var u=Io(n);e(u)}});return Io(r)},o.prototype.getFilterInstanceImpl=function(t,e){var r=this.columnModel.getPrimaryColumn(t);if(r){var i=this.filterManager.getFilterComponent(r,"NO_UI"),n=i&&i.resolveNow(null,function(u){return u});return n?setTimeout(e,0,n):i&&i.then(function(u){e(u)}),n}},o.prototype.destroyFilter=function(t){var e=this.columnModel.getPrimaryColumn(t);if(e)return this.filterManager.destroyFilter(e,"api")},o.prototype.getStatusPanel=function(t){if(it.assertRegistered(Ne.StatusBarModule,"api.getStatusPanel"))return Io(this.statusBarService.getStatusPanel(t))},o.prototype.getColumnDef=function(t){var e=this.columnModel.getPrimaryColumn(t);return e?e.getColDef():null},o.prototype.getColumnDefs=function(){return this.columnModel.getColumnDefs()},o.prototype.onFilterChanged=function(){this.filterManager.onFilterChanged()},o.prototype.onSortChanged=function(){this.sortController.onSortChanged("api")},o.prototype.setFilterModel=function(t){this.filterManager.setFilterModel(t)},o.prototype.getFilterModel=function(){return this.filterManager.getFilterModel()},o.prototype.getFocusedCell=function(){return this.focusService.getFocusedCell()},o.prototype.clearFocusedCell=function(){return this.focusService.clearFocusedCell()},o.prototype.setFocusedCell=function(t,e,r){this.focusService.setFocusedCell({rowIndex:t,column:e,rowPinned:r,forceBrowserFocus:!0})},o.prototype.setSuppressRowDrag=function(t){this.gridOptionsService.set("suppressRowDrag",t)},o.prototype.setSuppressMoveWhenRowDragging=function(t){this.gridOptionsService.set("suppressMoveWhenRowDragging",t)},o.prototype.setSuppressRowClickSelection=function(t){this.gridOptionsService.set("suppressRowClickSelection",t)},o.prototype.addRowDropZone=function(t){this.gridBodyCtrl.getRowDragFeature().addRowDropZone(t)},o.prototype.removeRowDropZone=function(t){var e=this.dragAndDropService.findExternalZone(t);e&&this.dragAndDropService.removeDropTarget(e)},o.prototype.getRowDropZoneParams=function(t){return this.gridBodyCtrl.getRowDragFeature().getRowDropZone(t)},o.prototype.setHeaderHeight=function(t){this.gridOptionsService.set("headerHeight",t)},o.prototype.setDomLayout=function(t){this.clientSideRowModel||"autoHeight"!==t||this.gridOptionsService.is("pagination")?this.gridOptionsService.set("domLayout",t):console.error("AG Grid: domLayout can only be set to 'autoHeight' when using the client side row model or when using pagination.")},o.prototype.setEnableCellTextSelection=function(t){this.gridBodyCtrl.setCellTextSelection(t)},o.prototype.setFillHandleDirection=function(t){this.gridOptionsService.set("fillHandleDirection",t)},o.prototype.setGroupHeaderHeight=function(t){this.gridOptionsService.set("groupHeaderHeight",t)},o.prototype.setFloatingFiltersHeight=function(t){this.gridOptionsService.set("floatingFiltersHeight",t)},o.prototype.setPivotHeaderHeight=function(t){this.gridOptionsService.set("pivotHeaderHeight",t)},o.prototype.setPivotGroupHeaderHeight=function(t){this.gridOptionsService.set("pivotGroupHeaderHeight",t)},o.prototype.setPivotMode=function(t){this.columnModel.setPivotMode(t)},o.prototype.setAnimateRows=function(t){this.gridOptionsService.set("animateRows",t)},o.prototype.setIsExternalFilterPresent=function(t){this.gridOptionsService.set("isExternalFilterPresent",t)},o.prototype.setDoesExternalFilterPass=function(t){this.gridOptionsService.set("doesExternalFilterPass",t)},o.prototype.setNavigateToNextCell=function(t){this.gridOptionsService.set("navigateToNextCell",t)},o.prototype.setTabToNextCell=function(t){this.gridOptionsService.set("tabToNextCell",t)},o.prototype.setTabToNextHeader=function(t){this.gridOptionsService.set("tabToNextHeader",t)},o.prototype.setNavigateToNextHeader=function(t){this.gridOptionsService.set("navigateToNextHeader",t)},o.prototype.setRowGroupPanelShow=function(t){this.gridOptionsService.set("rowGroupPanelShow",t)},o.prototype.setGroupRowAggNodes=function(t){Vt("27.2","setGroupRowAggNodes","setGetGroupRowAgg"),this.gridOptionsService.set("groupRowAggNodes",t)},o.prototype.setGetGroupRowAgg=function(t){this.gridOptionsService.set("getGroupRowAgg",t)},o.prototype.setGetBusinessKeyForNode=function(t){this.gridOptionsService.set("getBusinessKeyForNode",t)},o.prototype.setGetChildCount=function(t){this.gridOptionsService.set("getChildCount",t)},o.prototype.setProcessRowPostCreate=function(t){this.gridOptionsService.set("processRowPostCreate",t)},o.prototype.setGetRowNodeId=function(t){Vt("27.1","setGetRowNodeId","setGetRowId"),this.gridOptionsService.set("getRowNodeId",t)},o.prototype.setGetRowId=function(t){this.gridOptionsService.set("getRowId",t)},o.prototype.setGetRowClass=function(t){this.gridOptionsService.set("getRowClass",t)},o.prototype.setIsFullWidthCell=function(t){Vt("27.2","setIsFullWidthCell","setIsFullWidthRow"),this.gridOptionsService.set("isFullWidthCell",t)},o.prototype.setIsFullWidthRow=function(t){this.gridOptionsService.set("isFullWidthRow",t)},o.prototype.setIsRowSelectable=function(t){this.gridOptionsService.set("isRowSelectable",t)},o.prototype.setIsRowMaster=function(t){this.gridOptionsService.set("isRowMaster",t)},o.prototype.setPostSort=function(t){Vt("27.2","setPostSort","setPostSortRows"),this.gridOptionsService.set("postSort",t)},o.prototype.setPostSortRows=function(t){this.gridOptionsService.set("postSortRows",t)},o.prototype.setGetDocument=function(t){this.gridOptionsService.set("getDocument",t)},o.prototype.setGetContextMenuItems=function(t){this.gridOptionsService.set("getContextMenuItems",t)},o.prototype.setGetMainMenuItems=function(t){this.gridOptionsService.set("getMainMenuItems",t)},o.prototype.setProcessCellForClipboard=function(t){this.gridOptionsService.set("processCellForClipboard",t)},o.prototype.setSendToClipboard=function(t){this.gridOptionsService.set("sendToClipboard",t)},o.prototype.setProcessCellFromClipboard=function(t){this.gridOptionsService.set("processCellFromClipboard",t)},o.prototype.setProcessSecondaryColDef=function(t){Vt("28.0","setProcessSecondaryColDef","setProcessPivotResultColDef"),this.setProcessPivotResultColDef(t)},o.prototype.setProcessSecondaryColGroupDef=function(t){Vt("28.0","setProcessSecondaryColGroupDef","setProcessPivotResultColGroupDef"),this.setProcessPivotResultColGroupDef(t)},o.prototype.setProcessPivotResultColDef=function(t){this.gridOptionsService.set("processPivotResultColDef",t)},o.prototype.setProcessPivotResultColGroupDef=function(t){this.gridOptionsService.set("processPivotResultColGroupDef",t)},o.prototype.setPostProcessPopup=function(t){this.gridOptionsService.set("postProcessPopup",t)},o.prototype.setDefaultGroupOrderComparator=function(t){Vt("27.2","setDefaultGroupOrderComparator","setInitialGroupOrderComparator"),this.gridOptionsService.set("defaultGroupOrderComparator",t)},o.prototype.setInitialGroupOrderComparator=function(t){this.gridOptionsService.set("initialGroupOrderComparator",t)},o.prototype.setGetChartToolbarItems=function(t){this.gridOptionsService.set("getChartToolbarItems",t)},o.prototype.setPaginationNumberFormatter=function(t){this.gridOptionsService.set("paginationNumberFormatter",t)},o.prototype.setGetServerSideStoreParams=function(t){Vt("28.0","setGetServerSideStoreParams","setGetServerSideGroupLevelParams"),this.setGetServerSideGroupLevelParams(t)},o.prototype.setGetServerSideGroupLevelParams=function(t){this.gridOptionsService.set("getServerSideGroupLevelParams",t)},o.prototype.setIsServerSideGroupOpenByDefault=function(t){this.gridOptionsService.set("isServerSideGroupOpenByDefault",t)},o.prototype.setIsApplyServerSideTransaction=function(t){this.gridOptionsService.set("isApplyServerSideTransaction",t)},o.prototype.setIsServerSideGroup=function(t){this.gridOptionsService.set("isServerSideGroup",t)},o.prototype.setGetServerSideGroupKey=function(t){this.gridOptionsService.set("getServerSideGroupKey",t)},o.prototype.setGetRowStyle=function(t){this.gridOptionsService.set("getRowStyle",t)},o.prototype.setGetRowHeight=function(t){this.gridOptionsService.set("getRowHeight",t)},o.prototype.assertSideBarLoaded=function(t){return it.assertRegistered(Ne.SideBarModule,"api."+t)},o.prototype.isSideBarVisible=function(){return this.assertSideBarLoaded("isSideBarVisible")&&this.sideBarComp.isDisplayed()},o.prototype.setSideBarVisible=function(t){this.assertSideBarLoaded("setSideBarVisible")&&this.sideBarComp.setDisplayed(t)},o.prototype.setSideBarPosition=function(t){this.assertSideBarLoaded("setSideBarPosition")&&this.sideBarComp.setSideBarPosition(t)},o.prototype.openToolPanel=function(t){this.assertSideBarLoaded("openToolPanel")&&this.sideBarComp.openToolPanel(t,"api")},o.prototype.closeToolPanel=function(){this.assertSideBarLoaded("closeToolPanel")&&this.sideBarComp.close("api")},o.prototype.getOpenedToolPanel=function(){return this.assertSideBarLoaded("getOpenedToolPanel")?this.sideBarComp.openedItem():null},o.prototype.refreshToolPanel=function(){this.assertSideBarLoaded("refreshToolPanel")&&this.sideBarComp.refresh()},o.prototype.isToolPanelShowing=function(){return this.assertSideBarLoaded("isToolPanelShowing")&&this.sideBarComp.isToolPanelShowing()},o.prototype.getToolPanelInstance=function(t){if(this.assertSideBarLoaded("getToolPanelInstance"))return Io(this.sideBarComp.getToolPanelInstance(t))},o.prototype.getSideBar=function(){if(this.assertSideBarLoaded("getSideBar"))return this.sideBarComp.getDef()},o.prototype.setSideBar=function(t){this.gridOptionsService.set("sideBar",t)},o.prototype.setSuppressClipboardPaste=function(t){this.gridOptionsService.set("suppressClipboardPaste",t)},o.prototype.resetRowHeights=function(){if(me(this.clientSideRowModel)){if(this.columnModel.isAutoRowHeightActive())return void console.warn("AG Grid: calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.");this.clientSideRowModel.resetRowHeights()}},o.prototype.setGroupRemoveSingleChildren=function(t){this.gridOptionsService.set("groupRemoveSingleChildren",t)},o.prototype.setGroupRemoveLowestSingleChildren=function(t){this.gridOptionsService.set("groupRemoveLowestSingleChildren",t)},o.prototype.setGroupDisplayType=function(t){this.gridOptionsService.set("groupDisplayType",t)},o.prototype.setRowClass=function(t){this.gridOptionsService.set("rowClass",t)},o.prototype.setDeltaSort=function(t){this.gridOptionsService.set("deltaSort",t)},o.prototype.setRowCount=function(t,e){if(this.serverSideRowModel)return this.columnModel.isRowGroupEmpty()?void this.serverSideRowModel.setRowCount(t,e):void console.error("AG Grid: setRowCount cannot be used while using row grouping.");this.infiniteRowModel?this.infiniteRowModel.setRowCount(t,e):this.logMissingRowModel("setRowCount","infinite","serverSide")},o.prototype.onRowHeightChanged=function(){this.clientSideRowModel?this.clientSideRowModel.onRowHeightChanged():this.serverSideRowModel&&this.serverSideRowModel.onRowHeightChanged()},o.prototype.getValue=function(t,e){var r=this.columnModel.getPrimaryColumn(t);return Je(r)&&(r=this.columnModel.getGridColumn(t)),Je(r)?null:this.valueService.getValue(r,e)},o.prototype.addEventListener=function(t,e){var r=this.gridOptionsService.useAsyncEvents();this.eventService.addEventListener(t,e,r)},o.prototype.addGlobalListener=function(t){var e=this.gridOptionsService.useAsyncEvents();this.eventService.addGlobalListener(t,e)},o.prototype.removeEventListener=function(t,e){var r=this.gridOptionsService.useAsyncEvents();this.eventService.removeEventListener(t,e,r)},o.prototype.removeGlobalListener=function(t){var e=this.gridOptionsService.useAsyncEvents();this.eventService.removeGlobalListener(t,e)},o.prototype.dispatchEvent=function(t){this.eventService.dispatchEvent(t)},o.prototype.destroy=function(){if(!this.destroyCalled){this.destroyCalled=!0;var t=this.ctrlsService.getGridCtrl();t&&t.destroyGridUi(),this.context.destroy()}},o.prototype.cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid=function(){setTimeout(el.bind(window,this,"Grid API"),100)},o.prototype.warnIfDestroyed=function(t){return this.destroyCalled&&console.warn("AG Grid: Grid API method "+t+" was called on a grid that was destroyed."),this.destroyCalled},o.prototype.resetQuickFilter=function(){this.warnIfDestroyed("resetQuickFilter")||this.filterManager.resetQuickFilterCache()},o.prototype.getCellRanges=function(){return this.rangeService?this.rangeService.getCellRanges():(it.assertRegistered(Ne.RangeSelectionModule,"api.getCellRanges"),null)},o.prototype.addCellRange=function(t){this.rangeService?this.rangeService.addCellRange(t):it.assertRegistered(Ne.RangeSelectionModule,"api.addCellRange")},o.prototype.clearRangeSelection=function(){this.rangeService&&this.rangeService.removeAllCellRanges(),it.assertRegistered(Ne.RangeSelectionModule,"gridApi.clearRangeSelection")},o.prototype.undoCellEditing=function(){this.undoRedoService.undo("api")},o.prototype.redoCellEditing=function(){this.undoRedoService.redo("api")},o.prototype.getCurrentUndoSize=function(){return this.undoRedoService.getCurrentUndoStackSize()},o.prototype.getCurrentRedoSize=function(){return this.undoRedoService.getCurrentRedoStackSize()},o.prototype.getChartModels=function(){if(it.assertRegistered(Ne.GridChartsModule,"api.getChartModels"))return this.chartService.getChartModels()},o.prototype.getChartRef=function(t){if(it.assertRegistered(Ne.GridChartsModule,"api.getChartRef"))return this.chartService.getChartRef(t)},o.prototype.getChartImageDataURL=function(t){if(it.assertRegistered(Ne.GridChartsModule,"api.getChartImageDataURL"))return this.chartService.getChartImageDataURL(t)},o.prototype.downloadChart=function(t){if(it.assertRegistered(Ne.GridChartsModule,"api.downloadChart"))return this.chartService.downloadChart(t)},o.prototype.openChartToolPanel=function(t){if(it.assertRegistered(Ne.GridChartsModule,"api.openChartToolPanel"))return this.chartService.openChartToolPanel(t)},o.prototype.closeChartToolPanel=function(t){if(it.assertRegistered(Ne.GridChartsModule,"api.closeChartToolPanel"))return this.chartService.closeChartToolPanel(t.chartId)},o.prototype.createRangeChart=function(t){if(it.assertRegistered(Ne.GridChartsModule,"api.createRangeChart"))return this.chartService.createRangeChart(t)},o.prototype.createCrossFilterChart=function(t){if(it.assertRegistered(Ne.GridChartsModule,"api.createCrossFilterChart"))return this.chartService.createCrossFilterChart(t)},o.prototype.restoreChart=function(t,e){if(it.assertRegistered(Ne.GridChartsModule,"api.restoreChart"))return this.chartService.restoreChart(t,e)},o.prototype.createPivotChart=function(t){if(it.assertRegistered(Ne.GridChartsModule,"api.createPivotChart"))return this.chartService.createPivotChart(t)},o.prototype.copyToClipboard=function(t){it.assertRegistered(Ne.ClipboardModule,"api.copyToClipboard")&&this.clipboardService.copyToClipboard(t)},o.prototype.cutToClipboard=function(t){it.assertRegistered(Ne.ClipboardModule,"api.cutToClipboard")&&this.clipboardService.cutToClipboard(t)},o.prototype.copySelectedRowsToClipboard=function(t){it.assertRegistered(Ne.ClipboardModule,"api.copySelectedRowsToClipboard")&&this.clipboardService.copySelectedRowsToClipboard(t)},o.prototype.copySelectedRangeToClipboard=function(t){it.assertRegistered(Ne.ClipboardModule,"api.copySelectedRangeToClipboard")&&this.clipboardService.copySelectedRangeToClipboard(t)},o.prototype.copySelectedRangeDown=function(){it.assertRegistered(Ne.ClipboardModule,"api.copySelectedRangeDown")&&this.clipboardService.copyRangeDown()},o.prototype.showColumnMenuAfterButtonClick=function(t,e){var r=this.columnModel.getGridColumn(t);this.menuFactory.showMenuAfterButtonClick(r,e,"columnMenu")},o.prototype.showColumnMenuAfterMouseClick=function(t,e){var r=this.columnModel.getGridColumn(t);r||(r=this.columnModel.getPrimaryColumn(t)),r?this.menuFactory.showMenuAfterMouseEvent(r,e):console.error("AG Grid: column '"+t+"' not found")},o.prototype.hidePopupMenu=function(){this.contextMenuFactory&&this.contextMenuFactory.hideActiveMenu(),this.menuFactory.hideActiveMenu()},o.prototype.setPopupParent=function(t){this.gridOptionsService.set("popupParent",t)},o.prototype.tabToNextCell=function(t){return this.navigationService.tabToNextCell(!1,t)},o.prototype.tabToPreviousCell=function(t){return this.navigationService.tabToNextCell(!0,t)},o.prototype.getCellRendererInstances=function(t){return void 0===t&&(t={}),this.rowRenderer.getCellRendererInstances(t).map(Io)},o.prototype.getCellEditorInstances=function(t){return void 0===t&&(t={}),this.rowRenderer.getCellEditorInstances(t).map(Io)},o.prototype.getEditingCells=function(){return this.rowRenderer.getEditingCells()},o.prototype.stopEditing=function(t){void 0===t&&(t=!1),this.rowRenderer.stopEditing(t)},o.prototype.startEditingCell=function(t){var e=this.columnModel.getGridColumn(t.colKey);if(e){var r={rowIndex:t.rowIndex,rowPinned:t.rowPinned||null,column:e};null==t.rowPinned&&this.gridBodyCtrl.getScrollFeature().ensureIndexVisible(t.rowIndex);var n=this.navigationService.getCellByPosition(r);n&&n.startRowOrCellEdit(t.key,t.charPress)}else console.warn("AG Grid: no column found for "+t.colKey)},o.prototype.addAggFunc=function(t,e){this.aggFuncService&&this.aggFuncService.addAggFunc(t,e)},o.prototype.addAggFuncs=function(t){this.aggFuncService&&this.aggFuncService.addAggFuncs(t)},o.prototype.clearAggFuncs=function(){this.aggFuncService&&this.aggFuncService.clear()},o.prototype.applyServerSideTransaction=function(t){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.applyTransaction(t);this.logMissingRowModel("applyServerSideTransaction","serverSide")},o.prototype.applyServerSideTransactionAsync=function(t,e){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.applyTransactionAsync(t,e);this.logMissingRowModel("applyServerSideTransactionAsync","serverSide")},o.prototype.retryServerSideLoads=function(){this.serverSideRowModel?this.serverSideRowModel.retryLoads():this.logMissingRowModel("retryServerSideLoads","serverSide")},o.prototype.flushServerSideAsyncTransactions=function(){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.flushAsyncTransactions();this.logMissingRowModel("flushServerSideAsyncTransactions","serverSide")},o.prototype.applyTransaction=function(t){if(this.clientSideRowModel){var e=this.clientSideRowModel.updateRowData(t);return this.gridOptionsService.is("suppressChangeDetection")||this.rowRenderer.refreshCells(),e}this.logMissingRowModel("applyTransaction","clientSide")},o.prototype.applyTransactionAsync=function(t,e){this.clientSideRowModel?this.clientSideRowModel.batchUpdateRowData(t,e):this.logMissingRowModel("applyTransactionAsync","clientSide")},o.prototype.flushAsyncTransactions=function(){this.clientSideRowModel?this.clientSideRowModel.flushAsyncTransactions():this.logMissingRowModel("flushAsyncTransactions","clientSide")},o.prototype.setSuppressModelUpdateAfterUpdateTransaction=function(t){this.gridOptionsService.set("suppressModelUpdateAfterUpdateTransaction",t)},o.prototype.refreshInfiniteCache=function(){this.infiniteRowModel?this.infiniteRowModel.refreshCache():this.logMissingRowModel("refreshInfiniteCache","infinite")},o.prototype.purgeInfiniteCache=function(){this.infiniteRowModel?this.infiniteRowModel.purgeCache():this.logMissingRowModel("purgeInfiniteCache","infinite")},o.prototype.refreshServerSide=function(t){this.serverSideRowModel?this.serverSideRowModel.refreshStore(t):this.logMissingRowModel("refreshServerSide","serverSide")},o.prototype.refreshServerSideStore=function(t){return Vt("28.0","refreshServerSideStore","refreshServerSide"),this.refreshServerSide(t)},o.prototype.getServerSideStoreState=function(){return Vt("28.0","getServerSideStoreState","getServerSideGroupLevelState"),this.getServerSideGroupLevelState()},o.prototype.getServerSideGroupLevelState=function(){return this.serverSideRowModel?this.serverSideRowModel.getStoreState():(this.logMissingRowModel("getServerSideGroupLevelState","serverSide"),[])},o.prototype.getInfiniteRowCount=function(){if(this.infiniteRowModel)return this.infiniteRowModel.getRowCount();this.logMissingRowModel("getInfiniteRowCount","infinite")},o.prototype.isLastRowIndexKnown=function(){if(this.infiniteRowModel)return this.infiniteRowModel.isLastRowIndexKnown();this.logMissingRowModel("isLastRowIndexKnown","infinite")},o.prototype.getCacheBlockState=function(){return this.rowNodeBlockLoader.getBlockState()},o.prototype.getFirstDisplayedRow=function(){return this.rowRenderer.getFirstVirtualRenderedRow()},o.prototype.getLastDisplayedRow=function(){return this.rowRenderer.getLastVirtualRenderedRow()},o.prototype.getDisplayedRowAtIndex=function(t){return this.rowModel.getRow(t)},o.prototype.getDisplayedRowCount=function(){return this.rowModel.getRowCount()},o.prototype.setPagination=function(t){this.clientSideRowModel||"autoHeight"!==this.gridOptionsService.get("domLayout")||t?this.gridOptionsService.set("pagination",t):console.error("AG Grid: Pagination cannot be disabled when using domLayout set to 'autoHeight' unless using the client-side row model.")},o.prototype.paginationIsLastPageFound=function(){return this.paginationProxy.isLastPageFound()},o.prototype.paginationGetPageSize=function(){return this.paginationProxy.getPageSize()},o.prototype.paginationSetPageSize=function(t){this.gridOptionsService.set("paginationPageSize",t)},o.prototype.paginationGetCurrentPage=function(){return this.paginationProxy.getCurrentPage()},o.prototype.paginationGetTotalPages=function(){return this.paginationProxy.getTotalPages()},o.prototype.paginationGetRowCount=function(){return this.paginationProxy.getMasterRowCount()},o.prototype.paginationGoToNextPage=function(){this.paginationProxy.goToNextPage()},o.prototype.paginationGoToPreviousPage=function(){this.paginationProxy.goToPreviousPage()},o.prototype.paginationGoToFirstPage=function(){this.paginationProxy.goToFirstPage()},o.prototype.paginationGoToLastPage=function(){this.paginationProxy.goToLastPage()},o.prototype.paginationGoToPage=function(t){this.paginationProxy.goToPage(t)},xt([Ft("immutableService")],o.prototype,"immutableService",void 0),xt([Ft("csvCreator")],o.prototype,"csvCreator",void 0),xt([Ft("excelCreator")],o.prototype,"excelCreator",void 0),xt([D("rowRenderer")],o.prototype,"rowRenderer",void 0),xt([D("navigationService")],o.prototype,"navigationService",void 0),xt([D("filterManager")],o.prototype,"filterManager",void 0),xt([D("columnModel")],o.prototype,"columnModel",void 0),xt([D("selectionService")],o.prototype,"selectionService",void 0),xt([D("gridOptionsService")],o.prototype,"gridOptionsService",void 0),xt([D("valueService")],o.prototype,"valueService",void 0),xt([D("alignedGridsService")],o.prototype,"alignedGridsService",void 0),xt([D("eventService")],o.prototype,"eventService",void 0),xt([D("pinnedRowModel")],o.prototype,"pinnedRowModel",void 0),xt([D("context")],o.prototype,"context",void 0),xt([D("rowModel")],o.prototype,"rowModel",void 0),xt([D("sortController")],o.prototype,"sortController",void 0),xt([D("paginationProxy")],o.prototype,"paginationProxy",void 0),xt([D("focusService")],o.prototype,"focusService",void 0),xt([D("dragAndDropService")],o.prototype,"dragAndDropService",void 0),xt([Ft("rangeService")],o.prototype,"rangeService",void 0),xt([Ft("clipboardService")],o.prototype,"clipboardService",void 0),xt([Ft("aggFuncService")],o.prototype,"aggFuncService",void 0),xt([D("menuFactory")],o.prototype,"menuFactory",void 0),xt([Ft("contextMenuFactory")],o.prototype,"contextMenuFactory",void 0),xt([D("valueCache")],o.prototype,"valueCache",void 0),xt([D("animationFrameService")],o.prototype,"animationFrameService",void 0),xt([Ft("statusBarService")],o.prototype,"statusBarService",void 0),xt([Ft("chartService")],o.prototype,"chartService",void 0),xt([Ft("undoRedoService")],o.prototype,"undoRedoService",void 0),xt([Ft("rowNodeBlockLoader")],o.prototype,"rowNodeBlockLoader",void 0),xt([Ft("ssrmTransactionManager")],o.prototype,"serverSideTransactionManager",void 0),xt([D("ctrlsService")],o.prototype,"ctrlsService",void 0),xt([Re],o.prototype,"init",null),xt([Mr],o.prototype,"cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid",null),o=xt([He("gridApi")],o)}(),iw=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),kl=function(){return kl=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},kl.apply(this,arguments)},Mo=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},sg=function(o){function t(){var r=null!==o&&o.apply(this,arguments)||this;return r.allColumnFilters=new Map,r.activeAggregateFilters=[],r.activeColumnFilters=[],r.quickFilter=null,r.quickFilterParts=null,r.processingFilterChange=!1,r}var e;return iw(t,o),e=t,t.prototype.init=function(){var r=this;this.addManagedListener(this.eventService,I.EVENT_GRID_COLUMNS_CHANGED,function(){return r.onColumnsChanged()}),this.addManagedListener(this.eventService,I.EVENT_COLUMN_VALUE_CHANGED,function(){return r.refreshFiltersForAggregations()}),this.addManagedListener(this.eventService,I.EVENT_COLUMN_PIVOT_CHANGED,function(){return r.refreshFiltersForAggregations()}),this.addManagedListener(this.eventService,I.EVENT_COLUMN_PIVOT_MODE_CHANGED,function(){r.refreshFiltersForAggregations(),r.resetQuickFilterCache()}),this.addManagedListener(this.eventService,I.EVENT_NEW_COLUMNS_LOADED,function(){return r.resetQuickFilterCache()}),this.addManagedListener(this.eventService,I.EVENT_COLUMN_ROW_GROUP_CHANGED,function(){return r.resetQuickFilterCache()}),this.addManagedListener(this.eventService,I.EVENT_COLUMN_VISIBLE,function(){r.gridOptionsService.is("excludeHiddenColumnsFromQuickFilter")&&r.resetQuickFilterCache()}),this.addManagedPropertyListener("quickFilterText",function(i){return r.setQuickFilter(i.currentValue)}),this.addManagedPropertyListener("excludeHiddenColumnsFromQuickFilter",function(){return r.onExcludeHiddenColumnsFromQuickFilterChanged()}),this.quickFilter=this.parseQuickFilter(this.gridOptionsService.get("quickFilterText")),this.setQuickFilterParts(),this.allowShowChangeAfterFilter=this.gridOptionsService.is("allowShowChangeAfterFilter"),this.externalFilterPresent=this.isExternalFilterPresentCallback()},t.prototype.isExternalFilterPresentCallback=function(){var r=this.gridOptionsService.getCallback("isExternalFilterPresent");return"function"==typeof r&&r({})},t.prototype.doesExternalFilterPass=function(r){var i=this.gridOptionsService.get("doesExternalFilterPass");return"function"==typeof i&&i(r)},t.prototype.setQuickFilterParts=function(){this.quickFilterParts=this.quickFilter?this.quickFilter.split(" "):null},t.prototype.setFilterModel=function(r){var i=this,n=[],u=this.getFilterModel();if(r){var c=ea(Object.keys(r));this.allColumnFilters.forEach(function(v,m){var C=r[m];n.push(i.setModelOnFilterWrapper(v.filterPromise,C)),c.delete(m)}),c.forEach(function(v){var m=i.columnModel.getPrimaryColumn(v)||i.columnModel.getGridColumn(v);if(m)if(m.isFilterAllowed()){var C=i.getOrCreateFilterWrapper(m,"NO_UI");C?n.push(i.setModelOnFilterWrapper(C.filterPromise,r[v])):console.warn("AG-Grid: setFilterModel() - unable to fully apply model, unable to create filter for colId: "+v)}else console.warn("AG Grid: setFilterModel() - unable to fully apply model, filtering disabled for colId: "+v);else console.warn("AG Grid: setFilterModel() - no column found for colId: "+v)})}else this.allColumnFilters.forEach(function(v){n.push(i.setModelOnFilterWrapper(v.filterPromise,null))});ir.all(n).then(function(){var v=i.getFilterModel(),m=[];i.allColumnFilters.forEach(function(C,_){var O=u?u[_]:null,P=v?v[_]:null;rt.jsonEquals(O,P)||m.push(C.column)}),m.length>0&&i.onFilterChanged({columns:m})})},t.prototype.setModelOnFilterWrapper=function(r,i){return new ir(function(n){r.then(function(u){"function"!=typeof u.setModel&&(console.warn("AG Grid: filter missing setModel method, which is needed for setFilterModel"),n()),(u.setModel(i)||ir.resolve()).then(function(){return n()})})})},t.prototype.getFilterModel=function(){var r={};return this.allColumnFilters.forEach(function(i,n){var c=i.filterPromise.resolveNow(null,function(m){return m});if(null==c)return null;if("function"==typeof c.getModel){var v=c.getModel();me(v)&&(r[n]=v)}else console.warn("AG Grid: filter API missing getModel method, which is needed for getFilterModel")}),r},t.prototype.isColumnFilterPresent=function(){return this.activeColumnFilters.length>0},t.prototype.isAggregateFilterPresent=function(){return!!this.activeAggregateFilters.length},t.prototype.isExternalFilterPresent=function(){return this.externalFilterPresent},t.prototype.doAggregateFiltersPass=function(r,i){return this.doColumnFiltersPass(r,i,!0)},t.prototype.updateActiveFilters=function(){var r=this;this.activeColumnFilters.length=0,this.activeAggregateFilters.length=0;var i=function(c){return!!c&&(c.isFilterActive?c.isFilterActive():(console.warn("AG Grid: Filter is missing isFilterActive() method"),!1))},n=!!this.gridOptionsService.getGroupAggFiltering();this.allColumnFilters.forEach(function(c){if(c.filterPromise.resolveNow(!1,i)){var v=c.filterPromise.resolveNow(null,function(m){return m});!function(c){if(!c.isPrimary())return!0;var m=!r.columnModel.isPivotActive();return!(!c.isValueActive()||!m)&&(!!r.columnModel.isPivotMode()||n)}(c.column)?r.activeColumnFilters.push(v):r.activeAggregateFilters.push(v)}})},t.prototype.updateFilterFlagInColumns=function(r,i){this.allColumnFilters.forEach(function(n){var u=n.filterPromise.resolveNow(!1,function(c){return c.isFilterActive()});n.column.setFilterActive(u,r,i)})},t.prototype.isAnyFilterPresent=function(){return this.isQuickFilterPresent()||this.isColumnFilterPresent()||this.isAggregateFilterPresent()||this.isExternalFilterPresent()},t.prototype.doColumnFiltersPass=function(r,i,n){for(var u=r.data,c=r.aggData,v=n?this.activeAggregateFilters:this.activeColumnFilters,m=n?c:u,C=0;C<v.length;C++){var _=v[C];if(null!=_&&_!==i){if("function"!=typeof _.doesFilterPass)throw new Error("Filter is missing method doesFilterPass");if(!_.doesFilterPass({node:r,data:m}))return!1}}return!0},t.prototype.parseQuickFilter=function(r){return me(r)?this.gridOptionsService.isRowModelType("clientSide")?r.toUpperCase():(console.warn("AG Grid - Quick filtering only works with the Client-Side Row Model"),null):null},t.prototype.setQuickFilter=function(r){if(null==r||"string"==typeof r){var i=this.parseQuickFilter(r);this.quickFilter!==i&&(this.quickFilter=i,this.setQuickFilterParts(),this.onFilterChanged())}else console.warn("AG Grid - setQuickFilter() only supports string inputs, received: "+typeof r)},t.prototype.resetQuickFilterCache=function(){this.rowModel.forEachNode(function(r){return r.quickFilterAggregateText=null})},t.prototype.onExcludeHiddenColumnsFromQuickFilterChanged=function(){this.columnModel.refreshQuickFilterColumns(),this.resetQuickFilterCache(),this.isQuickFilterPresent()&&this.onFilterChanged()},t.prototype.refreshFiltersForAggregations=function(){this.gridOptionsService.getGroupAggFiltering()&&this.onFilterChanged()},t.prototype.callOnFilterChangedOutsideRenderCycle=function(r){var i=this;void 0===r&&(r={});var n=function(){return i.onFilterChanged(r)};this.rowRenderer.isRefreshInProgress()?setTimeout(n,0):n()},t.prototype.onFilterChanged=function(r){void 0===r&&(r={});var i=r.filterInstance,n=r.additionalEventAttributes,u=r.columns;this.updateDependantFilters(),this.updateActiveFilters(),this.updateFilterFlagInColumns("filterChanged",n),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.allColumnFilters.forEach(function(v){v.filterPromise&&v.filterPromise.then(function(m){m&&m!==i&&m.onAnyFilterChanged&&m.onAnyFilterChanged()})});var c={type:I.EVENT_FILTER_CHANGED,columns:u||[]};n&&Qr(c,n),this.processingFilterChange=!0,this.eventService.dispatchEvent(c),this.processingFilterChange=!1},t.prototype.isSuppressFlashingCellsBecauseFiltering=function(){return!this.allowShowChangeAfterFilter&&this.processingFilterChange},t.prototype.isQuickFilterPresent=function(){return null!==this.quickFilter},t.prototype.doesRowPassOtherFilters=function(r,i){return this.doesRowPassFilter({rowNode:i,filterInstanceToSkip:r})},t.prototype.doesRowPassQuickFilterNoCache=function(r,i){var n=this;return this.columnModel.getAllColumnsForQuickFilter().some(function(c){var v=n.getQuickFilterTextForColumn(c,r);return me(v)&&v.indexOf(i)>=0})},t.prototype.doesRowPassQuickFilterCache=function(r,i){return r.quickFilterAggregateText||this.aggregateRowForQuickFilter(r),r.quickFilterAggregateText.indexOf(i)>=0},t.prototype.doesRowPassQuickFilter=function(r){var i=this,n=this.gridOptionsService.is("cacheQuickFilter");return this.quickFilterParts.every(function(u){return n?i.doesRowPassQuickFilterCache(r,u):i.doesRowPassQuickFilterNoCache(r,u)})},t.prototype.doesRowPassAggregateFilters=function(r){return!(this.isAggregateFilterPresent()&&!this.doAggregateFiltersPass(r.rowNode,r.filterInstanceToSkip))},t.prototype.doesRowPassFilter=function(r){return!(this.isQuickFilterPresent()&&!this.doesRowPassQuickFilter(r.rowNode)||this.isExternalFilterPresent()&&!this.doesExternalFilterPass(r.rowNode)||this.isColumnFilterPresent()&&!this.doColumnFiltersPass(r.rowNode,r.filterInstanceToSkip))},t.prototype.getQuickFilterTextForColumn=function(r,i){var n=this.valueService.getValue(r,i,!0),u=r.getColDef();if(u.getQuickFilterText){var c={value:n,node:i,data:i.data,column:r,colDef:u,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};n=u.getQuickFilterText(c)}return me(n)?n.toString().toUpperCase():null},t.prototype.aggregateRowForQuickFilter=function(r){var i=this,n=[];this.columnModel.getAllColumnsForQuickFilter().forEach(function(c){var v=i.getQuickFilterTextForColumn(c,r);me(v)&&n.push(v)}),r.quickFilterAggregateText=n.join(e.QUICK_FILTER_SEPARATOR)},t.prototype.onNewRowsLoaded=function(r){this.allColumnFilters.forEach(function(i){i.filterPromise.then(function(n){n.onNewRowsLoaded&&n.onNewRowsLoaded()})}),this.updateFilterFlagInColumns(r,{afterDataChange:!0}),this.updateActiveFilters()},t.prototype.createValueGetter=function(r){var i=this;return function(n){var u=n.node;return i.valueService.getValue(r,u,!0)}},t.prototype.getFilterComponent=function(r,i,n){var u;if(void 0===n&&(n=!0),n)return(null===(u=this.getOrCreateFilterWrapper(r,i))||void 0===u?void 0:u.filterPromise)||null;var c=this.cachedFilter(r);return c?c.filterPromise:null},t.prototype.isFilterActive=function(r){var i=this.cachedFilter(r);return!!i&&i.filterPromise.resolveNow(!1,function(n){return n.isFilterActive()})},t.prototype.getOrCreateFilterWrapper=function(r,i){if(!r.isFilterAllowed())return null;var n=this.cachedFilter(r);return n?"NO_UI"!==i&&this.putIntoGui(n,i):(n=this.createFilterWrapper(r,i),this.allColumnFilters.set(r.getColId(),n)),n},t.prototype.cachedFilter=function(r){return this.allColumnFilters.get(r.getColId())},t.prototype.createFilterInstance=function(r){var c,i=this,n=it.isRegistered(Ne.SetFilterModule)?"agSetColumnFilter":"agTextColumnFilter",u=r.getColDef(),v=kl(kl({},this.createFilterParams(r,u)),{filterModifiedCallback:function(){var _={type:I.EVENT_FILTER_MODIFIED,column:r,filterInstance:c};i.eventService.dispatchEvent(_)},filterChangedCallback:function(_){var O={filterInstance:c,additionalEventAttributes:_,columns:[r]};i.callOnFilterChangedOutsideRenderCycle(O)},doesRowPassOtherFilter:function(_){return i.doesRowPassOtherFilters(c,_)}}),m=this.userComponentFactory.getFilterDetails(u,v,n);if(!m)return null;var C=m.newAgStackInstance();return C&&C.then(function(_){return c=_}),C},t.prototype.createFilterParams=function(r,i){return{column:r,colDef:Tf(i),rowModel:this.rowModel,filterChangedCallback:function(){},filterModifiedCallback:function(){},valueGetter:this.createValueGetter(r),doesRowPassOtherFilter:function(){return!0},api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}},t.prototype.createFilterWrapper=function(r,i){var n={column:r,filterPromise:null,compiledElement:null,guiPromise:ir.resolve(null)};return n.filterPromise=this.createFilterInstance(r),n.filterPromise&&this.putIntoGui(n,i),n},t.prototype.putIntoGui=function(r,i){var n=this,u=document.createElement("div");u.className="ag-filter",r.guiPromise=new ir(function(c){r.filterPromise.then(function(v){var m=v.getGui();me(m)||console.warn("AG Grid: getGui method from filter returned "+m+", it should be a DOM element or an HTML template string."),"string"==typeof m&&(m=Sr(m)),u.appendChild(m),c(u);var C={type:I.EVENT_FILTER_OPENED,column:r.column,source:i,eGui:u};n.eventService.dispatchEvent(C)})})},t.prototype.onColumnsChanged=function(){var r=this,i=[];this.allColumnFilters.forEach(function(n,u){!(n.column.isPrimary()?r.columnModel.getPrimaryColumn(u):r.columnModel.getGridColumn(u))&&(i.push(n.column),r.disposeFilterWrapper(n,"columnChanged"))}),i.length>0?this.onFilterChanged({columns:i}):this.updateDependantFilters()},t.prototype.updateDependantFilters=function(){var r=this;this.columnModel.getGroupAutoColumns()?.forEach(function(n){"agGroupColumnFilter"===n.getColDef().filter&&r.getOrCreateFilterWrapper(n,"NO_UI")})},t.prototype.isFilterAllowed=function(r){var i,n;return!!r.isFilterAllowed()&&(null===(n=null===(i=this.allColumnFilters.get(r.getColId())?.filterPromise)||void 0===i?void 0:i.resolveNow(!0,function(v){var m,C;return"function"!=typeof(null===(m=v)||void 0===m?void 0:m.isFilterAllowed)||(null===(C=v)||void 0===C?void 0:C.isFilterAllowed())}))||void 0===n||n)},t.prototype.getFloatingFilterCompDetails=function(r,i){var n=this,u=r.getColDef(),c=this.createFilterParams(r,u),v=this.userComponentFactory.mergeParamsWithApplicationProvidedParams(u,Tc,c),m=this.userComponentFactory.getDefaultFloatingFilterType(u);null==m&&(m="agReadOnlyFloatingFilter");var _={column:r,filterParams:v,currentParentModel:function(){return n.getCurrentFloatingFilterParentModel(r)},parentFilterInstance:function(O){n.getFilterComponent(r,"NO_UI")?.then(function(L){O(Io(L))})},showParentFilter:i,suppressFilterButton:!1};return this.userComponentFactory.getFloatingFilterCompDetails(u,_,m)},t.prototype.getCurrentFloatingFilterParentModel=function(r){var i=this.getFilterComponent(r,"NO_UI",!1);return i?i.resolveNow(null,function(n){return n&&n.getModel()}):null},t.prototype.destroyFilter=function(r,i){void 0===i&&(i="api");var n=this.allColumnFilters.get(r.getColId());n&&(this.disposeFilterWrapper(n,i),this.onFilterChanged({columns:[r]}))},t.prototype.disposeFilterWrapper=function(r,i){var n=this;r.filterPromise.then(function(u){(u.setModel(null)||ir.resolve()).then(function(){n.getContext().destroyBean(u),r.column.setFilterActive(!1,"filterDestroyed"),n.allColumnFilters.delete(r.column.getColId());var c={type:I.EVENT_FILTER_DESTROYED,source:i,column:r.column};n.eventService.dispatchEvent(c)})})},t.prototype.destroy=function(){var r=this;o.prototype.destroy.call(this),this.allColumnFilters.forEach(function(i){return r.disposeFilterWrapper(i,"gridDestroyed")})},t.QUICK_FILTER_SEPARATOR="\n",Mo([D("valueService")],t.prototype,"valueService",void 0),Mo([D("columnModel")],t.prototype,"columnModel",void 0),Mo([D("rowModel")],t.prototype,"rowModel",void 0),Mo([D("userComponentFactory")],t.prototype,"userComponentFactory",void 0),Mo([D("rowRenderer")],t.prototype,"rowRenderer",void 0),Mo([Re],t.prototype,"init",null),t=e=Mo([He("filterManager")],t)}(we),ag=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Oc=function(o){function t(e,r){var i=o.call(this,e)||this;return i.ctrl=r,i}return ag(t,o),t.prototype.getCtrl=function(){return this.ctrl},t}(Ue),$p=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Gl=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},lg=function(o){function t(e){return o.call(this,t.TEMPLATE,e)||this}return $p(t,o),t.prototype.postConstruct=function(){var e=this,r=this.getGui(),i={addOrRemoveCssClass:function(n,u){return e.addOrRemoveCssClass(n,u)},addOrRemoveBodyCssClass:function(n,u){return e.eFloatingFilterBody.classList.toggle(n,u)},setButtonWrapperDisplayed:function(n){return Ze(e.eButtonWrapper,n)},setCompDetails:function(n){return e.setCompDetails(n)},getFloatingFilterComp:function(){return e.compPromise},setWidth:function(n){return r.style.width=n},setMenuIcon:function(n){return e.eButtonShowMainFilter.appendChild(n)}};this.ctrl.setComp(i,r,this.eButtonShowMainFilter,this.eFloatingFilterBody)},t.prototype.setCompDetails=function(e){var r=this;this.compPromise=e.newAgStackInstance(),this.compPromise.then(function(i){return r.afterCompCreated(i)})},t.prototype.afterCompCreated=function(e){var r=this;e&&(this.addDestroyFunc(function(){return r.context.destroyBean(e)}),this.isAlive()&&(this.eFloatingFilterBody.appendChild(e.getGui()),e.afterGuiAttached&&e.afterGuiAttached()))},t.TEMPLATE='<div class="ag-header-cell ag-floating-filter" role="gridcell" tabindex="-1">\n            <div ref="eFloatingFilterBody" role="presentation"></div>\n            <div class="ag-floating-filter-button ag-hidden" ref="eButtonWrapper" role="presentation">\n                <button type="button" aria-label="Open Filter Menu" class="ag-floating-filter-button-button" ref="eButtonShowMainFilter" tabindex="-1"></button>\n            </div>\n        </div>',Gl([Te("eFloatingFilterBody")],t.prototype,"eFloatingFilterBody",void 0),Gl([Te("eButtonWrapper")],t.prototype,"eButtonWrapper",void 0),Gl([Te("eButtonShowMainFilter")],t.prototype,"eButtonShowMainFilter",void 0),Gl([Re],t.prototype,"postConstruct",null),t}(Oc),ug=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();!function(o){o.AUTO_HEIGHT="ag-layout-auto-height",o.NORMAL="ag-layout-normal",o.PRINT="ag-layout-print"}(yr||(yr={}));var No,Hl=function(o){function t(e){var r=o.call(this)||this;return r.view=e,r}return ug(t,o),t.prototype.postConstruct=function(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()},t.prototype.updateLayoutClasses=function(){var e=this.getDomLayout(),r={autoHeight:"autoHeight"===e,normal:"normal"===e,print:"print"===e},i=r.autoHeight?yr.AUTO_HEIGHT:r.print?yr.PRINT:yr.NORMAL;this.view.updateLayoutClasses(i,r)},t.prototype.getDomLayout=function(){var e,r=null!==(e=this.gridOptionsService.get("domLayout"))&&void 0!==e?e:"normal";return-1===["normal","print","autoHeight"].indexOf(r)?(_t(function(){return console.warn("AG Grid: "+r+" is not valid for DOM Layout, valid values are 'normal', 'autoHeight', 'print'.")},"warn about dom layout values"),"normal"):r},function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);i>3&&n&&Object.defineProperty(t,e,n)}([Re],t.prototype,"postConstruct",null),t}(we),fg=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Bl=function(){return Bl=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},Bl.apply(this,arguments)},so=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},pg=function(o){function t(e){var r=o.call(this)||this;return r.scrollLeft=-1,r.nextScrollTop=-1,r.scrollTop=-1,r.eBodyViewport=e,r.resetLastHScrollDebounced=Jr(function(){return r.eLastHScroll=null},500),r.resetLastVScrollDebounced=Jr(function(){return r.eLastVScroll=null},500),r}return fg(t,o),t.prototype.postConstruct=function(){var e=this;this.enableRtl=this.gridOptionsService.is("enableRtl"),this.addManagedListener(this.eventService,I.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this)),this.ctrlsService.whenReady(function(r){e.centerRowContainerCtrl=r.centerRowContainerCtrl,e.onDisplayedColumnsWidthChanged(),e.addScrollListener()})},t.prototype.addScrollListener=function(){var e=this.ctrlsService.getFakeHScrollComp(),r=this.ctrlsService.getFakeVScrollComp();this.addManagedListener(this.centerRowContainerCtrl.getViewportElement(),"scroll",this.onHScroll.bind(this)),this.addManagedListener(e.getViewport(),"scroll",this.onFakeHScroll.bind(this));var i=this.gridOptionsService.is("debounceVerticalScrollbar"),n=i?Jr(this.onVScroll.bind(this),100):this.onVScroll.bind(this),u=i?Jr(this.onFakeVScroll.bind(this),100):this.onFakeVScroll.bind(this);this.addManagedListener(this.eBodyViewport,"scroll",n),this.addManagedListener(r.getViewport(),"scroll",u)},t.prototype.onDisplayedColumnsWidthChanged=function(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()},t.prototype.horizontallyScrollHeaderCenterAndFloatingCenter=function(e){if(!(null==this.centerRowContainerCtrl)){void 0===e&&(e=this.centerRowContainerCtrl.getCenterViewportScrollLeft());var i=this.enableRtl?e:-e,n=this.ctrlsService.getTopCenterRowContainerCtrl(),u=this.ctrlsService.getStickyTopCenterRowContainerCtrl(),c=this.ctrlsService.getBottomCenterRowContainerCtrl(),v=this.ctrlsService.getFakeHScrollComp();this.ctrlsService.getHeaderRowContainerCtrl().setHorizontalScroll(-i),c.setContainerTranslateX(i),n.setContainerTranslateX(i),u.setContainerTranslateX(i);var C=this.centerRowContainerCtrl.getViewportElement();li(this.eLastHScroll===C?v.getViewport():this.centerRowContainerCtrl.getViewportElement(),Math.abs(e),this.enableRtl)}},t.prototype.isControllingHScroll=function(e){return this.eLastHScroll?e===this.eLastHScroll:(this.eLastHScroll=e,!0)},t.prototype.isControllingVScroll=function(e){return this.eLastVScroll?e===this.eLastVScroll:(this.eLastVScroll=e,!0)},t.prototype.onFakeHScroll=function(){var e=this.ctrlsService.getFakeHScrollComp().getViewport();this.isControllingHScroll(e)&&this.onHScrollCommon(e)},t.prototype.onHScroll=function(){var e=this.centerRowContainerCtrl.getViewportElement();this.isControllingHScroll(e)&&this.onHScrollCommon(e)},t.prototype.onHScrollCommon=function(e){var i=this.centerRowContainerCtrl.getViewportElement().scrollLeft;this.shouldBlockScrollUpdate("horizontal",i,!0)||(this.doHorizontalScroll(Math.round(Xs(e,this.enableRtl))),this.resetLastHScrollDebounced())},t.prototype.onFakeVScroll=function(){var e=this.ctrlsService.getFakeVScrollComp().getViewport();this.isControllingVScroll(e)&&this.onVScrollCommon(e)},t.prototype.onVScroll=function(){this.isControllingVScroll(this.eBodyViewport)&&this.onVScrollCommon(this.eBodyViewport)},t.prototype.onVScrollCommon=function(e){var r=e.scrollTop;if(!this.shouldBlockScrollUpdate("vertical",r,!0)){if(this.animationFrameService.setScrollTop(r),this.nextScrollTop=r,e===this.eBodyViewport)this.ctrlsService.getFakeVScrollComp().getViewport().scrollTop=r;else this.eBodyViewport.scrollTop=r;this.gridOptionsService.is("suppressAnimationFrame")?this.scrollGridIfNeeded():this.animationFrameService.schedule(),this.resetLastVScrollDebounced()}},t.prototype.doHorizontalScroll=function(e){var i=Xs(this.ctrlsService.getFakeHScrollComp().getViewport(),this.enableRtl);this.scrollLeft===e&&e===i||(this.scrollLeft=e,this.fireScrollEvent("horizontal"),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.onHorizontalViewportChanged())},t.prototype.fireScrollEvent=function(e){var r=this,i={type:I.EVENT_BODY_SCROLL,direction:e,left:this.scrollLeft,top:this.scrollTop};this.eventService.dispatchEvent(i),window.clearTimeout(this.scrollTimer),this.scrollTimer=void 0,this.scrollTimer=window.setTimeout(function(){var n=Bl(Bl({},i),{type:I.EVENT_BODY_SCROLL_END});r.eventService.dispatchEvent(n)},100)},t.prototype.shouldBlockScrollUpdate=function(e,r,i){return void 0===i&&(i=!1),!(i&&!on())&&("vertical"===e?this.shouldBlockVerticalScroll(r):this.shouldBlockHorizontalScroll(r))},t.prototype.shouldBlockVerticalScroll=function(e){var r=as(this.eBodyViewport),i=this.eBodyViewport.scrollHeight;return e<0||e+r>i},t.prototype.shouldBlockHorizontalScroll=function(e){var r=this.centerRowContainerCtrl.getCenterWidth(),i=this.centerRowContainerCtrl.getViewportElement().scrollWidth;if(this.enableRtl&&cn()){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+r>i},t.prototype.redrawRowsAfterScroll=function(){this.fireScrollEvent("vertical")},t.prototype.onHorizontalViewportChanged=function(){this.centerRowContainerCtrl.onHorizontalViewportChanged()},t.prototype.checkScrollLeft=function(){this.scrollLeft!==this.centerRowContainerCtrl.getCenterViewportScrollLeft()&&this.onHScrollCommon(this.centerRowContainerCtrl.getViewportElement())},t.prototype.scrollGridIfNeeded=function(){var e=this.scrollTop!=this.nextScrollTop;return e&&(this.scrollTop=this.nextScrollTop,this.redrawRowsAfterScroll()),e},t.prototype.setHorizontalScrollPosition=function(e){var i=this.centerRowContainerCtrl.getViewportElement().scrollWidth-this.centerRowContainerCtrl.getCenterWidth();this.shouldBlockScrollUpdate("horizontal",e)&&(e=this.enableRtl&&cn()?e>0?0:i:Math.min(Math.max(e,0),i)),li(this.centerRowContainerCtrl.getViewportElement(),Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)},t.prototype.setVerticalScrollPosition=function(e){this.eBodyViewport.scrollTop=e},t.prototype.getVScrollPosition=function(){return{top:this.eBodyViewport.scrollTop,bottom:this.eBodyViewport.scrollTop+this.eBodyViewport.offsetHeight}},t.prototype.getHScrollPosition=function(){return this.centerRowContainerCtrl.getHScrollPosition()},t.prototype.isHorizontalScrollShowing=function(){return this.centerRowContainerCtrl.isHorizontalScrollShowing()},t.prototype.scrollHorizontally=function(e){var r=this.centerRowContainerCtrl.getViewportElement().scrollLeft;return this.setHorizontalScrollPosition(r+e),this.centerRowContainerCtrl.getViewportElement().scrollLeft-r},t.prototype.scrollToTop=function(){this.eBodyViewport.scrollTop=0},t.prototype.ensureNodeVisible=function(e,r){void 0===r&&(r=null);for(var i=this.rowModel.getRowCount(),n=-1,u=0;u<i;u++){var c=this.rowModel.getRow(u);if("function"==typeof e){if(c&&e(c)){n=u;break}}else if(e===c||e===c.data){n=u;break}}n>=0&&this.ensureIndexVisible(n,r)},t.prototype.ensureIndexVisible=function(e,r){if(!this.gridOptionsService.isDomLayout("print")){var i=this.paginationProxy.getRowCount();if("number"!=typeof e||e<0||e>=i)return void console.warn("AG Grid: Invalid row index for ensureIndexVisible: "+e);this.gridOptionsService.is("pagination")&&!this.gridOptionsService.is("suppressPaginationPanel")||this.paginationProxy.goToPageWithIndex(e);var C,v=this.ctrlsService.getGridBodyCtrl().getStickyTopHeight(),m=this.paginationProxy.getRow(e);do{var _=m.rowTop,O=m.rowHeight,P=this.paginationProxy.getPixelOffset(),L=m.rowTop-P,z=L+m.rowHeight,q=this.getVScrollPosition(),Z=this.heightScaler.getDivStretchOffset(),re=q.top+Z,pe=q.bottom+Z,Ce=pe-re,be=this.heightScaler.getScrollPositionForPixel(L),qe=this.heightScaler.getScrollPositionForPixel(z-Ce),et=Math.min((be+qe)/2,L),nt=null;"top"===r?nt=be:"bottom"===r?nt=qe:"middle"===r?nt=et:re+v>L?nt=be-v:pe<z&&(nt=qe),null!==nt&&(this.eBodyViewport.scrollTop=nt,this.rowRenderer.redrawAfterScroll()),C=_!==m.rowTop||O!==m.rowHeight}while(C);this.animationFrameService.flushAllFrames()}},t.prototype.ensureColumnVisible=function(e,r){void 0===r&&(r="auto");var i=this.columnModel.getGridColumn(e);if(i&&!i.isPinned()&&this.columnModel.isColumnDisplayed(i)){var n=this.getPositionedHorizontalScroll(i,r);null!==n&&this.centerRowContainerCtrl.setCenterViewportScrollLeft(n),this.centerRowContainerCtrl.onHorizontalViewportChanged(),this.animationFrameService.flushAllFrames()}},t.prototype.getPositionedHorizontalScroll=function(e,r){var i=this.isColumnOutsideViewport(e),n=i.columnBeforeStart,u=i.columnAfterEnd,c=this.centerRowContainerCtrl.getCenterWidth()<e.getActualWidth(),v=this.centerRowContainerCtrl.getCenterWidth(),m=this.enableRtl,C=(m?n:u)||c,_=m?u:n;"auto"!==r&&(C="start"===r,_="end"===r);var O="middle"===r;if(C||_||O){var P=this.getColumnBounds(e),L=P.colLeft,z=P.colMiddle,q=P.colRight;return O?z-v/2:C?m?q:L:m?L-v:q-v}return null},t.prototype.isColumnOutsideViewport=function(e){var r=this.getViewportBounds(),i=r.start,n=r.end,u=this.getColumnBounds(e),c=u.colLeft,v=u.colRight,m=this.enableRtl;return{columnBeforeStart:m?i>v:n<v,columnAfterEnd:m?n<c:i>c}},t.prototype.getColumnBounds=function(e){var r=this.enableRtl,i=this.columnModel.getBodyContainerWidth(),n=e.getActualWidth(),u=e.getLeft(),c=r?-1:1,v=r?i-u:u;return{colLeft:v,colMiddle:v+n/2*c,colRight:v+n*c}},t.prototype.getViewportBounds=function(){var e=this.centerRowContainerCtrl.getCenterWidth(),r=this.centerRowContainerCtrl.getCenterViewportScrollLeft();return{start:r,end:e+r,width:e}},so([D("ctrlsService")],t.prototype,"ctrlsService",void 0),so([D("animationFrameService")],t.prototype,"animationFrameService",void 0),so([D("paginationProxy")],t.prototype,"paginationProxy",void 0),so([D("rowModel")],t.prototype,"rowModel",void 0),so([D("rowContainerHeightService")],t.prototype,"heightScaler",void 0),so([D("rowRenderer")],t.prototype,"rowRenderer",void 0),so([D("columnModel")],t.prototype,"columnModel",void 0),so([Re],t.prototype,"postConstruct",null),t}(we),dg=function(){function o(t){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=t.scrollContainer,this.scrollHorizontally=-1!==t.scrollAxis.indexOf("x"),this.scrollVertically=-1!==t.scrollAxis.indexOf("y"),this.scrollByTick=null!=t.scrollByTick?t.scrollByTick:20,t.onScrollCallback&&(this.onScrollCallback=t.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=t.getVerticalPosition,this.setVerticalPosition=t.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=t.getHorizontalPosition,this.setHorizontalPosition=t.setHorizontalPosition),this.shouldSkipVerticalScroll=t.shouldSkipVerticalScroll||function(){return!1},this.shouldSkipHorizontalScroll=t.shouldSkipHorizontalScroll||function(){return!1}}return o.prototype.check=function(t,e){void 0===e&&(e=!1);var r=e||this.shouldSkipVerticalScroll();if(!r||!this.shouldSkipHorizontalScroll()){var i=this.scrollContainer.getBoundingClientRect(),n=this.scrollByTick;this.tickLeft=t.clientX<i.left+n,this.tickRight=t.clientX>i.right-n,this.tickUp=t.clientY<i.top+n&&!r,this.tickDown=t.clientY>i.bottom-n&&!r,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}},o.prototype.ensureTickingStarted=function(){null===this.tickingInterval&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)},o.prototype.doTick=function(){var t;if(this.tickCount++,t=this.tickCount>20?200:this.tickCount>10?80:40,this.scrollVertically){var e=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(e-t),this.tickDown&&this.setVerticalPosition(e+t)}if(this.scrollHorizontally){var r=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(r-t),this.tickRight&&this.setHorizontalPosition(r+t)}this.onScrollCallback&&this.onScrollCallback()},o.prototype.ensureCleared=function(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)},o}(),Yp=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Yi=function(){return Yi=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},Yi.apply(this,arguments)},Ii=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},hg=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},gg=function(o){function t(e){var r=o.call(this)||this;return r.isMultiRowDrag=!1,r.isGridSorted=!1,r.isGridFiltered=!1,r.isRowGroupActive=!1,r.eContainer=e,r}return Yp(t,o),t.prototype.postConstruct=function(){var e=this;this.gridOptionsService.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel);var r=function(){e.onSortChanged(),e.onFilterChanged(),e.onRowGroupChanged()};this.addManagedListener(this.eventService,I.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_MODEL_UPDATED,function(){r()}),r(),this.ctrlsService.whenReady(function(){var i=e.ctrlsService.getGridBodyCtrl();e.autoScrollService=new dg({scrollContainer:i.getBodyViewportElement(),scrollAxis:"y",getVerticalPosition:function(){return i.getScrollFeature().getVScrollPosition().top},setVerticalPosition:function(n){return i.getScrollFeature().setVerticalScrollPosition(n)},onScrollCallback:function(){e.onDragging(e.lastDraggingEvent)}})})},t.prototype.onSortChanged=function(){this.isGridSorted=this.sortController.isSortActive()},t.prototype.onFilterChanged=function(){this.isGridFiltered=this.filterManager.isAnyFilterPresent()},t.prototype.onRowGroupChanged=function(){var e=this.columnModel.getRowGroupColumns();this.isRowGroupActive=!Ve(e)},t.prototype.getContainer=function(){return this.eContainer},t.prototype.isInterestedIn=function(e){return e===ni.RowDrag},t.prototype.getIconName=function(){return this.gridOptionsService.is("rowDragManaged")&&this.shouldPreventRowMove()?Vr.ICON_NOT_ALLOWED:Vr.ICON_MOVE},t.prototype.shouldPreventRowMove=function(){return this.isGridSorted||this.isGridFiltered||this.isRowGroupActive},t.prototype.getRowNodes=function(e){var r=this;if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];var i=this.gridOptionsService.is("rowDragMultiRow"),n=function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(hg(arguments[t]));return o}(this.selectionService.getSelectedNodes()).sort(function(c,v){return null==c.rowIndex||null==v.rowIndex?0:r.getRowIndexNumber(c)-r.getRowIndexNumber(v)}),u=e.dragItem.rowNode;return i&&-1!==n.indexOf(u)?(this.isMultiRowDrag=!0,n):(this.isMultiRowDrag=!1,[u])},t.prototype.onDragEnter=function(e){e.dragItem.rowNodes=this.getRowNodes(e),this.dispatchGridEvent(I.EVENT_ROW_DRAG_ENTER,e),this.getRowNodes(e).forEach(function(r){r.setDragging(!0)}),this.onEnterOrDragging(e)},t.prototype.onDragging=function(e){this.onEnterOrDragging(e)},t.prototype.isFromThisGrid=function(e){return e.dragSource.dragSourceDomDataKey===this.gridOptionsService.getDomDataKey()},t.prototype.isDropZoneWithinThisGrid=function(e){var i=this.ctrlsService.getGridBodyCtrl().getGui(),n=e.dropZoneTarget;return!i.contains(n)},t.prototype.onEnterOrDragging=function(e){this.dispatchGridEvent(I.EVENT_ROW_DRAG_MOVE,e),this.lastDraggingEvent=e;var r=this.mouseEventService.getNormalisedPosition(e).y;this.gridOptionsService.is("rowDragManaged")&&this.doManagedDrag(e,r),this.autoScrollService.check(e.event)},t.prototype.doManagedDrag=function(e,r){var i=this.isFromThisGrid(e),n=this.gridOptionsService.is("rowDragManaged"),u=e.dragItem.rowNodes;n&&this.shouldPreventRowMove()||(this.gridOptionsService.is("suppressMoveWhenRowDragging")||!i?this.isDropZoneWithinThisGrid(e)||this.clientSideRowModel.highlightRowAtPixel(u[0],r):this.moveRows(u,r))},t.prototype.getRowIndexNumber=function(e){return parseInt(Mt(e.getRowIndexString().split("-")),10)},t.prototype.moveRowAndClearHighlight=function(e){var r=this,i=this.clientSideRowModel.getLastHighlightedRowNode(),n=i&&i.highlighted===hn.Below,u=this.mouseEventService.getNormalisedPosition(e).y,c=e.dragItem.rowNodes,v=n?1:0;if(this.isFromThisGrid(e))c.forEach(function(_){_.rowTop<u&&(v-=1)}),this.moveRows(c,u,v);else{var m=this.gridOptionsService.getRowIdFunc(),C=this.clientSideRowModel.getRowIndexAtPixel(u)+1;this.clientSideRowModel.getHighlightPosition(u)===hn.Above&&C--,this.clientSideRowModel.updateRowData({add:c.map(function(_){return _.data}).filter(function(_){return!r.clientSideRowModel.getRowNode(m?m({data:_,level:0}):_.id)}),addIndex:C})}this.clearRowHighlight()},t.prototype.clearRowHighlight=function(){this.clientSideRowModel.highlightRowAtPixel(null)},t.prototype.moveRows=function(e,r,i){void 0===i&&(i=0),this.clientSideRowModel.ensureRowsAtPixel(e,r,i)&&(this.focusService.clearFocusedCell(),this.rangeService&&this.rangeService.removeAllCellRanges())},t.prototype.addRowDropZone=function(e){var r=this;if(e.getContainer())if(this.dragAndDropService.findExternalZone(e))console.warn("AG Grid: addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.");else{var i={getContainer:e.getContainer};e.fromGrid?(e.fromGrid=void 0,i=e):(e.onDragEnter&&(i.onDragEnter=function(n){e.onDragEnter(r.draggingToRowDragEvent(I.EVENT_ROW_DRAG_ENTER,n))}),e.onDragLeave&&(i.onDragLeave=function(n){e.onDragLeave(r.draggingToRowDragEvent(I.EVENT_ROW_DRAG_LEAVE,n))}),e.onDragging&&(i.onDragging=function(n){e.onDragging(r.draggingToRowDragEvent(I.EVENT_ROW_DRAG_MOVE,n))}),e.onDragStop&&(i.onDragStop=function(n){e.onDragStop(r.draggingToRowDragEvent(I.EVENT_ROW_DRAG_END,n))})),this.dragAndDropService.addDropTarget(Yi({isInterestedIn:function(n){return n===ni.RowDrag},getIconName:function(){return Vr.ICON_MOVE},external:!0},i))}else _t(function(){return console.warn("AG Grid: addRowDropZone - A container target needs to be provided")},"add-drop-zone-empty-target")},t.prototype.getRowDropZone=function(e){var r=this,i=this.getContainer.bind(this),n=this.onDragEnter.bind(this),u=this.onDragLeave.bind(this),c=this.onDragging.bind(this),v=this.onDragStop.bind(this);return e?{getContainer:i,onDragEnter:e.onDragEnter?function(m){n(m),e.onDragEnter(r.draggingToRowDragEvent(I.EVENT_ROW_DRAG_ENTER,m))}:n,onDragLeave:e.onDragLeave?function(m){u(m),e.onDragLeave(r.draggingToRowDragEvent(I.EVENT_ROW_DRAG_LEAVE,m))}:u,onDragging:e.onDragging?function(m){c(m),e.onDragging(r.draggingToRowDragEvent(I.EVENT_ROW_DRAG_MOVE,m))}:c,onDragStop:e.onDragStop?function(m){v(m),e.onDragStop(r.draggingToRowDragEvent(I.EVENT_ROW_DRAG_END,m))}:v,fromGrid:!0}:{getContainer:i,onDragEnter:n,onDragLeave:u,onDragging:c,onDragStop:v,fromGrid:!0}},t.prototype.draggingToRowDragEvent=function(e,r){var c,v,i=this.mouseEventService.getNormalisedPosition(r).y,u=-1;switch(i>this.paginationProxy.getCurrentPageHeight()||(u=this.rowModel.getRowIndexAtPixel(i),c=this.rowModel.getRow(u)),r.vDirection){case Po.Down:v="down";break;case Po.Up:v="up";break;default:v=null}return{type:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,event:r.event,node:r.dragItem.rowNode,nodes:r.dragItem.rowNodes,overIndex:u,overNode:c,y:i,vDirection:v}},t.prototype.dispatchGridEvent=function(e,r){var i=this.draggingToRowDragEvent(e,r);this.eventService.dispatchEvent(i)},t.prototype.onDragLeave=function(e){this.dispatchGridEvent(I.EVENT_ROW_DRAG_LEAVE,e),this.stopDragging(e),this.gridOptionsService.is("rowDragManaged")&&this.clearRowHighlight(),this.isFromThisGrid(e)&&(this.isMultiRowDrag=!1)},t.prototype.onDragStop=function(e){this.dispatchGridEvent(I.EVENT_ROW_DRAG_END,e),this.stopDragging(e),this.gridOptionsService.is("rowDragManaged")&&(this.gridOptionsService.is("suppressMoveWhenRowDragging")||!this.isFromThisGrid(e))&&!this.isDropZoneWithinThisGrid(e)&&this.moveRowAndClearHighlight(e)},t.prototype.stopDragging=function(e){this.autoScrollService.ensureCleared(),this.getRowNodes(e).forEach(function(r){r.setDragging(!1)})},Ii([D("dragAndDropService")],t.prototype,"dragAndDropService",void 0),Ii([D("rowModel")],t.prototype,"rowModel",void 0),Ii([D("paginationProxy")],t.prototype,"paginationProxy",void 0),Ii([D("columnModel")],t.prototype,"columnModel",void 0),Ii([D("focusService")],t.prototype,"focusService",void 0),Ii([D("sortController")],t.prototype,"sortController",void 0),Ii([D("filterManager")],t.prototype,"filterManager",void 0),Ii([D("selectionService")],t.prototype,"selectionService",void 0),Ii([D("mouseEventService")],t.prototype,"mouseEventService",void 0),Ii([D("ctrlsService")],t.prototype,"ctrlsService",void 0),Ii([Ft("rangeService")],t.prototype,"rangeService",void 0),Ii([Re],t.prototype,"postConstruct",null),t}(we),mg=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Li=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n};!function(o){o.ANIMATION_ON="ag-row-animation",o.ANIMATION_OFF="ag-row-no-animation"}(No||(No={}));var Vl,Ss,Ac="ag-selectable",Xp="ag-force-vertical-scroll",Cg=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.stickyTopHeight=0,e}return mg(t,o),t.prototype.getScrollFeature=function(){return this.bodyScrollFeature},t.prototype.getBodyViewportElement=function(){return this.eBodyViewport},t.prototype.setComp=function(e,r,i,n,u,c){this.comp=e,this.eGridBody=r,this.eBodyViewport=i,this.eTop=n,this.eBottom=u,this.eStickyTop=c,this.setCellTextSelection(this.gridOptionsService.is("enableCellTextSelection")),this.createManagedBean(new Hl(this.comp)),this.bodyScrollFeature=this.createManagedBean(new pg(this.eBodyViewport)),this.addRowDragListener(),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([n,i,u,c]),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.ctrlsService.registerGridBodyCtrl(this)},t.prototype.getComp=function(){return this.comp},t.prototype.addEventListeners=function(){this.addManagedListener(this.eventService,I.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))},t.prototype.addFocusListeners=function(e){var r=this;e.forEach(function(i){r.addManagedListener(i,"focusin",function(n){var c=lt(n.target,"ag-root",i);i.classList.toggle("ag-has-focus",!c)}),r.addManagedListener(i,"focusout",function(n){var u=n.target,c=n.relatedTarget,v=i.contains(c),m=lt(c,"ag-root",i);lt(u,"ag-root",i)||(!v||m)&&i.classList.remove("ag-has-focus")})})},t.prototype.setColumnMovingCss=function(e){this.comp.setColumnMovingCss("ag-column-moving",e)},t.prototype.setCellTextSelection=function(e){void 0===e&&(e=!1);var r=e?Ac:null;this.comp.setCellSelectableCss(r,e)},t.prototype.onScrollVisibilityChanged=function(){var e=this.scrollVisibleService.isVerticalScrollShowing();this.setVerticalScrollPaddingVisible(e),this.setStickyTopWidth(e);var n="calc(100% + "+((e&&this.gridOptionsService.getScrollbarWidth()||0)+(an()?16:0))+"px)";this.comp.setBodyViewportWidth(n)},t.prototype.onGridColumnsChanged=function(){var e=this.columnModel.getAllGridColumns();this.comp.setColumnCount(e?e.length:0)},t.prototype.disableBrowserDragging=function(){this.addManagedListener(this.eGridBody,"dragstart",function(e){if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1})},t.prototype.addStopEditingWhenGridLosesFocus=function(){var e=this;if(this.gridOptionsService.is("stopEditingWhenCellsLoseFocus")){var r=function(n){var u=n.relatedTarget;if(null!==Pn(u)){var c=i.some(function(m){return m.contains(u)})&&e.mouseEventService.isElementInThisGrid(u);if(!c){var v=e.popupService;c=v.getActivePopups().some(function(m){return m.contains(u)})||v.isElementWithinCustomPopup(u)}c||e.rowRenderer.stopEditing()}else e.rowRenderer.stopEditing()},i=[this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop];i.forEach(function(n){return e.addManagedListener(n,"focusout",r)})}},t.prototype.updateRowCount=function(){var e=this.headerNavigationService.getHeaderRowCount(),r=this.rowModel.isLastRowIndexKnown()?this.rowModel.getRowCount():-1,i=-1===r?-1:e+r;this.comp.setRowCount(i)},t.prototype.registerBodyViewportResizeListener=function(e){this.comp.registerBodyViewportResizeListener(e)},t.prototype.setVerticalScrollPaddingVisible=function(e){var r=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(r)},t.prototype.isVerticalScrollShowing=function(){var e=this.gridOptionsService.is("alwaysShowVerticalScroll"),r=e?Xp:null,i=this.gridOptionsService.isDomLayout("normal");return this.comp.setAlwaysVerticalScrollClass(r,e),e||i&&qs(this.eBodyViewport)},t.prototype.setupRowAnimationCssClass=function(){var e=this,r=function(){var i=e.gridOptionsService.isAnimateRows()&&!e.rowContainerHeightService.isStretching(),n=i?No.ANIMATION_ON:No.ANIMATION_OFF;e.comp.setRowAnimationCssOnBodyViewport(n,i)};r(),this.addManagedListener(this.eventService,I.EVENT_HEIGHT_SCALE_CHANGED,r),this.addManagedPropertyListener("animateRows",r)},t.prototype.getGridBodyElement=function(){return this.eGridBody},t.prototype.addBodyViewportListener=function(){var e=this.onBodyViewportContextMenu.bind(this);this.addManagedListener(this.eBodyViewport,"contextmenu",e),this.mockContextMenuForIPad(e),this.addManagedListener(this.eBodyViewport,"wheel",this.onBodyViewportWheel.bind(this)),this.addManagedListener(this.eStickyTop,"wheel",this.onStickyTopWheel.bind(this)),this.addFullWidthContainerWheelListener()},t.prototype.addFullWidthContainerWheelListener=function(){var e=this,r=this.eBodyViewport.querySelector(".ag-full-width-container"),i=this.eBodyViewport.querySelector(".ag-center-cols-viewport");r&&i&&this.addManagedListener(r,"wheel",function(n){return e.onFullWidthContainerWheel(n,i)})},t.prototype.onFullWidthContainerWheel=function(e,r){!e.deltaX||Math.abs(e.deltaY)>Math.abs(e.deltaX)||(e.preventDefault(),r.scrollBy({left:e.deltaX}))},t.prototype.onBodyViewportContextMenu=function(e,r,i){if(e||i){if(this.gridOptionsService.is("preventDefaultOnContextMenu"))(e||i).preventDefault();var u=(e||r).target;if(u===this.eBodyViewport||u===this.ctrlsService.getCenterRowContainerCtrl().getViewportElement()){if(!this.contextMenuFactory)return;e?this.contextMenuFactory.onContextMenu(e,null,null,null,null,this.eGridBody):i&&this.contextMenuFactory.onContextMenu(null,i,null,null,null,this.eGridBody)}}},t.prototype.mockContextMenuForIPad=function(e){if(on()){var r=new Ut(this.eBodyViewport);this.addManagedListener(r,Ut.EVENT_LONG_TAP,function(n){e(void 0,n.touchStart,n.touchEvent)}),this.addDestroyFunc(function(){return r.destroy()})}},t.prototype.onBodyViewportWheel=function(e){this.gridOptionsService.is("suppressScrollWhenPopupsAreOpen")&&this.popupService.hasAnchoredPopup()&&e.preventDefault()},t.prototype.onStickyTopWheel=function(e){e.preventDefault(),e.offsetY&&this.scrollVertically(e.deltaY)},t.prototype.getGui=function(){return this.eGridBody},t.prototype.scrollVertically=function(e){var r=this.eBodyViewport.scrollTop;return this.bodyScrollFeature.setVerticalScrollPosition(r+e),this.eBodyViewport.scrollTop-r},t.prototype.addRowDragListener=function(){this.rowDragFeature=this.createManagedBean(new gg(this.eBodyViewport)),this.dragAndDropService.addDropTarget(this.rowDragFeature)},t.prototype.getRowDragFeature=function(){return this.rowDragFeature},t.prototype.onPinnedRowDataChanged=function(){this.setFloatingHeights()},t.prototype.setFloatingHeights=function(){var e=this.pinnedRowModel,r=e.getPinnedTopTotalHeight();r&&(r+=1);var i=e.getPinnedBottomTotalHeight();i&&(i+=1),this.comp.setTopHeight(r),this.comp.setBottomHeight(i),this.comp.setTopDisplay(r?"inherit":"none"),this.comp.setBottomDisplay(i?"inherit":"none"),this.setStickyTopOffsetTop()},t.prototype.setStickyTopHeight=function(e){void 0===e&&(e=0),this.comp.setStickyTopHeight(e+"px"),this.stickyTopHeight=e},t.prototype.getStickyTopHeight=function(){return this.stickyTopHeight},t.prototype.setStickyTopWidth=function(e){if(e){var r=this.gridOptionsService.getScrollbarWidth();this.comp.setStickyTopWidth("calc(100% - "+r+"px)")}else this.comp.setStickyTopWidth("100%")},t.prototype.onHeaderHeightChanged=function(){this.setStickyTopOffsetTop()},t.prototype.setStickyTopOffsetTop=function(){var r=this.ctrlsService.getGridHeaderCtrl().getHeaderHeight(),i=this.pinnedRowModel.getPinnedTopTotalHeight(),n=0;r>0&&(n+=r+1),i>0&&(n+=i+1),this.comp.setStickyTopTop(n+"px")},t.prototype.sizeColumnsToFit=function(e,r){var i=this,u=this.isVerticalScrollShowing()?this.gridOptionsService.getScrollbarWidth():0,v=Ei(this.eGridBody)-u;v>0?this.columnModel.sizeColumnsToFit(v,"sizeColumnsToFit",!1,e):void 0===r?window.setTimeout(function(){i.sizeColumnsToFit(e,100)},0):100===r?window.setTimeout(function(){i.sizeColumnsToFit(e,500)},100):500===r?window.setTimeout(function(){i.sizeColumnsToFit(e,-1)},500):console.warn("AG Grid: tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?")},t.prototype.addScrollEventListener=function(e){this.eBodyViewport.addEventListener("scroll",e,{passive:!0})},t.prototype.removeScrollEventListener=function(e){this.eBodyViewport.removeEventListener("scroll",e)},Li([D("rowContainerHeightService")],t.prototype,"rowContainerHeightService",void 0),Li([D("ctrlsService")],t.prototype,"ctrlsService",void 0),Li([D("columnModel")],t.prototype,"columnModel",void 0),Li([D("scrollVisibleService")],t.prototype,"scrollVisibleService",void 0),Li([Ft("contextMenuFactory")],t.prototype,"contextMenuFactory",void 0),Li([D("headerNavigationService")],t.prototype,"headerNavigationService",void 0),Li([D("dragAndDropService")],t.prototype,"dragAndDropService",void 0),Li([D("pinnedRowModel")],t.prototype,"pinnedRowModel",void 0),Li([D("rowRenderer")],t.prototype,"rowRenderer",void 0),Li([D("popupService")],t.prototype,"popupService",void 0),Li([D("mouseEventService")],t.prototype,"mouseEventService",void 0),Li([D("rowModel")],t.prototype,"rowModel",void 0),t}(we);!function(o){o[o.FILL=0]="FILL",o[o.RANGE=1]="RANGE"}(Vl||(Vl={})),function(o){o[o.VALUE=0]="VALUE",o[o.DIMENSION=1]="DIMENSION"}(Ss||(Ss={}));var di,pa="ag-cell-range-selected",Rg=function(){function o(t,e){this.beans=t,this.cellCtrl=e}return o.prototype.setComp=function(t,e){this.cellComp=t,this.eGui=e,this.onRangeSelectionChanged()},o.prototype.onRangeSelectionChanged=function(){this.cellComp&&(this.rangeCount=this.beans.rangeService.getCellRangeCount(this.cellCtrl.getCellPosition()),this.hasChartRange=this.getHasChartRange(),this.cellComp.addOrRemoveCssClass(pa,0!==this.rangeCount),this.cellComp.addOrRemoveCssClass(pa+"-1",1===this.rangeCount),this.cellComp.addOrRemoveCssClass(pa+"-2",2===this.rangeCount),this.cellComp.addOrRemoveCssClass(pa+"-3",3===this.rangeCount),this.cellComp.addOrRemoveCssClass(pa+"-4",this.rangeCount>=4),this.cellComp.addOrRemoveCssClass("ag-cell-range-chart",this.hasChartRange),_o(this.eGui,this.rangeCount>0||void 0),this.cellComp.addOrRemoveCssClass("ag-cell-range-single-cell",this.isSingleCell()),this.updateRangeBorders(),this.refreshHandle())},o.prototype.updateRangeBorders=function(){var t=this.getRangeBorders(),e=this.isSingleCell(),r=!e&&t.top,i=!e&&t.right,n=!e&&t.bottom,u=!e&&t.left;this.cellComp.addOrRemoveCssClass("ag-cell-range-top",r),this.cellComp.addOrRemoveCssClass("ag-cell-range-right",i),this.cellComp.addOrRemoveCssClass("ag-cell-range-bottom",n),this.cellComp.addOrRemoveCssClass("ag-cell-range-left",u)},o.prototype.isSingleCell=function(){var t=this.beans.rangeService;return 1===this.rangeCount&&t&&!t.isMoreThanOneCell()},o.prototype.getHasChartRange=function(){var t=this.beans.rangeService;if(!this.rangeCount||!t)return!1;var e=t.getCellRanges();return e.length>0&&e.every(function(r){return kr([Ss.DIMENSION,Ss.VALUE],r.type)})},o.prototype.updateRangeBordersIfRangeCount=function(){this.rangeCount>0&&(this.updateRangeBorders(),this.refreshHandle())},o.prototype.getRangeBorders=function(){var _,O,t=this,e=this.beans.gridOptionsService.is("enableRtl"),r=!1,i=!1,n=!1,u=!1,c=this.cellCtrl.getCellPosition().column,v=this.beans,m=v.rangeService,C=v.columnModel;e?(_=C.getDisplayedColAfter(c),O=C.getDisplayedColBefore(c)):(_=C.getDisplayedColBefore(c),O=C.getDisplayedColAfter(c));var P=m.getCellRanges().filter(function(re){return m.isCellInSpecificRange(t.cellCtrl.getCellPosition(),re)});_||(u=!0),O||(i=!0);for(var L=0;L<P.length&&!(r&&i&&n&&u);L++){var z=P[L],q=m.getRangeStartRow(z),Z=m.getRangeEndRow(z);!r&&this.beans.rowPositionUtils.sameRow(q,this.cellCtrl.getCellPosition())&&(r=!0),!n&&this.beans.rowPositionUtils.sameRow(Z,this.cellCtrl.getCellPosition())&&(n=!0),!u&&_&&z.columns.indexOf(_)<0&&(u=!0),!i&&O&&z.columns.indexOf(O)<0&&(i=!0)}return{top:r,right:i,bottom:n,left:u}},o.prototype.refreshHandle=function(){if(this.beans.rangeService){var t=this.shouldHaveSelectionHandle();this.selectionHandle&&!t&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),t&&this.addSelectionHandle(),this.cellComp.addOrRemoveCssClass("ag-cell-range-handle",!!this.selectionHandle)}},o.prototype.shouldHaveSelectionHandle=function(){var t=this.beans,e=t.gridOptionsService,r=t.rangeService,i=r.getCellRanges(),n=i.length;if(this.rangeCount<1||n<1)return!1;var u=Mt(i),c=this.cellCtrl.getCellPosition(),v=e.is("enableFillHandle")&&!this.cellCtrl.isSuppressFillHandle(),m=e.is("enableRangeHandle"),C=1===n&&!this.cellCtrl.isEditing()&&(v||m);if(this.hasChartRange){var O=i[0].type===Ss.DIMENSION&&r.isCellInSpecificRange(c,i[0]);this.cellComp.addOrRemoveCssClass("ag-cell-range-chart-category",O),C=u.type===Ss.VALUE}return C&&null!=u.endRow&&r.isContiguousRange(u)&&r.isBottomRightCell(u,c)},o.prototype.addSelectionHandle=function(){var t=this.beans,e=t.gridOptionsService,i=Mt(t.rangeService.getCellRanges()).type,u=e.is("enableFillHandle")&&Je(i)?Vl.FILL:Vl.RANGE;this.selectionHandle&&this.selectionHandle.getType()!==u&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),this.selectionHandle||(this.selectionHandle=this.beans.selectionHandleFactory.createSelectionHandle(u)),this.selectionHandle.refresh(this.cellCtrl)},o.prototype.destroy=function(){this.beans.context.destroyBean(this.selectionHandle)},o}(),da=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Tg=function(o){function t(e,r){var i=o.call(this)||this;return i.cellCtrl=e,i.beans=r,i.column=e.getColumn(),i.rowNode=e.getRowNode(),i.setupColSpan(),i.setupRowSpan(),i}return da(t,o),t.prototype.setupRowSpan=function(){this.rowSpan=this.column.getRowSpan(this.rowNode)},t.prototype.setComp=function(e){this.eGui=e,this.onLeftChanged(),this.onWidthChanged(),this.applyRowSpan()},t.prototype.onDisplayColumnsChanged=function(){var e=this.getColSpanningList();Xn(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())},t.prototype.setupColSpan=function(){null!=this.column.getColDef().colSpan&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListener(this.beans.eventService,I.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayColumnsChanged.bind(this)),this.addManagedListener(this.beans.eventService,I.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onWidthChanged.bind(this)))},t.prototype.onWidthChanged=function(){if(this.eGui){var e=this.getCellWidth();this.eGui.style.width=e+"px"}},t.prototype.getCellWidth=function(){return this.colsSpanning?this.colsSpanning.reduce(function(e,r){return e+r.getActualWidth()},0):this.column.getActualWidth()},t.prototype.getColSpanningList=function(){var e=this.column.getColSpan(this.rowNode),r=[];if(1===e)r.push(this.column);else for(var i=this.column,n=this.column.getPinned(),u=0;i&&u<e&&(r.push(i),(i=this.beans.columnModel.getDisplayedColAfter(i))&&!Je(i)&&n===i.getPinned());u++);return r},t.prototype.onLeftChanged=function(){if(this.eGui){var e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eGui.style.left=e+"px"}},t.prototype.getCellLeft=function(){return(this.beans.gridOptionsService.is("enableRtl")&&this.colsSpanning?Mt(this.colsSpanning):this.column).getLeft()},t.prototype.modifyLeftForPrintLayout=function(e){if(!this.cellCtrl.isPrintLayout()||"left"===this.column.getPinned())return e;var r=this.beans.columnModel.getDisplayedColumnsLeftWidth();return"right"===this.column.getPinned()?r+this.beans.columnModel.getBodyContainerWidth()+(e||0):r+(e||0)},t.prototype.applyRowSpan=function(){if(1!==this.rowSpan){var r=this.beans.gridOptionsService.getRowHeightAsNumber()*this.rowSpan;this.eGui.style.height=r+"px",this.eGui.style.zIndex="1"}},t.prototype.destroy=function(){o.prototype.destroy.call(this)},t}(we),Og=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Wl=function(o){function t(e,r){var i=o.call(this)||this;return i.staticClasses=[],i.cellCtrl=e,i.beans=r,i.column=e.getColumn(),i.rowNode=e.getRowNode(),i}return Og(t,o),t.prototype.setComp=function(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()},t.prototype.applyCellClassRules=function(){var e=this,r=this.column.getColDef(),i={value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,colDef:r,column:this.column,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context};this.beans.stylingService.processClassRules(r.cellClassRules,i,function(n){return e.cellComp.addOrRemoveCssClass(n,!0)},function(n){return e.cellComp.addOrRemoveCssClass(n,!1)})},t.prototype.applyUserStyles=function(){var e=this.column.getColDef();if(e.cellStyle){var r;if("function"==typeof e.cellStyle){var i={column:this.column,value:this.cellCtrl.getValue(),colDef:e,data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context};r=(0,e.cellStyle)(i)}else r=e.cellStyle;r&&this.cellComp.setUserStyles(r)}},t.prototype.applyClassesFromColDef=function(){var e=this,r=this.column.getColDef(),i={value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,column:this.column,colDef:r,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context};this.staticClasses.length&&this.staticClasses.forEach(function(n){return e.cellComp.addOrRemoveCssClass(n,!1)}),this.staticClasses=this.beans.stylingService.getStaticCellClasses(r,i),this.staticClasses.length&&this.staticClasses.forEach(function(n){return e.cellComp.addOrRemoveCssClass(n,!0)})},t.prototype.destroy=function(){o.prototype.destroy.call(this)},t}(we),Jp=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),bc=function(o){function t(e,r){var i=o.call(this)||this;return i.ctrl=e,i.beans=r,i}return Jp(t,o),t.prototype.setComp=function(e){this.comp=e,this.setupTooltip()},t.prototype.setupTooltip=function(){this.browserTooltips=this.beans.gridOptionsService.is("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?this.comp.setTitle(null!=this.tooltip?this.tooltip:void 0):this.createTooltipFeatureIfNeeded()},t.prototype.updateTooltipText=function(){this.tooltip=this.ctrl.getTooltipValue()},t.prototype.createTooltipFeatureIfNeeded=function(){var e=this;if(null==this.genericTooltipFeature){var r={getTooltipParams:function(){return e.getTooltipParams()},getGui:function(){return e.ctrl.getGui()}};this.genericTooltipFeature=this.createManagedBean(new Tl(r),this.beans.context)}},t.prototype.refreshToolTip=function(){this.updateTooltipText(),this.browserTooltips&&this.comp.setTitle(null!=this.tooltip?this.tooltip:void 0)},t.prototype.getTooltipParams=function(){var e=this.ctrl,r=e.getColumn?e.getColumn():void 0,i=e.getColDef?e.getColDef():void 0,n=e.getRowNode?e.getRowNode():void 0;return{location:e.getLocation(),colDef:i,column:r,rowIndex:e.getRowIndex?e.getRowIndex():void 0,node:n,data:n?n.data:void 0,value:this.getTooltipText(),valueFormatted:e.getValueFormatted?e.getValueFormatted():void 0}},t.prototype.getTooltipText=function(){return this.tooltip},t.prototype.destroy=function(){o.prototype.destroy.call(this)},t}(we),ft=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Wr=function(){function o(){}return o.prototype.postConstruct=function(){this.doingMasterDetail=this.gridOptionsService.isMasterDetail(),this.gridOptionsService.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel),this.gridOptionsService.isRowModelType("serverSide")&&(this.serverSideRowModel=this.rowModel)},ft([D("resizeObserverService")],o.prototype,"resizeObserverService",void 0),ft([D("paginationProxy")],o.prototype,"paginationProxy",void 0),ft([D("context")],o.prototype,"context",void 0),ft([D("columnApi")],o.prototype,"columnApi",void 0),ft([D("gridApi")],o.prototype,"gridApi",void 0),ft([D("gridOptionsService")],o.prototype,"gridOptionsService",void 0),ft([D("expressionService")],o.prototype,"expressionService",void 0),ft([D("environment")],o.prototype,"environment",void 0),ft([D("rowRenderer")],o.prototype,"rowRenderer",void 0),ft([D("templateService")],o.prototype,"templateService",void 0),ft([D("valueService")],o.prototype,"valueService",void 0),ft([D("eventService")],o.prototype,"eventService",void 0),ft([D("columnModel")],o.prototype,"columnModel",void 0),ft([D("headerNavigationService")],o.prototype,"headerNavigationService",void 0),ft([D("navigationService")],o.prototype,"navigationService",void 0),ft([D("columnAnimationService")],o.prototype,"columnAnimationService",void 0),ft([Ft("rangeService")],o.prototype,"rangeService",void 0),ft([D("focusService")],o.prototype,"focusService",void 0),ft([Ft("contextMenuFactory")],o.prototype,"contextMenuFactory",void 0),ft([D("popupService")],o.prototype,"popupService",void 0),ft([D("valueFormatterService")],o.prototype,"valueFormatterService",void 0),ft([D("stylingService")],o.prototype,"stylingService",void 0),ft([D("columnHoverService")],o.prototype,"columnHoverService",void 0),ft([D("userComponentFactory")],o.prototype,"userComponentFactory",void 0),ft([D("userComponentRegistry")],o.prototype,"userComponentRegistry",void 0),ft([D("animationFrameService")],o.prototype,"animationFrameService",void 0),ft([D("dragService")],o.prototype,"dragService",void 0),ft([D("dragAndDropService")],o.prototype,"dragAndDropService",void 0),ft([D("sortController")],o.prototype,"sortController",void 0),ft([D("filterManager")],o.prototype,"filterManager",void 0),ft([D("rowContainerHeightService")],o.prototype,"rowContainerHeightService",void 0),ft([D("frameworkOverrides")],o.prototype,"frameworkOverrides",void 0),ft([D("cellPositionUtils")],o.prototype,"cellPositionUtils",void 0),ft([D("rowPositionUtils")],o.prototype,"rowPositionUtils",void 0),ft([D("selectionService")],o.prototype,"selectionService",void 0),ft([Ft("selectionHandleFactory")],o.prototype,"selectionHandleFactory",void 0),ft([D("rowCssClassCalculator")],o.prototype,"rowCssClassCalculator",void 0),ft([D("rowModel")],o.prototype,"rowModel",void 0),ft([D("ctrlsService")],o.prototype,"ctrlsService",void 0),ft([D("ctrlsFactory")],o.prototype,"ctrlsFactory",void 0),ft([D("agStackComponentsRegistry")],o.prototype,"agStackComponentsRegistry",void 0),ft([D("valueCache")],o.prototype,"valueCache",void 0),ft([D("rowNodeEventThrottle")],o.prototype,"rowNodeEventThrottle",void 0),ft([D("localeService")],o.prototype,"localeService",void 0),ft([Re],o.prototype,"postConstruct",null),o=ft([He("beans")],o)}(),ha=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),va=function(o){function t(e,r,i){var n=o.call(this)||this;return n.cellCtrl=e,n.beans=r,n.column=i,n}return ha(t,o),t.prototype.onMouseEvent=function(e,r){if(!tn(r))switch(e){case"click":this.onCellClicked(r);break;case"mousedown":case"touchstart":this.onMouseDown(r);break;case"dblclick":this.onCellDoubleClicked(r);break;case"mouseout":this.onMouseOut(r);break;case"mouseover":this.onMouseOver(r)}},t.prototype.onCellClicked=function(e){if(this.isDoubleClickOnIPad())return this.onCellDoubleClicked(e),void e.preventDefault();var r=this.beans,i=r.eventService,n=r.rangeService,u=r.gridOptionsService,c=e.ctrlKey||e.metaKey;n&&c&&n.getCellRangeCount(this.cellCtrl.getCellPosition())>1&&n.intersectLastRange(!0);var v=this.cellCtrl.createEvent(e,I.EVENT_CELL_CLICKED);i.dispatchEvent(v);var m=this.column.getColDef();m.onCellClicked&&window.setTimeout(function(){return m.onCellClicked(v)},0),(u.is("singleClickEdit")||m.singleClickEdit)&&!u.is("suppressClickEdit")&&this.cellCtrl.startRowOrCellEdit()},t.prototype.isDoubleClickOnIPad=function(){if(!on()||al("dblclick"))return!1;var e=(new Date).getTime(),r=e-this.lastIPadMouseClickEvent<200;return this.lastIPadMouseClickEvent=e,r},t.prototype.onCellDoubleClicked=function(e){var r=this.column.getColDef(),i=this.cellCtrl.createEvent(e,I.EVENT_CELL_DOUBLE_CLICKED);this.beans.eventService.dispatchEvent(i),"function"==typeof r.onCellDoubleClicked&&window.setTimeout(function(){return r.onCellDoubleClicked(i)},0),!this.beans.gridOptionsService.is("singleClickEdit")&&!this.beans.gridOptionsService.is("suppressClickEdit")&&this.cellCtrl.startRowOrCellEdit(null,null,e)},t.prototype.onMouseDown=function(e){var r=e.ctrlKey,i=e.metaKey,n=e.shiftKey,u=e.target,c=this.beans,v=c.eventService,m=c.rangeService;if(!this.isRightClickInExistingRange(e)){var C=m&&0!=m.getCellRanges().length;if(!n||!C){var _=Fi()&&!this.cellCtrl.isEditing()&&!Xu(u);this.cellCtrl.focusCell(_)}if(n&&C&&e.preventDefault(),!this.containsWidget(u)){if(m){var O=this.cellCtrl.getCellPosition();if(n)m.extendLatestRangeToCell(O);else{var P=r||i;m.setRangeToCell(O,P)}}v.dispatchEvent(this.cellCtrl.createEvent(e,I.EVENT_CELL_MOUSE_DOWN))}}},t.prototype.isRightClickInExistingRange=function(e){var r=this.beans.rangeService;if(r&&(r.isCellInAnyRange(this.cellCtrl.getCellPosition())&&2===e.button))return!0;return!1},t.prototype.containsWidget=function(e){return lt(e,"ag-selection-checkbox",3)},t.prototype.onMouseOut=function(e){if(!this.mouseStayingInsideCell(e)){var r=this.cellCtrl.createEvent(e,I.EVENT_CELL_MOUSE_OUT);this.beans.eventService.dispatchEvent(r),this.beans.columnHoverService.clearMouseOver()}},t.prototype.onMouseOver=function(e){if(!this.mouseStayingInsideCell(e)){var r=this.cellCtrl.createEvent(e,I.EVENT_CELL_MOUSE_OVER);this.beans.eventService.dispatchEvent(r),this.beans.columnHoverService.setMouseOver([this.column])}},t.prototype.mouseStayingInsideCell=function(e){if(!e.target||!e.relatedTarget)return!1;var r=this.cellCtrl.getGui(),i=r.contains(e.target),n=r.contains(e.relatedTarget);return i&&n},t.prototype.destroy=function(){},t}(Wr),Ul=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Fc=function(o){function t(e,r,i,n,u){var c=o.call(this)||this;return c.cellCtrl=e,c.beans=r,c.rowNode=n,c.rowCtrl=u,c}return Ul(t,o),t.prototype.setComp=function(e){this.eGui=e},t.prototype.onKeyDown=function(e){var r=e.key;switch(r){case ve.ENTER:this.onEnterKeyDown(e);break;case ve.F2:this.onF2KeyDown(e);break;case ve.ESCAPE:this.onEscapeKeyDown(e);break;case ve.TAB:this.onTabKeyDown(e);break;case ve.BACKSPACE:case ve.DELETE:this.onBackspaceOrDeleteKeyPressed(r,e);break;case ve.DOWN:case ve.UP:case ve.RIGHT:case ve.LEFT:this.onNavigationKeyPressed(e,r)}},t.prototype.onNavigationKeyPressed=function(e,r){this.cellCtrl.isEditing()||(e.shiftKey&&this.cellCtrl.isRangeSelectionEnabled()?this.onShiftRangeSelect(e):this.beans.navigationService.navigateToNextCell(e,r,this.cellCtrl.getCellPosition(),!0),e.preventDefault())},t.prototype.onShiftRangeSelect=function(e){if(this.beans.rangeService){var r=this.beans.rangeService.extendLatestRangeInDirection(e);r&&this.beans.navigationService.ensureCellVisible(r)}},t.prototype.onTabKeyDown=function(e){this.beans.navigationService.onTabKeyDown(this.cellCtrl,e)},t.prototype.onBackspaceOrDeleteKeyPressed=function(e,r){var i=this,n=i.cellCtrl,u=i.beans,c=i.rowNode,v=u.gridOptionsService,m=u.rangeService,C=u.eventService;n.isEditing()||(C.dispatchEvent({type:I.EVENT_KEY_SHORTCUT_CHANGED_CELL_START}),cp(e,v.is("enableCellEditingOnBackspace"))?m&&v.isEnableRangeSelection()?m.clearCellRangeCellValues():n.isCellEditable()&&c.setDataValue(n.getColumn(),null,"cellClear"):n.startRowOrCellEdit(e,void 0,r),C.dispatchEvent({type:I.EVENT_KEY_SHORTCUT_CHANGED_CELL_END}))},t.prototype.onEnterKeyDown=function(e){this.cellCtrl.isEditing()||this.rowCtrl.isEditing()?this.cellCtrl.stopEditingAndFocus():this.beans.gridOptionsService.is("enterMovesDown")?this.beans.navigationService.navigateToNextCell(null,ve.DOWN,this.cellCtrl.getCellPosition(),!1):(this.cellCtrl.startRowOrCellEdit(ve.ENTER,void 0,e),this.cellCtrl.isEditing()&&e.preventDefault())},t.prototype.onF2KeyDown=function(e){this.cellCtrl.isEditing()||this.cellCtrl.startRowOrCellEdit(ve.F2,void 0,e)},t.prototype.onEscapeKeyDown=function(e){this.cellCtrl.isEditing()&&(this.cellCtrl.stopRowOrCellEdit(!0),this.cellCtrl.focusCell(!0))},t.prototype.onKeyPress=function(e){if(!(e.target!==this.eGui)&&!this.cellCtrl.isEditing()){var n=String.fromCharCode(e.charCode);" "===n?this.onSpaceKeyPressed(e):Js(e)&&(this.cellCtrl.startRowOrCellEdit(null,n,e),e.preventDefault())}},t.prototype.onSpaceKeyPressed=function(e){var r=this.beans.gridOptionsService;if(!this.cellCtrl.isEditing()&&r.isRowSelection()){var i=this.rowNode.isSelected(),n=!i;if(n||!r.is("suppressRowDeselection")){var u=this.beans.gridOptionsService.is("groupSelectsFiltered"),c=this.rowNode.setSelectedParams({newValue:n,rangeSelect:e.shiftKey,groupSelectsFiltered:u,event:e,source:"spacePressed"});void 0===i&&0===c&&this.rowNode.setSelectedParams({newValue:!1,rangeSelect:e.shiftKey,groupSelectsFiltered:u,event:e,source:"spacePressed"})}}e.preventDefault()},t.prototype.destroy=function(){o.prototype.destroy.call(this)},t}(we),Pc=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ag=function(o){function t(e,r,i,n){var u=o.call(this,'<div class="ag-drag-handle ag-row-drag" draggable="true"></div>')||this;return u.rowNode=e,u.column=r,u.beans=i,u.eCell=n,u}return Pc(t,o),t.prototype.postConstruct=function(){this.getGui().appendChild(pr("rowDrag",this.beans.gridOptionsService,null)),this.addGuiEventListener("mousedown",function(r){r.stopPropagation()}),this.addDragSource(),this.checkVisibility()},t.prototype.addDragSource=function(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))},t.prototype.onDragStart=function(e){var r=this,i=this.column.getColDef().dndSourceOnRowDrag;e.dataTransfer.setDragImage(this.eCell,0,0);i?i({rowNode:this.rowNode,dragEvent:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}):function(){try{var c=JSON.stringify(r.rowNode.data);e.dataTransfer.setData("application/json",c),e.dataTransfer.setData("text/plain",c)}catch{}}()},t.prototype.checkVisibility=function(){var e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)},function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);i>3&&n&&Object.defineProperty(t,e,n)}([Re],t.prototype,"postConstruct",null),t}(Ue),Zp=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),lo=function(){return lo=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},lo.apply(this,arguments)},lw=0,ko=function(o){function t(e,r,i,n){var u=o.call(this)||this;return u.cellRangeFeature=null,u.cellPositionFeature=null,u.cellCustomStyleFeature=null,u.tooltipFeature=null,u.cellMouseListenerFeature=null,u.cellKeyboardListenerFeature=null,u.suppressRefreshCell=!1,u.onCellCompAttachedFuncs=[],u.column=e,u.rowNode=r,u.beans=i,u.rowCtrl=n,u.instanceId=e.getId()+"-"+lw++,u.createCellPosition(),u.addFeatures(),u}return Zp(t,o),t.prototype.addFeatures=function(){var e=this;this.cellPositionFeature=new Tg(this,this.beans),this.addDestroyFunc(function(){var i;null===(i=e.cellPositionFeature)||void 0===i||i.destroy(),e.cellPositionFeature=null}),this.cellCustomStyleFeature=new Wl(this,this.beans),this.addDestroyFunc(function(){var i;null===(i=e.cellCustomStyleFeature)||void 0===i||i.destroy(),e.cellCustomStyleFeature=null}),this.cellMouseListenerFeature=new va(this,this.beans,this.column),this.addDestroyFunc(function(){var i;null===(i=e.cellMouseListenerFeature)||void 0===i||i.destroy(),e.cellMouseListenerFeature=null}),this.cellKeyboardListenerFeature=new Fc(this,this.beans,this.column,this.rowNode,this.rowCtrl),this.addDestroyFunc(function(){var i;null===(i=e.cellKeyboardListenerFeature)||void 0===i||i.destroy(),e.cellKeyboardListenerFeature=null}),this.beans.rangeService&&this.beans.gridOptionsService.isEnableRangeSelection()&&(this.cellRangeFeature=new Rg(this.beans,this),this.addDestroyFunc(function(){var i;null===(i=e.cellRangeFeature)||void 0===i||i.destroy(),e.cellRangeFeature=null})),this.column.isTooltipEnabled()&&this.addTooltipFeature()},t.prototype.addTooltipFeature=function(){var e=this,i={getColumn:function(){return e.column},getColDef:function(){return e.column.getColDef()},getRowIndex:function(){return e.cellPosition.rowIndex},getRowNode:function(){return e.rowNode},getGui:function(){return e.getGui()},getLocation:function(){return"cell"},getTooltipValue:function(){var n=e.column.getColDef(),u=e.rowNode.data;if(n.tooltipField&&me(u))return Za(u,n.tooltipField,e.column.isTooltipFieldContainsDots());var c=n.tooltipValueGetter;return c?c({location:"cell",api:e.beans.gridOptionsService.api,columnApi:e.beans.gridOptionsService.columnApi,context:e.beans.gridOptionsService.context,colDef:e.column.getColDef(),column:e.column,rowIndex:e.cellPosition.rowIndex,node:e.rowNode,data:e.rowNode.data,value:e.value,valueFormatted:e.valueFormatted}):null},getValueFormatted:function(){return e.valueFormatted}};this.tooltipFeature=new bc(i,this.beans),this.addDestroyFunc(function(){var n;null===(n=e.tooltipFeature)||void 0===n||n.destroy(),e.tooltipFeature=null})},t.prototype.setComp=function(e,r,i,n,u){var c,v,m,C;this.cellComp=e,this.eGui=r,this.printLayout=n,this.updateAndFormatValue(!0),this.addDomData(),this.onCellFocused(),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),i&&this.setupAutoHeight(i),this.setAriaColIndex(),this.beans.gridOptionsService.is("suppressCellFocus")||this.cellComp.setTabIndex(-1);var _=Wi(this.column.getId());this.cellComp.setColId(_),this.cellComp.setRole("gridcell"),null===(c=this.cellPositionFeature)||void 0===c||c.setComp(r),null===(v=this.cellCustomStyleFeature)||void 0===v||v.setComp(e),null===(m=this.tooltipFeature)||void 0===m||m.setComp(e),null===(C=this.cellKeyboardListenerFeature)||void 0===C||C.setComp(this.eGui),this.cellRangeFeature&&this.cellRangeFeature.setComp(e,r),u&&this.isCellEditable()?this.startEditing():this.showValue(),this.onCellCompAttachedFuncs.length&&(this.onCellCompAttachedFuncs.forEach(function(O){return O()}),this.onCellCompAttachedFuncs=[])},t.prototype.setupAutoHeight=function(e){var r=this;if(this.column.isAutoHeight()){var i=e.parentElement,n=this.beans.gridOptionsService.getRowHeightForNode(this.rowNode).height,u=function(m){if(!r.editing&&r.isAlive()){var C=Ct(i),z=C.paddingTop+C.paddingBottom+C.borderBottomWidth+C.borderTopWidth,Z=e.offsetHeight+z;if(m<5){var re=r.beans.gridOptionsService.getDocument();if(!re||!re.contains(e)||0==Z)return void r.beans.frameworkOverrides.setTimeout(function(){return u(m+1)},0)}var be=Math.max(Z,n);r.rowNode.setRowAutoHeight(be,r.column)}},c=function(){return u(0)};c();var v=this.beans.resizeObserverService.observeResize(e,c);this.addDestroyFunc(function(){v(),r.rowNode.setRowAutoHeight(void 0,r.column)})}},t.prototype.getInstanceId=function(){return this.instanceId},t.prototype.showValue=function(e){void 0===e&&(e=!1);var r=null!=this.valueFormatted?this.valueFormatted:this.value,i=this.createCellRendererParams(),n=this.beans.userComponentFactory.getCellRendererDetails(this.column.getColDef(),i);this.cellComp.setRenderDetails(n,r,e),this.refreshHandle()},t.prototype.setupControlComps=function(){var e=this.column.getColDef();this.includeSelection=this.isIncludeControl(e.checkboxSelection),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.cellComp.setIncludeSelection(this.includeSelection),this.cellComp.setIncludeDndSource(this.includeDndSource),this.cellComp.setIncludeRowDrag(this.includeRowDrag)},t.prototype.isForceWrapper=function(){return this.beans.gridOptionsService.is("enableCellTextSelection")||this.column.isAutoHeight()},t.prototype.isIncludeControl=function(e){return!(null!=this.rowNode.rowPinned)&&("function"==typeof e||!0===e)},t.prototype.refreshShouldDestroy=function(){var e=this.column.getColDef(),r=this.includeSelection!=this.isIncludeControl(e.checkboxSelection),i=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),n=this.includeDndSource!=this.isIncludeControl(e.dndSource);return r||i||n},t.prototype.startEditing=function(e,r,i,n){var u=this;if(void 0===e&&(e=null),void 0===r&&(r=null),void 0===i&&(i=!1),void 0===n&&(n=null),this.isCellEditable()&&!this.editing){if(!this.cellComp)return void this.onCellCompAttachedFuncs.push(function(){u.startEditing(e,r,i,n)});var c=this.createCellEditorParams(e,r,i),v=this.column.getColDef(),m=this.beans.userComponentFactory.getCellEditorDetails(v,c),C=null!=m?.popupFromSelector?m.popupFromSelector:!!v.cellEditorPopup,_=null!=m?.popupPositionFromSelector?m.popupPositionFromSelector:v.cellEditorPopupPosition;this.setEditing(!0),this.cellComp.setEditDetails(m,C,_);var O=this.createEvent(n,I.EVENT_CELL_EDITING_STARTED);this.beans.eventService.dispatchEvent(O)}},t.prototype.setEditing=function(e){this.editing!==e&&(this.editing=e,this.refreshHandle())},t.prototype.stopRowOrCellEdit=function(e){void 0===e&&(e=!1),"fullRow"===this.beans.gridOptionsService.get("editType")?this.rowCtrl.stopRowEditing(e):this.stopEditing(e)},t.prototype.onPopupEditorClosed=function(){this.isEditing()&&this.stopEditingAndFocus()},t.prototype.takeValueFromCellEditor=function(e){var r={newValueExists:!1};if(e)return r;var i=this.cellComp.getCellEditor();return i?i.isCancelAfterEnd&&i.isCancelAfterEnd()?r:{newValue:i.getValue(),newValueExists:!0}:r},t.prototype.saveNewValue=function(e,r){if(r===e)return!1;this.suppressRefreshCell=!0;var i=this.rowNode.setDataValue(this.column,r,"edit");return this.suppressRefreshCell=!1,i},t.prototype.stopEditing=function(e){if(void 0===e&&(e=!1),!this.editing)return!1;var r=this.takeValueFromCellEditor(e),i=r.newValue,n=r.newValueExists,u=this.rowNode.getValueFromValueService(this.column),c=!1;return n&&(c=this.saveNewValue(u,i)),this.setEditing(!1),this.cellComp.setEditDetails(),this.updateAndFormatValue(),this.refreshCell({forceRefresh:!0,suppressFlash:!0}),this.dispatchEditingStoppedEvent(u,i,!e&&!!c),c},t.prototype.dispatchEditingStoppedEvent=function(e,r,i){var n=lo(lo({},this.createEvent(null,I.EVENT_CELL_EDITING_STOPPED)),{oldValue:e,newValue:r,valueChanged:i});this.beans.eventService.dispatchEvent(n)},t.prototype.createCellEditorParams=function(e,r,i){return{value:this.rowNode.getValueFromValueService(this.column),eventKey:e,charPress:r,column:this.column,colDef:this.column.getColDef(),rowIndex:this.getCellPosition().rowIndex,node:this.rowNode,data:this.rowNode.data,api:this.beans.gridOptionsService.api,cellStartedEdit:i,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context,onKeyDown:this.onKeyDown.bind(this),stopEditing:this.stopEditingAndFocus.bind(this),eGridCell:this.getGui(),parseValue:this.parseValue.bind(this),formatValue:this.formatValue.bind(this)}},t.prototype.createCellRendererParams=function(){var e=this;return{value:this.value,valueFormatted:this.valueFormatted,getValue:function(){return e.rowNode.getValueFromValueService(e.column)},setValue:function(i){return e.beans.valueService.setValue(e.rowNode,e.column,i)},formatValue:this.formatValue.bind(this),data:this.rowNode.data,node:this.rowNode,pinned:this.column.getPinned(),colDef:this.column.getColDef(),column:this.column,rowIndex:this.getCellPosition().rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context,refreshCell:this.refreshCell.bind(this),eGridCell:this.getGui(),eParentOfValue:this.cellComp.getParentOfValue(),registerRowDragger:function(i,n,u,c){return e.registerRowDragger(i,n,c)}}},t.prototype.parseValue=function(e){var r=this.column.getColDef(),i={node:this.rowNode,data:this.rowNode.data,oldValue:this.getValue(),newValue:e,colDef:r,column:this.column,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context},n=r.valueParser;return me(n)?"function"==typeof n?n(i):this.beans.expressionService.evaluate(n,i):e},t.prototype.setFocusOutOnEditor=function(){if(this.editing){var e=this.cellComp.getCellEditor();e&&e.focusOut&&e.focusOut()}},t.prototype.setFocusInOnEditor=function(){if(this.editing){var e=this.cellComp.getCellEditor();e&&e.focusIn?e.focusIn():this.focusCell(!0)}},t.prototype.onCellChanged=function(e){this.cellComp&&(e.column===this.column&&this.refreshCell({}))},t.prototype.refreshCell=function(e){var r,i,n;if(!this.suppressRefreshCell&&!this.editing&&this.cellComp){var u=this.column.getColDef(),c=null!=e&&!!e.newData,v=null!=e&&!!e.suppressFlash||!!u.suppressCellFlash,m=null==u.field&&null==u.valueGetter&&null==u.showRowGroup,C=e&&e.forceRefresh||m||c,_=this.updateAndFormatValue();if(C||_){this.showValue(c);var P=this.beans.filterManager.isSuppressFlashingCellsBecauseFiltering();!v&&!P&&(this.beans.gridOptionsService.is("enableCellChangeFlash")||u.enableCellChangeFlash)&&this.flashCell(),null===(r=this.cellCustomStyleFeature)||void 0===r||r.applyUserStyles(),null===(i=this.cellCustomStyleFeature)||void 0===i||i.applyClassesFromColDef()}this.refreshToolTip(),null===(n=this.cellCustomStyleFeature)||void 0===n||n.applyCellClassRules()}},t.prototype.stopEditingAndFocus=function(e){void 0===e&&(e=!1),this.stopRowOrCellEdit(),this.focusCell(!0),e||this.navigateAfterEdit()},t.prototype.navigateAfterEdit=function(){"fullRow"===this.beans.gridOptionsService.get("editType")||this.beans.gridOptionsService.is("enterMovesDownAfterEdit")&&this.beans.navigationService.navigateToNextCell(null,ve.DOWN,this.getCellPosition(),!1)},t.prototype.flashCell=function(e){var r=e&&e.flashDelay,i=e&&e.fadeDelay;this.animateCell("data-changed",r,i)},t.prototype.animateCell=function(e,r,i){var u,c,n=this,v="ag-cell-"+e,m="ag-cell-"+e+"-animation",C=this.beans.gridOptionsService;r||(r=null!==(u=C.getNum("cellFlashDelay"))&&void 0!==u?u:500),me(i)||(i=null!==(c=C.getNum("cellFadeDelay"))&&void 0!==c?c:1e3),this.cellComp.addOrRemoveCssClass(v,!0),this.cellComp.addOrRemoveCssClass(m,!1),window.setTimeout(function(){n.isAlive()&&(n.cellComp.addOrRemoveCssClass(v,!1),n.cellComp.addOrRemoveCssClass(m,!0),n.eGui.style.transition="background-color "+i+"ms",window.setTimeout(function(){n.isAlive()&&(n.cellComp.addOrRemoveCssClass(m,!1),n.eGui.style.transition="")},i))},r)},t.prototype.onFlashCells=function(e){if(this.cellComp){var r=this.beans.cellPositionUtils.createId(this.getCellPosition());e.cells[r]&&this.animateCell("highlight")}},t.prototype.isCellEditable=function(){return this.column.isCellEditable(this.rowNode)},t.prototype.isSuppressFillHandle=function(){return this.column.isSuppressFillHandle()},t.prototype.formatValue=function(e){return this.callValueFormatter(e)??e},t.prototype.callValueFormatter=function(e){return this.beans.valueFormatterService.formatValue(this.column,this.rowNode,e)},t.prototype.updateAndFormatValue=function(e){void 0===e&&(e=!1);var r=this.value,i=this.valueFormatted;return this.value=this.rowNode.getValueFromValueService(this.column),this.valueFormatted=this.callValueFormatter(this.value),!!e||(!this.valuesAreEqual(r,this.value)||this.valueFormatted!=i)},t.prototype.valuesAreEqual=function(e,r){var i=this.column.getColDef();return i.equals?i.equals(e,r):e===r},t.prototype.getComp=function(){return this.cellComp},t.prototype.getValue=function(){return this.value},t.prototype.getValueFormatted=function(){return this.valueFormatted},t.prototype.addDomData=function(){var e=this,r=this.getGui();this.beans.gridOptionsService.setDomData(r,t.DOM_DATA_KEY_CELL_CTRL,this),this.addDestroyFunc(function(){return e.beans.gridOptionsService.setDomData(r,t.DOM_DATA_KEY_CELL_CTRL,null)})},t.prototype.createEvent=function(e,r){return{type:r,node:this.rowNode,data:this.rowNode.data,value:this.value,column:this.column,colDef:this.column.getColDef(),context:this.beans.gridOptionsService.context,api:this.beans.gridApi,columnApi:this.beans.columnApi,rowPinned:this.rowNode.rowPinned,event:e,rowIndex:this.rowNode.rowIndex}},t.prototype.onKeyPress=function(e){var r;null===(r=this.cellKeyboardListenerFeature)||void 0===r||r.onKeyPress(e)},t.prototype.onKeyDown=function(e){var r;null===(r=this.cellKeyboardListenerFeature)||void 0===r||r.onKeyDown(e)},t.prototype.onMouseEvent=function(e,r){var i;null===(i=this.cellMouseListenerFeature)||void 0===i||i.onMouseEvent(e,r)},t.prototype.getGui=function(){return this.eGui},t.prototype.refreshToolTip=function(){var e;null===(e=this.tooltipFeature)||void 0===e||e.refreshToolTip()},t.prototype.getColSpanningList=function(){return this.cellPositionFeature.getColSpanningList()},t.prototype.onLeftChanged=function(){var e;this.cellComp&&(null===(e=this.cellPositionFeature)||void 0===e||e.onLeftChanged())},t.prototype.onDisplayedColumnsChanged=function(){this.eGui&&this.setAriaColIndex()},t.prototype.setAriaColIndex=function(){var e=this.beans.columnModel.getAriaColumnIndex(this.column);gl(this.getGui(),e)},t.prototype.isSuppressNavigable=function(){return this.column.isSuppressNavigable(this.rowNode)},t.prototype.onWidthChanged=function(){var e;return null===(e=this.cellPositionFeature)||void 0===e?void 0:e.onWidthChanged()},t.prototype.getColumn=function(){return this.column},t.prototype.getRowNode=function(){return this.rowNode},t.prototype.getBeans=function(){return this.beans},t.prototype.isPrintLayout=function(){return this.printLayout},t.prototype.appendChild=function(e){this.eGui.appendChild(e)},t.prototype.refreshHandle=function(){this.cellRangeFeature&&this.cellRangeFeature.refreshHandle()},t.prototype.getCellPosition=function(){return this.cellPosition},t.prototype.isEditing=function(){return this.editing},t.prototype.startRowOrCellEdit=function(e,r,i){void 0===i&&(i=null),this.cellComp&&("fullRow"===this.beans.gridOptionsService.get("editType")?this.rowCtrl.startRowEditing(e,r,this):this.startEditing(e,r,!0,i))},t.prototype.getRowCtrl=function(){return this.rowCtrl},t.prototype.getRowPosition=function(){return{rowIndex:this.cellPosition.rowIndex,rowPinned:this.cellPosition.rowPinned}},t.prototype.updateRangeBordersIfRangeCount=function(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.updateRangeBordersIfRangeCount()},t.prototype.onRangeSelectionChanged=function(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()},t.prototype.isRangeSelectionEnabled=function(){return null!=this.cellRangeFeature},t.prototype.focusCell=function(e){void 0===e&&(e=!1),this.beans.focusService.setFocusedCell({rowIndex:this.getCellPosition().rowIndex,column:this.column,rowPinned:this.rowNode.rowPinned,forceBrowserFocus:e})},t.prototype.onRowIndexChanged=function(){this.createCellPosition(),this.onCellFocused(),this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()},t.prototype.onFirstRightPinnedChanged=function(){if(this.cellComp){var e=this.column.isFirstRightPinned();this.cellComp.addOrRemoveCssClass("ag-cell-first-right-pinned",e)}},t.prototype.onLastLeftPinnedChanged=function(){if(this.cellComp){var e=this.column.isLastLeftPinned();this.cellComp.addOrRemoveCssClass("ag-cell-last-left-pinned",e)}},t.prototype.onCellFocused=function(e){if(this.cellComp&&!this.beans.gridOptionsService.is("suppressCellFocus")){var r=this.beans.focusService.isCellFocused(this.cellPosition);if(this.cellComp.addOrRemoveCssClass("ag-cell-focus",r),r&&e&&e.forceBrowserFocus)this.cellComp.getFocusableElement().focus({preventScroll:!!e.preventScrollOnBrowserFocus});var n="fullRow"===this.beans.gridOptionsService.get("editType");!r&&!n&&this.editing&&this.stopRowOrCellEdit()}},t.prototype.createCellPosition=function(){this.cellPosition={rowIndex:this.rowNode.rowIndex,rowPinned:Xt(this.rowNode.rowPinned),column:this.column}},t.prototype.applyStaticCssClasses=function(){this.cellComp.addOrRemoveCssClass("ag-cell",!0),this.cellComp.addOrRemoveCssClass("ag-cell-not-inline-editing",!0);var e=1==this.column.isAutoHeight();this.cellComp.addOrRemoveCssClass("ag-cell-auto-height",e),this.cellComp.addOrRemoveCssClass("ag-cell-normal-height",!e)},t.prototype.onColumnHover=function(){if(this.cellComp&&this.beans.gridOptionsService.is("columnHoverHighlight")){var e=this.beans.columnHoverService.isHovered(this.column);this.cellComp.addOrRemoveCssClass("ag-column-hover",e)}},t.prototype.onColDefChanged=function(){this.cellComp&&(this.setWrapText(),this.editing||this.refreshCell({forceRefresh:!0,suppressFlash:!0}))},t.prototype.setWrapText=function(){var e=1==this.column.getColDef().wrapText;this.cellComp.addOrRemoveCssClass("ag-cell-wrap-text",e)},t.prototype.dispatchCellContextMenuEvent=function(e){var r=this.column.getColDef(),i=this.createEvent(e,I.EVENT_CELL_CONTEXT_MENU);this.beans.eventService.dispatchEvent(i),r.onCellContextMenu&&window.setTimeout(function(){return r.onCellContextMenu(i)},0)},t.prototype.getCellRenderer=function(){return this.cellComp?this.cellComp.getCellRenderer():null},t.prototype.getCellEditor=function(){return this.cellComp?this.cellComp.getCellEditor():null},t.prototype.destroy=function(){this.onCellCompAttachedFuncs=[],o.prototype.destroy.call(this)},t.prototype.createSelectionCheckbox=function(){var e=new kp;return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e},t.prototype.createDndSource=function(){var e=new Ag(this.rowNode,this.column,this.beans,this.eGui);return this.beans.context.createBean(e),e},t.prototype.registerRowDragger=function(e,r,i){var n=this;if(this.customRowDragComp)this.customRowDragComp.setDragElement(e,r);else{var u=this.createRowDragComp(e,r,i);u&&(this.customRowDragComp=u,this.addDestroyFunc(function(){n.beans.context.destroyBean(u),n.customRowDragComp=null}))}},t.prototype.createRowDragComp=function(e,r,i){var n=this,u=this.beans.gridOptionsService.is("pagination"),c=this.beans.gridOptionsService.is("rowDragManaged"),v=this.beans.gridOptionsService.isRowModelType("clientSide");if(c){if(!v)return void _t(function(){return console.warn("AG Grid: managed row dragging is only allowed in the Client Side Row Model")},"CellComp.addRowDragging");if(u)return void _t(function(){return console.warn("AG Grid: managed row dragging is not possible when doing pagination")},"CellComp.addRowDragging")}var m=new Ll(function(){return n.value},this.rowNode,this.column,e,r,i);return this.beans.context.createBean(m),m},t.DOM_DATA_KEY_CELL_CTRL="cellCtrl",t}(we),Fg=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Pg=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n};!function(o){o.Normal="Normal",o.FullWidth="FullWidth",o.FullWidthLoading="FullWidthLoading",o.FullWidthGroup="FullWidthGroup",o.FullWidthDetail="FullWidthDetail"}(di||(di={}));var ue,Kr,Lg=0,Go=function(o){function t(e,r,i,n,u){var c=o.call(this)||this;return c.allRowGuis=[],c.active=!0,c.centerCellCtrls={list:[],map:{}},c.leftCellCtrls={list:[],map:{}},c.rightCellCtrls={list:[],map:{}},c.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},c.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},c.lastMouseDownOnDragger=!1,c.updateColumnListsPending=!1,c.businessKeySanitised=null,c.beans=r,c.rowNode=e,c.paginationPage=c.beans.paginationProxy.getCurrentPage(),c.useAnimationFrameForCreate=n,c.printLayout=u,c.instanceId=e.id+"-"+Lg++,c.setAnimateFlags(i),c.initRowBusinessKey(),c.rowFocused=c.beans.focusService.isRowFocused(c.rowNode.rowIndex,c.rowNode.rowPinned),c.rowLevel=c.beans.rowCssClassCalculator.calculateRowLevel(c.rowNode),c.setRowType(),c.addListeners(),c}return Fg(t,o),t.prototype.initRowBusinessKey=function(){var e=this.beans.gridOptionsService.get("getBusinessKeyForNode");if("function"==typeof e){var r=e(this.rowNode);this.businessKeySanitised=Wi(r)}},t.prototype.isSticky=function(){return this.rowNode.sticky},t.prototype.getBeans=function(){return this.beans},t.prototype.getInstanceId=function(){return this.instanceId},t.prototype.setComp=function(e,r,i){var n={rowComp:e,element:r,containerType:i};this.allRowGuis.push(n),i===Kr.LEFT?this.leftGui=n:i===Kr.RIGHT?this.rightGui=n:i===Kr.FULL_WIDTH?this.fullWidthGui=n:this.centerGui=n,this.initialiseRowComp(n),"FullWidthLoading"!==this.rowType&&!this.rowNode.rowPinned&&this.beans.rowRenderer.dispatchFirstDataRenderedEvent()},t.prototype.unsetComp=function(e){this.allRowGuis=this.allRowGuis.filter(function(r){return r.containerType!==e}),e===Kr.LEFT?this.leftGui=void 0:e===Kr.RIGHT?this.rightGui=void 0:e===Kr.FULL_WIDTH&&(this.fullWidthGui=void 0)},t.prototype.isCacheable=function(){return this.rowType===di.FullWidthDetail&&this.beans.gridOptionsService.is("keepDetailRows")},t.prototype.setCached=function(e){var r=e?"none":"";this.allRowGuis.forEach(function(i){return i.element.style.display=r})},t.prototype.initialiseRowComp=function(e){var r=this,i=this.beans.gridOptionsService;this.onRowHeightChanged(e),this.updateRowIndexes(e),this.setFocusedClasses(e),this.setStylesFromGridOptions(e),i.isRowSelection()&&this.rowNode.selectable&&this.onRowSelected(e),this.updateColumnLists(!this.useAnimationFrameForCreate);var n=e.rowComp;n.setRole("row"),this.getInitialRowClasses(e.containerType).forEach(function(v){return n.addOrRemoveCssClass(v,!0)}),this.executeSlideAndFadeAnimations(e),this.rowNode.group&&zi(e.element,1==this.rowNode.expanded);var c=Wi(this.rowNode.id);null!=c&&n.setRowId(c),null!=this.businessKeySanitised&&n.setRowBusinessKey(this.businessKeySanitised),this.isFullWidth()&&!this.beans.gridOptionsService.is("suppressCellFocus")&&n.setTabIndex(-1),i.setDomData(e.element,t.DOM_DATA_KEY_ROW_CTRL,this),this.addDestroyFunc(function(){return i.setDomData(e.element,t.DOM_DATA_KEY_ROW_CTRL,null)}),this.useAnimationFrameForCreate?this.beans.animationFrameService.createTask(this.addHoverFunctionality.bind(this,e.element),this.rowNode.rowIndex,"createTasksP2"):this.addHoverFunctionality(e.element),this.isFullWidth()&&this.setupFullWidth(e),i.is("rowDragEntireRow")&&this.addRowDraggerToRow(e),this.useAnimationFrameForCreate&&this.beans.animationFrameService.addDestroyTask(function(){r.isAlive()&&e.rowComp.addOrRemoveCssClass("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()},t.prototype.executeSlideAndFadeAnimations=function(e){var r=this,i=e.containerType;this.slideInAnimation[i]&&(Du(function(){r.onTopChanged()}),this.slideInAnimation[i]=!1),this.fadeInAnimation[i]&&(Du(function(){e.rowComp.addOrRemoveCssClass("ag-opacity-zero",!1)}),this.fadeInAnimation[i]=!1)},t.prototype.addRowDraggerToRow=function(e){if(this.beans.gridOptionsService.isEnableRangeSelection())_t(function(){console.warn("AG Grid: Setting `rowDragEntireRow: true` in the gridOptions doesn't work with `enableRangeSelection: true`")},"rowDragAndRangeSelectionEnabled");else{var r=this.beans.localeService.getLocaleTextFunc(),i=new Ll(function(){return"1 "+r("rowDragRow","row")},this.rowNode,void 0,e.element,void 0,!0);this.createManagedBean(i,this.beans.context)}},t.prototype.setupFullWidth=function(e){var r=this.getPinnedForContainer(e.containerType),i=this.createFullWidthParams(e.element,r);if(this.rowType!=di.FullWidthDetail||it.assertRegistered(Ne.MasterDetailModule,"cell renderer 'agDetailCellRenderer' (for master detail)")){var n;switch(this.rowType){case di.FullWidthDetail:n=this.beans.userComponentFactory.getFullWidthDetailCellRendererDetails(i);break;case di.FullWidthGroup:n=this.beans.userComponentFactory.getFullWidthGroupCellRendererDetails(i);break;case di.FullWidthLoading:n=this.beans.userComponentFactory.getFullWidthLoadingCellRendererDetails(i);break;default:n=this.beans.userComponentFactory.getFullWidthCellRendererDetails(i)}e.rowComp.showFullWidth(n)}},t.prototype.isPrintLayout=function(){return this.printLayout},t.prototype.getFullWidthCellRenderer=function(){var e,r;return null===(r=null===(e=this.fullWidthGui)||void 0===e?void 0:e.rowComp)||void 0===r?void 0:r.getFullWidthCellRenderer()},t.prototype.getCellElement=function(e){var r=this.getCellCtrl(e);return r?r.getGui():null},t.prototype.executeProcessRowPostCreateFunc=function(){var e,r=this.beans.gridOptionsService.getCallback("processRowPostCreate");r&&this.areAllContainersReady()&&r({eRow:null===(e=this.centerGui)||void 0===e?void 0:e.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)})},t.prototype.areAllContainersReady=function(){var e=!!this.leftGui||!this.beans.columnModel.isPinningLeft(),r=!!this.centerGui,i=!!this.rightGui||!this.beans.columnModel.isPinningRight();return e&&r&&i},t.prototype.setRowType=function(){var e=this.rowNode.stub,r=this.rowNode.isFullWidthCell(),i=this.beans.doingMasterDetail&&this.rowNode.detail,n=this.beans.columnModel.isPivotMode(),c=!!this.rowNode.group&&!this.rowNode.footer&&this.beans.gridOptionsService.isGroupUseEntireRow(n);this.rowType=e?di.FullWidthLoading:i?di.FullWidthDetail:r?di.FullWidth:c?di.FullWidthGroup:di.Normal},t.prototype.updateColumnLists=function(e,r){var i=this;if(void 0===e&&(e=!1),void 0===r&&(r=!1),!this.isFullWidth()){if(e||this.beans.gridOptionsService.is("suppressAnimationFrame")||this.printLayout)return void this.updateColumnListsImpl(r);this.updateColumnListsPending||(this.beans.animationFrameService.createTask(function(){i.active&&i.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"createTasksP1"),this.updateColumnListsPending=!0)}},t.prototype.createCellCtrls=function(e,r,i){var n=this;void 0===i&&(i=null);var u={list:[],map:{}},c=function(v,m){u.list.push(m),u.map[v]=m};return r.forEach(function(v){var m=v.getInstanceId(),C=e.map[m];C||(C=new ko(v,n.rowNode,n.beans,n)),c(m,C)}),e.list.forEach(function(v){if(!(null!=u.map[v.getColumn().getInstanceId()])){if(!n.isCellEligibleToBeRemoved(v,i))return void c(v.getColumn().getInstanceId(),v);v.destroy()}}),u},t.prototype.updateColumnListsImpl=function(e){var r=this;void 0===e&&(e=!1),this.updateColumnListsPending=!1;var i=this.beans.columnModel;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,i.getAllDisplayedColumns()),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{var n=i.getViewportCenterColumnsForRow(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,n);var u=i.getDisplayedLeftColumnsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,u,"left");var c=i.getDisplayedRightColumnsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,c,"right")}this.allRowGuis.forEach(function(v){var m=v.containerType===Kr.LEFT?r.leftCellCtrls:v.containerType===Kr.RIGHT?r.rightCellCtrls:r.centerCellCtrls;v.rowComp.setCellCtrls(m.list,e)})},t.prototype.isCellEligibleToBeRemoved=function(e,r){var i=!0;if(e.getColumn().getPinned()!=r)return i;var c=e.isEditing(),v=this.beans.focusService.isCellFocused(e.getCellPosition());if(c||v){var C=e.getColumn();return!(this.beans.columnModel.getAllDisplayedColumns().indexOf(C)>=0)&&i}return i},t.prototype.setAnimateFlags=function(e){if(!this.isSticky()&&e){var r=me(this.rowNode.oldRowTop),i=this.beans.columnModel.isPinningLeft(),n=this.beans.columnModel.isPinningRight();r?(this.slideInAnimation.center=!0,this.slideInAnimation.left=i,this.slideInAnimation.right=n):(this.fadeInAnimation.center=!0,this.fadeInAnimation.left=i,this.fadeInAnimation.right=n)}},t.prototype.isEditing=function(){return this.editingRow},t.prototype.stopRowEditing=function(e){this.stopEditing(e)},t.prototype.isFullWidth=function(){return this.rowType!==di.Normal},t.prototype.getRowType=function(){return this.rowType},t.prototype.refreshFullWidth=function(){var e=this,r=function(m,C){if(!m)return!0;var _=m.rowComp.getFullWidthCellRenderer();if(!_||!_.refresh)return!1;var O=e.createFullWidthParams(m.element,C);return _.refresh(O)},i=r(this.fullWidthGui,null),n=r(this.centerGui,null),u=r(this.leftGui,"left"),c=r(this.rightGui,"right");return i&&n&&u&&c},t.prototype.addListeners=function(){var e=this;this.addManagedListener(this.rowNode,wt.EVENT_HEIGHT_CHANGED,function(){return e.onRowHeightChanged()}),this.addManagedListener(this.rowNode,wt.EVENT_ROW_SELECTED,function(){return e.onRowSelected()}),this.addManagedListener(this.rowNode,wt.EVENT_ROW_INDEX_CHANGED,this.onRowIndexChanged.bind(this)),this.addManagedListener(this.rowNode,wt.EVENT_TOP_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(this.rowNode,wt.EVENT_EXPANDED_CHANGED,this.updateExpandedCss.bind(this)),this.addManagedListener(this.rowNode,wt.EVENT_HAS_CHILDREN_CHANGED,this.updateExpandedCss.bind(this)),this.addManagedListener(this.rowNode,wt.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addManagedListener(this.rowNode,wt.EVENT_CELL_CHANGED,this.onRowNodeCellChanged.bind(this)),this.addManagedListener(this.rowNode,wt.EVENT_HIGHLIGHT_CHANGED,this.onRowNodeHighlightChanged.bind(this)),this.addManagedListener(this.rowNode,wt.EVENT_DRAGGING_CHANGED,this.onRowNodeDraggingChanged.bind(this)),this.addManagedListener(this.rowNode,wt.EVENT_UI_LEVEL_CHANGED,this.onUiLevelChanged.bind(this));var r=this.beans.eventService;this.addManagedListener(r,I.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,this.onPaginationPixelOffsetChanged.bind(this)),this.addManagedListener(r,I.EVENT_HEIGHT_SCALE_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(r,I.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(r,I.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addManagedListener(r,I.EVENT_CELL_FOCUSED,this.onCellFocused.bind(this)),this.addManagedListener(r,I.EVENT_CELL_FOCUS_CLEARED,this.onCellFocusCleared.bind(this)),this.addManagedListener(r,I.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),this.addManagedListener(r,I.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addManagedListener(r,I.EVENT_COLUMN_MOVED,this.onColumnMoved.bind(this)),this.addListenersForCellComps()},t.prototype.onColumnMoved=function(){this.updateColumnLists()},t.prototype.addListenersForCellComps=function(){var e=this;this.addManagedListener(this.rowNode,wt.EVENT_ROW_INDEX_CHANGED,function(){e.getAllCellCtrls().forEach(function(r){return r.onRowIndexChanged()})}),this.addManagedListener(this.rowNode,wt.EVENT_CELL_CHANGED,function(r){e.getAllCellCtrls().forEach(function(i){return i.onCellChanged(r)})})},t.prototype.onRowNodeDataChanged=function(e){this.rowNode.detailNode&&this.beans.rowRenderer.refreshFullWidthRow(this.rowNode.detailNode),this.isFullWidth()?this.beans.rowRenderer.refreshFullWidthRow(this.rowNode):(this.getAllCellCtrls().forEach(function(r){return r.refreshCell({suppressFlash:!e.update,newData:!e.update})}),this.onRowSelected(),this.postProcessCss())},t.prototype.onRowNodeCellChanged=function(){this.postProcessCss()},t.prototype.postProcessCss=function(){this.setStylesFromGridOptions(),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()},t.prototype.onRowNodeHighlightChanged=function(){var e=this.rowNode.highlighted;this.allRowGuis.forEach(function(r){var i=e===hn.Above,n=e===hn.Below;r.rowComp.addOrRemoveCssClass("ag-row-highlight-above",i),r.rowComp.addOrRemoveCssClass("ag-row-highlight-below",n)})},t.prototype.onRowNodeDraggingChanged=function(){this.postProcessRowDragging()},t.prototype.postProcessRowDragging=function(){var e=this.rowNode.dragging;this.allRowGuis.forEach(function(r){return r.rowComp.addOrRemoveCssClass("ag-row-dragging",e)})},t.prototype.updateExpandedCss=function(){var e=this.rowNode.isExpandable(),r=1==this.rowNode.expanded;this.allRowGuis.forEach(function(i){i.rowComp.addOrRemoveCssClass("ag-row-group",e),i.rowComp.addOrRemoveCssClass("ag-row-group-expanded",e&&r),i.rowComp.addOrRemoveCssClass("ag-row-group-contracted",e&&!r),zi(i.element,e&&r)})},t.prototype.onDisplayedColumnsChanged=function(){this.updateColumnLists(!0),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights()},t.prototype.onVirtualColumnsChanged=function(){this.updateColumnLists(!1,!0)},t.prototype.getRowPosition=function(){return{rowPinned:Xt(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}},t.prototype.onKeyboardNavigate=function(e){var r=this.allRowGuis.find(function(m){return m.element.contains(e.target)});if((r?r.element:null)===e.target){var u=this.rowNode,c=this.beans.focusService.getFocusedCell(),v={rowIndex:u.rowIndex,rowPinned:u.rowPinned,column:c&&c.column};this.beans.navigationService.navigateToNextCell(e,e.key,v,!0),e.preventDefault()}},t.prototype.onTabKeyDown=function(e){if(!e.defaultPrevented&&!tn(e)){var r=this.allRowGuis.find(function(c){return c.element.contains(e.target)}),i=r?r.element:null,n=i===e.target,u=null;n||(u=this.beans.focusService.findNextFocusableElement(i,!1,e.shiftKey)),(this.isFullWidth()&&n||!u)&&this.beans.navigationService.onTabKeyDown(this,e)}},t.prototype.onFullWidthRowFocused=function(e){var r,i=this.rowNode,n=!!e&&(this.isFullWidth()&&e.rowIndex===i.rowIndex&&e.rowPinned==i.rowPinned),u=this.fullWidthGui?this.fullWidthGui.element:null===(r=this.centerGui)||void 0===r?void 0:r.element;u&&(u.classList.toggle("ag-full-width-focus",n),n&&u.focus({preventScroll:!0}))},t.prototype.refreshCell=function(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),this.updateColumnLists()},t.prototype.removeCellCtrl=function(e,r){var i={list:[],map:{}};return e.list.forEach(function(n){n!==r&&(i.list.push(n),i.map[n.getInstanceId()]=n)}),i},t.prototype.onMouseEvent=function(e,r){switch(e){case"dblclick":this.onRowDblClick(r);break;case"click":this.onRowClick(r);break;case"touchstart":case"mousedown":this.onRowMouseDown(r)}},t.prototype.createRowEvent=function(e,r){return{type:e,node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,rowPinned:this.rowNode.rowPinned,context:this.beans.gridOptionsService.context,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,event:r}},t.prototype.createRowEventWithSource=function(e,r){var i=this.createRowEvent(e,r);return i.source=this,i},t.prototype.onRowDblClick=function(e){if(!tn(e)){var r=this.createRowEventWithSource(I.EVENT_ROW_DOUBLE_CLICKED,e);this.beans.eventService.dispatchEvent(r)}},t.prototype.onRowMouseDown=function(e){if(this.lastMouseDownOnDragger=lt(e.target,"ag-row-drag",3),this.isFullWidth()){var r=this.rowNode,i=this.beans.columnModel;this.beans.rangeService&&this.beans.rangeService.removeAllCellRanges(),this.beans.focusService.setFocusedCell({rowIndex:r.rowIndex,column:i.getAllDisplayedColumns()[0],rowPinned:r.rowPinned,forceBrowserFocus:!0})}},t.prototype.onRowClick=function(e){if(!(tn(e)||this.lastMouseDownOnDragger)){var i=this.createRowEventWithSource(I.EVENT_ROW_CLICKED,e);this.beans.eventService.dispatchEvent(i);var n=e.ctrlKey||e.metaKey,u=e.shiftKey;if(!(this.beans.gridOptionsService.is("groupSelectsChildren")&&this.rowNode.group||!this.rowNode.selectable||this.rowNode.rowPinned||!this.beans.gridOptionsService.isRowSelection()||this.beans.gridOptionsService.is("suppressRowClickSelection"))){var v=this.beans.gridOptionsService.is("rowMultiSelectWithClick"),m=!this.beans.gridOptionsService.is("suppressRowDeselection"),C="rowClicked";if(this.rowNode.isSelected())v?this.rowNode.setSelectedParams({newValue:!1,event:e,source:C}):n?m&&this.rowNode.setSelectedParams({newValue:!1,event:e,source:C}):this.rowNode.setSelectedParams({newValue:!0,clearSelection:!u,rangeSelect:u,event:e,source:C});else{var _=!v&&!n;this.rowNode.setSelectedParams({newValue:!0,clearSelection:_,rangeSelect:u,event:e,source:C})}}}},t.prototype.setupDetailRowAutoHeight=function(e){var r=this;if(this.rowType===di.FullWidthDetail&&this.beans.gridOptionsService.is("detailRowAutoHeight")){var i=function(){var u=e.clientHeight;if(null!=u&&u>0){r.beans.frameworkOverrides.setTimeout(function(){r.rowNode.setRowHeight(u),r.beans.clientSideRowModel?r.beans.clientSideRowModel.onRowHeightChanged():r.beans.serverSideRowModel&&r.beans.serverSideRowModel.onRowHeightChanged()},0)}},n=this.beans.resizeObserverService.observeResize(e,i);this.addDestroyFunc(n),i()}},t.prototype.createFullWidthParams=function(e,r){var i=this;return{fullWidth:!0,data:this.rowNode.data,node:this.rowNode,value:this.rowNode.key,valueFormatted:this.rowNode.key,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context,eGridCell:e,eParentOfValue:e,pinned:r,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:function(u,c,v,m){return i.addFullWidthRowDragging(u,c,v,m)}}},t.prototype.addFullWidthRowDragging=function(e,r,i,n){if(void 0===i&&(i=""),this.isFullWidth()){var u=new Ll(function(){return i},this.rowNode,void 0,e,r,n);this.createManagedBean(u,this.beans.context)}},t.prototype.onUiLevelChanged=function(){var e=this.beans.rowCssClassCalculator.calculateRowLevel(this.rowNode);if(this.rowLevel!=e){var r="ag-row-level-"+e,i="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach(function(n){n.rowComp.addOrRemoveCssClass(r,!0),n.rowComp.addOrRemoveCssClass(i,!1)})}this.rowLevel=e},t.prototype.isFirstRowOnPage=function(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageFirstRow()},t.prototype.isLastRowOnPage=function(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageLastRow()},t.prototype.onModelUpdated=function(){this.refreshFirstAndLastRowStyles()},t.prototype.refreshFirstAndLastRowStyles=function(){var e=this.isFirstRowOnPage(),r=this.isLastRowOnPage();this.firstRowOnPage!==e&&(this.firstRowOnPage=e,this.allRowGuis.forEach(function(i){return i.rowComp.addOrRemoveCssClass("ag-row-first",e)})),this.lastRowOnPage!==r&&(this.lastRowOnPage=r,this.allRowGuis.forEach(function(i){return i.rowComp.addOrRemoveCssClass("ag-row-last",r)}))},t.prototype.stopEditing=function(e){var r,i;if(void 0===e&&(e=!1),!this.stoppingRowEdit){var n=this.getAllCellCtrls(),u=this.editingRow;this.stoppingRowEdit=!0;var c=!1;try{for(var v=function(o){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&o[t],r=0;if(e)return e.call(o);if(o&&"number"==typeof o.length)return{next:function(){return o&&r>=o.length&&(o=void 0),{value:o&&o[r++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),m=v.next();!m.done;m=v.next()){var _=m.value.stopEditing(e);u&&!e&&!c&&_&&(c=!0)}}catch(P){r={error:P}}finally{try{m&&!m.done&&(i=v.return)&&i.call(v)}finally{if(r)throw r.error}}if(c){var O=this.createRowEvent(I.EVENT_ROW_VALUE_CHANGED);this.beans.eventService.dispatchEvent(O)}u&&this.setEditingRow(!1),this.stoppingRowEdit=!1}},t.prototype.setInlineEditingCss=function(e){this.allRowGuis.forEach(function(r){r.rowComp.addOrRemoveCssClass("ag-row-inline-editing",e),r.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing",!e)})},t.prototype.setEditingRow=function(e){this.editingRow=e,this.allRowGuis.forEach(function(i){return i.rowComp.addOrRemoveCssClass("ag-row-editing",e)});var r=e?this.createRowEvent(I.EVENT_ROW_EDITING_STARTED):this.createRowEvent(I.EVENT_ROW_EDITING_STOPPED);this.beans.eventService.dispatchEvent(r)},t.prototype.startRowEditing=function(e,r,i,n){(void 0===e&&(e=null),void 0===r&&(r=null),void 0===i&&(i=null),void 0===n&&(n=null),this.editingRow)||this.getAllCellCtrls().reduce(function(c,v){var m=v===i;return m?v.startEditing(e,r,m,n):v.startEditing(null,null,m,n),!!c||v.isEditing()},!1)&&this.setEditingRow(!0)},t.prototype.getAllCellCtrls=function(){if(0===this.leftCellCtrls.list.length&&0===this.rightCellCtrls.list.length)return this.centerCellCtrls.list;var e=function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(Pg(arguments[t]));return o}(this.centerCellCtrls.list,this.leftCellCtrls.list,this.rightCellCtrls.list);return e},t.prototype.postProcessClassesFromGridOptions=function(){var e=this,r=this.beans.rowCssClassCalculator.processClassesFromGridOptions(this.rowNode);!r||!r.length||r.forEach(function(i){e.allRowGuis.forEach(function(n){return n.rowComp.addOrRemoveCssClass(i,!0)})})},t.prototype.postProcessRowClassRules=function(){var e=this;this.beans.rowCssClassCalculator.processRowClassRules(this.rowNode,function(r){e.allRowGuis.forEach(function(i){return i.rowComp.addOrRemoveCssClass(r,!0)})},function(r){e.allRowGuis.forEach(function(i){return i.rowComp.addOrRemoveCssClass(r,!1)})})},t.prototype.setStylesFromGridOptions=function(e){var r=this.processStylesFromGridOptions();this.forEachGui(e,function(i){return i.rowComp.setUserStyles(r)})},t.prototype.getPinnedForContainer=function(e){return e===Kr.LEFT?"left":e===Kr.RIGHT?"right":null},t.prototype.getInitialRowClasses=function(e){var r=this.getPinnedForContainer(e),i={rowNode:this.rowNode,rowFocused:this.rowFocused,fadeRowIn:this.fadeInAnimation[e],rowIsEven:this.rowNode.rowIndex%2==0,rowLevel:this.rowLevel,fullWidthRow:this.isFullWidth(),firstRowOnPage:this.isFirstRowOnPage(),lastRowOnPage:this.isLastRowOnPage(),printLayout:this.printLayout,expandable:this.rowNode.isExpandable(),pinned:r};return this.beans.rowCssClassCalculator.getInitialRowClasses(i)},t.prototype.processStylesFromGridOptions=function(){var e=this.beans.gridOptionsService.get("rowStyle");if(!e||"function"!=typeof e){var i,r=this.beans.gridOptionsService.getCallback("getRowStyle");if(r)i=r({data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex});return Object.assign({},e,i)}console.warn("AG Grid: rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead")},t.prototype.onRowSelected=function(e){var r=this,i=!!this.rowNode.isSelected();this.forEachGui(e,function(n){n.rowComp.addOrRemoveCssClass("ag-row-selected",i),_o(n.element,!!i||void 0);var u=r.createAriaLabel();wo(n.element,u??"")})},t.prototype.createAriaLabel=function(){var e=this.rowNode.isSelected();if(!e||!this.beans.gridOptionsService.is("suppressRowDeselection"))return this.beans.localeService.getLocaleTextFunc()(e?"ariaRowDeselect":"ariaRowSelect","Press SPACE to "+(e?"deselect":"select")+" this row.")},t.prototype.isUseAnimationFrameForCreate=function(){return this.useAnimationFrameForCreate},t.prototype.addHoverFunctionality=function(e){var r=this;this.active&&(this.addManagedListener(e,"mouseenter",function(){return r.rowNode.onMouseEnter()}),this.addManagedListener(e,"mouseleave",function(){return r.rowNode.onMouseLeave()}),this.addManagedListener(this.rowNode,wt.EVENT_MOUSE_ENTER,function(){!r.beans.dragService.isDragging()&&!r.beans.gridOptionsService.is("suppressRowHoverHighlight")&&(e.classList.add("ag-row-hover"),r.rowNode.setHovered(!0))}),this.addManagedListener(this.rowNode,wt.EVENT_MOUSE_LEAVE,function(){e.classList.remove("ag-row-hover"),r.rowNode.setHovered(!1)}))},t.prototype.roundRowTopToBounds=function(e){var i=this.beans.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),n=this.applyPaginationOffset(i.top,!0)-100,u=this.applyPaginationOffset(i.bottom,!0)+100;return Math.min(Math.max(n,e),u)},t.prototype.getFrameworkOverrides=function(){return this.beans.frameworkOverrides},t.prototype.forEachGui=function(e,r){(e?[e]:this.allRowGuis).forEach(r)},t.prototype.onRowHeightChanged=function(e){if(null!=this.rowNode.rowHeight){var r=this.rowNode.rowHeight,i=this.beans.environment.getDefaultRowHeight(),u=this.beans.gridOptionsService.isGetRowHeightFunction()?this.beans.gridOptionsService.getRowHeightForNode(this.rowNode).height:void 0,c=u?Math.min(i,u)-2+"px":void 0;this.forEachGui(e,function(v){v.element.style.height=r+"px",c&&v.element.style.setProperty("--ag-line-height",c)})}},t.prototype.addEventListener=function(e,r){o.prototype.addEventListener.call(this,e,r)},t.prototype.removeEventListener=function(e,r){o.prototype.removeEventListener.call(this,e,r)},t.prototype.destroyFirstPass=function(){this.active=!1,this.beans.gridOptionsService.isAnimateRows()&&this.setupRemoveAnimation(),this.rowNode.setHovered(!1);var e=this.createRowEvent(I.EVENT_VIRTUAL_ROW_REMOVED);this.dispatchEvent(e),this.beans.eventService.dispatchEvent(e),o.prototype.destroy.call(this)},t.prototype.setupRemoveAnimation=function(){if(!this.isSticky())if(null!=this.rowNode.rowTop){var r=this.roundRowTopToBounds(this.rowNode.rowTop);this.setRowTop(r)}else this.allRowGuis.forEach(function(i){return i.rowComp.addOrRemoveCssClass("ag-opacity-zero",!0)})},t.prototype.destroySecondPass=function(){this.allRowGuis.length=0;var e=function(r){return r.list.forEach(function(i){return i.destroy()}),{list:[],map:{}}};this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)},t.prototype.setFocusedClasses=function(e){var r=this;this.forEachGui(e,function(i){i.rowComp.addOrRemoveCssClass("ag-row-focus",r.rowFocused),i.rowComp.addOrRemoveCssClass("ag-row-no-focus",!r.rowFocused)})},t.prototype.onCellFocused=function(){this.onCellFocusChanged()},t.prototype.onCellFocusCleared=function(){this.onCellFocusChanged()},t.prototype.onCellFocusChanged=function(){var e=this.beans.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);e!==this.rowFocused&&(this.rowFocused=e,this.setFocusedClasses()),!e&&this.editingRow&&this.stopEditing(!1)},t.prototype.onPaginationChanged=function(){var e=this.beans.paginationProxy.getCurrentPage();this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged()),this.refreshFirstAndLastRowStyles()},t.prototype.onTopChanged=function(){this.setRowTop(this.rowNode.rowTop)},t.prototype.onPaginationPixelOffsetChanged=function(){this.onTopChanged()},t.prototype.applyPaginationOffset=function(e,r){return void 0===r&&(r=!1),this.rowNode.isRowPinned()?e:e+this.beans.paginationProxy.getPixelOffset()*(r?1:-1)},t.prototype.setRowTop=function(e){if(!this.printLayout&&me(e)){var r=this.applyPaginationOffset(e),n=(this.rowNode.isRowPinned()?r:this.beans.rowContainerHeightService.getRealPixelPosition(r))+"px";this.setRowTopStyle(n)}},t.prototype.getInitialRowTop=function(e){return this.beans.gridOptionsService.is("suppressRowTransform")?this.getInitialRowTopShared(e):void 0},t.prototype.getInitialTransform=function(e){return this.beans.gridOptionsService.is("suppressRowTransform")?void 0:"translateY("+this.getInitialRowTopShared(e)+")"},t.prototype.getInitialRowTopShared=function(e){if(this.printLayout)return"";var r;if(this.isSticky())r=this.rowNode.stickyRowTop;else{var i=this.slideInAnimation[e]?this.roundRowTopToBounds(this.rowNode.oldRowTop):this.rowNode.rowTop,n=this.applyPaginationOffset(i);r=this.rowNode.isRowPinned()?n:this.beans.rowContainerHeightService.getRealPixelPosition(n)}return r+"px"},t.prototype.setRowTopStyle=function(e){var r=this.beans.gridOptionsService.is("suppressRowTransform");this.allRowGuis.forEach(function(i){return r?i.rowComp.setTop(e):i.rowComp.setTransform("translateY("+e+")")})},t.prototype.getRowNode=function(){return this.rowNode},t.prototype.getCellCtrl=function(e){var r=null;return this.getAllCellCtrls().forEach(function(i){i.getColumn()==e&&(r=i)}),null!=r||this.getAllCellCtrls().forEach(function(i){i.getColSpanningList().indexOf(e)>=0&&(r=i)}),r},t.prototype.onRowIndexChanged=function(){null!=this.rowNode.rowIndex&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())},t.prototype.updateRowIndexes=function(e){var r=this.rowNode.getRowIndexString(),i=this.beans.headerNavigationService.getHeaderRowCount(),n=this.rowNode.rowIndex%2==0,u=i+this.rowNode.rowIndex+1;this.forEachGui(e,function(c){c.rowComp.setRowIndex(r),c.rowComp.addOrRemoveCssClass("ag-row-even",n),c.rowComp.addOrRemoveCssClass("ag-row-odd",!n),ju(c.element,u)})},t.prototype.getPinnedLeftRowElement=function(){return this.leftGui?this.leftGui.element:void 0},t.prototype.getPinnedRightRowElement=function(){return this.rightGui?this.rightGui.element:void 0},t.prototype.getBodyRowElement=function(){return this.centerGui?this.centerGui.element:void 0},t.prototype.getFullWidthRowElement=function(){return this.fullWidthGui?this.fullWidthGui.element:void 0},t.DOM_DATA_KEY_ROW_CTRL="renderedRow",t}(we),Ic=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ti=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Mg=function(o){function t(e){var r=o.call(this)||this;return r.element=e,r}return Ic(t,o),t.prototype.postConstruct=function(){this.addMouseListeners(),this.mockContextMenuForIPad(),this.addKeyboardEvents()},t.prototype.addKeyboardEvents=function(){var e=this;["keydown","keypress"].forEach(function(i){var n=e.processKeyboardEvent.bind(e,i);e.addManagedListener(e.element,i,n)})},t.prototype.addMouseListeners=function(){var e=this;["dblclick","contextmenu","mouseover","mouseout","click",al("touchstart")?"touchstart":"mousedown"].forEach(function(n){var u=e.processMouseEvent.bind(e,n);e.addManagedListener(e.element,n,u)})},t.prototype.processMouseEvent=function(e,r){if(this.mouseEventService.isEventFromThisGrid(r)&&!tn(r)){var i=this.getRowForEvent(r),n=this.mouseEventService.getRenderedCellForEvent(r);"contextmenu"===e?this.handleContextMenuMouseEvent(r,null,i,n):(n&&n.onMouseEvent(e,r),i&&i.onMouseEvent(e,r))}},t.prototype.mockContextMenuForIPad=function(){var e=this;if(on()){var r=new Ut(this.element);this.addManagedListener(r,Ut.EVENT_LONG_TAP,function(n){var u=e.getRowForEvent(n.touchEvent),c=e.mouseEventService.getRenderedCellForEvent(n.touchEvent);e.handleContextMenuMouseEvent(null,n.touchEvent,u,c)}),this.addDestroyFunc(function(){return r.destroy()})}},t.prototype.getRowForEvent=function(e){for(var r=e.target;r;){var i=this.gridOptionsService.getDomData(r,Go.DOM_DATA_KEY_ROW_CTRL);if(i)return i;r=r.parentElement}return null},t.prototype.handleContextMenuMouseEvent=function(e,r,i,n){var u=i?i.getRowNode():null,c=n?n.getColumn():null,v=null;if(c){var m=e||r;n.dispatchCellContextMenuEvent(m),v=this.valueService.getValue(c,u)}var C=this.ctrlsService.getGridBodyCtrl(),_=n?n.getGui():C.getGridBodyElement();this.contextMenuFactory&&this.contextMenuFactory.onContextMenu(e,r,u,c,v,_)},t.prototype.processKeyboardEvent=function(e,r){var i=ll(this.gridOptionsService,r.target,ko.DOM_DATA_KEY_CELL_CTRL),n=ll(this.gridOptionsService,r.target,Go.DOM_DATA_KEY_ROW_CTRL);r.defaultPrevented||(i?this.processCellKeyboardEvent(i,e,r):n&&n.isFullWidth()&&this.processFullWidthRowKeyboardEvent(n,e,r))},t.prototype.processCellKeyboardEvent=function(e,r,i){var n=e.getRowNode(),u=e.getColumn(),c=e.isEditing();if(!Zu(this.gridOptionsService,i,n,u,c))switch(r){case"keydown":!c&&this.navigationService.handlePageScrollingKey(i)||e.onKeyDown(i),this.doGridOperations(i,e.isEditing());break;case"keypress":e.onKeyPress(i)}if("keydown"===r){var C=e.createEvent(i,I.EVENT_CELL_KEY_DOWN);this.eventService.dispatchEvent(C)}if("keypress"===r){var _=e.createEvent(i,I.EVENT_CELL_KEY_PRESS);this.eventService.dispatchEvent(_)}},t.prototype.processFullWidthRowKeyboardEvent=function(e,r,i){var n=e.getRowNode(),u=this.focusService.getFocusedCell(),c=u&&u.column;if(!Zu(this.gridOptionsService,i,n,c,!1)){var m=i.key;if("keydown"===r)switch(m){case ve.PAGE_HOME:case ve.PAGE_END:this.navigationService.handlePageScrollingKey(i);break;case ve.UP:case ve.DOWN:e.onKeyboardNavigate(i);break;case ve.TAB:e.onTabKeyDown(i)}}if("keydown"===r){var C=e.createRowEvent(I.EVENT_CELL_KEY_DOWN,i);this.eventService.dispatchEvent(C)}if("keypress"===r){var _=e.createRowEvent(I.EVENT_CELL_KEY_PRESS,i);this.eventService.dispatchEvent(_)}},t.prototype.doGridOperations=function(e,r){if((e.ctrlKey||e.metaKey)&&!r&&this.mouseEventService.isEventFromThisGrid(e)){var i=up(e);if(i===ve.A)return this.onCtrlAndA(e);if(i===ve.C)return this.onCtrlAndC(e);if(i===ve.X)return this.onCtrlAndX(e);if(i===ve.V)return this.onCtrlAndV();if(i===ve.D)return this.onCtrlAndD(e);if(i===ve.Z)return this.onCtrlAndZ(e);if(i===ve.Y)return this.onCtrlAndY()}},t.prototype.onCtrlAndA=function(e){var r=this,i=r.pinnedRowModel,n=r.paginationProxy,u=r.rangeService;if(u&&n.isRowsToRender()){var c=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n}([i.isEmpty("top"),i.isEmpty("bottom")],2),C=c[0]?null:"top",_=void 0,O=void 0;c[1]?(_=null,O=this.paginationProxy.getRowCount()-1):(_="bottom",O=i.getPinnedBottomRowData().length-1);var P=this.columnModel.getAllDisplayedColumns();if(Ve(P))return;u.setCellRange({rowStartIndex:0,rowStartPinned:C,rowEndIndex:O,rowEndPinned:_,columnStart:P[0],columnEnd:Mt(P)})}e.preventDefault()},t.prototype.onCtrlAndC=function(e){!this.clipboardService||this.gridOptionsService.is("enableCellTextSelection")||(this.clipboardService.copyToClipboard(),e.preventDefault())},t.prototype.onCtrlAndX=function(e){!this.clipboardService||this.gridOptionsService.is("enableCellTextSelection")||this.gridOptionsService.is("suppressCutToClipboard")||(this.clipboardService.cutToClipboard(),e.preventDefault())},t.prototype.onCtrlAndV=function(){it.isRegistered(Ne.ClipboardModule)&&!this.gridOptionsService.is("suppressClipboardPaste")&&this.clipboardService.pasteFromClipboard()},t.prototype.onCtrlAndD=function(e){it.isRegistered(Ne.ClipboardModule)&&!this.gridOptionsService.is("suppressClipboardPaste")&&this.clipboardService.copyRangeDown(),e.preventDefault()},t.prototype.onCtrlAndZ=function(e){this.gridOptionsService.is("undoRedoCellEditing")&&(e.preventDefault(),e.shiftKey?this.undoRedoService.redo("ui"):this.undoRedoService.undo("ui"))},t.prototype.onCtrlAndY=function(){this.undoRedoService.redo("ui")},Ti([D("mouseEventService")],t.prototype,"mouseEventService",void 0),Ti([D("valueService")],t.prototype,"valueService",void 0),Ti([Ft("contextMenuFactory")],t.prototype,"contextMenuFactory",void 0),Ti([D("ctrlsService")],t.prototype,"ctrlsService",void 0),Ti([D("navigationService")],t.prototype,"navigationService",void 0),Ti([D("focusService")],t.prototype,"focusService",void 0),Ti([D("undoRedoService")],t.prototype,"undoRedoService",void 0),Ti([D("columnModel")],t.prototype,"columnModel",void 0),Ti([D("paginationProxy")],t.prototype,"paginationProxy",void 0),Ti([D("pinnedRowModel")],t.prototype,"pinnedRowModel",void 0),Ti([Ft("rangeService")],t.prototype,"rangeService",void 0),Ti([Ft("clipboardService")],t.prototype,"clipboardService",void 0),Ti([Re],t.prototype,"postConstruct",null),t}(we),rd=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),uo=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Ng=function(o){function t(e){var r=o.call(this)||this;return r.centerContainerCtrl=e,r}return rd(t,o),t.prototype.postConstruct=function(){var e=this;this.ctrlsService.whenReady(function(){e.gridBodyCtrl=e.ctrlsService.getGridBodyCtrl(),e.listenForResize()}),this.addManagedListener(this.eventService,I.EVENT_SCROLLBAR_WIDTH_CHANGED,this.onScrollbarWidthChanged.bind(this))},t.prototype.listenForResize=function(){var e=this,r=function(){return e.onCenterViewportResized()};this.centerContainerCtrl.registerViewportResizeListener(r),this.gridBodyCtrl.registerBodyViewportResizeListener(r)},t.prototype.onScrollbarWidthChanged=function(){this.checkViewportAndScrolls()},t.prototype.onCenterViewportResized=function(){if(this.centerContainerCtrl.isViewportVisible()){this.checkViewportAndScrolls();var e=this.centerContainerCtrl.getCenterWidth();e!==this.centerWidth&&(this.centerWidth=e,this.columnModel.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0},t.prototype.checkViewportAndScrolls=function(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.getScrollFeature().checkScrollLeft()},t.prototype.getBodyHeight=function(){return this.bodyHeight},t.prototype.checkBodyHeight=function(){var r=as(this.gridBodyCtrl.getBodyViewportElement());if(this.bodyHeight!==r){this.bodyHeight=r;var i={type:I.EVENT_BODY_HEIGHT_CHANGED};this.eventService.dispatchEvent(i)}},t.prototype.updateScrollVisibleService=function(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)},t.prototype.updateScrollVisibleServiceImpl=function(){var e={horizontalScrollShowing:this.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleService.setScrollsVisible(e)},t.prototype.isHorizontalScrollShowing=function(){return this.centerContainerCtrl.isHorizontalScrollShowing()},t.prototype.onHorizontalViewportChanged=function(){var e=this.centerContainerCtrl.getCenterWidth(),r=this.centerContainerCtrl.getViewportScrollLeft();this.columnModel.setViewportPosition(e,r)},uo([D("ctrlsService")],t.prototype,"ctrlsService",void 0),uo([D("columnModel")],t.prototype,"columnModel",void 0),uo([D("scrollVisibleService")],t.prototype,"scrollVisibleService",void 0),uo([Re],t.prototype,"postConstruct",null),t}(we),kg=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),id=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Gg=function(o){function t(e){var r=o.call(this)||this;return r.element=e,r}return kg(t,o),t.prototype.postConstruct=function(){this.addManagedListener(this.eventService,I.EVENT_LEFT_PINNED_WIDTH_CHANGED,this.onPinnedLeftWidthChanged.bind(this))},t.prototype.onPinnedLeftWidthChanged=function(){var e=this.pinnedWidthService.getPinnedLeftWidth(),r=e>0;Ze(this.element,r),ci(this.element,e)},t.prototype.getWidth=function(){return this.pinnedWidthService.getPinnedLeftWidth()},id([D("pinnedWidthService")],t.prototype,"pinnedWidthService",void 0),id([Re],t.prototype,"postConstruct",null),t}(we),Hg=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),nd=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Bg=function(o){function t(e){var r=o.call(this)||this;return r.element=e,r}return Hg(t,o),t.prototype.postConstruct=function(){this.addManagedListener(this.eventService,I.EVENT_RIGHT_PINNED_WIDTH_CHANGED,this.onPinnedRightWidthChanged.bind(this))},t.prototype.onPinnedRightWidthChanged=function(){var e=this.pinnedWidthService.getPinnedRightWidth(),r=e>0;Ze(this.element,r),ci(this.element,e)},t.prototype.getWidth=function(){return this.pinnedWidthService.getPinnedRightWidth()},nd([D("pinnedWidthService")],t.prototype,"pinnedWidthService",void 0),nd([Re],t.prototype,"postConstruct",null),t}(we),Vg=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),od=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},sd=function(o){function t(e,r){var i=o.call(this)||this;return i.eContainer=e,i.eWrapper=r,i}return Vg(t,o),t.prototype.postConstruct=function(){this.addManagedListener(this.eventService,I.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onHeightChanged.bind(this))},t.prototype.onHeightChanged=function(){var e=this.maxDivHeightScaler.getUiContainerHeight(),r=null!=e?e+"px":"";this.eContainer.style.height=r,this.eWrapper&&(this.eWrapper.style.height=r)},od([D("rowContainerHeightService")],t.prototype,"maxDivHeightScaler",void 0),od([Re],t.prototype,"postConstruct",null),t}(we),Wg=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Lc=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Ug=function(o){function t(e){var r=o.call(this)||this;return r.eContainer=e,r}return Wg(t,o),t.prototype.postConstruct=function(){var e=this;if(this.gridOptionsService.isEnableRangeSelection()&&!Je(this.rangeService)){var r={eElement:this.eContainer,onDragStart:this.rangeService.onDragStart.bind(this.rangeService),onDragStop:this.rangeService.onDragStop.bind(this.rangeService),onDragging:this.rangeService.onDragging.bind(this.rangeService)};this.dragService.addDragSource(r),this.addDestroyFunc(function(){return e.dragService.removeDragSource(r)})}},Lc([Ft("rangeService")],t.prototype,"rangeService",void 0),Lc([D("dragService")],t.prototype,"dragService",void 0),Lc([Re],t.prototype,"postConstruct",null),t}(we),jg=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ad=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Mc=function(o){function t(e,r){void 0===r&&(r=!1);var i=o.call(this)||this;return i.callback=e,i.addSpacer=r,i}return jg(t,o),t.prototype.postConstruct=function(){var e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedListener(this.eventService,I.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,I.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,e),this.addManagedListener(this.eventService,I.EVENT_LEFT_PINNED_WIDTH_CHANGED,e),this.addSpacer&&(this.addManagedListener(this.eventService,I.EVENT_RIGHT_PINNED_WIDTH_CHANGED,e),this.addManagedListener(this.eventService,I.EVENT_SCROLL_VISIBILITY_CHANGED,e),this.addManagedListener(this.eventService,I.EVENT_SCROLLBAR_WIDTH_CHANGED,e)),this.setWidth()},t.prototype.setWidth=function(){var c,e=this.columnModel,r=this.gridOptionsService.isDomLayout("print"),i=e.getBodyContainerWidth(),n=e.getDisplayedColumnsLeftWidth(),u=e.getDisplayedColumnsRightWidth();if(r)c=i+n+u;else if(c=i,this.addSpacer){0===(this.gridOptionsService.is("enableRtl")?n:u)&&this.scrollVisibleService.isVerticalScrollShowing()&&(c+=this.gridOptionsService.getScrollbarWidth())}this.callback(c)},ad([D("columnModel")],t.prototype,"columnModel",void 0),ad([D("scrollVisibleService")],t.prototype,"scrollVisibleService",void 0),ad([Re],t.prototype,"postConstruct",null),t}(we),zg=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ho=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Kg=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n};!function(o){o.LEFT="left",o.RIGHT="right",o.CENTER="center",o.FULL_WIDTH="fullWidth",o.TOP_LEFT="topLeft",o.TOP_RIGHT="topRight",o.TOP_CENTER="topCenter",o.TOP_FULL_WIDTH="topFullWidth",o.STICKY_TOP_LEFT="stickyTopLeft",o.STICKY_TOP_RIGHT="stickyTopRight",o.STICKY_TOP_CENTER="stickyTopCenter",o.STICKY_TOP_FULL_WIDTH="stickyTopFullWidth",o.BOTTOM_LEFT="bottomLeft",o.BOTTOM_RIGHT="bottomRight",o.BOTTOM_CENTER="bottomCenter",o.BOTTOM_FULL_WIDTH="bottomFullWidth"}(ue||(ue={})),function(o){o.LEFT="left",o.RIGHT="right",o.CENTER="center",o.FULL_WIDTH="fullWidth"}(Kr||(Kr={}));var Xg=bn([[ue.CENTER,"ag-center-cols-container"],[ue.LEFT,"ag-pinned-left-cols-container"],[ue.RIGHT,"ag-pinned-right-cols-container"],[ue.FULL_WIDTH,"ag-full-width-container"],[ue.TOP_CENTER,"ag-floating-top-container"],[ue.TOP_LEFT,"ag-pinned-left-floating-top"],[ue.TOP_RIGHT,"ag-pinned-right-floating-top"],[ue.TOP_FULL_WIDTH,"ag-floating-top-full-width-container"],[ue.STICKY_TOP_CENTER,"ag-sticky-top-container"],[ue.STICKY_TOP_LEFT,"ag-pinned-left-sticky-top"],[ue.STICKY_TOP_RIGHT,"ag-pinned-right-sticky-top"],[ue.STICKY_TOP_FULL_WIDTH,"ag-sticky-top-full-width-container"],[ue.BOTTOM_CENTER,"ag-floating-bottom-container"],[ue.BOTTOM_LEFT,"ag-pinned-left-floating-bottom"],[ue.BOTTOM_RIGHT,"ag-pinned-right-floating-bottom"],[ue.BOTTOM_FULL_WIDTH,"ag-floating-bottom-full-width-container"]]),qg=bn([[ue.CENTER,"ag-center-cols-viewport"],[ue.TOP_CENTER,"ag-floating-top-viewport"],[ue.STICKY_TOP_CENTER,"ag-sticky-top-viewport"],[ue.BOTTOM_CENTER,"ag-floating-bottom-viewport"]]),ld=bn([[ue.CENTER,"ag-center-cols-clipper"]]),$l=function(o){function t(e){var r=o.call(this)||this;return r.visible=!0,r.EMPTY_CTRLS=[],r.name=e,r.isFullWithContainer=r.name===ue.TOP_FULL_WIDTH||r.name===ue.STICKY_TOP_FULL_WIDTH||r.name===ue.BOTTOM_FULL_WIDTH||r.name===ue.FULL_WIDTH,r}return zg(t,o),t.getRowContainerCssClasses=function(e){return{container:Xg.get(e),viewport:qg.get(e),wrapper:ld.get(e)}},t.getPinned=function(e){switch(e){case ue.BOTTOM_LEFT:case ue.TOP_LEFT:case ue.STICKY_TOP_LEFT:case ue.LEFT:return"left";case ue.BOTTOM_RIGHT:case ue.TOP_RIGHT:case ue.STICKY_TOP_RIGHT:case ue.RIGHT:return"right";default:return null}},t.prototype.postConstruct=function(){var e=this;this.enableRtl=this.gridOptionsService.is("enableRtl"),this.embedFullWidthRows=this.gridOptionsService.is("embedFullWidthRows"),this.forContainers([ue.CENTER],function(){return e.viewportSizeFeature=e.createManagedBean(new Ng(e))})},t.prototype.registerWithCtrlsService=function(){switch(this.name){case ue.CENTER:this.ctrlsService.registerCenterRowContainerCtrl(this);break;case ue.LEFT:this.ctrlsService.registerLeftRowContainerCtrl(this);break;case ue.RIGHT:this.ctrlsService.registerRightRowContainerCtrl(this);break;case ue.TOP_CENTER:this.ctrlsService.registerTopCenterRowContainerCtrl(this);break;case ue.TOP_LEFT:this.ctrlsService.registerTopLeftRowContainerCon(this);break;case ue.TOP_RIGHT:this.ctrlsService.registerTopRightRowContainerCtrl(this);break;case ue.STICKY_TOP_CENTER:this.ctrlsService.registerStickyTopCenterRowContainerCtrl(this);break;case ue.STICKY_TOP_LEFT:this.ctrlsService.registerStickyTopLeftRowContainerCon(this);break;case ue.STICKY_TOP_RIGHT:this.ctrlsService.registerStickyTopRightRowContainerCtrl(this);break;case ue.BOTTOM_CENTER:this.ctrlsService.registerBottomCenterRowContainerCtrl(this);break;case ue.BOTTOM_LEFT:this.ctrlsService.registerBottomLeftRowContainerCtrl(this);break;case ue.BOTTOM_RIGHT:this.ctrlsService.registerBottomRightRowContainerCtrl(this)}},t.prototype.forContainers=function(e,r){e.indexOf(this.name)>=0&&r()},t.prototype.getContainerElement=function(){return this.eContainer},t.prototype.getViewportSizeFeature=function(){return this.viewportSizeFeature},t.prototype.setComp=function(e,r,i,n){var u=this;this.comp=e,this.eContainer=r,this.eViewport=i,this.eWrapper=n,this.createManagedBean(new Mg(this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder(),this.stopHScrollOnPinnedRows();var c=[ue.TOP_CENTER,ue.TOP_LEFT,ue.TOP_RIGHT],v=[ue.STICKY_TOP_CENTER,ue.STICKY_TOP_LEFT,ue.STICKY_TOP_RIGHT],_=function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(Kg(arguments[t]));return o}(c,[ue.BOTTOM_CENTER,ue.BOTTOM_LEFT,ue.BOTTOM_RIGHT],[ue.CENTER,ue.LEFT,ue.RIGHT],v),O=[ue.CENTER,ue.LEFT,ue.RIGHT,ue.FULL_WIDTH],P=[ue.CENTER,ue.TOP_CENTER,ue.STICKY_TOP_CENTER,ue.BOTTOM_CENTER],L=[ue.LEFT,ue.BOTTOM_LEFT,ue.TOP_LEFT,ue.STICKY_TOP_LEFT],z=[ue.RIGHT,ue.BOTTOM_RIGHT,ue.TOP_RIGHT,ue.STICKY_TOP_RIGHT];this.forContainers(L,function(){u.pinnedWidthFeature=u.createManagedBean(new Gg(u.eContainer)),u.addManagedListener(u.eventService,I.EVENT_LEFT_PINNED_WIDTH_CHANGED,function(){return u.onPinnedWidthChanged()})}),this.forContainers(z,function(){u.pinnedWidthFeature=u.createManagedBean(new Bg(u.eContainer)),u.addManagedListener(u.eventService,I.EVENT_RIGHT_PINNED_WIDTH_CHANGED,function(){return u.onPinnedWidthChanged()})}),this.forContainers(O,function(){return u.createManagedBean(new sd(u.eContainer,u.eWrapper))}),this.forContainers(_,function(){return u.createManagedBean(new Ug(u.eContainer))}),this.forContainers(P,function(){return u.createManagedBean(new Mc(function(q){return u.comp.setContainerWidth(q+"px")}))}),an()&&(this.forContainers([ue.CENTER],function(){var q=u.enableRtl?I.EVENT_LEFT_PINNED_WIDTH_CHANGED:I.EVENT_RIGHT_PINNED_WIDTH_CHANGED;u.addManagedListener(u.eventService,q,function(){return u.refreshPaddingForFakeScrollbar()})}),this.refreshPaddingForFakeScrollbar()),this.addListeners(),this.registerWithCtrlsService()},t.prototype.refreshPaddingForFakeScrollbar=function(){var e=this,r=e.enableRtl,i=e.columnModel,n=e.name,u=e.eWrapper,c=e.eContainer,v=r?ue.LEFT:ue.RIGHT;this.forContainers([ue.CENTER,v],function(){var m=i.getContainerWidth(v),C=r?"marginLeft":"marginRight";n===ue.CENTER?u.style[C]=m?"0px":"16px":c.style[C]=m?"16px":"0px"})},t.prototype.addListeners=function(){var e=this;this.addManagedListener(this.eventService,I.EVENT_SCROLL_VISIBILITY_CHANGED,function(){return e.onScrollVisibilityChanged()}),this.addManagedListener(this.eventService,I.EVENT_DISPLAYED_COLUMNS_CHANGED,function(){return e.onDisplayedColumnsChanged()}),this.addManagedListener(this.eventService,I.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,function(){return e.onDisplayedColumnsWidthChanged()}),this.addManagedListener(this.eventService,I.EVENT_DISPLAYED_ROWS_CHANGED,function(r){return e.onDisplayedRowsChanged(r.afterScroll)}),this.onScrollVisibilityChanged(),this.onDisplayedColumnsChanged(),this.onDisplayedColumnsWidthChanged(),this.onDisplayedRowsChanged()},t.prototype.listenOnDomOrder=function(){var e=this;if([ue.STICKY_TOP_CENTER,ue.STICKY_TOP_LEFT,ue.STICKY_TOP_RIGHT,ue.STICKY_TOP_FULL_WIDTH].indexOf(this.name)>=0)this.comp.setDomOrder(!0);else{var n=function(){var u=e.gridOptionsService.is("ensureDomOrder"),c=e.gridOptionsService.isDomLayout("print");e.comp.setDomOrder(u||c)};this.addManagedPropertyListener("domLayout",n),n()}},t.prototype.stopHScrollOnPinnedRows=function(){var e=this;this.forContainers([ue.TOP_CENTER,ue.STICKY_TOP_CENTER,ue.BOTTOM_CENTER],function(){e.addManagedListener(e.eViewport,"scroll",function(){return e.eViewport.scrollLeft=0})})},t.prototype.onDisplayedColumnsChanged=function(){var e=this;this.forContainers([ue.CENTER],function(){return e.onHorizontalViewportChanged()})},t.prototype.onDisplayedColumnsWidthChanged=function(){var e=this;this.forContainers([ue.CENTER],function(){return e.onHorizontalViewportChanged()})},t.prototype.onScrollVisibilityChanged=function(){var e=this.gridOptionsService.getScrollbarWidth()||0;if(this.name===ue.CENTER){var i=this.scrollVisibleService.isHorizontalScrollShowing()?e:0,n=0==i?"100%":"calc(100% + "+i+"px)";this.comp.setViewportHeight(n)}if(this.name===ue.FULL_WIDTH){n="calc(100% - "+(an()?16:0)+"px)";this.eContainer.style.setProperty("width",n)}},t.prototype.addPreventScrollWhileDragging=function(){var e=this,r=function(i){e.dragService.isDragging()&&i.cancelable&&i.preventDefault()};this.eContainer.addEventListener("touchmove",r,{passive:!1}),this.addDestroyFunc(function(){return e.eContainer.removeEventListener("touchmove",r)})},t.prototype.onHorizontalViewportChanged=function(){var e=this.getCenterWidth(),r=this.getCenterViewportScrollLeft();this.columnModel.setViewportPosition(e,r)},t.prototype.getCenterWidth=function(){return Ei(this.eViewport)},t.prototype.getCenterViewportScrollLeft=function(){return Xs(this.eViewport,this.enableRtl)},t.prototype.registerViewportResizeListener=function(e){var r=this.resizeObserverService.observeResize(this.eViewport,e);this.addDestroyFunc(function(){return r()})},t.prototype.isViewportVisible=function(){return ls(this.eViewport)},t.prototype.getViewportScrollLeft=function(){return Xs(this.eViewport,this.enableRtl)},t.prototype.isHorizontalScrollShowing=function(){return this.gridOptionsService.is("alwaysShowHorizontalScroll")||xl(this.eViewport)},t.prototype.getViewportElement=function(){return this.eViewport},t.prototype.setContainerTranslateX=function(e){this.eContainer.style.transform="translateX("+e+"px)"},t.prototype.getHScrollPosition=function(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}},t.prototype.setCenterViewportScrollLeft=function(e){li(this.eViewport,e,this.enableRtl)},t.prototype.isContainerVisible=function(){return!t.getPinned(this.name)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0},t.prototype.onPinnedWidthChanged=function(){var e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged()),an()&&this.refreshPaddingForFakeScrollbar()},t.prototype.onDisplayedRowsChanged=function(e){var r=this;if(void 0===e&&(e=!1),this.visible){var i=this.gridOptionsService.isDomLayout("print"),u=this.getRowCtrls().filter(function(c){var v=c.isFullWidth(),m=r.embedFullWidthRows||i;return r.isFullWithContainer?!m&&v:m||!v});this.comp.setRowCtrls(u,e)}else this.comp.setRowCtrls(this.EMPTY_CTRLS,!1)},t.prototype.getRowCtrls=function(){switch(this.name){case ue.TOP_CENTER:case ue.TOP_LEFT:case ue.TOP_RIGHT:case ue.TOP_FULL_WIDTH:return this.rowRenderer.getTopRowCtrls();case ue.STICKY_TOP_CENTER:case ue.STICKY_TOP_LEFT:case ue.STICKY_TOP_RIGHT:case ue.STICKY_TOP_FULL_WIDTH:return this.rowRenderer.getStickyTopRowCtrls();case ue.BOTTOM_CENTER:case ue.BOTTOM_LEFT:case ue.BOTTOM_RIGHT:case ue.BOTTOM_FULL_WIDTH:return this.rowRenderer.getBottomRowCtrls();default:return this.rowRenderer.getRowCtrls()}},Ho([D("scrollVisibleService")],t.prototype,"scrollVisibleService",void 0),Ho([D("dragService")],t.prototype,"dragService",void 0),Ho([D("ctrlsService")],t.prototype,"ctrlsService",void 0),Ho([D("columnModel")],t.prototype,"columnModel",void 0),Ho([D("resizeObserverService")],t.prototype,"resizeObserverService",void 0),Ho([D("rowRenderer")],t.prototype,"rowRenderer",void 0),Ho([Re],t.prototype,"postConstruct",null),t}(we),Qg=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),vn=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Jg='<div class="ag-root ag-unselectable" role="treegrid">\n        <ag-header-root ref="gridHeader"></ag-header-root>\n        <div class="ag-floating-top" ref="eTop" role="presentation">\n            <ag-row-container ref="topLeftContainer" name="'+ue.TOP_LEFT+'"></ag-row-container>\n            <ag-row-container ref="topCenterContainer" name="'+ue.TOP_CENTER+'"></ag-row-container>\n            <ag-row-container ref="topRightContainer" name="'+ue.TOP_RIGHT+'"></ag-row-container>\n            <ag-row-container ref="topFullWidthContainer" name="'+ue.TOP_FULL_WIDTH+'"></ag-row-container>\n        </div>\n        <div class="ag-body" ref="eBody" role="presentation">\n            <div class="ag-body-clipper" ref="eBodyClipper" role="presentation">\n                <div class="ag-body-viewport" ref="eBodyViewport" role="presentation">\n                    <ag-row-container ref="leftContainer" name="'+ue.LEFT+'"></ag-row-container>\n                    <ag-row-container ref="centerContainer" name="'+ue.CENTER+'"></ag-row-container>\n                    <ag-row-container ref="rightContainer" name="'+ue.RIGHT+'"></ag-row-container>\n                    <ag-row-container ref="fullWidthContainer" name="'+ue.FULL_WIDTH+'"></ag-row-container>\n                </div>\n            </div>\n            <ag-fake-vertical-scroll></ag-fake-vertical-scroll>\n        </div>\n        <div class="ag-sticky-top" ref="eStickyTop" role="presentation">\n            <ag-row-container ref="stickyTopLeftContainer" name="'+ue.STICKY_TOP_LEFT+'"></ag-row-container>\n            <ag-row-container ref="stickyTopCenterContainer" name="'+ue.STICKY_TOP_CENTER+'"></ag-row-container>\n            <ag-row-container ref="stickyTopRightContainer" name="'+ue.STICKY_TOP_RIGHT+'"></ag-row-container>\n            <ag-row-container ref="stickyTopFullWidthContainer" name="'+ue.STICKY_TOP_FULL_WIDTH+'"></ag-row-container>\n        </div>\n        <div class="ag-floating-bottom" ref="eBottom" role="presentation">\n            <ag-row-container ref="bottomLeftContainer" name="'+ue.BOTTOM_LEFT+'"></ag-row-container>\n            <ag-row-container ref="bottomCenterContainer" name="'+ue.BOTTOM_CENTER+'"></ag-row-container>\n            <ag-row-container ref="bottomRightContainer" name="'+ue.BOTTOM_RIGHT+'"></ag-row-container>\n            <ag-row-container ref="bottomFullWidthContainer" name="'+ue.BOTTOM_FULL_WIDTH+'"></ag-row-container>\n        </div>\n        <ag-fake-horizontal-scroll></ag-fake-horizontal-scroll>\n        <ag-overlay-wrapper></ag-overlay-wrapper>\n    </div>',Zg=function(o){function t(){return o.call(this,Jg)||this}return Qg(t,o),t.prototype.init=function(){var e=this,r=function(n,u){var c=n+"px";u.style.minHeight=c,u.style.height=c},i={setRowAnimationCssOnBodyViewport:function(n,u){return e.setRowAnimationCssOnBodyViewport(n,u)},setColumnCount:function(n){return Zf(e.getGui(),n)},setRowCount:function(n){return ai(e.getGui(),n)},setTopHeight:function(n){return r(n,e.eTop)},setBottomHeight:function(n){return r(n,e.eBottom)},setTopDisplay:function(n){return e.eTop.style.display=n},setBottomDisplay:function(n){return e.eBottom.style.display=n},setStickyTopHeight:function(n){return e.eStickyTop.style.height=n},setStickyTopTop:function(n){return e.eStickyTop.style.top=n},setStickyTopWidth:function(n){return e.eStickyTop.style.width=n},setColumnMovingCss:function(n,u){return e.addOrRemoveCssClass(n,u)},updateLayoutClasses:function(n,u){[e.eBodyViewport.classList,e.eBodyClipper.classList,e.eBody.classList].forEach(function(v){v.toggle(yr.AUTO_HEIGHT,u.autoHeight),v.toggle(yr.NORMAL,u.normal),v.toggle(yr.PRINT,u.print)}),e.addOrRemoveCssClass(yr.AUTO_HEIGHT,u.autoHeight),e.addOrRemoveCssClass(yr.NORMAL,u.normal),e.addOrRemoveCssClass(yr.PRINT,u.print)},setAlwaysVerticalScrollClass:function(n,u){return e.eBodyViewport.classList.toggle(Xp,u)},registerBodyViewportResizeListener:function(n){var u=e.resizeObserverService.observeResize(e.eBodyViewport,n);e.addDestroyFunc(function(){return u()})},setPinnedTopBottomOverflowY:function(n){return e.eTop.style.overflowY=e.eBottom.style.overflowY=n},setCellSelectableCss:function(n,u){[e.eTop,e.eBodyViewport,e.eBottom].forEach(function(c){return c.classList.toggle(Ac,u)})},setBodyViewportWidth:function(n){return e.eBodyViewport.style.width=n}};this.ctrl=this.createManagedBean(new Cg),this.ctrl.setComp(i,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop),(this.rangeService||"multiple"===this.gridOptionsService.get("rowSelection"))&&Fn(this.getGui(),!0)},t.prototype.setRowAnimationCssOnBodyViewport=function(e,r){var i=this.eBodyViewport.classList;i.toggle(No.ANIMATION_ON,r),i.toggle(No.ANIMATION_OFF,!r)},t.prototype.getFloatingTopBottom=function(){return[this.eTop,this.eBottom]},vn([D("resizeObserverService")],t.prototype,"resizeObserverService",void 0),vn([Ft("rangeService")],t.prototype,"rangeService",void 0),vn([Te("eBodyViewport")],t.prototype,"eBodyViewport",void 0),vn([Te("eStickyTop")],t.prototype,"eStickyTop",void 0),vn([Te("eTop")],t.prototype,"eTop",void 0),vn([Te("eBottom")],t.prototype,"eBottom",void 0),vn([Te("gridHeader")],t.prototype,"headerRootComp",void 0),vn([Te("eBodyClipper")],t.prototype,"eBodyClipper",void 0),vn([Te("eBody")],t.prototype,"eBody",void 0),vn([Re],t.prototype,"init",null),t}(Ue),e0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Nc=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},t0=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return e0(t,o),t.prototype.postConstruct=function(){this.addManagedListener(this.eventService,I.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this))},t.prototype.onDisplayedColumnsChanged=function(){this.update()},t.prototype.onDisplayedColumnsWidthChanged=function(){this.update()},t.prototype.update=function(){this.updateImpl(),setTimeout(this.updateImpl.bind(this),500)},t.prototype.updateImpl=function(){var e=this.ctrlsService.getCenterRowContainerCtrl();if(e){var r={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.isVerticalScrollShowing()};this.setScrollsVisible(r)}},t.prototype.setScrollsVisible=function(e){if(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing){this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing;var i={type:I.EVENT_SCROLL_VISIBILITY_CHANGED};this.eventService.dispatchEvent(i)}},t.prototype.isHorizontalScrollShowing=function(){return this.horizontalScrollShowing},t.prototype.isVerticalScrollShowing=function(){return this.verticalScrollShowing},Nc([D("ctrlsService")],t.prototype,"ctrlsService",void 0),Nc([Re],t.prototype,"postConstruct",null),t=Nc([He("scrollVisibleService")],t)}(we),r0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ud=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},i0=function(o){function t(){var r=null!==o&&o.apply(this,arguments)||this;return r.gridInstanceId=e.gridInstanceSequence.next(),r}var e;return r0(t,o),e=t,t.prototype.stampTopLevelGridCompWithGridInstance=function(r){r[e.GRID_DOM_KEY]=this.gridInstanceId},t.prototype.getRenderedCellForEvent=function(r){return ll(this.gridOptionsService,r.target,ko.DOM_DATA_KEY_CELL_CTRL)},t.prototype.isEventFromThisGrid=function(r){return this.isElementInThisGrid(r.target)},t.prototype.isElementInThisGrid=function(r){for(var i=r;i;){var n=i[e.GRID_DOM_KEY];if(me(n))return n===this.gridInstanceId;i=i.parentElement}return!1},t.prototype.getCellPositionForEvent=function(r){var i=this.getRenderedCellForEvent(r);return i?i.getCellPosition():null},t.prototype.getNormalisedPosition=function(r){var u,c,i=this.gridOptionsService.isDomLayout("normal"),n=r;if(null!=n.clientX||null!=n.clientY?(u=n.clientX,c=n.clientY):(u=n.x,c=n.y),i){var v=this.ctrlsService.getGridBodyCtrl(),m=v.getScrollFeature().getVScrollPosition();u+=v.getScrollFeature().getHScrollPosition().left,c+=m.top}return{x:u,y:c}},t.gridInstanceSequence=new cs,t.GRID_DOM_KEY="__ag_grid_instance",ud([D("ctrlsService")],t.prototype,"ctrlsService",void 0),t=e=ud([He("mouseEventService")],t)}(we),n0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Yl=function(){return Yl=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},Yl.apply(this,arguments)},hi=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},o0=function(o){function t(){var e=o.call(this)||this;return e.onPageDown=qo(e.onPageDown,100),e.onPageUp=qo(e.onPageUp,100),e}return n0(t,o),t.prototype.postConstruct=function(){var e=this;this.ctrlsService.whenReady(function(r){e.gridBodyCon=r.gridBodyCtrl})},t.prototype.handlePageScrollingKey=function(e){var r=e.key,i=e.altKey,n=e.ctrlKey||e.metaKey,u=!!this.rangeService&&e.shiftKey,c=this.mouseEventService.getCellPositionForEvent(e),v=!1;switch(r){case ve.PAGE_HOME:case ve.PAGE_END:!n&&!i&&(this.onHomeOrEndKey(r),v=!0);break;case ve.LEFT:case ve.RIGHT:case ve.UP:case ve.DOWN:if(!c)return!1;n&&!i&&!u&&(this.onCtrlUpDownLeftRight(r,c),v=!0);break;case ve.PAGE_DOWN:if(!c)return!1;!n&&!i&&(this.onPageDown(c),v=!0);break;case ve.PAGE_UP:if(!c)return!1;!n&&!i&&(this.onPageUp(c),v=!0)}return v&&e.preventDefault(),v},t.prototype.navigateTo=function(e){var r=e.scrollIndex,i=e.scrollType,n=e.scrollColumn,u=e.focusIndex,c=e.focusColumn;if(me(n)&&!n.isPinned()&&this.gridBodyCon.getScrollFeature().ensureColumnVisible(n),me(r)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(r,i),e.isAsync||this.gridBodyCon.getScrollFeature().ensureIndexVisible(u),this.focusService.setFocusedCell({rowIndex:u,column:c,rowPinned:null,forceBrowserFocus:!0}),this.rangeService){var v={rowIndex:u,rowPinned:null,column:c};this.rangeService.setRangeToCell(v)}},t.prototype.onPageDown=function(e){var i=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),n=this.getViewportHeight(),u=this.paginationProxy.getPixelOffset(),c=i.top+n,v=this.paginationProxy.getRowIndexAtPixel(c+u);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,v):this.navigateToNextPage(e,v)},t.prototype.onPageUp=function(e){var i=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),n=this.paginationProxy.getPixelOffset(),u=i.top,c=this.paginationProxy.getRowIndexAtPixel(u+n);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,c,!0):this.navigateToNextPage(e,c,!0)},t.prototype.navigateToNextPage=function(e,r,i){void 0===i&&(i=!1);var L,n=this.getViewportHeight(),u=this.paginationProxy.getPageFirstRow(),c=this.paginationProxy.getPageLastRow(),v=this.paginationProxy.getPixelOffset(),m=this.paginationProxy.getRow(e.rowIndex),C=i?m?.rowHeight-n-v:n-v,_=m?.rowTop+C,O=this.paginationProxy.getRowIndexAtPixel(_+v);if(O===e.rowIndex){var P=i?-1:1;r=O=e.rowIndex+P}i?(L="bottom",O<u&&(O=u),r<u&&(r=u)):(L="top",O>c&&(O=c),r>c&&(r=c)),this.isRowTallerThanView(O)&&(r=O,L="top"),this.navigateTo({scrollIndex:r,scrollType:L,scrollColumn:null,focusIndex:O,focusColumn:e.column})},t.prototype.navigateToNextPageWithAutoHeight=function(e,r,i){var n=this;void 0===i&&(i=!1),this.navigateTo({scrollIndex:r,scrollType:i?"bottom":"top",scrollColumn:null,focusIndex:r,focusColumn:e.column}),setTimeout(function(){var u=n.getNextFocusIndexForAutoHeight(e,i);n.navigateTo({scrollIndex:r,scrollType:i?"bottom":"top",scrollColumn:null,focusIndex:u,focusColumn:e.column,isAsync:!0})},50)},t.prototype.getNextFocusIndexForAutoHeight=function(e,r){var i;void 0===r&&(r=!1);for(var n=r?-1:1,u=this.getViewportHeight(),c=this.paginationProxy.getPageLastRow(),v=0,m=e.rowIndex;m>=0&&m<=c;){var C=this.paginationProxy.getRow(m);if(C){var _=null!==(i=C.rowHeight)&&void 0!==i?i:0;if(v+_>u)break;v+=_}m+=n}return Math.max(0,Math.min(m,c))},t.prototype.getViewportHeight=function(){var r=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),i=this.gridOptionsService.getScrollbarWidth(),n=r.bottom-r.top;return this.ctrlsService.getCenterRowContainerCtrl().isHorizontalScrollShowing()&&(n-=i),n},t.prototype.isRowTallerThanView=function(e){var r=this.paginationProxy.getRow(e);if(!r)return!1;var i=r.rowHeight;return"number"==typeof i&&i>this.getViewportHeight()},t.prototype.onCtrlUpDownLeftRight=function(e,r){var i=this.cellNavigationService.getNextCellToFocus(e,r,!0),n=i.rowIndex,u=i.column;this.navigateTo({scrollIndex:n,scrollType:null,scrollColumn:u,focusIndex:n,focusColumn:u})},t.prototype.onHomeOrEndKey=function(e){var r=e===ve.PAGE_HOME,i=this.columnModel.getAllDisplayedColumns(),n=r?i[0]:Mt(i),u=r?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow();this.navigateTo({scrollIndex:u,scrollType:null,scrollColumn:n,focusIndex:u,focusColumn:n})},t.prototype.onTabKeyDown=function(e,r){var i=r.shiftKey;if(this.tabToNextCellCommon(e,i,r))r.preventDefault();else if(i){var u=e.getRowPosition(),c=u.rowIndex;(u.rowPinned?0===c:c===this.paginationProxy.getPageFirstRow())&&(0===this.gridOptionsService.getNum("headerHeight")?this.focusService.focusNextGridCoreContainer(!0,!0):(r.preventDefault(),this.focusService.focusLastHeader(r)))}else e instanceof ko&&e.focusCell(!0),this.focusService.focusNextGridCoreContainer(i)&&r.preventDefault()},t.prototype.tabToNextCell=function(e,r){var i=this.focusService.getFocusedCell();if(!i)return!1;var n=this.getCellByPosition(i);return!!(n||(n=this.rowRenderer.getRowByPosition(i),n&&n.isFullWidth()))&&this.tabToNextCellCommon(n,e,r)},t.prototype.tabToNextCellCommon=function(e,r,i){var n=e.isEditing();if(!n&&e instanceof ko){var c=e.getRowCtrl();c&&(n=c.isEditing())}return(n?"fullRow"===this.gridOptionsService.get("editType")?this.moveToNextEditingRow(e,r,i):this.moveToNextEditingCell(e,r,i):this.moveToNextCellNotEditing(e,r))||!!this.focusService.getFocusedHeader()},t.prototype.moveToNextEditingCell=function(e,r,i){void 0===i&&(i=null);var n=e.getCellPosition();e.getGui().focus(),e.stopEditing();var u=this.findNextCellToFocusOn(n,r,!0);return null!=u&&(u.startEditing(null,null,!0,i),u.focusCell(!1),!0)},t.prototype.moveToNextEditingRow=function(e,r,i){void 0===i&&(i=null);var n=e.getCellPosition(),u=this.findNextCellToFocusOn(n,r,!0);if(null==u)return!1;var c=u.getCellPosition(),v=this.isCellEditable(n),m=this.isCellEditable(c),C=c&&n.rowIndex===c.rowIndex&&n.rowPinned===c.rowPinned;(v&&e.setFocusOutOnEditor(),C)||(e.getRowCtrl().stopEditing(),u.getRowCtrl().startRowEditing(void 0,void 0,void 0,i));return m?(u.setFocusInOnEditor(),u.focusCell()):u.focusCell(!0),!0},t.prototype.moveToNextCellNotEditing=function(e,r){var n,i=this.columnModel.getAllDisplayedColumns();n=e instanceof Go?Yl(Yl({},e.getRowPosition()),{column:r?i[0]:Mt(i)}):e.getCellPosition();var u=this.findNextCellToFocusOn(n,r,!1);if(u instanceof ko)u.focusCell(!0);else if(u)return this.tryToFocusFullWidthRow(u.getRowPosition(),r);return me(u)},t.prototype.findNextCellToFocusOn=function(e,r,i){for(var n=e;;){e!==n&&(e=n),r||(n=this.getLastCellOfColSpan(n)),n=this.cellNavigationService.getNextTabbedCell(n,r);var u=this.gridOptionsService.getCallback("tabToNextCell");if(me(u)){var v=u({backwards:r,editing:i,previousCellPosition:e,nextCellPosition:n||null});me(v)?(v.floating&&(_t(function(){console.warn("AG Grid: tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?")},"no floating in userCell"),v.rowPinned=v.floating),n={rowIndex:v.rowIndex,column:v.column,rowPinned:v.rowPinned}):n=null}if(!n)return null;if(n.rowIndex<0){var m=this.headerNavigationService.getHeaderRowCount();return this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:m+n.rowIndex,column:n.column}}),null}var C="fullRow"===this.gridOptionsService.get("editType");if(i&&!C)if(!this.isCellEditable(n))continue;this.ensureCellVisible(n);var O=this.getCellByPosition(n);if(!O){var P=this.rowRenderer.getRowByPosition(n);if(!P||!P.isFullWidth()||i)continue;return P}if(!O.isSuppressNavigable())return this.rangeService&&this.rangeService.setRangeToCell(n),O}},t.prototype.isCellEditable=function(e){var r=this.lookupRowNodeForCell(e);return!!r&&e.column.isCellEditable(r)},t.prototype.getCellByPosition=function(e){var r=this.rowRenderer.getRowByPosition(e);return r?r.getCellCtrl(e.column):null},t.prototype.lookupRowNodeForCell=function(e){return"top"===e.rowPinned?this.pinnedRowModel.getPinnedTopRow(e.rowIndex):"bottom"===e.rowPinned?this.pinnedRowModel.getPinnedBottomRow(e.rowIndex):this.paginationProxy.getRow(e.rowIndex)},t.prototype.navigateToNextCell=function(e,r,i,n){for(var u=i,c=!1;u&&(u===i||!this.isValidNavigateCell(u));)this.gridOptionsService.is("enableRtl")?r===ve.LEFT&&(u=this.getLastCellOfColSpan(u)):r===ve.RIGHT&&(u=this.getLastCellOfColSpan(u)),c=Je(u=this.cellNavigationService.getNextCellToFocus(r,u));if(c&&e&&e.key===ve.UP&&(u={rowIndex:-1,rowPinned:null,column:i.column}),n){var v=this.gridOptionsService.getCallback("navigateToNextCell");if(me(v)){var C=v({key:r,previousCellPosition:i,nextCellPosition:u||null,event:e});me(C)?(C.floating&&(_t(function(){console.warn("AG Grid: tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?")},"no floating in userCell"),C.rowPinned=C.floating),u={rowPinned:C.rowPinned,rowIndex:C.rowIndex,column:C.column}):u=null}}if(u){if(u.rowIndex<0){var _=this.headerNavigationService.getHeaderRowCount();return void this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:_+u.rowIndex,column:i.column},event:e||void 0})}var O=this.getNormalisedPosition(u);O?this.focusPosition(O):this.tryToFocusFullWidthRow(u)}},t.prototype.getNormalisedPosition=function(e){this.ensureCellVisible(e);var r=this.getCellByPosition(e);return r?(e=r.getCellPosition(),this.ensureCellVisible(e),e):null},t.prototype.tryToFocusFullWidthRow=function(e,r){void 0===r&&(r=!1);var i=this.columnModel.getAllDisplayedColumns(),n=this.rowRenderer.getRowByPosition(e);if(!n||!n.isFullWidth())return!1;var u=this.focusService.getFocusedCell(),c={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(r?Mt(i):i[0])};this.focusPosition(c);var v=null!=u&&this.rowPositionUtils.before(c,u),m={type:I.EVENT_FULL_WIDTH_ROW_FOCUSED,rowIndex:c.rowIndex,rowPinned:c.rowPinned,column:c.column,isFullWidthCell:!0,floating:c.rowPinned,fromBelow:v};return this.eventService.dispatchEvent(m),!0},t.prototype.focusPosition=function(e){this.focusService.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),this.rangeService&&this.rangeService.setRangeToCell(e)},t.prototype.isValidNavigateCell=function(e){return!!this.rowPositionUtils.getRowNode(e)},t.prototype.getLastCellOfColSpan=function(e){var r=this.getCellByPosition(e);if(!r)return e;var i=r.getColSpanningList();return 1===i.length?e:{rowIndex:e.rowIndex,column:Mt(i),rowPinned:e.rowPinned}},t.prototype.ensureCellVisible=function(e){var r=this.gridOptionsService.is("groupRowsSticky"),i=this.rowModel.getRow(e.rowIndex);!(r&&i?.sticky)&&Je(e.rowPinned)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(e.rowIndex),e.column.isPinned()||this.gridBodyCon.getScrollFeature().ensureColumnVisible(e.column)},hi([D("mouseEventService")],t.prototype,"mouseEventService",void 0),hi([D("paginationProxy")],t.prototype,"paginationProxy",void 0),hi([D("focusService")],t.prototype,"focusService",void 0),hi([Ft("rangeService")],t.prototype,"rangeService",void 0),hi([D("columnModel")],t.prototype,"columnModel",void 0),hi([D("rowModel")],t.prototype,"rowModel",void 0),hi([D("ctrlsService")],t.prototype,"ctrlsService",void 0),hi([D("rowRenderer")],t.prototype,"rowRenderer",void 0),hi([D("headerNavigationService")],t.prototype,"headerNavigationService",void 0),hi([D("rowPositionUtils")],t.prototype,"rowPositionUtils",void 0),hi([D("cellNavigationService")],t.prototype,"cellNavigationService",void 0),hi([D("pinnedRowModel")],t.prototype,"pinnedRowModel",void 0),hi([Re],t.prototype,"postConstruct",null),t=hi([He("navigationService")],t)}(we),s0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),l0=function(o){function t(e){var r=o.call(this,'<div class="ag-popup-editor" tabindex="-1"/>')||this;return r.params=e,r}return s0(t,o),t.prototype.postConstruct=function(){this.gridOptionsService.setDomData(this.getGui(),t.DOM_KEY_POPUP_EDITOR_WRAPPER,!0),this.addKeyDownListener()},t.prototype.addKeyDownListener=function(){var e=this,r=this.getGui(),i=this.params;this.addManagedListener(r,"keydown",function(u){Zu(e.gridOptionsService,u,i.node,i.column,!0)||i.onKeyDown(u)})},t.DOM_KEY_POPUP_EDITOR_WRAPPER="popupEditorWrapper",function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);i>3&&n&&Object.defineProperty(t,e,n)}([Re],t.prototype,"postConstruct",null),t}(sa),u0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),cd=function(o){function t(e,r,i,n,u){var c=o.call(this)||this;c.rendererVersion=0,c.editorVersion=0,c.beans=e,c.column=r.getColumn(),c.rowNode=r.getRowNode(),c.rowCtrl=r.getRowCtrl(),c.eRow=n,c.setTemplate('<div comp-id="'+c.getCompId()+'"/>');var v=c.getGui();c.forceWrapper=r.isForceWrapper(),c.refreshWrapper(!1);var m=function(_,O,P){var L=P||v;null!=O&&""!=O?L.setAttribute(_,O):L.removeAttribute(_)},C={addOrRemoveCssClass:function(_,O){return c.addOrRemoveCssClass(_,O)},setUserStyles:function(_){return _l(v,_)},getFocusableElement:function(){return c.getFocusableElement()},setTabIndex:function(_){return m("tabindex",_.toString())},setRole:function(_){return vt(v,_)},setColId:function(_){return m("col-id",_)},setTitle:function(_){return m("title",_)},setIncludeSelection:function(_){return c.includeSelection=_},setIncludeRowDrag:function(_){return c.includeRowDrag=_},setIncludeDndSource:function(_){return c.includeDndSource=_},setRenderDetails:function(_,O,P){return c.setRenderDetails(_,O,P)},setEditDetails:function(_,O,P){return c.setEditDetails(_,O,P)},getCellEditor:function(){return c.cellEditor||null},getCellRenderer:function(){return c.cellRenderer||null},getParentOfValue:function(){return c.getParentOfValue()}};return c.cellCtrl=r,r.setComp(C,c.getGui(),c.eCellWrapper,i,u),c}return u0(t,o),t.prototype.getParentOfValue=function(){return this.eCellValue?this.eCellValue:this.eCellWrapper?this.eCellWrapper:this.getGui()},t.prototype.setRenderDetails=function(e,r,i){if(!(this.cellEditor&&!this.cellEditorPopupWrapper)){this.firstRender=null==this.firstRender;var u=this.refreshWrapper(!1);if(this.refreshEditStyles(!1),e)!(i||u)&&this.refreshCellRenderer(e)||(this.destroyRenderer(),this.createCellRendererInstance(e));else this.destroyRenderer(),this.insertValueWithoutCellRenderer(r)}},t.prototype.setEditDetails=function(e,r,i){e?this.createCellEditorInstance(e,r,i):this.destroyEditor()},t.prototype.removeControls=function(){this.checkboxSelectionComp=this.beans.context.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=this.beans.context.destroyBean(this.dndSourceComp),this.rowDraggingComp=this.beans.context.destroyBean(this.rowDraggingComp)},t.prototype.refreshWrapper=function(e){var r=this.includeRowDrag||this.includeDndSource||this.includeSelection,i=r||this.forceWrapper,n=i&&null==this.eCellWrapper;n&&(this.eCellWrapper=Sr('<div class="ag-cell-wrapper" role="presentation"></div>'),this.getGui().appendChild(this.eCellWrapper));var u=!i&&null!=this.eCellWrapper;u&&(Ln(this.eCellWrapper),this.eCellWrapper=void 0),this.addOrRemoveCssClass("ag-cell-value",!i);var c=!e&&i,v=c&&null==this.eCellValue;v&&(this.eCellValue=Sr('<span class="ag-cell-value" role="presentation"></span>'),this.eCellWrapper.appendChild(this.eCellValue));var m=!c&&null!=this.eCellValue;m&&(Ln(this.eCellValue),this.eCellValue=void 0);var C=n||u||v||m;return C&&this.removeControls(),e||r&&this.addControls(),C},t.prototype.addControls=function(){this.includeRowDrag&&null==this.rowDraggingComp&&(this.rowDraggingComp=this.cellCtrl.createRowDragComp(),this.rowDraggingComp&&this.eCellWrapper.insertBefore(this.rowDraggingComp.getGui(),this.eCellValue)),this.includeDndSource&&null==this.dndSourceComp&&(this.dndSourceComp=this.cellCtrl.createDndSource(),this.eCellWrapper.insertBefore(this.dndSourceComp.getGui(),this.eCellValue)),this.includeSelection&&null==this.checkboxSelectionComp&&(this.checkboxSelectionComp=this.cellCtrl.createSelectionCheckbox(),this.eCellWrapper.insertBefore(this.checkboxSelectionComp.getGui(),this.eCellValue))},t.prototype.createCellEditorInstance=function(e,r,i){var n=this,u=this.editorVersion,c=e.newAgStackInstance();if(c){var v=e.params;c.then(function(C){return n.afterCellEditorCreated(u,C,v,r,i)}),Je(this.cellEditor)&&v.cellStartedEdit&&this.cellCtrl.focusCell(!0)}},t.prototype.insertValueWithoutCellRenderer=function(e){var r=this.getParentOfValue();Wt(r);var i=null!=e?Wi(e):null;null!=i&&(r.innerHTML=i)},t.prototype.destroyEditorAndRenderer=function(){this.destroyRenderer(),this.destroyEditor()},t.prototype.destroyRenderer=function(){var e=this.beans.context;this.cellRenderer=e.destroyBean(this.cellRenderer),Ln(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++},t.prototype.destroyEditor=function(){var e=this.beans.context;this.hideEditorPopup&&this.hideEditorPopup(),this.hideEditorPopup=void 0,this.cellEditor=e.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=e.destroyBean(this.cellEditorPopupWrapper),Ln(this.cellEditorGui),this.cellEditorGui=null,this.editorVersion++},t.prototype.refreshCellRenderer=function(e){if(null==this.cellRenderer||null==this.cellRenderer.refresh||this.cellRendererClass!==e.componentClass)return!1;var r=this.cellRenderer.refresh(e.params);return!0===r||void 0===r},t.prototype.createCellRendererInstance=function(e){var r=this,n=!this.beans.gridOptionsService.is("suppressAnimationFrame"),u=this.rendererVersion,c=e.componentClass,v=function(){if(!(r.rendererVersion!==u||!r.isAlive())){var C=e.newAgStackInstance(),_=r.afterCellRendererCreated.bind(r,u,c);C&&C.then(_)}};n&&this.firstRender?this.beans.animationFrameService.createTask(v,this.rowNode.rowIndex,"createTasksP2"):v()},t.prototype.getCtrl=function(){return this.cellCtrl},t.prototype.getRowCtrl=function(){return this.rowCtrl},t.prototype.getCellRenderer=function(){return this.cellRenderer},t.prototype.getCellEditor=function(){return this.cellEditor},t.prototype.afterCellRendererCreated=function(e,r,i){if(!this.isAlive()||e!==this.rendererVersion)this.beans.context.destroyBean(i);else if(this.cellRenderer=i,this.cellRendererClass=r,this.cellRendererGui=this.cellRenderer.getGui(),null!=this.cellRendererGui){var u=this.getParentOfValue();Wt(u),u.appendChild(this.cellRendererGui)}},t.prototype.afterCellEditorCreated=function(e,r,i,n,u){if(e!==this.editorVersion)this.beans.context.destroyBean(r);else{if(r.isCancelBeforeStart&&r.isCancelBeforeStart())return this.beans.context.destroyBean(r),void this.cellCtrl.stopEditing(!0);if(!r.getGui)return console.warn("AG Grid: cellEditor for column "+this.column.getId()+" is missing getGui() method"),void this.beans.context.destroyBean(r);this.cellEditor=r,this.cellEditorGui=r.getGui();var m=n||void 0!==r.isPopup&&r.isPopup();m?this.addPopupCellEditor(i,u):this.addInCellEditor(),this.refreshEditStyles(!0,m),r.afterGuiAttached&&r.afterGuiAttached()}},t.prototype.refreshEditStyles=function(e,r){var i;this.addOrRemoveCssClass("ag-cell-inline-editing",e&&!r),this.addOrRemoveCssClass("ag-cell-popup-editing",e&&!!r),this.addOrRemoveCssClass("ag-cell-not-inline-editing",!e||!!r),null===(i=this.rowCtrl)||void 0===i||i.setInlineEditingCss(e)},t.prototype.addInCellEditor=function(){var e=this.getGui(),r=this.beans.gridOptionsService.getDocument();(e.contains(r.activeElement)&&e.focus(),this.destroyRenderer(),this.refreshWrapper(!0),this.clearParentOfValue(),this.cellEditorGui)&&this.getParentOfValue().appendChild(this.cellEditorGui)},t.prototype.addPopupCellEditor=function(e,r){var i=this;"fullRow"===this.beans.gridOptionsService.get("editType")&&console.warn("AG Grid: popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.");var n=this.cellEditor;this.cellEditorPopupWrapper=this.beans.context.createBean(new l0(e));var u=this.cellEditorPopupWrapper.getGui();this.cellEditorGui&&u.appendChild(this.cellEditorGui);var c=this.beans.popupService,v=this.beans.gridOptionsService.is("stopEditingWhenCellsLoseFocus"),m=r??(n.getPopupPosition?n.getPopupPosition():"over"),C=this.beans.gridOptionsService.is("enableRtl"),_={ePopup:u,column:this.column,rowNode:this.rowNode,type:"popupCellEditor",eventSource:this.getGui(),position:m,alignSide:C?"right":"left",keepWithinBounds:!0},O=c.positionPopupByComponent.bind(c,_),P=this.beans.localeService.getLocaleTextFunc(),L=c.addPopup({modal:v,eChild:u,closeOnEsc:!0,closedCallback:function(){i.cellCtrl.onPopupEditorClosed()},anchorToElement:this.getGui(),positionCallback:O,ariaLabel:P("ariaLabelCellEditor","Cell Editor")});L&&(this.hideEditorPopup=L.hideFunc)},t.prototype.detach=function(){this.eRow.removeChild(this.getGui())},t.prototype.destroy=function(){this.cellCtrl.stopEditing(),this.destroyEditorAndRenderer(),this.removeControls(),o.prototype.destroy.call(this)},t.prototype.clearParentOfValue=function(){var e=this.getGui(),r=this.beans.gridOptionsService.getDocument();e.contains(r.activeElement)&&$s()&&e.focus({preventScroll:!0}),Wt(this.getParentOfValue())},t}(Ue),c0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),f0=function(o){function t(e,r,i){var n=o.call(this)||this;n.cellComps={},n.beans=r,n.rowCtrl=e,n.setTemplate('<div comp-id="'+n.getCompId()+'" style="'+n.getInitialStyle(i)+'"/>');var u=n.getGui(),c=u.style,v={setDomOrder:function(m){return n.domOrder=m},setCellCtrls:function(m){return n.setCellCtrls(m)},showFullWidth:function(m){return n.showFullWidth(m)},getFullWidthCellRenderer:function(){return n.getFullWidthCellRenderer()},addOrRemoveCssClass:function(m,C){return n.addOrRemoveCssClass(m,C)},setUserStyles:function(m){return _l(u,m)},setTop:function(m){return c.top=m},setTransform:function(m){return c.transform=m},setRowIndex:function(m){return u.setAttribute("row-index",m)},setRole:function(m){return vt(u,m)},setRowId:function(m){return u.setAttribute("row-id",m)},setRowBusinessKey:function(m){return u.setAttribute("row-business-key",m)},setTabIndex:function(m){return u.setAttribute("tabindex",m.toString())}};return e.setComp(v,n.getGui(),i),n.addDestroyFunc(function(){e.unsetComp(i)}),n}return c0(t,o),t.prototype.getInitialStyle=function(e){var r=this.rowCtrl.getInitialTransform(e),i=this.rowCtrl.getInitialRowTop(e);return r?"transform: "+r:"top: "+i},t.prototype.showFullWidth=function(e){var r=this,n=e.newAgStackInstance();n&&n.then(function(u){if(r.isAlive()){var c=u.getGui();r.getGui().appendChild(c),r.rowCtrl.setupDetailRowAutoHeight(c),r.setFullWidthRowComp(u)}else r.beans.context.destroyBean(u)})},t.prototype.setCellCtrls=function(e){var r=this,i=Object.assign({},this.cellComps);e.forEach(function(u){var c=u.getInstanceId();null==r.cellComps[c]?r.newCellComp(u):i[c]=null});var n=Ir(i).filter(function(u){return null!=u});this.destroyCells(n),this.ensureDomOrder(e)},t.prototype.ensureDomOrder=function(e){var r=this;if(this.domOrder){var i=[];e.forEach(function(n){var u=r.cellComps[n.getInstanceId()];u&&i.push(u.getGui())}),Nn(this.getGui(),i)}},t.prototype.newCellComp=function(e){var r=new cd(this.beans,e,this.rowCtrl.isPrintLayout(),this.getGui(),this.rowCtrl.isEditing());this.cellComps[e.getInstanceId()]=r,this.getGui().appendChild(r.getGui())},t.prototype.destroy=function(){o.prototype.destroy.call(this),this.destroyAllCells()},t.prototype.destroyAllCells=function(){var e=Ir(this.cellComps).filter(function(r){return null!=r});this.destroyCells(e)},t.prototype.setFullWidthRowComp=function(e){var r=this;this.fullWidthCellRenderer&&console.error("AG Grid - should not be setting fullWidthRowComponent twice"),this.fullWidthCellRenderer=e,this.addDestroyFunc(function(){r.fullWidthCellRenderer=r.beans.context.destroyBean(r.fullWidthCellRenderer)})},t.prototype.getFullWidthCellRenderer=function(){return this.fullWidthCellRenderer},t.prototype.destroyCells=function(e){var r=this;e.forEach(function(i){if(i){var n=i.getCtrl().getInstanceId();r.cellComps[n]===i&&(i.detach(),i.destroy(),r.cellComps[n]=null)}})},t}(Ue),p0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),fd=function(){return fd=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},fd.apply(this,arguments)},_s=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n};var Ur,xs=function(o){function t(){var e=o.call(this,function d0(){var o=Ue.elementGettingCreated.getAttribute("name"),t=$l.getRowContainerCssClasses(o),r=o===ue.CENTER,i=o===ue.TOP_CENTER||o===ue.STICKY_TOP_CENTER||o===ue.BOTTOM_CENTER;return r?'<div class="'+t.wrapper+'" ref="eWrapper" role="presentation">\n                <div class="'+t.viewport+'" ref="eViewport" role="presentation">\n                    <div class="'+t.container+'" ref="eContainer"></div>\n                </div>\n            </div>':i?'<div class="'+t.viewport+'" ref="eViewport" role="presentation">\n                <div class="'+t.container+'" ref="eContainer"></div>\n            </div>':'<div class="'+t.container+'" ref="eContainer"></div>'}())||this;return e.rowComps={},e.name=Ue.elementGettingCreated.getAttribute("name"),e.type=function Yg(o){switch(o){case ue.CENTER:case ue.TOP_CENTER:case ue.STICKY_TOP_CENTER:case ue.BOTTOM_CENTER:return Kr.CENTER;case ue.LEFT:case ue.TOP_LEFT:case ue.STICKY_TOP_LEFT:case ue.BOTTOM_LEFT:return Kr.LEFT;case ue.RIGHT:case ue.TOP_RIGHT:case ue.STICKY_TOP_RIGHT:case ue.BOTTOM_RIGHT:return Kr.RIGHT;case ue.FULL_WIDTH:case ue.TOP_FULL_WIDTH:case ue.STICKY_TOP_FULL_WIDTH:case ue.BOTTOM_FULL_WIDTH:return Kr.FULL_WIDTH;default:throw Error("Invalid Row Container Type")}}(e.name),e}return p0(t,o),t.prototype.postConstruct=function(){var e=this,r={setViewportHeight:function(n){return e.eViewport.style.height=n},setRowCtrls:function(n){return e.setRowCtrls(n)},setDomOrder:function(n){e.domOrder=n},setContainerWidth:function(n){return e.eContainer.style.width=n}};this.createManagedBean(new $l(this.name)).setComp(r,this.eContainer,this.eViewport,this.eWrapper)},t.prototype.preDestroy=function(){this.setRowCtrls([])},t.prototype.setRowCtrls=function(e){var r=this,i=fd({},this.rowComps);this.rowComps={},this.lastPlacedElement=null;e.forEach(function(u){var c=u.getInstanceId(),v=i[c];if(v)r.rowComps[c]=v,delete i[c],r.ensureDomOrder(v.getGui());else{var m=new f0(u,r.beans,r.type);r.rowComps[c]=m,r.appendRow(m.getGui())}}),Ir(i).forEach(function(u){r.eContainer.removeChild(u.getGui()),u.destroy()}),vt(this.eContainer,e.length?"rowgroup":"presentation")},t.prototype.appendRow=function(e){this.domOrder?eo(this.eContainer,e,this.lastPlacedElement):this.eContainer.appendChild(e),this.lastPlacedElement=e},t.prototype.ensureDomOrder=function(e){this.domOrder&&(Mn(this.eContainer,e,this.lastPlacedElement),this.lastPlacedElement=e)},_s([D("beans")],t.prototype,"beans",void 0),_s([Te("eViewport")],t.prototype,"eViewport",void 0),_s([Te("eContainer")],t.prototype,"eContainer",void 0),_s([Te("eWrapper")],t.prototype,"eWrapper",void 0),_s([Re],t.prototype,"postConstruct",null),_s([Mr],t.prototype,"preDestroy",null),t}(Ue),kc=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},pd=function(){function o(t){this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[],this.pinned=t}return o.prototype.onDragEnter=function(t){var e=this;if(this.clearColumnsList(),!this.gridOptionsService.is("functionsReadOnly")){var r=t.dragItem.columns;r&&r.forEach(function(i){i.isPrimary()&&(i.isAnyFunctionActive()||(i.isAllowValue()?e.columnsToAggregate.push(i):i.isAllowRowGroup()?e.columnsToGroup.push(i):i.isAllowPivot()&&e.columnsToPivot.push(i)))})}},o.prototype.getIconName=function(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?Vr.ICON_PINNED:Vr.ICON_MOVE:null},o.prototype.onDragLeave=function(t){this.clearColumnsList()},o.prototype.clearColumnsList=function(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0},o.prototype.onDragging=function(t){},o.prototype.onDragStop=function(t){this.columnsToAggregate.length>0&&this.columnModel.addValueColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&this.columnModel.addRowGroupColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&this.columnModel.addPivotColumns(this.columnsToPivot,"toolPanelDragAndDrop")},kc([D("columnModel")],o.prototype,"columnModel",void 0),kc([D("gridOptionsService")],o.prototype,"gridOptionsService",void 0),o}(),ga=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},h0=function(){function o(t,e){this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.pinned=t,this.eContainer=e,this.centerContainer=!me(t)}return o.prototype.init=function(){var t=this;this.ctrlsService.whenReady(function(){t.gridBodyCon=t.ctrlsService.getGridBodyCtrl()})},o.prototype.getIconName=function(){return this.pinned?Vr.ICON_PINNED:Vr.ICON_MOVE},o.prototype.onDragEnter=function(t){var e=t.dragItem.columns;if(t.dragSource.type===ni.ToolPanel)this.setColumnsVisible(e,!0,"uiColumnDragged");else{var i=t.dragItem.visibleState,n=(e||[]).filter(function(u){return i[u.getId()]});this.setColumnsVisible(n,!0,"uiColumnDragged")}this.setColumnsPinned(e,this.pinned,"uiColumnDragged"),this.onDragging(t,!0,!0)},o.prototype.onDragLeave=function(){this.ensureIntervalCleared(),this.lastMovedInfo=null},o.prototype.setColumnsVisible=function(t,e,r){if(void 0===r&&(r="api"),t){var i=t.filter(function(n){return!n.getColDef().lockVisible});this.columnModel.setColumnsVisible(i,e,r)}},o.prototype.setColumnsPinned=function(t,e,r){if(void 0===r&&(r="api"),t){var i=t.filter(function(n){return!n.getColDef().lockPinned});this.columnModel.setColumnsPinned(i,e,r)}},o.prototype.onDragStop=function(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null},o.prototype.normaliseX=function(t){this.gridOptionsService.is("enableRtl")&&(t=this.eContainer.clientWidth-t);return this.centerContainer&&(t+=this.ctrlsService.getCenterRowContainerCtrl().getCenterViewportScrollLeft()),t},o.prototype.checkCenterForScrolling=function(t){if(this.centerContainer){var e=this.ctrlsService.getCenterRowContainerCtrl().getCenterViewportScrollLeft(),r=e+this.ctrlsService.getCenterRowContainerCtrl().getCenterWidth();this.gridOptionsService.is("enableRtl")?(this.needToMoveRight=t<e+50,this.needToMoveLeft=t>r-50):(this.needToMoveLeft=t<e+50,this.needToMoveRight=t>r-50),this.needToMoveLeft||this.needToMoveRight?this.ensureIntervalStarted():this.ensureIntervalCleared()}},o.prototype.onDragging=function(t,e,r,i){var u,n=this;if(void 0===t&&(t=this.lastDraggingEvent),void 0===e&&(e=!1),void 0===r&&(r=!1),void 0===i&&(i=!1),i){if(this.lastMovedInfo){var c=this.lastMovedInfo,v=c.columns,m=c.toIndex;this.moveColumns(v,m,"uiColumnMoved",!0)}}else if(this.lastDraggingEvent=t,!Je(t.hDirection)){var C=this.normaliseX(t.x);e||this.checkCenterForScrolling(C);var _=this.normaliseDirection(t.hDirection),O=t.dragSource.type,P=(null===(u=t.dragSource.getDragItem().columns)||void 0===u?void 0:u.filter(function(L){return!L.getColDef().lockPinned||L.getPinned()==n.pinned}))||[];this.attemptMoveColumns({dragSourceType:O,allMovingColumns:P,hDirection:_,mouseX:C,fromEnter:e,fakeEvent:r})}},o.prototype.normaliseDirection=function(t){if(!this.gridOptionsService.is("enableRtl"))return t;switch(t){case dn.Left:return dn.Right;case dn.Right:return dn.Left;default:console.error("AG Grid: Unknown direction "+t)}},o.prototype.attemptMoveColumns=function(t){var e=t.dragSourceType,r=t.hDirection,i=t.mouseX,n=t.fromEnter,u=t.fakeEvent,c=r===dn.Left,v=r===dn.Right,m=t.allMovingColumns;if(e===ni.HeaderCell){var C=[];m.forEach(function(ze){for(var st=null,nt=ze.getParent();null!=nt&&1===nt.getDisplayedLeafColumns().length;)st=nt,nt=nt.getParent();null!=st?st.getLeafColumns().forEach(function(Gt){C.includes(Gt)||C.push(Gt)}):C.includes(ze)||C.push(ze)}),m=C}var _=m.slice();this.columnModel.sortColumnsLikeGridColumns(_);var O=this.calculateValidMoves(_,v,i),P=this.calculateOldIndex(_);if(0!==O.length){var L=O[0],z=null!==P&&!n;if(e==ni.HeaderCell&&(z=null!==P),!z||u||!(c&&L>=P||v&&L<=P)){for(var q=this.columnModel.getAllDisplayedColumns(),Z=[],re=null,pe=0;pe<O.length;pe++){var Ce=O[pe],be=this.columnModel.getProposedColumnOrder(_,Ce);if(this.columnModel.doesOrderPassRules(be)){var qe=be.filter(function(ze){return q.includes(ze)});if(null===re)re=qe;else if(!rt.areEqual(qe,re))break;var et=this.groupFragCount(be);Z.push({move:Ce,fragCount:et})}}0!==Z.length&&(Z.sort(function(ze,st){return ze.fragCount-st.fragCount}),this.moveColumns(m,Z[0].move,"uiColumnMoved",!1))}}},o.prototype.calculateOldIndex=function(t){var e=this.columnModel.getAllGridColumns(),r=Nf(t.map(function(v){return e.indexOf(v)})),i=r[0];return Mt(r)-i!==r.length-1?null:i},o.prototype.moveColumns=function(t,e,r,i){this.columnModel.moveColumns(t,e,r,i),this.lastMovedInfo=i?null:{columns:t,toIndex:e}},o.prototype.groupFragCount=function(t){function e(u){for(var c=[],v=u.getOriginalParent();null!=v;)c.push(v),v=v.getOriginalParent();return c}for(var r=0,i=function(u){var c,v=e(t[u]),m=e(t[u+1]);c=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n}(v.length>m.length?[v,m]:[m,v],2),v=c[0],m=c[1],v.forEach(function(C){-1===m.indexOf(C)&&r++})},n=0;n<t.length-1;n++)i(n);return r},o.prototype.calculateValidMoves=function(t,e,r){if(this.gridOptionsService.is("suppressMovableColumns")||t.some(function(et){return et.getColDef().suppressMovable}))return[];var z,n=this.columnModel.getDisplayedColumns(this.pinned),u=this.columnModel.getAllGridColumns(),c=n.filter(function(et){return kr(t,et)}),v=n.filter(function(et){return!kr(t,et)}),m=u.filter(function(et){return!kr(t,et)}),C=0,_=r;if(e){var O=0;c.forEach(function(et){return O+=et.getActualWidth()}),_-=O}if(_>0){for(var P=0;P<v.length;P++){if((_-=v[P].getActualWidth())<0)break;C++}e&&C++}if(C>0){var q=v[C-1];z=m.indexOf(q)+1}else-1===(z=m.indexOf(v[0]))&&(z=0);var Z=[z],re=function(et,ze){return et-ze};if(e){for(var pe=z+1,Ce=u.length-1;pe<=Ce;)Z.push(pe),pe++;Z.sort(re)}else{pe=z,Ce=u.length-1;for(var be=u[pe];pe<=Ce&&this.isColumnHidden(n,be);)pe++,Z.push(pe),be=u[pe];pe=z-1;for(;pe>=0;)Z.push(pe),pe--;Z.sort(re).reverse()}return Z},o.prototype.isColumnHidden=function(t,e){return t.indexOf(e)<0},o.prototype.ensureIntervalStarted=function(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),100),this.needToMoveLeft?this.dragAndDropService.setGhostIcon(Vr.ICON_LEFT,!0):this.dragAndDropService.setGhostIcon(Vr.ICON_RIGHT,!0))},o.prototype.ensureIntervalCleared=function(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.dragAndDropService.setGhostIcon(Vr.ICON_MOVE))},o.prototype.moveInterval=function(){var t;this.intervalCount++,(t=10+5*this.intervalCount)>100&&(t=100);var e=null,r=this.gridBodyCon.getScrollFeature();if(this.needToMoveLeft?e=r.scrollHorizontally(-t):this.needToMoveRight&&(e=r.scrollHorizontally(t)),0!==e)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;var n=this.lastDraggingEvent.dragItem.columns.filter(function(c){return!c.getColDef().lockPinned});if(n.length>0&&(this.dragAndDropService.setGhostIcon(Vr.ICON_PINNED),this.failedMoveAttempts>7)){var u=this.needToMoveLeft?"left":"right";this.setColumnsPinned(n,u,"uiColumnDragged"),this.dragAndDropService.nudge()}}},ga([D("columnModel")],o.prototype,"columnModel",void 0),ga([D("dragAndDropService")],o.prototype,"dragAndDropService",void 0),ga([D("gridOptionsService")],o.prototype,"gridOptionsService",void 0),ga([D("ctrlsService")],o.prototype,"ctrlsService",void 0),ga([Re],o.prototype,"init",null),o}(),v0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ma=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},g0=function(o){function t(e,r){var i=o.call(this)||this;return i.pinned=e,i.eContainer=r,i}return v0(t,o),t.prototype.postConstruct=function(){var e=this;this.ctrlsService.whenReady(function(r){switch(e.pinned){case"left":e.eSecondaryContainers=[[r.gridBodyCtrl.getBodyViewportElement(),r.leftRowContainerCtrl.getContainerElement()],[r.bottomLeftRowContainerCtrl.getContainerElement()],[r.topLeftRowContainerCtrl.getContainerElement()]];break;case"right":e.eSecondaryContainers=[[r.gridBodyCtrl.getBodyViewportElement(),r.rightRowContainerCtrl.getContainerElement()],[r.bottomRightRowContainerCtrl.getContainerElement()],[r.topRightRowContainerCtrl.getContainerElement()]];break;default:e.eSecondaryContainers=[[r.gridBodyCtrl.getBodyViewportElement(),r.centerRowContainerCtrl.getViewportElement()],[r.bottomCenterRowContainerCtrl.getViewportElement()],[r.topCenterRowContainerCtrl.getViewportElement()]]}})},t.prototype.isInterestedIn=function(e){return e===ni.HeaderCell||e===ni.ToolPanel&&this.gridOptionsService.is("allowDragFromColumnsToolPanel")},t.prototype.getSecondaryContainers=function(){return this.eSecondaryContainers},t.prototype.getContainer=function(){return this.eContainer},t.prototype.init=function(){this.moveColumnFeature=this.createManagedBean(new h0(this.pinned,this.eContainer)),this.bodyDropPivotTarget=this.createManagedBean(new pd(this.pinned)),this.dragAndDropService.addDropTarget(this)},t.prototype.getIconName=function(){return this.currentDropListener.getIconName()},t.prototype.isDropColumnInPivotMode=function(e){return this.columnModel.isPivotMode()&&e.dragSource.type===ni.ToolPanel},t.prototype.onDragEnter=function(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)},t.prototype.onDragLeave=function(e){this.currentDropListener.onDragLeave(e)},t.prototype.onDragging=function(e){this.currentDropListener.onDragging(e)},t.prototype.onDragStop=function(e){this.currentDropListener.onDragStop(e)},ma([D("dragAndDropService")],t.prototype,"dragAndDropService",void 0),ma([D("columnModel")],t.prototype,"columnModel",void 0),ma([D("ctrlsService")],t.prototype,"ctrlsService",void 0),ma([Re],t.prototype,"postConstruct",null),ma([Re],t.prototype,"init",null),t}(we),m0=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},hd=function(){function o(){}return o.getHeaderClassesFromColDef=function(t,e,r,i){return Je(t)?[]:this.getColumnClassesFromCollDef(t.headerClass,t,e,r,i)},o.getToolPanelClassesFromColDef=function(t,e,r,i){return Je(t)?[]:this.getColumnClassesFromCollDef(t.toolPanelClass,t,e,r,i)},o.getClassParams=function(t,e,r,i){return{colDef:t,column:r,columnGroup:i,api:e.api,columnApi:e.columnApi,context:e.context}},o.getColumnClassesFromCollDef=function(t,e,r,i,n){if(Je(t))return[];var u;"function"==typeof t?u=t(this.getClassParams(e,r,i,n)):u=t;return"string"==typeof u?[u]:Array.isArray(u)?function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(m0(arguments[t]));return o}(u):[]},o}(),C0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Xl=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},w0=function(o){function t(e){var r=o.call(this,t.TEMPLATE,e)||this;return r.headerCompVersion=0,r.column=e.getColumnGroupChild(),r.pinned=e.getPinned(),r}return C0(t,o),t.prototype.postConstruct=function(){var e=this,r=this.getGui(),i=function(c,v,m){var C=m||r;null!=v&&""!=v?C.setAttribute(c,v):C.removeAttribute(c)},n={setWidth:function(c){return r.style.width=c},addOrRemoveCssClass:function(c,v){return e.addOrRemoveCssClass(c,v)},setColId:function(c){return i("col-id",c)},setTitle:function(c){return i("title",c)},setAriaDescription:function(c){return Wu(r,c)},setAriaSort:function(c){return c?Ku(r,c):Ws(r)},setUserCompDetails:function(c){return e.setUserCompDetails(c)},getUserCompInstance:function(){return e.headerComp}};this.ctrl.setComp(n,this.getGui(),this.eResize,this.eHeaderCompWrapper);var u=this.ctrl.getSelectAllGui();this.eResize.insertAdjacentElement("afterend",u)},t.prototype.destroyHeaderComp=function(){this.headerComp&&(this.eHeaderCompWrapper.removeChild(this.headerCompGui),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)},t.prototype.setUserCompDetails=function(e){var r=this;this.headerCompVersion++;var i=this.headerCompVersion;e.newAgStackInstance().then(function(n){return r.afterCompCreated(i,n)})},t.prototype.afterCompCreated=function(e,r){e==this.headerCompVersion&&this.isAlive()?(this.destroyHeaderComp(),this.headerComp=r,this.headerCompGui=r.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())):this.destroyBean(r)},t.TEMPLATE='<div class="ag-header-cell" role="columnheader" tabindex="-1">\n            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n            <div ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"></div>\n        </div>',Xl([Te("eResize")],t.prototype,"eResize",void 0),Xl([Te("eHeaderCompWrapper")],t.prototype,"eHeaderCompWrapper",void 0),Xl([Re],t.prototype,"postConstruct",null),Xl([Mr],t.prototype,"destroyHeaderComp",null),t}(Oc),S0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Gc=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},_0=function(o){function t(e){return o.call(this,t.TEMPLATE,e)||this}return S0(t,o),t.prototype.postConstruct=function(){var e=this,r=this.getGui(),i=function(u,c){return null!=c?r.setAttribute(u,c):r.removeAttribute(u)},n={addOrRemoveCssClass:function(u,c){return e.addOrRemoveCssClass(u,c)},setResizableDisplayed:function(u){return Ze(e.eResize,u)},setWidth:function(u){return r.style.width=u},setColId:function(u){return r.setAttribute("col-id",u)},setAriaExpanded:function(u){return i("aria-expanded",u)},setTitle:function(u){return i("title",u)},setUserCompDetails:function(u){return e.setUserCompDetails(u)}};this.ctrl.setComp(n,r,this.eResize)},t.prototype.setUserCompDetails=function(e){var r=this;e.newAgStackInstance().then(function(i){return r.afterHeaderCompCreated(i)})},t.prototype.afterHeaderCompCreated=function(e){var r=this,i=function(){return r.destroyBean(e)};this.isAlive()?(this.getGui().appendChild(e.getGui()),this.addDestroyFunc(i),this.ctrl.setDragSource(e.getGui())):i()},t.TEMPLATE='<div class="ag-header-group-cell" role="columnheader" tabindex="-1">\n            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n        </div>',Gc([D("userComponentFactory")],t.prototype,"userComponentFactory",void 0),Gc([Te("eResize")],t.prototype,"eResize",void 0),Gc([Re],t.prototype,"postConstruct",null),t}(Oc),vd=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),gd=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n};!function(o){o.COLUMN_GROUP="group",o.COLUMN="column",o.FLOATING_FILTER="filter"}(Ur||(Ur={}));var mn,x0=function(o){function t(e){var r=o.call(this)||this;r.headerComps={};var i=e.getType()==Ur.COLUMN_GROUP?"ag-header-row-column-group":e.getType()==Ur.FLOATING_FILTER?"ag-header-row-column-filter":"ag-header-row-column";return r.setTemplate('<div class="ag-header-row '+i+'" role="row"></div>'),r.ctrl=e,r}return vd(t,o),t.prototype.init=function(){var e=this,r={setTransform:function(i){return e.getGui().style.transform=i},setHeight:function(i){return e.getGui().style.height=i},setTop:function(i){return e.getGui().style.top=i},setHeaderCtrls:function(i){return e.setHeaderCtrls(i)},setWidth:function(i){return e.getGui().style.width=i},setAriaRowIndex:function(i){return ju(e.getGui(),i)}};this.ctrl.setComp(r)},t.prototype.destroyHeaderCtrls=function(){this.setHeaderCtrls([])},t.prototype.setHeaderCtrls=function(e){var r=this;if(this.isAlive()){var i=this.headerComps;this.headerComps={},e.forEach(function(m){var C=m.getInstanceId(),_=i[C];delete i[C],null==_&&(_=r.createHeaderComp(m),r.getGui().appendChild(_.getGui())),r.headerComps[C]=_}),Xe(i,function(m,C){r.getGui().removeChild(C.getGui()),r.destroyBean(C)});var n=this.gridOptionsService.is("ensureDomOrder"),u=this.gridOptionsService.isDomLayout("print");if(n||u){var c=Ir(this.headerComps);c.sort(function(m,C){return m.getCtrl().getColumnGroupChild().getLeft()-C.getCtrl().getColumnGroupChild().getLeft()});var v=c.map(function(m){return m.getGui()});Nn(this.getGui(),v)}}},t.prototype.createHeaderComp=function(e){var r;switch(this.ctrl.getType()){case Ur.COLUMN_GROUP:r=new _0(e);break;case Ur.FLOATING_FILTER:r=new lg(e);break;default:r=new w0(e)}return this.createBean(r),r.setParentComponent(this),r},gd([Re],t.prototype,"init",null),gd([Mr],t.prototype,"destroyHeaderCtrls",null),t}(Ue),E0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),co=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Hc=0,Es=function(o){function t(e,r){var i=o.call(this)||this;return i.lastFocusEvent=null,i.columnGroupChild=e,i.parentRowCtrl=r,i.instanceId=e.getUniqueId()+"-"+Hc++,i}return E0(t,o),t.prototype.shouldStopEventPropagation=function(e){var r=this.focusService.getFocusedHeader(),i=r.headerRowIndex,n=r.column;return Zs(this.gridOptionsService,e,i,n)},t.prototype.getWrapperHasFocus=function(){return this.gridOptionsService.getDocument().activeElement===this.eGui},t.prototype.setGui=function(e){this.eGui=e,this.addDomData()},t.prototype.handleKeyDown=function(e){var r=this.getWrapperHasFocus();switch(e.key){case ve.PAGE_DOWN:case ve.PAGE_UP:case ve.PAGE_HOME:case ve.PAGE_END:r&&e.preventDefault()}},t.prototype.addDomData=function(){var e=this,r=t.DOM_DATA_KEY_HEADER_CTRL;this.gridOptionsService.setDomData(this.eGui,r,this),this.addDestroyFunc(function(){return e.gridOptionsService.setDomData(e.eGui,r,null)})},t.prototype.getGui=function(){return this.eGui},t.prototype.focus=function(e){return!!this.eGui&&(this.lastFocusEvent=e||null,this.eGui.focus(),!0)},t.prototype.getRowIndex=function(){return this.parentRowCtrl.getRowIndex()},t.prototype.getParentRowCtrl=function(){return this.parentRowCtrl},t.prototype.getPinned=function(){return this.parentRowCtrl.getPinned()},t.prototype.getInstanceId=function(){return this.instanceId},t.prototype.getColumnGroupChild=function(){return this.columnGroupChild},t.DOM_DATA_KEY_HEADER_CTRL="headerCtrl",co([D("focusService")],t.prototype,"focusService",void 0),co([D("beans")],t.prototype,"beans",void 0),co([D("userComponentFactory")],t.prototype,"userComponentFactory",void 0),t}(we),md=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Bc=function(o){function t(e,r,i,n){var u=o.call(this)||this;return u.columnOrGroup=e,u.eCell=r,u.ariaEl=u.eCell.querySelector("[role=columnheader]")||u.eCell,u.colsSpanning=n,u.beans=i,u}return md(t,o),t.prototype.setColsSpanning=function(e){this.colsSpanning=e,this.onLeftChanged()},t.prototype.getColumnOrGroup=function(){return this.beans.gridOptionsService.is("enableRtl")&&this.colsSpanning?Mt(this.colsSpanning):this.columnOrGroup},t.prototype.postConstruct=function(){this.addManagedListener(this.columnOrGroup,Kt.EVENT_LEFT_CHANGED,this.onLeftChanged.bind(this)),this.setLeftFirstTime(),this.addManagedListener(this.eventService,I.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onLeftChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onLeftChanged.bind(this))},t.prototype.setLeftFirstTime=function(){var e=this.beans.gridOptionsService.is("suppressColumnMoveAnimation"),r=me(this.columnOrGroup.getOldLeft());this.beans.columnAnimationService.isActive()&&r&&!e?this.animateInLeft():this.onLeftChanged()},t.prototype.animateInLeft=function(){var e=this,r=this.getColumnOrGroup(),i=r.getLeft(),n=r.getOldLeft(),u=this.modifyLeftForPrintLayout(r,n),c=this.modifyLeftForPrintLayout(r,i);this.setLeft(u),this.actualLeft=c,this.beans.columnAnimationService.executeNextVMTurn(function(){e.actualLeft===c&&e.setLeft(c)})},t.prototype.onLeftChanged=function(){var e=this.getColumnOrGroup(),r=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,r),this.setLeft(this.actualLeft)},t.prototype.modifyLeftForPrintLayout=function(e,r){if(!this.beans.gridOptionsService.isDomLayout("print")||"left"===e.getPinned())return r;var n=this.beans.columnModel.getDisplayedColumnsLeftWidth();return"right"===e.getPinned()?n+this.beans.columnModel.getBodyContainerWidth()+r:n+r},t.prototype.setLeft=function(e){var r;if(me(e)&&(this.eCell.style.left=e+"px"),this.columnOrGroup instanceof Kt)r=this.columnOrGroup;else{var n=this.columnOrGroup.getLeafColumns();if(!n.length)return;n.length>1&&zu(this.ariaEl,n.length),r=n[0]}var u=this.beans.columnModel.getAriaColumnIndex(r);gl(this.ariaEl,u)},function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);i>3&&n&&Object.defineProperty(t,e,n)}([Re],t.prototype,"postConstruct",null),t}(we),cw=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),gr=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},gn=function(o){function t(e,r){var i=o.call(this)||this;return i.columns=e,i.element=r,i}return cw(t,o),t.prototype.postConstruct=function(){this.gridOptionsService.is("columnHoverHighlight")&&this.addMouseHoverListeners()},t.prototype.addMouseHoverListeners=function(){this.addManagedListener(this.element,"mouseout",this.onMouseOut.bind(this)),this.addManagedListener(this.element,"mouseover",this.onMouseOver.bind(this))},t.prototype.onMouseOut=function(){this.columnHoverService.clearMouseOver()},t.prototype.onMouseOver=function(){this.columnHoverService.setMouseOver(this.columns)},gr([D("columnHoverService")],t.prototype,"columnHoverService",void 0),gr([Re],t.prototype,"postConstruct",null),t}(we),yd=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ql=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},R0=function(o){function t(e,r){var i=o.call(this,e,r)||this;return i.column=e,i}return yd(t,o),t.prototype.setComp=function(e,r,i,n){o.prototype.setGui.call(this,r),this.comp=e,this.eButtonShowMainFilter=i,this.eFloatingFilterBody=n;var u=this.column.getColDef(),c=!!u.filter||!!u.filterFramework,v=!!u.floatingFilter;this.active=c&&v,this.setupWidth(),this.setupLeft(),this.setupHover(),this.setupFocus(),this.setupUserComp(),this.setupSyncWithFilter(),this.setupUi(),this.addManagedListener(this.eButtonShowMainFilter,"click",this.showParentFilter.bind(this)),this.active&&this.addManagedListener(this.column,Kt.EVENT_FILTER_CHANGED,this.updateFilterButton.bind(this))},t.prototype.setupUi=function(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.active){this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton);var e=pr("filter",this.gridOptionsService,this.column);e&&this.eButtonShowMainFilter.appendChild(e)}},t.prototype.setupFocus=function(){this.createManagedBean(new ro(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))},t.prototype.onTabKeyDown=function(e){if(!(this.gridOptionsService.getDocument().activeElement===this.eGui)){var u=this.focusService.findNextFocusableElement(this.eGui,null,e.shiftKey);if(u)return this.beans.headerNavigationService.scrollToColumn(this.column),e.preventDefault(),void u.focus();var c=this.findNextColumnWithFloatingFilter(e.shiftKey);c&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:this.getParentRowCtrl().getRowIndex(),column:c},event:e})&&e.preventDefault()}},t.prototype.findNextColumnWithFloatingFilter=function(e){var r=this.beans.columnModel,i=this.column;do{if(!(i=e?r.getDisplayedColBefore(i):r.getDisplayedColAfter(i)))break}while(!i.getColDef().filter||!i.getColDef().floatingFilter);return i},t.prototype.handleKeyDown=function(e){o.prototype.handleKeyDown.call(this,e);var r=this.getWrapperHasFocus();switch(e.key){case ve.UP:case ve.DOWN:r||e.preventDefault();case ve.LEFT:case ve.RIGHT:if(r)return;e.stopPropagation();case ve.ENTER:r&&this.focusService.focusInto(this.eGui)&&e.preventDefault();break;case ve.ESCAPE:r||this.eGui.focus()}},t.prototype.onFocusIn=function(e){if(!this.eGui.contains(e.relatedTarget)){var i=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),n=!!e.relatedTarget&&lt(e.relatedTarget,"ag-floating-filter");if(i&&n&&e.target===this.eGui){var u=this.lastFocusEvent,c=!(!u||u.key!==ve.TAB);if(u&&c){var v=u.shiftKey;this.focusService.focusInto(this.eGui,v)}}var m=this.getRowIndex();this.beans.focusService.setFocusedHeader(m,this.column)}},t.prototype.setupHover=function(){var e=this;this.createManagedBean(new gn([this.column],this.eGui));var r=function(){if(e.gridOptionsService.is("columnHoverHighlight")){var i=e.columnHoverService.isHovered(e.column);e.comp.addOrRemoveCssClass("ag-column-hover",i)}};this.addManagedListener(this.eventService,I.EVENT_COLUMN_HOVER_CHANGED,r),r()},t.prototype.setupLeft=function(){var e=new Bc(this.column,this.eGui,this.beans);this.createManagedBean(e)},t.prototype.setupUserComp=function(){var e=this;if(this.active){var r=this.column.getColDef();this.suppressFilterButton=!!r.floatingFilterComponentParams&&!!r.floatingFilterComponentParams.suppressFilterButton;var i=this.filterManager.getFloatingFilterCompDetails(this.column,function(){return e.showParentFilter()});i&&this.comp.setCompDetails(i)}},t.prototype.showParentFilter=function(){var e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.menuFactory.showMenuAfterButtonClick(this.column,e,"floatingFilter","filterMenuTab",["filterMenuTab"])},t.prototype.setupSyncWithFilter=function(){var e=this;if(this.active){var r=function(i){var n=e.comp.getFloatingFilterComp();if(n){var u=e.filterManager.getCurrentFloatingFilterParentModel(e.column);n.then(function(c){c&&c.onParentModelChanged(u,i)})}};this.addManagedListener(this.column,Kt.EVENT_FILTER_CHANGED,r),this.filterManager.isFilterActive(this.column)&&r(null)}},t.prototype.setupWidth=function(){var e=this,r=function(){var i=e.column.getActualWidth()+"px";e.comp.setWidth(i)};this.addManagedListener(this.column,Kt.EVENT_WIDTH_CHANGED,r),r()},t.prototype.updateFilterButton=function(){!this.suppressFilterButton&&this.comp&&this.comp.setButtonWrapperDisplayed(this.filterManager.isFilterAllowed(this.column))},ql([D("filterManager")],t.prototype,"filterManager",void 0),ql([D("columnHoverService")],t.prototype,"columnHoverService",void 0),ql([D("menuFactory")],t.prototype,"menuFactory",void 0),t}(Es),Cd=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Vc=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},T0=function(o){function t(e,r,i,n,u){var c=o.call(this)||this;return c.pinned=e,c.column=r,c.eResize=i,c.comp=n,c.ctrl=u,c}return Cd(t,o),t.prototype.postConstruct=function(){var n,u,e=this,r=this.column.getColDef(),i=[],v=function(){i.forEach(function(C){return C()}),i.length=0},m=function(){var C=e.column.isResizable(),_=!e.gridOptionsService.is("suppressAutoSize")&&!r.suppressAutoSize;(C!==n||_!==u)&&(n=C,u=_,v(),function(){if(Ze(e.eResize,n),n){var C=e.horizontalResizeService.addResizeBar({eResizeBar:e.eResize,onResizeStart:e.onResizeStart.bind(e),onResizing:e.onResizing.bind(e,!1),onResizeEnd:e.onResizing.bind(e,!0)});if(i.push(C),u){var _=e.gridOptionsService.is("skipHeaderOnAutoSize"),O=function(){e.columnModel.autoSizeColumn(e.column,_,"uiColumnResized")};e.eResize.addEventListener("dblclick",O);var P=new Ut(e.eResize);P.addEventListener(Ut.EVENT_DOUBLE_TAP,O),e.addDestroyFunc(function(){e.eResize.removeEventListener("dblclick",O),P.removeEventListener(Ut.EVENT_DOUBLE_TAP,O),P.destroy()})}}}())};m(),this.addDestroyFunc(v),this.ctrl.addRefreshFunction(m)},t.prototype.onResizing=function(e,r){var i=this.normaliseResizeAmount(r),n=[{key:this.column,newWidth:this.resizeStartWidth+i}];this.columnModel.setColumnWidths(n,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.comp.addOrRemoveCssClass("ag-column-resizing",!1)},t.prototype.onResizeStart=function(e){this.resizeStartWidth=this.column.getActualWidth(),this.resizeWithShiftKey=e,this.comp.addOrRemoveCssClass("ag-column-resizing",!0)},t.prototype.normaliseResizeAmount=function(e){var r=e,i="left"!==this.pinned,n="right"===this.pinned;return this.gridOptionsService.is("enableRtl")?i&&(r*=-1):n&&(r*=-1),r},Vc([D("horizontalResizeService")],t.prototype,"horizontalResizeService",void 0),Vc([D("columnModel")],t.prototype,"columnModel",void 0),Vc([Re],t.prototype,"postConstruct",null),t}(we),O0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ql=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},A0=function(o){function t(e){var r=o.call(this)||this;r.cbSelectAllVisible=!1,r.processingEventFromCheckbox=!1,r.column=e;var i=e.getColDef();return r.filteredOnly=!!i?.headerCheckboxSelectionFilteredOnly,r.currentPageOnly=!!i?.headerCheckboxSelectionCurrentPageOnly,r}return O0(t,o),t.prototype.onSpaceKeyPressed=function(e){var r=this.cbSelectAll,i=this.gridOptionsService.getDocument();r.isDisplayed()&&!r.getGui().contains(i.activeElement)&&(e.preventDefault(),r.setValue(!r.getValue()))},t.prototype.getCheckboxGui=function(){return this.cbSelectAll.getGui()},t.prototype.setComp=function(e){this.headerCellCtrl=e,this.cbSelectAll=this.createManagedBean(new vs),this.cbSelectAll.addCssClass("ag-header-select-all"),vt(this.cbSelectAll.getGui(),"presentation"),this.showOrHideSelectAll(),this.addManagedListener(this.eventService,I.EVENT_NEW_COLUMNS_LOADED,this.showOrHideSelectAll.bind(this)),this.addManagedListener(this.eventService,I.EVENT_DISPLAYED_COLUMNS_CHANGED,this.showOrHideSelectAll.bind(this)),this.addManagedListener(this.eventService,I.EVENT_SELECTION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_PAGINATION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_MODEL_UPDATED,this.onModelChanged.bind(this)),this.addManagedListener(this.cbSelectAll,vs.EVENT_CHANGED,this.onCbSelectAll.bind(this)),ts(this.cbSelectAll.getGui(),!0),this.cbSelectAll.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()},t.prototype.showOrHideSelectAll=function(){this.cbSelectAllVisible=this.isCheckboxSelection(),this.cbSelectAll.setDisplayed(this.cbSelectAllVisible,{skipAriaHidden:!0}),this.cbSelectAllVisible&&(this.checkRightRowModelType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel()},t.prototype.onModelChanged=function(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()},t.prototype.onSelectionChanged=function(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()},t.prototype.updateStateOfCheckbox=function(){if(!this.processingEventFromCheckbox){this.processingEventFromCheckbox=!0;var e=this.selectionService.getSelectAllState(this.filteredOnly,this.currentPageOnly);this.cbSelectAll.setValue(e),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}},t.prototype.refreshSelectAllLabel=function(){if(this.cbSelectAllVisible){var e=this.localeService.getLocaleTextFunc(),i=this.cbSelectAll.getValue()?e("ariaChecked","checked"):e("ariaUnchecked","unchecked"),n=e("ariaRowSelectAll","Press Space to toggle all rows selection");this.headerCellCtrl.setAriaDescriptionProperty("selectAll",n+" ("+i+")"),this.cbSelectAll.setInputAriaLabel(n+" ("+i+")")}else this.headerCellCtrl.setAriaDescriptionProperty("selectAll",null),this.cbSelectAll.setInputAriaLabel(null);this.headerCellCtrl.refreshAriaDescription()},t.prototype.checkRightRowModelType=function(e){var r=this.rowModel.getType();return!!("clientSide"===r||"serverSide"===r)||(console.warn("AG Grid: "+e+" is only available if using 'clientSide' or 'serverSide' rowModelType, you are using "+r+"."),!1)},t.prototype.onCbSelectAll=function(){if(!this.processingEventFromCheckbox&&this.cbSelectAllVisible){var e=this.cbSelectAll.getValue(),r="uiSelectAll";this.currentPageOnly?r="uiSelectAllCurrentPage":this.filteredOnly&&(r="uiSelectAllFiltered");var i={source:r,justFiltered:this.filteredOnly,justCurrentPage:this.currentPageOnly};e?this.selectionService.selectAllRowNodes(i):this.selectionService.deselectAllRowNodes(i)}},t.prototype.isCheckboxSelection=function(){var e=this.column.getColDef().headerCheckboxSelection;"function"==typeof e&&(e=e({column:this.column,colDef:this.column.getColDef(),columnApi:this.columnApi,api:this.gridApi,context:this.gridOptionsService.context}));return!!e&&this.checkRightRowModelType("headerCheckboxSelection")},Ql([D("gridApi")],t.prototype,"gridApi",void 0),Ql([D("columnApi")],t.prototype,"columnApi",void 0),Ql([D("rowModel")],t.prototype,"rowModel",void 0),Ql([D("selectionService")],t.prototype,"selectionService",void 0),t}(we),D0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Vn=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},b0=function(o){function t(e,r){var i=o.call(this,e,r)||this;return i.refreshFunctions=[],i.userHeaderClasses=new Set,i.ariaDescriptionProperties=new Map,i.column=e,i}return D0(t,o),t.prototype.setComp=function(e,r,i,n){var u=this;o.prototype.setGui.call(this,r),this.comp=e,this.updateState(),this.setupWidth(),this.setupMovingCss(),this.setupMenuClass(),this.setupSortableClass(),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight(n),this.addColumnHoverListener(),this.setupFilterCss(),this.setupColId(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(),this.setupSelectAll(),this.setupUserComp(),this.refreshAria(),this.createManagedBean(new T0(this.getPinned(),this.column,i,e,this)),this.createManagedBean(new gn([this.column],r)),this.createManagedBean(new Bc(this.column,r,this.beans)),this.createManagedBean(new ro(r,{shouldStopEventPropagation:function(c){return u.shouldStopEventPropagation(c)},onTabKeyDown:function(){return null},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedListener(this.column,Kt.EVENT_COL_DEF_CHANGED,this.onColDefChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_COLUMN_VALUE_CHANGED,this.onColumnValueChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onColumnRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_COLUMN_PIVOT_CHANGED,this.onColumnPivotChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))},t.prototype.setupUserComp=function(){var e=this.lookupUserCompDetails();this.setCompDetails(e)},t.prototype.setCompDetails=function(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)},t.prototype.lookupUserCompDetails=function(){var e=this.createParams(),r=this.column.getColDef();return this.userComponentFactory.getHeaderCompDetails(r,e)},t.prototype.createParams=function(){var e=this,r=this.column.getColDef();return{column:this.column,displayName:this.displayName,enableSorting:r.sortable,enableMenu:this.menuEnabled,showColumnMenu:function(n){e.gridApi.showColumnMenuAfterButtonClick(e.column,n)},progressSort:function(n){e.sortController.progressSort(e.column,!!n,"uiColumnSorted")},setSort:function(n,u){e.sortController.setSortForColumn(e.column,n,!!u,"uiColumnSorted")},api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsService.context,eGridHeader:this.getGui()}},t.prototype.setupSelectAll=function(){this.selectAllFeature=this.createManagedBean(new A0(this.column)),this.selectAllFeature.setComp(this)},t.prototype.getSelectAllGui=function(){return this.selectAllFeature.getCheckboxGui()},t.prototype.handleKeyDown=function(e){o.prototype.handleKeyDown.call(this,e),e.key===ve.SPACE&&this.selectAllFeature.onSpaceKeyPressed(e),e.key===ve.ENTER&&this.onEnterKeyPressed(e)},t.prototype.onEnterKeyPressed=function(e){var r=this.comp.getUserCompInstance();if(r)if(e.ctrlKey||e.metaKey)this.menuEnabled&&r.showMenu&&(e.preventDefault(),r.showMenu());else if(this.sortable){var i=e.shiftKey;this.sortController.progressSort(this.column,i,"uiColumnSorted")}},t.prototype.isMenuEnabled=function(){return this.menuEnabled},t.prototype.onFocusIn=function(e){if(!this.getGui().contains(e.relatedTarget)){var r=this.getRowIndex();this.focusService.setFocusedHeader(r,this.column)}this.setActiveHeader(!0)},t.prototype.onFocusOut=function(e){this.getGui().contains(e.relatedTarget)||this.setActiveHeader(!1)},t.prototype.setupTooltip=function(){var e=this,r={getColumn:function(){return e.column},getColDef:function(){return e.column.getColDef()},getGui:function(){return e.eGui},getLocation:function(){return"header"},getTooltipValue:function(){return e.column.getColDef().headerTooltip}},i=this.createManagedBean(new bc(r,this.beans));i.setComp(this.comp),this.refreshFunctions.push(function(){return i.refreshToolTip()})},t.prototype.setupClassesFromColDef=function(){var e=this,r=function(){var i=e.column.getColDef(),n=hd.getHeaderClassesFromColDef(i,e.gridOptionsService,e.column,null),u=e.userHeaderClasses;e.userHeaderClasses=new Set(n),n.forEach(function(c){u.has(c)?u.delete(c):e.comp.addOrRemoveCssClass(c,!0)}),u.forEach(function(c){return e.comp.addOrRemoveCssClass(c,!1)})};this.refreshFunctions.push(r),r()},t.prototype.setDragSource=function(e){var r=this;if(this.dragSourceElement=e,this.removeDragSource(),e&&this.draggable){var i=!this.gridOptionsService.is("suppressDragLeaveHidesColumns");this.moveDragSource={type:ni.HeaderCell,eElement:e,defaultIconName:i?Vr.ICON_HIDE:Vr.ICON_NOT_ALLOWED,getDragItem:function(){return r.createDragItem()},dragItemName:this.displayName,onDragStarted:function(){return r.column.setMoving(!0,"uiColumnMoved")},onDragStopped:function(){return r.column.setMoving(!1,"uiColumnMoved")},onGridEnter:function(n){var u;if(i){var c=(null===(u=n?.columns)||void 0===u?void 0:u.filter(function(v){return!v.getColDef().lockVisible}))||[];r.columnModel.setColumnsVisible(c,!0,"uiColumnMoved")}},onGridExit:function(n){var u;if(i){var c=(null===(u=n?.columns)||void 0===u?void 0:u.filter(function(v){return!v.getColDef().lockVisible}))||[];r.columnModel.setColumnsVisible(c,!1,"uiColumnMoved")}}},this.dragAndDropService.addDragSource(this.moveDragSource,!0)}},t.prototype.createDragItem=function(){var e={};return e[this.column.getId()]=this.column.isVisible(),{columns:[this.column],visibleState:e}},t.prototype.removeDragSource=function(){this.moveDragSource&&(this.dragAndDropService.removeDragSource(this.moveDragSource),this.moveDragSource=void 0)},t.prototype.onColDefChanged=function(){this.refresh()},t.prototype.updateState=function(){var e=this.column.getColDef();this.menuEnabled=this.menuFactory.isMenuEnabled(this.column)&&!e.suppressMenu,this.sortable=e.sortable,this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()},t.prototype.addRefreshFunction=function(e){this.refreshFunctions.push(e)},t.prototype.refresh=function(){this.updateState(),this.refreshHeaderComp(),this.refreshAria(),this.refreshFunctions.forEach(function(e){return e()})},t.prototype.refreshHeaderComp=function(){var e=this.lookupUserCompDetails();!!(null!=this.comp.getUserCompInstance()&&this.userCompDetails.componentClass==e.componentClass)&&this.attemptHeaderCompRefresh(e.params)?this.setDragSource(this.dragSourceElement):this.setCompDetails(e)},t.prototype.attemptHeaderCompRefresh=function(e){var r=this.comp.getUserCompInstance();return!(!r||!r.refresh)&&r.refresh(e)},t.prototype.calculateDisplayName=function(){return this.columnModel.getDisplayNameForColumn(this.column,"header",!0)},t.prototype.checkDisplayName=function(){this.displayName!==this.calculateDisplayName()&&this.refresh()},t.prototype.workOutDraggable=function(){var e=this.column.getColDef();return!!(!this.gridOptionsService.is("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot},t.prototype.onColumnRowGroupChanged=function(){this.checkDisplayName()},t.prototype.onColumnPivotChanged=function(){this.checkDisplayName()},t.prototype.onColumnValueChanged=function(){this.checkDisplayName()},t.prototype.setupWidth=function(){var e=this,r=function(){var i=e.column.getActualWidth();e.comp.setWidth(i+"px")};this.addManagedListener(this.column,Kt.EVENT_WIDTH_CHANGED,r),r()},t.prototype.setupMovingCss=function(){var e=this,r=function(){e.comp.addOrRemoveCssClass("ag-header-cell-moving",e.column.isMoving())};this.addManagedListener(this.column,Kt.EVENT_MOVING_CHANGED,r),r()},t.prototype.setupMenuClass=function(){var e=this,r=function(){e.comp.addOrRemoveCssClass("ag-column-menu-visible",e.column.isMenuVisible())};this.addManagedListener(this.column,Kt.EVENT_MENU_VISIBLE_CHANGED,r),r()},t.prototype.setupSortableClass=function(){var e=this,r=function(){e.comp.addOrRemoveCssClass("ag-header-cell-sortable",!!e.sortable)};r(),this.addRefreshFunction(r),this.addManagedListener(this.eventService,Kt.EVENT_SORT_CHANGED,this.refreshAriaSort.bind(this))},t.prototype.setupWrapTextClass=function(){var e=this,r=function(){var i=!!e.column.getColDef().wrapHeaderText;e.comp.addOrRemoveCssClass("ag-header-cell-wrap-text",i)};r(),this.addRefreshFunction(r)},t.prototype.onHeaderHeightChanged=function(){this.refreshSpanHeaderHeight()},t.prototype.refreshSpanHeaderHeight=function(){var e=this,r=e.eGui,i=e.column,n=e.comp,u=e.columnModel,c=e.gridOptionsService;if(i.isSpanHeaderHeight()){var v=this.getColumnGroupPaddingInfo(),m=v.numberOfParents,C=v.isSpanningTotal;if(n.addOrRemoveCssClass("ag-header-span-height",m>0),0!==m){n.addOrRemoveCssClass("ag-header-span-total",C);var O=c.is("pivotMode")?u.getPivotGroupHeaderHeight():u.getGroupHeaderHeight(),P=u.getColumnHeaderRowHeight(),L=m*O;r.style.setProperty("top",-L+"px"),r.style.setProperty("height",P+L+"px")}}},t.prototype.getColumnGroupPaddingInfo=function(){var e=this.column.getParent();if(!e||!e.isPadding())return{numberOfParents:0,isSpanningTotal:!1};for(var r=e.getPaddingLevel()+1,i=!0;e;){if(!e.isPadding()){i=!1;break}e=e.getParent()}return{numberOfParents:r,isSpanningTotal:i}},t.prototype.setupAutoHeight=function(e){var u,r=this,i=function(C){if(r.isAlive()){var _=Ct(r.getGui()),q=_.paddingTop+_.paddingBottom+_.borderBottomWidth+_.borderTopWidth,re=e.offsetHeight+q;if(C<5){var pe=r.beans.gridOptionsService.getDocument();if(!pe||!pe.contains(e)||0==re)return void r.beans.frameworkOverrides.setTimeout(function(){return i(C+1)},0)}r.columnModel.setColumnHeaderHeight(r.column,re)}},n=!1,c=function(){var C=r.column.isSpanHeaderHeight(),_=r.column.isAutoHeaderHeight();if(C){if(m(),_){_t(function(){return console.warn("AG Grid: The properties `spanHeaderHeight` and `autoHeaderHeight` cannot be used together in the same column.")},"HeaderCellCtrl.spanHeaderHeightAndAutoHeaderHeight")}}else _&&!n&&v(),!_&&n&&m()},v=function(){n=!0,i(0),r.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!0),u=r.resizeObserverService.observeResize(e,function(){return i(0)})},m=function(){n=!1,u&&u(),r.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!1),u=void 0};c(),this.addDestroyFunc(function(){return m()}),this.addManagedListener(this.column,Kt.EVENT_WIDTH_CHANGED,function(){return n&&i(0)}),this.addManagedListener(this.eventService,Kt.EVENT_SORT_CHANGED,function(){n&&r.beans.frameworkOverrides.setTimeout(function(){return i(0)})}),this.addRefreshFunction(c)},t.prototype.refreshAriaSort=function(){if(this.sortable){var e=this.localeService.getLocaleTextFunc(),r=this.sortController.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(ji(r)),this.setAriaDescriptionProperty("sort",e("ariaSortableColumn","Press ENTER to sort."))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)},t.prototype.refreshAriaMenu=function(){if(this.menuEnabled){var e=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press CTRL ENTER to open column menu."))}else this.setAriaDescriptionProperty("menu",null)},t.prototype.setAriaDescriptionProperty=function(e,r){null!=r?this.ariaDescriptionProperties.set(e,r):this.ariaDescriptionProperties.delete(e)},t.prototype.refreshAriaDescription=function(){var e=Array.from(this.ariaDescriptionProperties.values());this.comp.setAriaDescription(e.length?e.join(" "):void 0)},t.prototype.refreshAria=function(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaDescription()},t.prototype.addColumnHoverListener=function(){var e=this,r=function(){if(e.gridOptionsService.is("columnHoverHighlight")){var i=e.columnHoverService.isHovered(e.column);e.comp.addOrRemoveCssClass("ag-column-hover",i)}};this.addManagedListener(this.eventService,I.EVENT_COLUMN_HOVER_CHANGED,r),r()},t.prototype.setupFilterCss=function(){var e=this,r=function(){e.comp.addOrRemoveCssClass("ag-header-cell-filtered",e.column.isFilterActive())};this.addManagedListener(this.column,Kt.EVENT_FILTER_ACTIVE_CHANGED,r),r()},t.prototype.setupColId=function(){this.comp.setColId(this.column.getColId())},t.prototype.addActiveHeaderMouseListeners=function(){var e=this,r=function(i){return e.setActiveHeader("mouseenter"===i.type)};this.addManagedListener(this.getGui(),"mouseenter",r),this.addManagedListener(this.getGui(),"mouseleave",r)},t.prototype.setActiveHeader=function(e){this.comp.addOrRemoveCssClass("ag-header-active",e)},Vn([D("columnModel")],t.prototype,"columnModel",void 0),Vn([D("columnHoverService")],t.prototype,"columnHoverService",void 0),Vn([D("sortController")],t.prototype,"sortController",void 0),Vn([D("menuFactory")],t.prototype,"menuFactory",void 0),Vn([D("dragAndDropService")],t.prototype,"dragAndDropService",void 0),Vn([D("resizeObserverService")],t.prototype,"resizeObserverService",void 0),Vn([D("gridApi")],t.prototype,"gridApi",void 0),Vn([D("columnApi")],t.prototype,"columnApi",void 0),Vn([Mr],t.prototype,"removeDragSource",null),t}(Es),F0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Jl=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},wd=function(o){function t(e,r,i,n){var u=o.call(this)||this;return u.eResize=r,u.comp=e,u.pinned=i,u.columnGroup=n,u}return F0(t,o),t.prototype.postConstruct=function(){var e=this;if(this.columnGroup.isResizable()){var r=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(this.addDestroyFunc(r),!this.gridOptionsService.is("suppressAutoSize")){var i=this.gridOptionsService.is("skipHeaderOnAutoSize");this.eResize.addEventListener("dblclick",function(){var n=[];e.columnGroup.getDisplayedLeafColumns().forEach(function(c){c.getColDef().suppressAutoSize||n.push(c.getColId())}),n.length>0&&e.columnModel.autoSizeColumns({columns:n,skipHeader:i,stopAtGroup:e.columnGroup,source:"uiColumnResized"}),e.resizeLeafColumnsToFit("uiColumnResized")})}}else this.comp.setResizableDisplayed(!1)},t.prototype.onResizeStart=function(e){var r=this;this.calculateInitialValues();var i=null;if(e&&(i=this.columnModel.getDisplayedGroupAfter(this.columnGroup)),i){var n=i.getDisplayedLeafColumns();this.resizeTakeFromCols=n.filter(function(u){return u.isResizable()}),this.resizeTakeFromStartWidth=0,this.resizeTakeFromCols.forEach(function(u){return r.resizeTakeFromStartWidth+=u.getActualWidth()}),this.resizeTakeFromRatios=[],this.resizeTakeFromCols.forEach(function(u){return r.resizeTakeFromRatios.push(u.getActualWidth()/r.resizeTakeFromStartWidth)})}else this.resizeTakeFromCols=null,this.resizeTakeFromStartWidth=null,this.resizeTakeFromRatios=null;this.comp.addOrRemoveCssClass("ag-column-resizing",!0)},t.prototype.onResizing=function(e,r,i){void 0===i&&(i="uiColumnResized");var n=this.normaliseDragChange(r),u=this.resizeStartWidth+n;this.resizeColumns(u,i,e)},t.prototype.resizeLeafColumnsToFit=function(e){var r=this.autoWidthCalculator.getPreferredWidthForColumnGroup(this.columnGroup);this.calculateInitialValues(),r>this.resizeStartWidth&&this.resizeColumns(r,e,!0)},t.prototype.resizeColumns=function(e,r,i){void 0===i&&(i=!0);var n=[];if(n.push({columns:this.resizeCols,ratios:this.resizeRatios,width:e}),this.resizeTakeFromCols){var u=e-this.resizeStartWidth;n.push({columns:this.resizeTakeFromCols,ratios:this.resizeTakeFromRatios,width:this.resizeTakeFromStartWidth-u})}this.columnModel.resizeColumnSets({resizeSets:n,finished:i,source:r}),i&&this.comp.addOrRemoveCssClass("ag-column-resizing",!1)},t.prototype.calculateInitialValues=function(){var e=this,r=this.columnGroup.getDisplayedLeafColumns();this.resizeCols=r.filter(function(i){return i.isResizable()}),this.resizeStartWidth=0,this.resizeCols.forEach(function(i){return e.resizeStartWidth+=i.getActualWidth()}),this.resizeRatios=[],this.resizeCols.forEach(function(i){return e.resizeRatios.push(i.getActualWidth()/e.resizeStartWidth)})},t.prototype.normaliseDragChange=function(e){var r=e;return this.gridOptionsService.is("enableRtl")?"left"!==this.pinned&&(r*=-1):"right"===this.pinned&&(r*=-1),r},Jl([D("horizontalResizeService")],t.prototype,"horizontalResizeService",void 0),Jl([D("autoWidthCalculator")],t.prototype,"autoWidthCalculator",void 0),Jl([D("columnModel")],t.prototype,"columnModel",void 0),Jl([Re],t.prototype,"postConstruct",null),t}(we),P0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),L0=function(o){function t(e,r){var i=o.call(this)||this;return i.removeChildListenersFuncs=[],i.columnGroup=r,i.comp=e,i}return P0(t,o),t.prototype.postConstruct=function(){this.addListenersToChildrenColumns(),this.addManagedListener(this.columnGroup,ti.EVENT_DISPLAYED_CHILDREN_CHANGED,this.onDisplayedChildrenChanged.bind(this)),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))},t.prototype.addListenersToChildrenColumns=function(){var e=this;this.removeListenersOnChildrenColumns();var r=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach(function(i){i.addEventListener("widthChanged",r),i.addEventListener("visibleChanged",r),e.removeChildListenersFuncs.push(function(){i.removeEventListener("widthChanged",r),i.removeEventListener("visibleChanged",r)})})},t.prototype.removeListenersOnChildrenColumns=function(){this.removeChildListenersFuncs.forEach(function(e){return e()}),this.removeChildListenersFuncs=[]},t.prototype.onDisplayedChildrenChanged=function(){this.addListenersToChildrenColumns(),this.onWidthChanged()},t.prototype.onWidthChanged=function(){var e=this.columnGroup.getActualWidth();this.comp.setWidth(e+"px"),this.comp.addOrRemoveCssClass("ag-hidden",0===e)},function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);i>3&&n&&Object.defineProperty(t,e,n)}([Re],t.prototype,"postConstruct",null),t}(we),M0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Zl=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Sd=function(o){function t(e,r){var i=o.call(this,e,r)||this;return i.columnGroup=e,i}return M0(t,o),t.prototype.setComp=function(e,r,i){o.prototype.setGui.call(this,r),this.comp=e,this.displayName=this.columnModel.getDisplayNameForColumnGroup(this.columnGroup,"header"),this.addClasses(),this.addAttributes(),this.setupMovingCss(),this.setupExpandable(),this.setupTooltip(),this.setupUserComp();var n=this.getParentRowCtrl().getPinned(),u=this.columnGroup.getProvidedColumnGroup().getLeafColumns();this.createManagedBean(new gn(u,r)),this.createManagedBean(new Bc(this.columnGroup,r,this.beans)),this.createManagedBean(new L0(e,this.columnGroup)),this.groupResizeFeature=this.createManagedBean(new wd(e,i,n,this.columnGroup)),this.createManagedBean(new ro(r,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:function(){},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))},t.prototype.resizeLeafColumnsToFit=function(e){var r,i;null===(r=this.groupResizeFeature)||void 0===r||r.onResizeStart(!1),null===(i=this.groupResizeFeature)||void 0===i||i.resizeLeafColumnsToFit(e)},t.prototype.setupUserComp=function(){var e=this,r=this.displayName,i={displayName:this.displayName,columnGroup:this.columnGroup,setExpanded:function(m){e.columnModel.setColumnGroupOpened(e.columnGroup.getProvidedColumnGroup(),m,"gridInitializing")},api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsService.context};if(!r){for(var n=this.columnGroup,u=n.getLeafColumns();n.getParent()&&n.getParent().getLeafColumns().length===u.length;)n=n.getParent();var c=n.getColGroupDef();c&&(r=c.headerName),r||(r=u?this.columnModel.getDisplayNameForColumn(u[0],"header",!0):"")}var v=this.userComponentFactory.getHeaderGroupCompDetails(i);this.comp.setUserCompDetails(v)},t.prototype.setupTooltip=function(){var e=this,r=this.columnGroup.getColGroupDef(),i={getColumn:function(){return e.columnGroup},getGui:function(){return e.eGui},getLocation:function(){return"headerGroup"},getTooltipValue:function(){return r&&r.headerTooltip}};r&&(i.getColDef=function(){return r}),this.createManagedBean(new bc(i,this.beans)).setComp(this.comp)},t.prototype.setupExpandable=function(){var e=this.columnGroup.getProvidedColumnGroup();this.refreshExpanded(),this.addManagedListener(e,tr.EVENT_EXPANDABLE_CHANGED,this.refreshExpanded.bind(this)),this.addManagedListener(e,tr.EVENT_EXPANDED_CHANGED,this.refreshExpanded.bind(this))},t.prototype.refreshExpanded=function(){var e=this.columnGroup;this.expandable=e.isExpandable();var r=e.isExpanded();this.expandable?this.comp.setAriaExpanded(r?"true":"false"):this.comp.setAriaExpanded(void 0)},t.prototype.addAttributes=function(){this.comp.setColId(this.columnGroup.getUniqueId())},t.prototype.addClasses=function(){var e=this,r=this.columnGroup.getColGroupDef(),i=hd.getHeaderClassesFromColDef(r,this.gridOptionsService,null,this.columnGroup);this.columnGroup.isPadding()?(i.push("ag-header-group-cell-no-group"),this.columnGroup.getLeafColumns().every(function(u){return u.isSpanHeaderHeight()})&&i.push("ag-header-span-height")):i.push("ag-header-group-cell-with-group");i.forEach(function(u){return e.comp.addOrRemoveCssClass(u,!0)})},t.prototype.setupMovingCss=function(){var e=this,i=this.columnGroup.getProvidedColumnGroup().getLeafColumns(),n=function(){return e.comp.addOrRemoveCssClass("ag-header-cell-moving",e.columnGroup.isMoving())};i.forEach(function(u){e.addManagedListener(u,Kt.EVENT_MOVING_CHANGED,n)}),n()},t.prototype.onFocusIn=function(e){if(!this.eGui.contains(e.relatedTarget)){var r=this.getRowIndex();this.beans.focusService.setFocusedHeader(r,this.columnGroup)}},t.prototype.handleKeyDown=function(e){o.prototype.handleKeyDown.call(this,e);var r=this.getWrapperHasFocus();if(this.expandable&&r&&e.key===ve.ENTER){var i=this.columnGroup,n=!i.isExpanded();this.columnModel.setColumnGroupOpened(i.getProvidedColumnGroup(),n,"uiColumnExpanded")}},t.prototype.setDragSource=function(e){var r=this;if(!this.isSuppressMoving()){var i=this.columnGroup.getProvidedColumnGroup().getLeafColumns(),n=!this.gridOptionsService.is("suppressDragLeaveHidesColumns"),u={type:ni.HeaderCell,eElement:e,defaultIconName:n?Vr.ICON_HIDE:Vr.ICON_NOT_ALLOWED,dragItemName:this.displayName,getDragItem:this.getDragItemForGroup.bind(this),onDragStarted:function(){return i.forEach(function(c){return c.setMoving(!0,"uiColumnDragged")})},onDragStopped:function(){return i.forEach(function(c){return c.setMoving(!1,"uiColumnDragged")})},onGridEnter:function(c){var v;if(n){var m=(null===(v=c?.columns)||void 0===v?void 0:v.filter(function(C){return!C.getColDef().lockVisible}))||[];r.columnModel.setColumnsVisible(m,!0,"uiColumnMoved")}},onGridExit:function(c){var v;if(n){var m=(null===(v=c?.columns)||void 0===v?void 0:v.filter(function(C){return!C.getColDef().lockVisible}))||[];r.columnModel.setColumnsVisible(m,!1,"uiColumnMoved")}}};this.dragAndDropService.addDragSource(u,!0),this.addDestroyFunc(function(){return r.dragAndDropService.removeDragSource(u)})}},t.prototype.getDragItemForGroup=function(){var e=this.columnGroup.getProvidedColumnGroup().getLeafColumns(),r={};e.forEach(function(n){return r[n.getId()]=n.isVisible()});var i=[];return this.columnModel.getAllDisplayedColumns().forEach(function(n){e.indexOf(n)>=0&&(i.push(n),Nr(e,n))}),e.forEach(function(n){return i.push(n)}),{columns:i,visibleState:r}},t.prototype.isSuppressMoving=function(){var e=!1;return this.columnGroup.getLeafColumns().forEach(function(i){(i.getColDef().suppressMovable||i.getColDef().lockPosition)&&(e=!0)}),e||this.gridOptionsService.is("suppressMovableColumns")},Zl([D("columnModel")],t.prototype,"columnModel",void 0),Zl([D("dragAndDropService")],t.prototype,"dragAndDropService",void 0),Zl([D("gridApi")],t.prototype,"gridApi",void 0),Zl([D("columnApi")],t.prototype,"columnApi",void 0),t}(Es),N0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),_d=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},k0=0,Wc=function(o){function t(e,r,i){var n=o.call(this)||this;return n.instanceId=k0++,n.headerCellCtrls={},n.rowIndex=e,n.pinned=r,n.type=i,n}return N0(t,o),t.prototype.getInstanceId=function(){return this.instanceId},t.prototype.setComp=function(e){this.comp=e,this.onRowHeightChanged(),this.onVirtualColumnsChanged(),this.setWidth(),this.addEventListeners(),Fi()&&this.comp.setTransform("translateZ(0)"),e.setAriaRowIndex(this.rowIndex+1)},t.prototype.addEventListeners=function(){this.addManagedListener(this.eventService,I.EVENT_COLUMN_RESIZED,this.onColumnResized.bind(this)),this.addManagedListener(this.eventService,I.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_GRID_STYLES_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onDisplayedColumnsChanged.bind(this)),this.addManagedPropertyListener("headerHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("groupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotGroupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("floatingFiltersHeight",this.onRowHeightChanged.bind(this))},t.prototype.getHeaderCellCtrl=function(e){return Pr(this.headerCellCtrls).find(function(r){return r.getColumnGroupChild()===e})},t.prototype.onDisplayedColumnsChanged=function(){this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()},t.prototype.getType=function(){return this.type},t.prototype.onColumnResized=function(){this.setWidth()},t.prototype.setWidth=function(){var e=this.getWidthForRow();this.comp.setWidth(e+"px")},t.prototype.getWidthForRow=function(){return this.gridOptionsService.isDomLayout("print")?null!=this.pinned?0:this.columnModel.getContainerWidth("right")+this.columnModel.getContainerWidth("left")+this.columnModel.getContainerWidth(null):this.columnModel.getContainerWidth(this.pinned)},t.prototype.onRowHeightChanged=function(){var e=this.columnModel.getHeaderRowCount(),r=[],i=0;this.columnModel.hasFloatingFilters()&&(e++,i=1);for(var n=this.columnModel.getColumnGroupHeaderRowHeight(),u=this.columnModel.getColumnHeaderRowHeight(),v=e-(1+i),m=0;m<v;m++)r.push(n);r.push(u);for(m=0;m<i;m++)r.push(this.columnModel.getFloatingFiltersHeight());var C=0;for(m=0;m<this.rowIndex;m++)C+=r[m];var _=r[this.rowIndex]+"px";this.comp.setTop(C+"px"),this.comp.setHeight(_)},t.prototype.getPinned=function(){return this.pinned},t.prototype.getRowIndex=function(){return this.rowIndex},t.prototype.onVirtualColumnsChanged=function(){var e=this,r=this.headerCellCtrls;this.headerCellCtrls={},this.getColumnsInViewport().forEach(function(c){if(!c.isEmptyGroup()){var v=c.getUniqueId(),m=r[v];if(delete r[v],m&&m.getColumnGroupChild()!=c&&(e.destroyBean(m),m=void 0),null==m)switch(e.type){case Ur.FLOATING_FILTER:m=e.createBean(new R0(c,e));break;case Ur.COLUMN_GROUP:m=e.createBean(new Sd(c,e));break;default:m=e.createBean(new b0(c,e))}e.headerCellCtrls[v]=m}});Xe(r,function(c,v){var m=function(c){return!!e.focusService.isHeaderWrapperFocused(c)&&e.columnModel.isDisplayed(c.getColumnGroupChild())}(v);m?e.headerCellCtrls[c]=v:e.destroyBean(v)});var u=Ir(this.headerCellCtrls);this.comp.setHeaderCtrls(u)},t.prototype.getColumnsInViewport=function(){return this.gridOptionsService.isDomLayout("print")?this.getColumnsInViewportPrintLayout():this.getColumnsInViewportNormalLayout()},t.prototype.getColumnsInViewportPrintLayout=function(){var e=this;if(null!=this.pinned)return[];var r=[],i=this.getActualDepth();return["left",null,"right"].forEach(function(n){var u=e.columnModel.getVirtualHeaderGroupRow(n,i);r=r.concat(u)}),r},t.prototype.getActualDepth=function(){return this.type==Ur.FLOATING_FILTER?this.rowIndex-1:this.rowIndex},t.prototype.getColumnsInViewportNormalLayout=function(){return this.columnModel.getVirtualHeaderGroupRow(this.pinned,this.getActualDepth())},t.prototype.focusHeader=function(e,r){var n=Ir(this.headerCellCtrls).find(function(u){return u.getColumnGroupChild()==e});return!!n&&(n.focus(r),!0)},t.prototype.destroy=function(){var e=this;Xe(this.headerCellCtrls,function(r,i){e.destroyBean(i)}),this.headerCellCtrls={},o.prototype.destroy.call(this)},_d([D("columnModel")],t.prototype,"columnModel",void 0),_d([D("focusService")],t.prototype,"focusService",void 0),t}(we),G0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ya=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},H0=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},V0=function(o){function t(e){var r=o.call(this)||this;return r.hidden=!1,r.groupsRowCtrls=[],r.pinned=e,r}return G0(t,o),t.prototype.setComp=function(e,r){this.comp=e,this.eViewport=r,this.setupCenterWidth(),this.setupPinnedWidth(),this.setupDragAndDrop(this.eViewport),this.addManagedListener(this.eventService,I.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.ctrlsService.registerHeaderContainer(this,this.pinned),this.columnModel.isReady()&&this.refresh()},t.prototype.setupDragAndDrop=function(e){var r=new g0(this.pinned,e);this.createManagedBean(r)},t.prototype.refresh=function(e){var r=this;void 0===e&&(e=!1);var C,_,i=new cs,n=this.focusService.getFocusHeaderToUseAfterRefresh();(function(){var C=r.columnModel.getHeaderRowCount()-1;r.groupsRowCtrls=r.destroyBeans(r.groupsRowCtrls);for(var _=0;_<C;_++){var O=r.createBean(new Wc(i.next(),r.pinned,Ur.COLUMN_GROUP));r.groupsRowCtrls.push(O)}})(),C=i.next(),((_=!(r.hidden||null!=r.columnsRowCtrl&&e&&r.columnsRowCtrl.getRowIndex()===C))||r.hidden)&&(r.columnsRowCtrl=r.destroyBean(r.columnsRowCtrl)),_&&(r.columnsRowCtrl=r.createBean(new Wc(C,r.pinned,Ur.COLUMN))),function(){var _=function(){r.filtersRowCtrl=r.destroyBean(r.filtersRowCtrl)};if(r.columnModel.hasFloatingFilters()&&!r.hidden){var O=i.next();if(r.filtersRowCtrl){var P=r.filtersRowCtrl.getRowIndex()!==O;(!e||P)&&_()}r.filtersRowCtrl||(r.filtersRowCtrl=r.createBean(new Wc(O,r.pinned,Ur.FLOATING_FILTER)))}else _()}();var m=this.getAllCtrls();this.comp.setCtrls(m),this.restoreFocusOnHeader(n)},t.prototype.restoreFocusOnHeader=function(e){null==e||e.column.getPinned()!=this.pinned||this.focusService.focusHeaderPosition({headerPosition:e})},t.prototype.getAllCtrls=function(){var e=function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(H0(arguments[t]));return o}(this.groupsRowCtrls);return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e},t.prototype.onGridColumnsChanged=function(){this.refresh(!0)},t.prototype.setupCenterWidth=function(){var e=this;null==this.pinned&&this.createManagedBean(new Mc(function(r){return e.comp.setCenterWidth(r+"px")},!0))},t.prototype.setHorizontalScroll=function(e){this.comp.setViewportScrollLeft(e)},t.prototype.setupPinnedWidth=function(){var e=this;if(null!=this.pinned){var r="left"===this.pinned,i="right"===this.pinned;this.hidden=!0;var n=function(){var u=r?e.pinnedWidthService.getPinnedLeftWidth():e.pinnedWidthService.getPinnedRightWidth();if(null!=u){var c=0==u,v=e.hidden!==c,m=e.gridOptionsService.is("enableRtl"),C=e.gridOptionsService.getScrollbarWidth(),O=e.scrollVisibleService.isVerticalScrollShowing()&&(m&&r||!m&&i)?u+C:u;e.comp.setPinnedContainerWidth(O+"px"),e.comp.setDisplayed(!c),v&&(e.hidden=c,e.refresh())}};this.addManagedListener(this.eventService,I.EVENT_LEFT_PINNED_WIDTH_CHANGED,n),this.addManagedListener(this.eventService,I.EVENT_RIGHT_PINNED_WIDTH_CHANGED,n),this.addManagedListener(this.eventService,I.EVENT_SCROLL_VISIBILITY_CHANGED,n),this.addManagedListener(this.eventService,I.EVENT_SCROLLBAR_WIDTH_CHANGED,n)}},t.prototype.getHeaderCtrlForColumn=function(e){if(e instanceof Kt)return this.columnsRowCtrl?this.columnsRowCtrl.getHeaderCellCtrl(e):void 0;if(0!==this.groupsRowCtrls.length)for(var r=0;r<this.groupsRowCtrls.length;r++){var i=this.groupsRowCtrls[r].getHeaderCellCtrl(e);if(i)return i}},t.prototype.getHtmlElementForColumnHeader=function(e){var r=this.getHeaderCtrlForColumn(e);return r?r.getGui():null},t.prototype.getRowType=function(e){var i=this.getAllCtrls()[e];return i?i.getType():void 0},t.prototype.focusHeader=function(e,r,i){var u=this.getAllCtrls()[e];return!!u&&u.focusHeader(r,i)},t.prototype.getRowCount=function(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)},t.prototype.destroy=function(){this.filtersRowCtrl&&(this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)),this.columnsRowCtrl&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),this.groupsRowCtrls&&this.groupsRowCtrls.length&&(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls)),o.prototype.destroy.call(this)},ya([D("ctrlsService")],t.prototype,"ctrlsService",void 0),ya([D("scrollVisibleService")],t.prototype,"scrollVisibleService",void 0),ya([D("pinnedWidthService")],t.prototype,"pinnedWidthService",void 0),ya([D("columnModel")],t.prototype,"columnModel",void 0),ya([D("focusService")],t.prototype,"focusService",void 0),t}(we),W0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Uc=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},jc=function(o){function t(e){var r=o.call(this)||this;return r.headerRowComps={},r.rowCompsList=[],r.pinned=e,r}return W0(t,o),t.prototype.init=function(){var e=this;this.selectAndSetTemplate();var r={setDisplayed:function(n){return e.setDisplayed(n)},setCtrls:function(n){return e.setCtrls(n)},setCenterWidth:function(n){return e.eCenterContainer.style.width=n},setViewportScrollLeft:function(n){return e.getGui().scrollLeft=n},setPinnedContainerWidth:function(n){var u=e.getGui();u.style.width=n,u.style.maxWidth=n,u.style.minWidth=n}};this.createManagedBean(new V0(this.pinned)).setComp(r,this.getGui())},t.prototype.selectAndSetTemplate=function(){var e="left"==this.pinned,r="right"==this.pinned,i=e?t.PINNED_LEFT_TEMPLATE:r?t.PINNED_RIGHT_TEMPLATE:t.CENTER_TEMPLATE;this.setTemplate(i),this.eRowContainer=this.eCenterContainer?this.eCenterContainer:this.getGui()},t.prototype.destroyRowComps=function(){this.setCtrls([])},t.prototype.destroyRowComp=function(e){this.destroyBean(e),this.eRowContainer.removeChild(e.getGui())},t.prototype.setCtrls=function(e){var r=this,i=this.headerRowComps;this.headerRowComps={},this.rowCompsList=[];var n;e.forEach(function(c){var v=c.getInstanceId(),m=i[v];delete i[v];var C=m||r.createBean(new x0(c));r.headerRowComps[v]=C,r.rowCompsList.push(C),function(c){var v=c.getGui();v.parentElement!=r.eRowContainer&&r.eRowContainer.appendChild(v),n&&Mn(r.eRowContainer,v,n),n=v}(C)}),Ir(i).forEach(function(c){return r.destroyRowComp(c)})},t.PINNED_LEFT_TEMPLATE='<div class="ag-pinned-left-header" role="presentation"></div>',t.PINNED_RIGHT_TEMPLATE='<div class="ag-pinned-right-header" role="presentation"></div>',t.CENTER_TEMPLATE='<div class="ag-header-viewport" role="presentation">\n            <div class="ag-header-container" ref="eCenterContainer" role="rowgroup"></div>\n        </div>',Uc([Te("eCenterContainer")],t.prototype,"eCenterContainer",void 0),Uc([Re],t.prototype,"init",null),Uc([Mr],t.prototype,"destroyRowComps",null),t}(Ue),U0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ca=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n};!function(o){o[o.UP=0]="UP",o[o.DOWN=1]="DOWN",o[o.LEFT=2]="LEFT",o[o.RIGHT=3]="RIGHT"}(mn||(mn={}));var j0=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return U0(t,o),t.prototype.postConstruct=function(){var e=this;this.ctrlsService.whenReady(function(r){e.gridBodyCon=r.gridBodyCtrl})},t.prototype.getHeaderRowCount=function(){var e=this.ctrlsService.getHeaderRowContainerCtrl();return e?e.getRowCount():0},t.prototype.navigateVertically=function(e,r,i){if(r||(r=this.focusService.getFocusedHeader()),!r)return!1;var n=r.headerRowIndex,u=r.column,c=this.getHeaderRowCount(),m=e===mn.UP?this.headerPositionUtils.getColumnVisibleParent(u,n):this.headerPositionUtils.getColumnVisibleChild(u,n),C=m.nextRow,_=m.nextFocusColumn,O=!1;return C<0&&(C=0,_=u,O=!0),C>=c&&(C=-1),!(!O&&!_)&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:C,column:_},allowUserOverride:!0,event:i})},t.prototype.navigateHorizontally=function(e,r,i){void 0===r&&(r=!1);var v,m,n=this.focusService.getFocusedHeader();return e===mn.LEFT!==this.gridOptionsService.is("enableRtl")?(m="Before",v=this.headerPositionUtils.findHeader(n,m)):(m="After",v=this.headerPositionUtils.findHeader(n,m)),v||!r?this.focusService.focusHeaderPosition({headerPosition:v,direction:m,fromTab:r,allowUserOverride:!0,event:i}):this.focusNextHeaderRow(n,m,i)},t.prototype.focusNextHeaderRow=function(e,r,i){var c,n=e.headerRowIndex,u=null;return"Before"===r?n>0&&(c=n-1,u=this.headerPositionUtils.findColAtEdgeForHeaderRow(c,"end")):(c=n+1,u=this.headerPositionUtils.findColAtEdgeForHeaderRow(c,"start")),this.focusService.focusHeaderPosition({headerPosition:u,direction:r,fromTab:!0,allowUserOverride:!0,event:i})},t.prototype.scrollToColumn=function(e,r){if(void 0===r&&(r="After"),!e.getPinned()){var i;if(e instanceof ti){var n=e.getDisplayedLeafColumns();i="Before"===r?Mt(n):n[0]}else i=e;this.gridBodyCon.getScrollFeature().ensureColumnVisible(i)}},Ca([D("focusService")],t.prototype,"focusService",void 0),Ca([D("headerPositionUtils")],t.prototype,"headerPositionUtils",void 0),Ca([D("ctrlsService")],t.prototype,"ctrlsService",void 0),Ca([Re],t.prototype,"postConstruct",null),t=Ca([He("headerNavigationService")],t)}(we),z0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),eu=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},K0=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return z0(t,o),t.prototype.setComp=function(e,r,i){this.comp=e,this.eGui=r,this.createManagedBean(new ro(i,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedListener(this.eventService,I.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onPivotModeChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.onPivotModeChanged(),this.setupHeaderHeight(),this.ctrlsService.registerGridHeaderCtrl(this)},t.prototype.setupHeaderHeight=function(){var e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListener("headerHeight",e),this.addManagedPropertyListener("pivotHeaderHeight",e),this.addManagedPropertyListener("groupHeaderHeight",e),this.addManagedPropertyListener("pivotGroupHeaderHeight",e),this.addManagedPropertyListener("floatingFiltersHeight",e),this.addManagedListener(this.eventService,I.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,I.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,e),this.addManagedListener(this.eventService,I.EVENT_GRID_STYLES_CHANGED,e)},t.prototype.getHeaderHeight=function(){return this.headerHeight},t.prototype.setHeaderHeight=function(){var n,e=this.columnModel,r=0,i=e.getHeaderRowCount();e.hasFloatingFilters()&&(i++,r=1);var c=this.columnModel.getColumnGroupHeaderRowHeight(),v=this.columnModel.getColumnHeaderRowHeight(),C=i-(1+r);if(n=r*e.getFloatingFiltersHeight(),n+=C*c,n+=v,this.headerHeight!==n){this.headerHeight=n;var _=n+1+"px";this.comp.setHeightAndMinHeight(_),this.eventService.dispatchEvent({type:I.EVENT_HEADER_HEIGHT_CHANGED})}},t.prototype.onPivotModeChanged=function(){var e=this.columnModel.isPivotMode();this.comp.addOrRemoveCssClass("ag-pivot-on",e),this.comp.addOrRemoveCssClass("ag-pivot-off",!e)},t.prototype.onDisplayedColumnsChanged=function(){var r=this.columnModel.getAllDisplayedColumns().some(function(i){return i.isSpanHeaderHeight()});this.comp.addOrRemoveCssClass("ag-header-allow-overflow",r)},t.prototype.onTabKeyDown=function(e){var r=this.gridOptionsService.is("enableRtl"),i=e.shiftKey!==r?mn.LEFT:mn.RIGHT;(this.headerNavigationService.navigateHorizontally(i,!0,e)||this.focusService.focusNextGridCoreContainer(e.shiftKey))&&e.preventDefault()},t.prototype.handleKeyDown=function(e){var r=null;switch(e.key){case ve.LEFT:r=mn.LEFT;case ve.RIGHT:me(r)||(r=mn.RIGHT),this.headerNavigationService.navigateHorizontally(r,!1,e);break;case ve.UP:r=mn.UP;case ve.DOWN:me(r)||(r=mn.DOWN),this.headerNavigationService.navigateVertically(r,null,e)&&e.preventDefault();break;default:return}},t.prototype.onFocusOut=function(e){var r=this.gridOptionsService.getDocument(),i=e.relatedTarget;!i&&this.eGui.contains(r.activeElement)||this.eGui.contains(i)||this.focusService.clearFocusedHeader()},eu([D("headerNavigationService")],t.prototype,"headerNavigationService",void 0),eu([D("focusService")],t.prototype,"focusService",void 0),eu([D("columnModel")],t.prototype,"columnModel",void 0),eu([D("ctrlsService")],t.prototype,"ctrlsService",void 0),t}(we),$0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),X0=function(o){function t(){return o.call(this,t.TEMPLATE)||this}return $0(t,o),t.prototype.postConstruct=function(){var e=this,r={addOrRemoveCssClass:function(u,c){return e.addOrRemoveCssClass(u,c)},setHeightAndMinHeight:function(u){e.getGui().style.height=u,e.getGui().style.minHeight=u}};this.createManagedBean(new K0).setComp(r,this.getGui(),this.getFocusableElement());var n=function(u){e.createManagedBean(u),e.appendChild(u)};n(new jc("left")),n(new jc(null)),n(new jc("right"))},t.TEMPLATE='<div class="ag-header" role="presentation"/>',function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);i>3&&n&&Object.defineProperty(t,e,n)}([Re],t.prototype,"postConstruct",null),t}(Ue),q0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),zc=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Q0=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return q0(t,o),t.prototype.addResizeBar=function(e){var r=this,i={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e)};this.dragService.addDragSource(i,!0);return function(){return r.dragService.removeDragSource(i)}},t.prototype.onDragStart=function(e,r){this.dragStartX=r.clientX,this.setResizeIcons();var i=r instanceof MouseEvent&&!0===r.shiftKey;e.onResizeStart(i)},t.prototype.setResizeIcons=function(){var e=this.ctrlsService.getGridCtrl();e.setResizeCursor(!0),e.disableUserSelect(!0)},t.prototype.onDragStop=function(e,r){e.onResizeEnd(this.resizeAmount),this.resetIcons()},t.prototype.resetIcons=function(){var e=this.ctrlsService.getGridCtrl();e.setResizeCursor(!1),e.disableUserSelect(!1)},t.prototype.onDragging=function(e,r){this.resizeAmount=r.clientX-this.dragStartX,e.onResizing(this.resizeAmount)},zc([D("dragService")],t.prototype,"dragService",void 0),zc([D("ctrlsService")],t.prototype,"ctrlsService",void 0),t=zc([He("horizontalResizeService")],t)}(we),J0=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),wa=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Z0=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return J0(t,o),t.prototype.hideActiveMenu=function(){this.hidePopup&&this.hidePopup()},t.prototype.showMenuAfterMouseEvent=function(e,r){var i=this;this.showPopup(e,function(n){i.popupService.positionPopupUnderMouseEvent({column:e,type:"columnMenu",mouseEvent:r,ePopup:n})},"columnMenu",r.target)},t.prototype.showMenuAfterButtonClick=function(e,r,i){var n=this;this.showPopup(e,function(u){n.popupService.positionPopupByComponent({type:i,eventSource:r,ePopup:u,keepWithinBounds:!0,position:"under",column:e})},i,r)},t.prototype.showPopup=function(e,r,i,n){var u=this,c=this.filterManager.getOrCreateFilterWrapper(e,"COLUMN_MENU");if(!c)throw new Error("AG Grid - unable to show popup filter, filter instantiation failed");var v=document.createElement("div");vt(v,"presentation"),v.classList.add("ag-menu"),this.tabListener=this.addManagedListener(v,"keydown",function(z){return u.trapFocusWithin(z,v)}),c.guiPromise.then(function(z){return v.appendChild(z)});var m,_=n||this.ctrlsService.getGridBodyCtrl().getGui(),P=this.localeService.getLocaleTextFunc(),L=this.popupService.addPopup({modal:!0,eChild:v,closeOnEsc:!0,closedCallback:function(z){e.setMenuVisible(!1,"contextMenu");var q=z instanceof KeyboardEvent;if(u.tabListener&&(u.tabListener=u.tabListener()),q&&n&&ls(n)){var Z=u.focusService.findTabbableParent(n);Z&&Z.focus()}!function(){var z;null===(z=c.filterPromise)||void 0===z||z.then(function(q){var Z;return null===(Z=q?.afterGuiDetached)||void 0===Z?void 0:Z.call(q)})}()},positionCallback:function(){return r(v)},anchorToElement:_,ariaLabel:P("ariaLabelColumnMenu","Column Menu")});L&&(this.hidePopup=m=L.hideFunc),c.filterPromise.then(function(z){r(v),z.afterGuiAttached&&z.afterGuiAttached({container:i,hidePopup:m})}),e.setMenuVisible(!0,"contextMenu")},t.prototype.trapFocusWithin=function(e,r){e.key!==ve.TAB||e.defaultPrevented||this.focusService.findNextFocusableElement(r,!1,e.shiftKey)||(e.preventDefault(),this.focusService.focusInto(r,e.shiftKey))},t.prototype.isMenuEnabled=function(e){return e.isFilterAllowed()&&e.getMenuTabs(["filterMenuTab"]).includes("filterMenuTab")},wa([D("filterManager")],t.prototype,"filterManager",void 0),wa([D("popupService")],t.prototype,"popupService",void 0),wa([D("focusService")],t.prototype,"focusService",void 0),wa([D("ctrlsService")],t.prototype,"ctrlsService",void 0),t=wa([He("menuFactory")],t)}(we),Sa=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Rs=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n};!function(o){function t(e){var r=o.call(this,t.getTemplate(e.cssClass))||this;return r.items=[],r.tabbedItemScrollMap=new Map,r.params=e,e.items&&e.items.forEach(function(i){return r.addItem(i)}),r}Sa(t,o),t.prototype.postConstruct=function(){var e=this;this.createManagedBean(new ro(this.getFocusableElement(),{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this)})),this.addDestroyFunc(function(){var r,i,n;return null===(n=null===(i=null===(r=e.activeItem)||void 0===r?void 0:r.tabbedItem)||void 0===i?void 0:i.afterDetachedCallback)||void 0===n?void 0:n.call(i)})},t.getTemplate=function(e){return'<div class="ag-tabs '+e+'">\n            <div ref="eHeader" role="tablist" class="ag-tabs-header '+(e?e+"-header":"")+'"></div>\n            <div ref="eBody" role="presentation" class="ag-tabs-body '+(e?e+"-body":"")+'"></div>\n        </div>'},t.prototype.handleKeyDown=function(e){var r=this.gridOptionsService.getDocument();switch(e.key){case ve.RIGHT:case ve.LEFT:if(!this.eHeader.contains(r.activeElement))return;var i=e.key===ve.RIGHT,n=this.gridOptionsService.is("enableRtl"),u=this.items.indexOf(this.activeItem),c=i!==n?Math.min(u+1,this.items.length-1):Math.max(u-1,0);if(u===c)return;e.preventDefault();var v=this.items[c];this.showItemWrapper(v),v.eHeaderButton.focus();break;case ve.UP:case ve.DOWN:e.stopPropagation()}},t.prototype.onTabKeyDown=function(e){if(!e.defaultPrevented){var r=this,i=r.focusService,n=r.eHeader,u=r.eBody,c=r.activeItem,m=this.gridOptionsService.getDocument().activeElement,C=e.target;if(e.preventDefault(),n.contains(m))return void i.focusInto(u,e.shiftKey);var _=null;i.isTargetUnderManagedComponent(u,C)&&(e.shiftKey&&(_=this.focusService.findFocusableElementBeforeTabGuard(u,C)),_||(_=c.eHeaderButton)),!_&&u.contains(m)&&((_=i.findNextFocusableElement(u,!1,e.shiftKey))||(_=c.eHeaderButton)),_&&_.focus()}},t.prototype.setAfterAttachedParams=function(e){this.afterAttachedParams=e},t.prototype.showFirstItem=function(){this.items.length>0&&this.showItemWrapper(this.items[0])},t.prototype.addItem=function(e){var r=document.createElement("span");vt(r,"tab"),r.setAttribute("tabIndex","-1"),r.appendChild(e.title),r.classList.add("ag-tab"),this.eHeader.appendChild(r),wo(r,e.titleLabel);var i={tabbedItem:e,eHeaderButton:r};this.items.push(i),r.addEventListener("click",this.showItemWrapper.bind(this,i))},t.prototype.showItem=function(e){var r=this.items.find(function(i){return i.tabbedItem===e});r&&this.showItemWrapper(r)},t.prototype.showItemWrapper=function(e){var i,n,r=this,u=e.tabbedItem,c=e.eHeaderButton;this.params.onItemClicked&&this.params.onItemClicked({item:u}),this.activeItem!==e?(this.lastScrollListener&&(this.lastScrollListener=this.lastScrollListener()),Wt(this.eBody),u.bodyPromise.then(function(v){r.eBody.appendChild(v);var m=!r.focusService.isKeyboardMode();if(r.focusService.focusInto(r.eBody,!1,m),u.afterAttachedCallback&&u.afterAttachedCallback(r.afterAttachedParams),r.params.keepScrollPosition){var C=u.getScrollableContainer&&u.getScrollableContainer()||v;r.lastScrollListener=r.addManagedListener(C,"scroll",function(){r.tabbedItemScrollMap.set(u.name,C.scrollTop)});var _=r.tabbedItemScrollMap.get(u.name);void 0!==_&&setTimeout(function(){C.scrollTop=_},0)}}),this.activeItem&&(this.activeItem.eHeaderButton.classList.remove("ag-tab-selected"),null===(n=(i=this.activeItem.tabbedItem).afterDetachedCallback)||void 0===n||n.call(i)),c.classList.add("ag-tab-selected"),this.activeItem=e):Of(this.params.onActiveItemClicked)},Rs([D("focusService")],t.prototype,"focusService",void 0),Rs([Te("eHeader")],t.prototype,"eHeader",void 0),Rs([Te("eBody")],t.prototype,"eBody",void 0),Rs([Re],t.prototype,"postConstruct",null)}(Ue);var Td,em=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),rm=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.polyfillFunctions=[],e}return em(t,o),t.prototype.observeResize=function(e,r){var _,i=this,u=this.gridOptionsService.getDocument().defaultView||window,m=this.gridOptionsService.is("suppressBrowserResizeObserver");return!!u.ResizeObserver&&!m?((_=new u.ResizeObserver(r)).observe(e),function(){return _.disconnect()}):function(){var _=ui(e),O=qu(e),P=!0,L=function(){if(P){var z=ui(e),q=qu(e);(z!==_||q!==O)&&(_=z,O=q,r()),i.doNextPolyfillTurn(L)}};return L(),function(){return P=!1}}()},t.prototype.doNextPolyfillTurn=function(e){this.polyfillFunctions.push(e),this.schedulePolyfill()},t.prototype.schedulePolyfill=function(){var e=this;if(!this.polyfillScheduled){this.polyfillScheduled=!0,this.getFrameworkOverrides().setTimeout(function(){var i=e.polyfillFunctions;e.polyfillScheduled=!1,e.polyfillFunctions=[],i.forEach(function(n){return n()})},50)}},t=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n}([He("resizeObserverService")],t),t}(we),im=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),tu=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},nm=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.createTasksP1={list:[],sorted:!1},e.createTasksP2={list:[],sorted:!1},e.destroyTasks=[],e.ticking=!1,e.scrollGoingDown=!0,e.lastPage=0,e.lastScrollTop=0,e.taskCount=0,e.cancelledTasks=new Set,e}return im(t,o),t.prototype.setScrollTop=function(e){var r=this.gridOptionsService.is("pagination");if(this.scrollGoingDown=e>=this.lastScrollTop,r&&0===e){var i=this.paginationProxy.getCurrentPage();i!==this.lastPage&&(this.lastPage=i,this.scrollGoingDown=!0)}this.lastScrollTop=e},t.prototype.init=function(){this.useAnimationFrame=!this.gridOptionsService.is("suppressAnimationFrame")},t.prototype.isOn=function(){return this.useAnimationFrame},t.prototype.verifyAnimationFrameOn=function(e){!1===this.useAnimationFrame&&console.warn("AG Grid: AnimationFrameService."+e+" called but animation frames are off")},t.prototype.createTask=function(e,r,i){this.verifyAnimationFrameOn(i);var n={task:e,index:r,createOrder:++this.taskCount};this.addTaskToList(this[i],n),this.schedule()},t.prototype.cancelTask=function(e){this.cancelledTasks.add(e)},t.prototype.addTaskToList=function(e,r){e.list.push(r),e.sorted=!1},t.prototype.sortTaskList=function(e){if(!e.sorted){var r=this.scrollGoingDown?1:-1;e.list.sort(function(i,n){return i.index!==n.index?r*(n.index-i.index):n.createOrder-i.createOrder}),e.sorted=!0}},t.prototype.addDestroyTask=function(e){this.verifyAnimationFrameOn("createTasksP3"),this.destroyTasks.push(e),this.schedule()},t.prototype.executeFrame=function(e){this.verifyAnimationFrameOn("executeFrame");for(var r=this.createTasksP1,i=r.list,n=this.createTasksP2,u=n.list,c=this.destroyTasks,v=(new Date).getTime(),m=(new Date).getTime()-v,C=e<=0,_=this.ctrlsService.getGridBodyCtrl();C||m<e;){if(!_.getScrollFeature().scrollGridIfNeeded()){var P=void 0;if(i.length)this.sortTaskList(r),P=i.pop().task;else if(u.length)this.sortTaskList(n),P=u.pop().task;else{if(!c.length){this.cancelledTasks.clear();break}P=c.pop()}this.cancelledTasks.has(P)||P()}m=(new Date).getTime()-v}i.length||u.length||c.length?this.requestFrame():this.stopTicking()},t.prototype.stopTicking=function(){this.ticking=!1},t.prototype.flushAllFrames=function(){this.useAnimationFrame&&this.executeFrame(-1)},t.prototype.schedule=function(){this.useAnimationFrame&&(this.ticking||(this.ticking=!0,this.requestFrame()))},t.prototype.requestFrame=function(){var e=this.executeFrame.bind(this,60),i=this.gridOptionsService.getDocument().defaultView||window;i.requestAnimationFrame?i.requestAnimationFrame(e):i.webkitRequestAnimationFrame?i.webkitRequestAnimationFrame(e):i.setTimeout(e,0)},t.prototype.isQueueEmpty=function(){return!this.ticking},t.prototype.debounce=function(e){var r=this,i=!1;return function(){r.isOn()?i||(i=!0,r.addDestroyTask(function(){i=!1,e()})):r.getFrameworkOverrides().setTimeout(e,0)}},tu([D("ctrlsService")],t.prototype,"ctrlsService",void 0),tu([D("paginationProxy")],t.prototype,"paginationProxy",void 0),tu([Re],t.prototype,"init",null),t=tu([He("animationFrameService")],t)}(we),om=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),_a=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},sm=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return om(t,o),t.prototype.postConstruct=function(){var e=this;this.ctrlsService.whenReady(function(r){e.centerRowContainerCtrl=r.centerRowContainerCtrl})},t.prototype.getPreferredWidthForColumn=function(e,r){var i=this.getHeaderCellForColumn(e);if(!i)return-1;var n=this.rowRenderer.getAllCellsForColumn(e);return r||n.push(i),this.addElementsToContainerAndGetWidth(n)},t.prototype.getPreferredWidthForColumnGroup=function(e){var r=this.getHeaderCellForColumn(e);return r?this.addElementsToContainerAndGetWidth([r]):-1},t.prototype.addElementsToContainerAndGetWidth=function(e){var r=this,i=document.createElement("form");i.style.position="fixed";var n=this.centerRowContainerCtrl.getContainerElement();n.appendChild(i),e.forEach(function(v){return r.cloneItemIntoDummy(v,i)});var u=i.offsetWidth;return n.removeChild(i),u+this.getAutoSizePadding()},t.prototype.getAutoSizePadding=function(){var e=this.gridOptionsService.getNum("autoSizePadding");return null!=e&&e>=0?e:20},t.prototype.getHeaderCellForColumn=function(e){var r=null;return this.ctrlsService.getHeaderRowContainerCtrls().forEach(function(i){var n=i.getHtmlElementForColumnHeader(e);null!=n&&(r=n)}),r},t.prototype.cloneItemIntoDummy=function(e,r){var i=e.cloneNode(!0);i.style.width="",i.style.position="static",i.style.left="";var n=document.createElement("div"),u=n.classList;["ag-header-cell","ag-header-group-cell"].some(function(O){return i.classList.contains(O)})?(u.add("ag-header","ag-header-row"),n.style.position="static"):u.add("ag-row");for(var v=e.parentElement;v;){if(["ag-header-row","ag-row"].some(function(O){return v.classList.contains(O)})){for(var C=0;C<v.classList.length;C++){var _=v.classList[C];"ag-row-position-absolute"!=_&&u.add(_)}break}v=v.parentElement}n.appendChild(i),r.appendChild(n)},_a([D("rowRenderer")],t.prototype,"rowRenderer",void 0),_a([D("ctrlsService")],t.prototype,"ctrlsService",void 0),_a([D("rowCssClassCalculator")],t.prototype,"rowCssClassCalculator",void 0),_a([Re],t.prototype,"postConstruct",null),t=_a([He("autoWidthCalculator")],t)}(we),am=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ru=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},um=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},fm=function(o){function t(e,r){var i=o.call(this)||this;return i.createRowCon=e,i.destroyRowCtrls=r,i.stickyRowCtrls=[],i.containerHeight=0,i}return am(t,o),t.prototype.postConstruct=function(){var e=this;this.isClientSide="clientSide"===this.rowModel.getType(),this.ctrlsService.whenReady(function(r){e.gridBodyCtrl=r.gridBodyCtrl})},t.prototype.getStickyRowCtrls=function(){return this.stickyRowCtrls},t.prototype.checkStickyRows=function(){var e=this,r=0;if(this.gridOptionsService.is("groupRowsSticky")){for(var i=[],n=this.rowRenderer.getFirstVisibleVerticalPixel(),u=function(P){var L,z,q,Z;if(i.push(P),e.isClientSide){for(var re=P;re.expanded;)if(re.master)re=re.detailNode;else if(re.childrenAfterSort){if(0===re.childrenAfterSort.length)break;re=Mt(re.childrenAfterSort)}Z=re.rowTop+re.rowHeight}else{var pe=null===(L=P.childStore)||void 0===L?void 0:L.getStoreBounds();Z=(null!==(z=pe?.heightPx)&&void 0!==z?z:0)+(null!==(q=pe?.topPx)&&void 0!==q?q:0)}var Ce=n+r+P.rowHeight;P.stickyRowTop=Z<Ce?r+(Z-Ce):r,r=0,i.forEach(function(be){var qe=be.stickyRowTop+be.rowHeight;r<qe&&(r=qe)})};;){var c=n+r,v=this.rowModel.getRowIndexAtPixel(c),m=this.rowModel.getRow(v);if(null==m||m.level<0)break;for(var C=[],_=m.parent;_.level>=0;)C.push(_),_=_.parent;var O=C.reverse().find(function(P){return i.indexOf(P)<0&&P.displayed});if(O)u(O);else{if(!(m.isExpandable()&&m.expanded&&m.rowTop<c))break;u(m)}}this.refreshNodesAndContainerHeight(i,r)}else this.refreshNodesAndContainerHeight([],r)},t.prototype.refreshStickyNode=function(e){for(var r=[],i=0;i<this.stickyRowCtrls.length;i++){var n=this.stickyRowCtrls[i].getRowNode();n!==e&&r.push(n)}this.refreshNodesAndContainerHeight(r,this.containerHeight),this.checkStickyRows()},t.prototype.refreshNodesAndContainerHeight=function(e,r){var i,n,u,c=this,v=this.stickyRowCtrls.filter(function(z){return-1===e.indexOf(z.getRowNode())}),m=e.filter(function(z){return-1===c.stickyRowCtrls.findIndex(function(q){return q.getRowNode()===z})}),C={};v.forEach(function(z){C[z.getRowNode().id]=z,c.stickyRowCtrls=c.stickyRowCtrls.filter(function(q){return q!==z})});try{for(var _=function(o){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&o[t],r=0;if(e)return e.call(o);if(o&&"number"==typeof o.length)return{next:function(){return o&&r>=o.length&&(o=void 0),{value:o&&o[r++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(Object.values(C)),O=_.next();!O.done;O=_.next()){O.value.getRowNode().sticky=!1}}catch(z){i={error:z}}finally{try{O&&!O.done&&(n=_.return)&&n.call(_)}finally{if(i)throw i.error}}this.destroyRowCtrls(C,!1);var L=m.map(function(z){return z.sticky=!0,c.createRowCon(z,!1,!1)});(u=this.stickyRowCtrls).push.apply(u,function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(um(arguments[t]));return o}(L)),this.stickyRowCtrls.forEach(function(z){return z.setRowTop(z.getRowNode().stickyRowTop)}),this.stickyRowCtrls.sort(function(z,q){return q.getRowNode().rowIndex-z.getRowNode().rowIndex}),this.containerHeight!==r&&(this.containerHeight=r,this.gridBodyCtrl.setStickyTopHeight(r))},ru([D("rowModel")],t.prototype,"rowModel",void 0),ru([D("rowRenderer")],t.prototype,"rowRenderer",void 0),ru([D("ctrlsService")],t.prototype,"ctrlsService",void 0),ru([Re],t.prototype,"postConstruct",null),t}(we),Ed=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Xi=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},pm=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},Kc=function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(pm(arguments[t]));return o},dm=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.destroyFuncsForColumnListeners=[],e.rowCtrlsByRowIndex={},e.zombieRowCtrls={},e.allRowCtrls=[],e.topRowCtrls=[],e.bottomRowCtrls=[],e.refreshInProgress=!1,e.dataFirstRenderedFired=!1,e}return Ed(t,o),t.prototype.postConstruct=function(){var e=this;this.ctrlsService.whenReady(function(){e.gridBodyCtrl=e.ctrlsService.getGridBodyCtrl(),e.initialise()})},t.prototype.initialise=function(){if(this.addManagedListener(this.eventService,I.EVENT_PAGINATION_CHANGED,this.onPageLoaded.bind(this)),this.addManagedListener(this.eventService,I.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_BODY_SCROLL,this.onBodyScroll.bind(this)),this.addManagedListener(this.eventService,I.EVENT_BODY_HEIGHT_CHANGED,this.redrawAfterScroll.bind(this)),this.addManagedPropertyListener("domLayout",this.onDomLayoutChanged.bind(this)),this.addManagedPropertyListener("rowClass",this.redrawRows.bind(this)),this.gridOptionsService.is("groupRowsSticky")){var e=this.rowModel.getType();"clientSide"!=e&&"serverSide"!=e?_t(function(){return console.warn("AG Grid: The feature Sticky Row Groups only works with the Client Side or Server Side Row Model")},"rowRenderer.stickyWorksWithCsrmOnly"):this.stickyRowFeature=this.createManagedBean(new fm(this.createRowCon.bind(this),this.destroyRowCtrls.bind(this)))}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=this.gridOptionsService.isDomLayout("print"),this.embedFullWidthRows=this.printLayout||this.gridOptionsService.is("embedFullWidthRows"),this.redrawAfterModelUpdate()},t.prototype.initialiseCache=function(){if(this.gridOptionsService.is("keepDetailRows")){var r=this.getKeepDetailRowsCount()??3;this.cachedRowCtrls=new hm(r)}},t.prototype.getKeepDetailRowsCount=function(){var e=this.gridOptionsService.getNum("keepDetailRowsCount");return me(e)&&e>0?e:10},t.prototype.getRowCtrls=function(){return this.allRowCtrls},t.prototype.getStickyTopRowCtrls=function(){return this.stickyRowFeature?this.stickyRowFeature.getStickyRowCtrls():[]},t.prototype.updateAllRowCtrls=function(){var e=Ir(this.rowCtrlsByRowIndex),r=this.gridOptionsService.is("ensureDomOrder"),i=this.gridOptionsService.isDomLayout("print");(r||i)&&e.sort(function(c,v){return c.getRowNode().rowIndex-v.getRowNode.rowIndex});var n=Ir(this.zombieRowCtrls),u=this.cachedRowCtrls?this.cachedRowCtrls.getEntries():[];this.allRowCtrls=Kc(e,n,u)},t.prototype.onCellFocusChanged=function(e){this.getAllCellCtrls().forEach(function(r){return r.onCellFocused(e)}),this.getFullWidthRowCtrls().forEach(function(r){return r.onFullWidthRowFocused(e)})},t.prototype.registerCellEventListeners=function(){var e=this;this.addManagedListener(this.eventService,I.EVENT_CELL_FOCUSED,function(i){e.onCellFocusChanged(i)}),this.addManagedListener(this.eventService,I.EVENT_CELL_FOCUS_CLEARED,function(){e.onCellFocusChanged()}),this.addManagedListener(this.eventService,I.EVENT_FLASH_CELLS,function(i){e.getAllCellCtrls().forEach(function(n){return n.onFlashCells(i)})}),this.addManagedListener(this.eventService,I.EVENT_COLUMN_HOVER_CHANGED,function(){e.getAllCellCtrls().forEach(function(i){return i.onColumnHover()})}),this.addManagedListener(this.eventService,I.EVENT_DISPLAYED_COLUMNS_CHANGED,function(){e.getAllCellCtrls().forEach(function(i){return i.onDisplayedColumnsChanged()})}),this.addManagedListener(this.eventService,I.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,function(){e.printLayout&&e.getAllCellCtrls().forEach(function(i){return i.onLeftChanged()})}),this.gridOptionsService.isEnableRangeSelection()&&(this.addManagedListener(this.eventService,I.EVENT_RANGE_SELECTION_CHANGED,function(){e.getAllCellCtrls().forEach(function(i){return i.onRangeSelectionChanged()})}),this.addManagedListener(this.eventService,I.EVENT_COLUMN_MOVED,function(){e.getAllCellCtrls().forEach(function(i){return i.updateRangeBordersIfRangeCount()})}),this.addManagedListener(this.eventService,I.EVENT_COLUMN_PINNED,function(){e.getAllCellCtrls().forEach(function(i){return i.updateRangeBordersIfRangeCount()})}),this.addManagedListener(this.eventService,I.EVENT_COLUMN_VISIBLE,function(){e.getAllCellCtrls().forEach(function(i){return i.updateRangeBordersIfRangeCount()})})),this.refreshListenersToColumnsForCellComps(),this.addManagedListener(this.eventService,I.EVENT_GRID_COLUMNS_CHANGED,this.refreshListenersToColumnsForCellComps.bind(this)),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))},t.prototype.removeGridColumnListeners=function(){this.destroyFuncsForColumnListeners.forEach(function(e){return e()}),this.destroyFuncsForColumnListeners.length=0},t.prototype.refreshListenersToColumnsForCellComps=function(){var e=this;this.removeGridColumnListeners();var r=this.columnModel.getAllGridColumns();r&&r.forEach(function(i){var n=function(_){e.getAllCellCtrls().forEach(function(O){O.getColumn()===i&&_(O)})},u=function(){n(function(_){return _.onLeftChanged()})},c=function(){n(function(_){return _.onWidthChanged()})},v=function(){n(function(_){return _.onFirstRightPinnedChanged()})},m=function(){n(function(_){return _.onLastLeftPinnedChanged()})},C=function(){n(function(_){return _.onColDefChanged()})};i.addEventListener("leftChanged",u),i.addEventListener("widthChanged",c),i.addEventListener("firstRightPinnedChanged",v),i.addEventListener("lastLeftPinnedChanged",m),i.addEventListener("colDefChanged",C),e.destroyFuncsForColumnListeners.push(function(){i.removeEventListener("leftChanged",u),i.removeEventListener("widthChanged",c),i.removeEventListener("firstRightPinnedChanged",v),i.removeEventListener("lastLeftPinnedChanged",m),i.removeEventListener("colDefChanged",C)})})},t.prototype.onDomLayoutChanged=function(){var e=this.gridOptionsService.isDomLayout("print"),r=e||this.gridOptionsService.is("embedFullWidthRows"),i=r!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=r,i&&this.redrawAfterModelUpdate({domLayoutChanged:!0})},t.prototype.datasourceChanged=function(){this.firstRenderedRow=0,this.lastRenderedRow=-1;var e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)},t.prototype.onPageLoaded=function(e){var r={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(r)},t.prototype.getAllCellsForColumn=function(e){var r=[];return this.getAllRowCtrls().forEach(function(i){var n=i.getCellElement(e);n&&r.push(n)}),r},t.prototype.refreshFloatingRowComps=function(){this.refreshFloatingRows(this.topRowCtrls,this.pinnedRowModel.getPinnedTopRowData()),this.refreshFloatingRows(this.bottomRowCtrls,this.pinnedRowModel.getPinnedBottomRowData())},t.prototype.getTopRowCtrls=function(){return this.topRowCtrls},t.prototype.getBottomRowCtrls=function(){return this.bottomRowCtrls},t.prototype.refreshFloatingRows=function(e,r){var i=this;e.forEach(function(n){n.destroyFirstPass(),n.destroySecondPass()}),e.length=0,r&&r.forEach(function(n){var u=new Go(n,i.beans,!1,!1,i.printLayout);e.push(u)})},t.prototype.onPinnedRowDataChanged=function(){this.redrawAfterModelUpdate({recycleRows:!0})},t.prototype.getRenderedIndexesForRowNodes=function(e){var r=[];return Je(e)||Xe(this.rowCtrlsByRowIndex,function(i,n){var u=n.getRowNode();e.indexOf(u)>=0&&r.push(i)}),r},t.prototype.redrawRows=function(e){var r=null!=e&&e.length>0;if(r){var i=this.getRenderedIndexesForRowNodes(e);this.removeRowCtrls(i)}this.redrawAfterModelUpdate({recycleRows:r})},t.prototype.getCellToRestoreFocusToAfterRefresh=function(e){var r=e?.suppressKeepFocus?null:this.focusService.getFocusCellToUseAfterRefresh();if(null==r)return null;var n=this.gridOptionsService.getDocument().activeElement,u=this.gridOptionsService.getDomData(n,ko.DOM_DATA_KEY_CELL_CTRL),c=this.gridOptionsService.getDomData(n,Go.DOM_DATA_KEY_ROW_CTRL);return u||c?r:null},t.prototype.redrawAfterModelUpdate=function(e){void 0===e&&(e={}),this.getLockOnRefresh();var r=this.getCellToRestoreFocusToAfterRefresh(e);this.updateContainerHeights(),this.scrollToTopIfNewData(e);var i=!e.domLayoutChanged&&!!e.recycleRows,n=e.animate&&this.gridOptionsService.isAnimateRows(),u=i?this.recycleRows():null;i||this.removeAllRowComps(),this.redraw(u,n),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(),this.dispatchDisplayedRowsChanged(),null!=r&&this.restoreFocusedCell(r),this.releaseLockOnRefresh()},t.prototype.scrollToTopIfNewData=function(e){var r=e.newData||e.newPage,i=this.gridOptionsService.is("suppressScrollOnNewData");r&&!i&&this.gridBodyCtrl.getScrollFeature().scrollToTop()},t.prototype.updateContainerHeights=function(){if(this.printLayout)this.rowContainerHeightService.setModelHeight(null);else{var e=this.paginationProxy.getCurrentPageHeight();0===e&&(e=1),this.rowContainerHeightService.setModelHeight(e)}},t.prototype.getLockOnRefresh=function(){if(this.refreshInProgress)throw new Error("AG Grid: cannot get grid to draw rows when it is in the middle of drawing rows. Your code probably called a grid API method while the grid was in the render stage. To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). To see what part of your code that caused the refresh check this stacktrace.");this.refreshInProgress=!0},t.prototype.releaseLockOnRefresh=function(){this.refreshInProgress=!1},t.prototype.isRefreshInProgress=function(){return this.refreshInProgress},t.prototype.restoreFocusedCell=function(e){e&&this.onCellFocusChanged({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,api:this.beans.gridApi,columnApi:this.beans.columnApi,context:this.beans.gridOptionsService.context,type:"mock"})},t.prototype.stopEditing=function(e){void 0===e&&(e=!1),this.getAllRowCtrls().forEach(function(r){r.stopEditing(e)})},t.prototype.getAllCellCtrls=function(){for(var e=[],r=this.getAllRowCtrls(),i=r.length,n=0;n<i;n++)for(var u=r[n].getAllCellCtrls(),c=u.length,v=0;v<c;v++)e.push(u[v]);return e},t.prototype.getAllRowCtrls=function(){var e,r,i=this.stickyRowFeature&&this.stickyRowFeature.getStickyRowCtrls()||[],n=Kc(this.topRowCtrls,this.bottomRowCtrls,i);try{for(var u=function(o){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&o[t],r=0;if(e)return e.call(o);if(o&&"number"==typeof o.length)return{next:function(){return o&&r>=o.length&&(o=void 0),{value:o&&o[r++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(Object.keys(this.rowCtrlsByRowIndex)),c=u.next();!c.done;c=u.next()){var v=c.value;n.push(this.rowCtrlsByRowIndex[v])}}catch(m){e={error:m}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}return n},t.prototype.addRenderedRowListener=function(e,r,i){var n=this.rowCtrlsByRowIndex[r];n&&n.addEventListener(e,i)},t.prototype.flashCells=function(e){void 0===e&&(e={});var r=e.flashDelay,i=e.fadeDelay;this.getCellCtrls(e.rowNodes,e.columns).forEach(function(n){return n.flashCell({flashDelay:r,fadeDelay:i})})},t.prototype.refreshCells=function(e){void 0===e&&(e={});var r={forceRefresh:e.force,newData:!1,suppressFlash:e.suppressFlash};this.getCellCtrls(e.rowNodes,e.columns).forEach(function(i){if(i.refreshShouldDestroy()){var n=i.getRowCtrl();n&&n.refreshCell(i)}else i.refreshCell(r)}),this.getFullWidthRowCtrls(e.rowNodes).forEach(function(i){i.refreshFullWidth()})},t.prototype.getCellRendererInstances=function(e){var i,r=this,n=this.getCellCtrls(e.rowNodes,e.columns).map(function(v){return v.getCellRenderer()}).filter(function(v){return null!=v});if(null!==(i=e.columns)&&void 0!==i&&i.length)return n;var u=[],c=this.mapRowNodes(e.rowNodes);return this.getAllRowCtrls().forEach(function(v){if((!c||r.isRowInMap(v.getRowNode(),c))&&v.isFullWidth()){var m=v.getFullWidthCellRenderer();m&&u.push(m)}}),Kc(u,n)},t.prototype.getCellEditorInstances=function(e){var r=[];return this.getCellCtrls(e.rowNodes,e.columns).forEach(function(i){var n=i.getCellEditor();n&&r.push(n)}),r},t.prototype.getEditingCells=function(){var e=[];return this.getAllCellCtrls().forEach(function(r){if(r.isEditing()){var i=r.getCellPosition();e.push(i)}}),e},t.prototype.mapRowNodes=function(e){if(e){var r={top:{},bottom:{},normal:{}};return e.forEach(function(i){var n=i.id;"top"===i.rowPinned?r.top[n]=i:"bottom"===i.rowPinned?r.bottom[n]=i:r.normal[n]=i}),r}},t.prototype.isRowInMap=function(e,r){var i=e.id,n=e.rowPinned;return"bottom"===n?null!=r.bottom[i]:"top"===n?null!=r.top[i]:null!=r.normal[i]},t.prototype.getCellCtrls=function(e,r){var c,i=this,n=this.mapRowNodes(e),u=[];me(r)&&(c={},r.forEach(function(m){var C=i.columnModel.getGridColumn(m);me(C)&&(c[C.getId()]=!0)}));return this.getAllRowCtrls().forEach(function(m){return function(m){var C=m.getRowNode();null!=n&&!i.isRowInMap(C,n)||m.getAllCellCtrls().forEach(function(_){var O=_.getColumn().getId();c&&!c[O]||u.push(_)})}(m)}),u},t.prototype.destroy=function(){this.removeAllRowComps(),o.prototype.destroy.call(this)},t.prototype.removeAllRowComps=function(){var e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)},t.prototype.recycleRows=function(){var e=[];Xe(this.rowCtrlsByRowIndex,function(i,n){null==n.getRowNode().id&&e.push(i)}),this.removeRowCtrls(e);var r={};return Xe(this.rowCtrlsByRowIndex,function(i,n){var u=n.getRowNode();r[u.id]=n}),this.rowCtrlsByRowIndex={},r},t.prototype.removeRowCtrls=function(e){var r=this;e.forEach(function(i){var n=r.rowCtrlsByRowIndex[i];n&&(n.destroyFirstPass(),n.destroySecondPass()),delete r.rowCtrlsByRowIndex[i]})},t.prototype.onBodyScroll=function(e){"vertical"===e.direction&&this.redrawAfterScroll()},t.prototype.redrawAfterScroll=function(){var e;if(this.stickyRowFeature&&$s()&&(e=this.getCellToRestoreFocusToAfterRefresh()||void 0),this.getLockOnRefresh(),this.redraw(null,!1,!0),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(!0),null!=e){var r=this.getCellToRestoreFocusToAfterRefresh();null!=e&&null==r&&(this.animationFrameService.flushAllFrames(),this.restoreFocusedCell(e))}},t.prototype.removeRowCompsNotToDraw=function(e){var r={};e.forEach(function(u){return r[u]=!0});var n=Object.keys(this.rowCtrlsByRowIndex).filter(function(u){return!r[u]});this.removeRowCtrls(n)},t.prototype.calculateIndexesToDraw=function(e){var r=this,i=ip(this.firstRenderedRow,this.lastRenderedRow),n=function(u,c){var v=c.getRowNode().rowIndex;null!=v&&(v<r.firstRenderedRow||v>r.lastRenderedRow)&&r.doNotUnVirtualiseRow(c)&&i.push(v)};return Xe(this.rowCtrlsByRowIndex,n),Xe(e,n),i.sort(function(u,c){return u-c}),i=i.filter(function(u){var c=r.paginationProxy.getRow(u);return c&&!c.sticky})},t.prototype.redraw=function(e,r,i){var n=this;void 0===r&&(r=!1),void 0===i&&(i=!1),this.rowContainerHeightService.updateOffset(),this.workOutFirstAndLastRowsToRender(),this.stickyRowFeature&&this.stickyRowFeature.checkStickyRows();var u=this.calculateIndexesToDraw(e);(this.removeRowCompsNotToDraw(u),this.printLayout&&(r=!1),u.forEach(function(v){me(n.createOrUpdateRowCtrl(v,e,r,i))}),e)&&(i&&!this.gridOptionsService.is("suppressAnimationFrame")&&!this.printLayout?this.beans.animationFrameService.addDestroyTask(function(){n.destroyRowCtrls(e,r),n.updateAllRowCtrls(),n.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(e,r));this.updateAllRowCtrls()},t.prototype.dispatchDisplayedRowsChanged=function(e){void 0===e&&(e=!1);var r={type:I.EVENT_DISPLAYED_ROWS_CHANGED,afterScroll:e};this.eventService.dispatchEvent(r)},t.prototype.onDisplayedColumnsChanged=function(){var e=this.columnModel.isPinningLeft(),r=this.columnModel.isPinningRight();(this.pinningLeft!==e||r!==this.pinningRight)&&(this.pinningLeft=e,this.pinningRight=r,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())},t.prototype.redrawFullWidthEmbeddedRows=function(){var e=[];this.getFullWidthRowCtrls().forEach(function(r){var i=r.getRowNode().rowIndex;e.push(i.toString())}),this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redrawAfterScroll()},t.prototype.getFullWidthRowCtrls=function(e){var r=this,i=this.mapRowNodes(e);return this.getAllRowCtrls().filter(function(n){if(!n.isFullWidth())return!1;var u=n.getRowNode();return!(null!=i&&!r.isRowInMap(u,i))})},t.prototype.refreshFullWidthRow=function(e){var r=this.getFullWidthRowCtrls().find(function(n){return n.getRowNode()===e});r&&(r.refreshFullWidth()||(e.sticky?this.stickyRowFeature.refreshStickyNode(e):this.removeRowCtrls([e.rowIndex]),this.redrawAfterScroll()))},t.prototype.createOrUpdateRowCtrl=function(e,r,i,n){var u,c=this.rowCtrlsByRowIndex[e];if(c||me(u=this.paginationProxy.getRow(e))&&me(r)&&r[u.id]&&u.alreadyRendered&&(c=r[u.id],r[u.id]=null),!c){if(u||(u=this.paginationProxy.getRow(e)),!me(u))return;c=this.createRowCon(u,i,n)}return u&&(u.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=c,c},t.prototype.destroyRowCtrls=function(e,r){var i=this,n=[];Xe(e,function(u,c){if(c){if(i.cachedRowCtrls&&c.isCacheable())return void i.cachedRowCtrls.addRow(c);c.destroyFirstPass(),r?(i.zombieRowCtrls[c.getInstanceId()]=c,n.push(function(){c.destroySecondPass(),delete i.zombieRowCtrls[c.getInstanceId()]})):c.destroySecondPass()}}),r&&(n.push(function(){i.updateAllRowCtrls(),i.dispatchDisplayedRowsChanged()}),tl(n))},t.prototype.getRowBuffer=function(){var e=this.gridOptionsService.getNum("rowBuffer");return"number"==typeof e?e<0&&(_t(function(){return console.warn("AG Grid: rowBuffer should not be negative")},"warn rowBuffer negative"),e=0,this.gridOptionsService.set("rowBuffer",0)):e=10,e},t.prototype.getRowBufferInPixels=function(){return this.getRowBuffer()*this.gridOptionsService.getRowHeightAsNumber()},t.prototype.workOutFirstAndLastRowsToRender=function(){var e,r;if(this.paginationProxy.isRowsToRender())if(this.printLayout)e=this.paginationProxy.getPageFirstRow(),r=this.paginationProxy.getPageLastRow();else{var i=this.getRowBufferInPixels(),n=this.ctrlsService.getGridBodyCtrl(),u=this.gridOptionsService.is("suppressRowVirtualisation"),c=!1,v=void 0,m=void 0;do{var C=this.paginationProxy.getPixelOffset(),_=this.paginationProxy.getCurrentPagePixelRange(),O=_.pageFirstPixel,P=_.pageLastPixel,L=this.rowContainerHeightService.getDivStretchOffset(),z=n.getScrollFeature().getVScrollPosition(),q=z.top,Z=z.bottom;u?(v=O+L,m=P+L):(v=Math.max(q+C-i,O)+L,m=Math.min(Z+C+i,P)+L),this.firstVisibleVPixel=Math.max(q+C,O)+L,c=this.ensureAllRowsInRangeHaveHeightsCalculated(v,m)}while(c);var re=this.paginationProxy.getRowIndexAtPixel(v),pe=this.paginationProxy.getRowIndexAtPixel(m),Ce=this.paginationProxy.getPageFirstRow(),be=this.paginationProxy.getPageLastRow();re<Ce&&(re=Ce),pe>be&&(pe=be),e=re,r=pe}else e=0,r=-1;var qe=this.gridOptionsService.isDomLayout("normal"),et=this.gridOptionsService.is("suppressMaxRenderedRowRestriction"),ze=Math.max(this.getRowBuffer(),500);qe&&!et&&r-e>ze&&(r=e+ze);var st=e!==this.firstRenderedRow,nt=r!==this.lastRenderedRow;if(st||nt){this.firstRenderedRow=e,this.lastRenderedRow=r;var Gt={type:I.EVENT_VIEWPORT_CHANGED,firstRow:e,lastRow:r};this.eventService.dispatchEvent(Gt)}},t.prototype.dispatchFirstDataRenderedEvent=function(){var e=this;if(!this.dataFirstRenderedFired){this.dataFirstRenderedFired=!0;var r={type:I.EVENT_FIRST_DATA_RENDERED,firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow};window.requestAnimationFrame(function(){e.beans.eventService.dispatchEvent(r)})}},t.prototype.ensureAllRowsInRangeHaveHeightsCalculated=function(e,r){var i=this.paginationProxy.ensureRowHeightsValid(e,r,-1,-1);return i&&this.updateContainerHeights(),i},t.prototype.getFirstVisibleVerticalPixel=function(){return this.firstVisibleVPixel},t.prototype.getFirstVirtualRenderedRow=function(){return this.firstRenderedRow},t.prototype.getLastVirtualRenderedRow=function(){return this.lastRenderedRow},t.prototype.doNotUnVirtualiseRow=function(e){var n=e.getRowNode(),u=this.focusService.isRowNodeFocused(n),c=e.isEditing(),v=n.detail;return!!(u||c||v)&&!!this.paginationProxy.isRowPresent(n)},t.prototype.createRowCon=function(e,r,i){var n=this.cachedRowCtrls?this.cachedRowCtrls.getRow(e):null;if(n)return n;var u=this.gridOptionsService.is("suppressAnimationFrame"),c=i&&!u&&!this.printLayout;return new Go(e,this.beans,r,c,this.printLayout)},t.prototype.getRenderedNodes=function(){var e=this.rowCtrlsByRowIndex;return Object.keys(e).map(function(r){return e[r].getRowNode()})},t.prototype.getRowByPosition=function(e){var r,i=e.rowIndex;switch(e.rowPinned){case"top":r=this.topRowCtrls[i];break;case"bottom":r=this.bottomRowCtrls[i];break;default:(r=this.rowCtrlsByRowIndex[i])||(r=this.getStickyTopRowCtrls().find(function(n){return n.getRowNode().rowIndex===i})||null)}return r},t.prototype.getRowNode=function(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[e.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[e.rowIndex];default:return this.rowModel.getRow(e.rowIndex)}},t.prototype.isRangeInRenderedViewport=function(e,r){if(null==e||null==r)return!1;var n=e>this.lastRenderedRow;return!(r<this.firstRenderedRow)&&!n},Xi([D("animationFrameService")],t.prototype,"animationFrameService",void 0),Xi([D("paginationProxy")],t.prototype,"paginationProxy",void 0),Xi([D("columnModel")],t.prototype,"columnModel",void 0),Xi([D("pinnedRowModel")],t.prototype,"pinnedRowModel",void 0),Xi([D("rowModel")],t.prototype,"rowModel",void 0),Xi([D("focusService")],t.prototype,"focusService",void 0),Xi([D("beans")],t.prototype,"beans",void 0),Xi([D("rowContainerHeightService")],t.prototype,"rowContainerHeightService",void 0),Xi([D("ctrlsService")],t.prototype,"ctrlsService",void 0),Xi([Re],t.prototype,"postConstruct",null),t=Xi([He("rowRenderer")],t)}(we),hm=function(){function o(t){this.entriesMap={},this.entriesList=[],this.maxCount=t}return o.prototype.addRow=function(t){if(this.entriesMap[t.getRowNode().id]=t,this.entriesList.push(t),t.setCached(!0),this.entriesList.length>this.maxCount){var e=this.entriesList[0];e.destroyFirstPass(),e.destroySecondPass(),this.removeFromCache(e)}},o.prototype.getRow=function(t){if(null==t||null==t.id)return null;var e=this.entriesMap[t.id];return e?(this.removeFromCache(e),e.setCached(!1),e.getRowNode()!=t?null:e):null},o.prototype.removeFromCache=function(t){var e=t.getRowNode().id;delete this.entriesMap[e],Nr(this.entriesList,t)},o.prototype.getEntries=function(){return this.entriesList},o}(),vm=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),$c=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Rd=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return vm(t,o),t.prototype.formatValue=function(e,r,i,n,u){void 0===u&&(u=!0);var v,c=null,m=e.getColDef();if(n?v=n:u&&(v=m.valueFormatter),v){var C={value:i,node:r,data:r?r.data:null,colDef:m,column:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};c="function"==typeof v?v(C):this.expressionService.evaluate(v,C)}else if(m.refData)return m.refData[i]||"";return null==c&&Array.isArray(i)&&(c=i.join(", ")),c},$c([D("expressionService")],t.prototype,"expressionService",void 0),t=$c([He("valueFormatterService")],t)}(we),$r=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Yc=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},gm=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return $r(t,o),t.prototype.init=function(){this.setPinnedTopRowData(this.gridOptionsService.get("pinnedTopRowData")),this.setPinnedBottomRowData(this.gridOptionsService.get("pinnedBottomRowData"))},t.prototype.isEmpty=function(e){return Ve("top"===e?this.pinnedTopRows:this.pinnedBottomRows)},t.prototype.isRowsToRender=function(e){return!this.isEmpty(e)},t.prototype.getRowAtPixel=function(e,r){var i="top"===r?this.pinnedTopRows:this.pinnedBottomRows;if(Ve(i))return 0;for(var n=0;n<i.length;n++){var u=i[n];if(u.rowTop+u.rowHeight-1>=e)return n}return i.length-1},t.prototype.setPinnedTopRowData=function(e){this.pinnedTopRows=this.createNodesFromData(e,!0);var r={type:I.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(r)},t.prototype.setPinnedBottomRowData=function(e){this.pinnedBottomRows=this.createNodesFromData(e,!1);var r={type:I.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(r)},t.prototype.createNodesFromData=function(e,r){var i=this,n=[];if(e){var u=0;e.forEach(function(c,v){var m=new wt(i.beans);m.data=c;var C=r?wt.ID_PREFIX_TOP_PINNED:wt.ID_PREFIX_BOTTOM_PINNED;m.id=C+v,m.rowPinned=r?"top":"bottom",m.setRowTop(u),m.setRowHeight(i.gridOptionsService.getRowHeightForNode(m).height),m.setRowIndex(v),u+=m.rowHeight,n.push(m)})}return n},t.prototype.getPinnedTopRowData=function(){return this.pinnedTopRows},t.prototype.getPinnedBottomRowData=function(){return this.pinnedBottomRows},t.prototype.getPinnedTopTotalHeight=function(){return this.getTotalHeight(this.pinnedTopRows)},t.prototype.getPinnedTopRowCount=function(){return this.pinnedTopRows?this.pinnedTopRows.length:0},t.prototype.getPinnedBottomRowCount=function(){return this.pinnedBottomRows?this.pinnedBottomRows.length:0},t.prototype.getPinnedTopRow=function(e){return this.pinnedTopRows[e]},t.prototype.getPinnedBottomRow=function(e){return this.pinnedBottomRows[e]},t.prototype.forEachPinnedTopRow=function(e){Ve(this.pinnedTopRows)||this.pinnedTopRows.forEach(e)},t.prototype.forEachPinnedBottomRow=function(e){Ve(this.pinnedBottomRows)||this.pinnedBottomRows.forEach(e)},t.prototype.getPinnedBottomTotalHeight=function(){return this.getTotalHeight(this.pinnedBottomRows)},t.prototype.getTotalHeight=function(e){if(!e||0===e.length)return 0;var r=Mt(e);return r.rowTop+r.rowHeight},Yc([D("beans")],t.prototype,"beans",void 0),Yc([Re],t.prototype,"init",null),t=Yc([He("pinnedRowModel")],t)}(we);!function(o){o.Applied="Applied",o.StoreNotFound="StoreNotFound",o.StoreLoading="StoreLoading",o.StoreWaitingToLoad="StoreWaitingToLoad",o.StoreLoadingFailed="StoreLoadingFailed",o.StoreWrongType="StoreWrongType",o.Cancelled="Cancelled"}(Td||(Td={}));var As,Xc=function(){function o(t,e){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=t,this.pathRoot={rowNode:e,children:null},this.mapToItems[e.id]=this.pathRoot}return o.prototype.setInactive=function(){this.active=!1},o.prototype.isActive=function(){return this.active},o.prototype.depthFirstSearchChangedPath=function(t,e){if(t.children)for(var r=0;r<t.children.length;r++)this.depthFirstSearchChangedPath(t.children[r],e);e(t.rowNode)},o.prototype.depthFirstSearchEverything=function(t,e,r){if(t.childrenAfterGroup)for(var i=0;i<t.childrenAfterGroup.length;i++){var n=t.childrenAfterGroup[i];n.childrenAfterGroup?this.depthFirstSearchEverything(t.childrenAfterGroup[i],e,r):r&&e(n)}e(t)},o.prototype.forEachChangedNodeDepthFirst=function(t,e,r){void 0===e&&(e=!1),void 0===r&&(r=!1),this.active&&!r?this.depthFirstSearchChangedPath(this.pathRoot,t):this.depthFirstSearchEverything(this.pathRoot.rowNode,t,e)},o.prototype.executeFromRootNode=function(t){t(this.pathRoot.rowNode)},o.prototype.createPathItems=function(t){for(var e=t,r=0;!this.mapToItems[e.id];){var i={rowNode:e,children:null};this.mapToItems[e.id]=i,r++,e=e.parent}return r},o.prototype.populateColumnsMap=function(t,e){var r=this;if(this.keepingColumns&&e)for(var i=t;i;)this.nodeIdsToColumns[i.id]||(this.nodeIdsToColumns[i.id]={}),e.forEach(function(n){return r.nodeIdsToColumns[i.id][n.getId()]=!0}),i=i.parent},o.prototype.linkPathItems=function(t,e){for(var r=t,i=0;i<e;i++){var n=this.mapToItems[r.id],u=this.mapToItems[r.parent.id];u.children||(u.children=[]),u.children.push(n),r=r.parent}},o.prototype.addParentNode=function(t,e){if(t&&!t.isRowPinned()){var r=this.createPathItems(t);this.linkPathItems(t,r),this.populateColumnsMap(t,e)}},o.prototype.canSkip=function(t){return this.active&&!this.mapToItems[t.id]},o.prototype.getValueColumnsForNode=function(t,e){if(!this.keepingColumns)return e;var r=this.nodeIdsToColumns[t.id];return e.filter(function(n){return r[n.getId()]})},o.prototype.getNotValueColumnsForNode=function(t,e){if(!this.keepingColumns)return null;var r=this.nodeIdsToColumns[t.id];return e.filter(function(n){return!r[n.getId()]})},o}(),mm=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),qc=function(o){function t(e){var r=o.call(this)||this;return r.state=t.STATE_WAITING_TO_LOAD,r.version=0,r.id=e,r}return mm(t,o),t.prototype.getId=function(){return this.id},t.prototype.load=function(){this.state=t.STATE_LOADING,this.loadFromDatasource()},t.prototype.getVersion=function(){return this.version},t.prototype.setStateWaitingToLoad=function(){this.version++,this.state=t.STATE_WAITING_TO_LOAD},t.prototype.getState=function(){return this.state},t.prototype.pageLoadFailed=function(e){this.isRequestMostRecentAndLive(e)&&(this.state=t.STATE_FAILED,this.processServerFail()),this.dispatchLoadCompleted(!1)},t.prototype.success=function(e,r){this.successCommon(e,r)},t.prototype.pageLoaded=function(e,r,i){this.successCommon(e,{rowData:r,rowCount:i})},t.prototype.isRequestMostRecentAndLive=function(e){var r=e===this.version,i=this.isAlive();return r&&i},t.prototype.successCommon=function(e,r){this.dispatchLoadCompleted(),this.isRequestMostRecentAndLive(e)&&(this.state=t.STATE_LOADED,this.processServerResult(r))},t.prototype.dispatchLoadCompleted=function(e){void 0===e&&(e=!0);var r={type:t.EVENT_LOAD_COMPLETE,success:e,block:this};this.dispatchEvent(r)},t.EVENT_LOAD_COMPLETE="loadComplete",t.STATE_WAITING_TO_LOAD="needsLoading",t.STATE_LOADING="loading",t.STATE_LOADED="loaded",t.STATE_FAILED="failed",t}(we),Qc=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),iu=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},nu=function(o,t){return function(e,r){t(e,r,o)}},ym=function(o){function t(){var r=null!==o&&o.apply(this,arguments)||this;return r.activeBlockLoadsCount=0,r.blocks=[],r.active=!0,r}var e;return Qc(t,o),e=t,t.prototype.postConstruct=function(){this.maxConcurrentRequests=this.getMaxConcurrentDatasourceRequests();var r=this.gridOptionsService.getNum("blockLoadDebounceMillis");r&&r>0&&(this.checkBlockToLoadDebounce=rt.debounce(this.performCheckBlocksToLoad.bind(this),r))},t.prototype.setBeans=function(r){this.logger=r.create("RowNodeBlockLoader")},t.prototype.getMaxConcurrentDatasourceRequests=function(){var r=this.gridOptionsService.getNum("maxConcurrentDatasourceRequests");return null==r?2:r<=0?void 0:r},t.prototype.addBlock=function(r){this.blocks.push(r),r.addEventListener(qc.EVENT_LOAD_COMPLETE,this.loadComplete.bind(this)),this.checkBlockToLoad()},t.prototype.removeBlock=function(r){rt.removeFromArray(this.blocks,r)},t.prototype.destroy=function(){o.prototype.destroy.call(this),this.active=!1},t.prototype.loadComplete=function(){this.activeBlockLoadsCount--,this.checkBlockToLoad(),this.dispatchEvent({type:e.BLOCK_LOADED_EVENT}),0==this.activeBlockLoadsCount&&this.dispatchEvent({type:e.BLOCK_LOADER_FINISHED_EVENT})},t.prototype.checkBlockToLoad=function(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()},t.prototype.performCheckBlocksToLoad=function(){if(this.active){if(this.printCacheStatus(),null!=this.maxConcurrentRequests&&this.activeBlockLoadsCount>=this.maxConcurrentRequests)return void this.logger.log("checkBlockToLoad: max loads exceeded");var r=this.getAvailableLoadingCount(),i=this.blocks.filter(function(n){return n.getState()===qc.STATE_WAITING_TO_LOAD}).slice(0,r);this.registerLoads(i.length),i.forEach(function(n){return n.load()}),this.printCacheStatus()}},t.prototype.getBlockState=function(){if(this.gridOptionsService.isRowModelType("serverSide"))return this.rowModel.getBlockStates();var i={};return this.blocks.forEach(function(n){var u=n.getBlockStateJson(),c=u.id,v=u.state;i[c]=v}),i},t.prototype.printCacheStatus=function(){this.logger.isLogging()&&this.logger.log("printCacheStatus: activePageLoadsCount = "+this.activeBlockLoadsCount+", blocks = "+JSON.stringify(this.getBlockState()))},t.prototype.isLoading=function(){return this.activeBlockLoadsCount>0},t.prototype.registerLoads=function(r){this.activeBlockLoadsCount+=r},t.prototype.getAvailableLoadingCount=function(){return void 0!==this.maxConcurrentRequests?this.maxConcurrentRequests-this.activeBlockLoadsCount:void 0},t.BLOCK_LOADED_EVENT="blockLoaded",t.BLOCK_LOADER_FINISHED_EVENT="blockLoaderFinished",iu([D("rowModel")],t.prototype,"rowModel",void 0),iu([Re],t.prototype,"postConstruct",null),iu([nu(0,Zr("loggerFactory"))],t.prototype,"setBeans",null),t=e=iu([He("rowNodeBlockLoader")],t)}(we),ou=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Jc=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Cm=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.currentPage=0,e.topDisplayedRowIndex=0,e.bottomDisplayedRowIndex=0,e.pixelOffset=0,e.masterRowCount=0,e}return ou(t,o),t.prototype.postConstruct=function(){this.active=this.gridOptionsService.is("pagination"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedListener(this.eventService,I.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addManagedPropertyListener("pagination",this.onPaginationPageSizeChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPaginationPageSizeChanged.bind(this)),this.onModelUpdated()},t.prototype.ensureRowHeightsValid=function(e,r,i,n){var u=this.rowModel.ensureRowHeightsValid(e,r,this.getPageFirstRow(),this.getPageLastRow());return u&&this.calculatePages(),u},t.prototype.isPaginateChildRows=function(){return!!(this.gridOptionsService.is("groupRemoveSingleChildren")||this.gridOptionsService.is("groupRemoveLowestSingleChildren"))||this.gridOptionsService.is("paginateChildRows")},t.prototype.onModelUpdated=function(e){this.calculatePages();var r={type:I.EVENT_PAGINATION_CHANGED,animate:!!e&&e.animate,newData:!!e&&e.newData,newPage:!!e&&e.newPage,keepRenderedRows:!!e&&e.keepRenderedRows};this.eventService.dispatchEvent(r)},t.prototype.onPaginationPageSizeChanged=function(){this.active=this.gridOptionsService.is("pagination"),this.calculatePages();var e={type:I.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!1,keepRenderedRows:!0};this.eventService.dispatchEvent(e)},t.prototype.goToPage=function(e){if(this.active&&this.currentPage!==e&&"number"==typeof this.currentPage){this.currentPage=e;var r={type:I.EVENT_MODEL_UPDATED,animate:!1,keepRenderedRows:!1,newData:!1,newPage:!0};this.onModelUpdated(r)}},t.prototype.getPixelOffset=function(){return this.pixelOffset},t.prototype.getRow=function(e){return this.rowModel.getRow(e)},t.prototype.getRowNode=function(e){return this.rowModel.getRowNode(e)},t.prototype.getRowIndexAtPixel=function(e){return this.rowModel.getRowIndexAtPixel(e)},t.prototype.getCurrentPageHeight=function(){return Je(this.topRowBounds)||Je(this.bottomRowBounds)?0:Math.max(this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight-this.topRowBounds.rowTop,0)},t.prototype.getCurrentPagePixelRange=function(){return{pageFirstPixel:this.topRowBounds?this.topRowBounds.rowTop:0,pageLastPixel:this.bottomRowBounds?this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight:0}},t.prototype.isRowPresent=function(e){return!!this.rowModel.isRowPresent(e)&&(e.rowIndex>=this.topDisplayedRowIndex&&e.rowIndex<=this.bottomDisplayedRowIndex)},t.prototype.isEmpty=function(){return this.rowModel.isEmpty()},t.prototype.isRowsToRender=function(){return this.rowModel.isRowsToRender()},t.prototype.forEachNode=function(e){return this.rowModel.forEachNode(e)},t.prototype.forEachNodeOnPage=function(e){for(var r=this.getPageFirstRow(),i=this.getPageLastRow(),n=r;n<=i;n++){var u=this.getRow(n);u&&e(u)}},t.prototype.getType=function(){return this.rowModel.getType()},t.prototype.getRowBounds=function(e){var r=this.rowModel.getRowBounds(e);return r.rowIndex=e,r},t.prototype.getPageFirstRow=function(){return this.topRowBounds?this.topRowBounds.rowIndex:-1},t.prototype.getPageLastRow=function(){return this.bottomRowBounds?this.bottomRowBounds.rowIndex:-1},t.prototype.getRowCount=function(){return this.rowModel.getRowCount()},t.prototype.getPageForIndex=function(e){return Math.floor(e/this.pageSize)},t.prototype.goToPageWithIndex=function(e){if(this.active){var r=this.getPageForIndex(e);this.goToPage(r)}},t.prototype.isRowInPage=function(e){return!this.active||this.getPageForIndex(e.rowIndex)===this.currentPage},t.prototype.isLastPageFound=function(){return this.rowModel.isLastRowIndexKnown()},t.prototype.getCurrentPage=function(){return this.currentPage},t.prototype.goToNextPage=function(){this.goToPage(this.currentPage+1)},t.prototype.goToPreviousPage=function(){this.goToPage(this.currentPage-1)},t.prototype.goToFirstPage=function(){this.goToPage(0)},t.prototype.goToLastPage=function(){var e=this.rowModel.getRowCount(),r=Math.floor(e/this.pageSize);this.goToPage(r)},t.prototype.getPageSize=function(){return this.pageSize},t.prototype.getTotalPages=function(){return this.totalPages},t.prototype.setPageSize=function(){this.pageSize=this.gridOptionsService.getNum("paginationPageSize"),(null==this.pageSize||this.pageSize<1)&&(this.pageSize=100)},t.prototype.calculatePages=function(){this.active?(this.setPageSize(),this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly()):this.calculatedPagesNotActive(),this.topRowBounds=this.rowModel.getRowBounds(this.topDisplayedRowIndex),this.topRowBounds&&(this.topRowBounds.rowIndex=this.topDisplayedRowIndex),this.bottomRowBounds=this.rowModel.getRowBounds(this.bottomDisplayedRowIndex),this.bottomRowBounds&&(this.bottomRowBounds.rowIndex=this.bottomDisplayedRowIndex),this.setPixelOffset(me(this.topRowBounds)?this.topRowBounds.rowTop:0)},t.prototype.setPixelOffset=function(e){this.pixelOffset!==e&&(this.pixelOffset=e,this.eventService.dispatchEvent({type:I.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED}))},t.prototype.setZeroRows=function(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0},t.prototype.adjustCurrentPageIfInvalid=function(){this.currentPage>=this.totalPages&&(this.currentPage=this.totalPages-1),(!isFinite(this.currentPage)||isNaN(this.currentPage)||this.currentPage<0)&&(this.currentPage=0)},t.prototype.calculatePagesMasterRowsOnly=function(){if(this.masterRowCount=this.rowModel.getTopLevelRowCount(),this.masterRowCount<=0)this.setZeroRows();else{var e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid();var r=this.pageSize*this.currentPage,i=this.pageSize*(this.currentPage+1)-1;if(i>e&&(i=e),this.topDisplayedRowIndex=this.rowModel.getTopLevelRowDisplayedIndex(r),i===e)this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1;else{var n=this.rowModel.getTopLevelRowDisplayedIndex(i+1);this.bottomDisplayedRowIndex=n-1}}},t.prototype.getMasterRowCount=function(){return this.masterRowCount},t.prototype.calculatePagesAllRows=function(){if(this.masterRowCount=this.rowModel.getRowCount(),0!==this.masterRowCount){var e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=this.pageSize*this.currentPage,this.bottomDisplayedRowIndex=this.pageSize*(this.currentPage+1)-1,this.bottomDisplayedRowIndex>e&&(this.bottomDisplayedRowIndex=e)}else this.setZeroRows()},t.prototype.calculatedPagesNotActive=function(){this.pageSize=this.rowModel.getRowCount(),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1},Jc([D("rowModel")],t.prototype,"rowModel",void 0),Jc([Re],t.prototype,"postConstruct",null),t=Jc([He("paginationProxy")],t)}(we),wm=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Zc=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Sm=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return wm(t,o),t.prototype.processAllCellClasses=function(e,r,i,n){this.processClassRules(e.cellClassRules,r,i,n),this.processStaticCellClasses(e,r,i)},t.prototype.processClassRules=function(e,r,i,n){if(null!=e){for(var u=Object.keys(e),c={},v={},m=function(O){var z,P=u[O],L=e[P];"string"==typeof L?z=C.expressionService.evaluate(L,r):"function"==typeof L&&(z=L(r)),P.split(" ").forEach(function(q){null==q||""==q.trim()||(z?c[q]=!0:v[q]=!0)})},C=this,_=0;_<u.length;_++)m(_);n&&Object.keys(v).forEach(n),Object.keys(c).forEach(i)}},t.prototype.getStaticCellClasses=function(e,r){var n,i=e.cellClass;if(!i)return[];"function"==typeof i?n=i(r):n=i;return"string"==typeof n&&(n=[n]),n||[]},t.prototype.processStaticCellClasses=function(e,r,i){this.getStaticCellClasses(e,r).forEach(function(u){i(u)})},Zc([D("expressionService")],t.prototype,"expressionService",void 0),t=Zc([He("stylingService")],t)}(we),Od=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),_m=function(o){function t(e){return o.call(this,e,"ag-toggle-button")||this}return Od(t,o),t.prototype.setValue=function(e,r){return o.prototype.setValue.call(this,e,r),this.addOrRemoveCssClass("ag-selected",this.getValue()),this},t}(vs),ef=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),xm=function(o){function t(e){return o.call(this,e,"ag-text-area",null,"textarea")||this}return ef(t,o),t.prototype.setValue=function(e,r){var i=o.prototype.setValue.call(this,e,r);return this.eInput.value=e,i},t.prototype.setCols=function(e){return this.eInput.cols=e,this},t.prototype.setRows=function(e){return this.eInput.rows=e,this},t}(pn),su=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ts=function(o){function t(e){return o.call(this,e,"ag-range-field","range")||this}return su(t,o),t.prototype.postConstruct=function(){o.prototype.postConstruct.call(this);var e=this.config,r=e.min,i=e.max,n=e.step;null!=r&&this.setMinValue(r),null!=i&&this.setMaxValue(i),this.setStep(n||1)},t.prototype.addInputListeners=function(){var e=this;this.addManagedListener(this.eInput,"input",function(r){var i=r.target.value;e.setValue(i)})},t.prototype.setMinValue=function(e){return this.min=e,this.eInput.setAttribute("min",e.toString()),this},t.prototype.setMaxValue=function(e){return this.max=e,this.eInput.setAttribute("max",e.toString()),this},t.prototype.setStep=function(e){return this.eInput.setAttribute("step",e.toString()),this},t.prototype.setValue=function(e,r){null!=this.min&&(e=Math.max(parseFloat(e),this.min).toString()),null!=this.max&&(e=Math.min(parseFloat(e),this.max).toString());var i=o.prototype.setValue.call(this,e,r);return this.eInput.value=e,i},t}(pn),Ra=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Os=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},au=function(o){function t(e){var r=o.call(this,e,t.TEMPLATE)||this;return r.labelAlignment="top",r}return Ra(t,o),t.prototype.init=function(){this.eSlider.addCssClass("ag-slider-field")},t.prototype.onValueChange=function(e){var r=this,i=Do.EVENT_CHANGED;return this.addManagedListener(this.eText,i,function(){var n=parseFloat(r.eText.getValue());r.eSlider.setValue(n.toString(),!0),e(n||0)}),this.addManagedListener(this.eSlider,i,function(){var n=r.eSlider.getValue();r.eText.setValue(n,!0),e(parseFloat(n))}),this},t.prototype.setSliderWidth=function(e){return this.eSlider.setWidth(e),this},t.prototype.setTextFieldWidth=function(e){return this.eText.setWidth(e),this},t.prototype.setMinValue=function(e){return this.eSlider.setMinValue(e),this.eText.setMin(e),this},t.prototype.setMaxValue=function(e){return this.eSlider.setMaxValue(e),this.eText.setMax(e),this},t.prototype.getValue=function(){return this.eText.getValue()},t.prototype.setValue=function(e){return this.getValue()===e||(this.eText.setValue(e,!0),this.eSlider.setValue(e,!0),this.dispatchEvent({type:Do.EVENT_CHANGED})),this},t.prototype.setStep=function(e){return this.eSlider.setStep(e),this.eText.setStep(e),this},t.TEMPLATE='<div class="ag-slider">\n            <label ref="eLabel"></label>\n            <div class="ag-wrapper ag-slider-wrapper">\n                <ag-input-range ref="eSlider"></ag-input-range>\n                <ag-input-number-field ref="eText"></ag-input-number-field>\n            </div>\n        </div>',Os([Te("eLabel")],t.prototype,"eLabel",void 0),Os([Te("eSlider")],t.prototype,"eSlider",void 0),Os([Te("eText")],t.prototype,"eText",void 0),Os([Re],t.prototype,"init",null),t}(yp),Bo=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),oi=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Em=function(o){function t(e){void 0===e&&(e={});var r=o.call(this,t.getTemplate(e))||this;r.suppressEnabledCheckbox=!0,r.suppressOpenCloseIcons=!1;var i=e.title,n=e.enabled,u=e.items,c=e.suppressEnabledCheckbox,v=e.suppressOpenCloseIcons;return r.title=i,r.cssIdentifier=e.cssIdentifier||"default",r.enabled=n??!0,r.items=u||[],r.alignItems=e.alignItems||"center",null!=c&&(r.suppressEnabledCheckbox=c),null!=v&&(r.suppressOpenCloseIcons=v),r}return Bo(t,o),t.getTemplate=function(e){var r=e.cssIdentifier||"default";return'<div class="ag-group ag-'+r+'-group" role="presentation">\n            <div class="ag-group-title-bar ag-'+r+'-group-title-bar ag-unselectable" ref="eTitleBar" role="button">\n                <span class="ag-group-title-bar-icon ag-'+r+'-group-title-bar-icon" ref="eGroupOpenedIcon" role="presentation"></span>\n                <span class="ag-group-title-bar-icon ag-'+r+'-group-title-bar-icon" ref="eGroupClosedIcon" role="presentation"></span>\n                <span ref="eTitle" class="ag-group-title ag-'+r+'-group-title"></span>\n            </div>\n            <div ref="eToolbar" class="ag-group-toolbar ag-'+r+'-group-toolbar">\n                <ag-checkbox ref="cbGroupEnabled"></ag-checkbox>\n            </div>\n            <div ref="eContainer" class="ag-group-container ag-group-container-'+(e.direction||"vertical")+" ag-"+r+'-group-container"></div>\n        </div>'},t.prototype.postConstruct=function(){if(this.items.length){var e=this.items;this.items=[],this.addItems(e)}var r=this.localeService.getLocaleTextFunc();this.cbGroupEnabled.setLabel(r("enabled","Enabled")),this.title&&this.setTitle(this.title),this.enabled&&this.setEnabled(this.enabled),this.setAlignItems(this.alignItems),this.hideEnabledCheckbox(this.suppressEnabledCheckbox),this.hideOpenCloseIcons(this.suppressOpenCloseIcons),this.setupExpandContract(),this.refreshAriaStatus(),this.refreshChildDisplay()},t.prototype.setupExpandContract=function(){var e=this;this.eGroupClosedIcon.appendChild(ii("columnSelectClosed",this.gridOptionsService,null)),this.eGroupOpenedIcon.appendChild(ii("columnSelectOpen",this.gridOptionsService,null)),this.addManagedListener(this.eTitleBar,"click",function(){return e.toggleGroupExpand()}),this.addManagedListener(this.eTitleBar,"keydown",function(r){switch(r.key){case ve.ENTER:case ve.SPACE:r.preventDefault(),e.toggleGroupExpand();break;case ve.RIGHT:case ve.LEFT:r.preventDefault(),e.toggleGroupExpand(r.key===ve.RIGHT)}})},t.prototype.refreshAriaStatus=function(){this.suppressOpenCloseIcons||zi(this.eTitleBar,this.expanded)},t.prototype.refreshChildDisplay=function(){var e=!this.suppressOpenCloseIcons;Ze(this.eToolbar,this.expanded&&!this.suppressEnabledCheckbox),Ze(this.eGroupOpenedIcon,e&&this.expanded),Ze(this.eGroupClosedIcon,e&&!this.expanded)},t.prototype.isExpanded=function(){return this.expanded},t.prototype.setAlignItems=function(e){this.alignItems!==e&&this.removeCssClass("ag-group-item-alignment-"+this.alignItems),this.alignItems=e;var r="ag-group-item-alignment-"+this.alignItems;return this.addCssClass(r),this},t.prototype.toggleGroupExpand=function(e){return this.suppressOpenCloseIcons?(this.expanded=!0,this.refreshChildDisplay(),Ze(this.eContainer,!0),this):(e=e??!this.expanded,this.expanded===e||(this.expanded=e,this.refreshAriaStatus(),this.refreshChildDisplay(),Ze(this.eContainer,e),this.dispatchEvent({type:this.expanded?t.EVENT_EXPANDED:t.EVENT_COLLAPSED})),this)},t.prototype.addItems=function(e){var r=this;e.forEach(function(i){return r.addItem(i)})},t.prototype.addItem=function(e){var r=this.eContainer,i=e instanceof Ue?e.getGui():e;i.classList.add("ag-group-item","ag-"+this.cssIdentifier+"-group-item"),r.appendChild(i),this.items.push(i)},t.prototype.hideItem=function(e,r){Ze(this.items[r],!e)},t.prototype.setTitle=function(e){return this.eTitle.innerText=e,this},t.prototype.addCssClassToTitleBar=function(e){this.eTitleBar.classList.add(e)},t.prototype.setEnabled=function(e,r){return this.enabled=e,this.refreshDisabledStyles(),this.toggleGroupExpand(e),r||this.cbGroupEnabled.setValue(e),this},t.prototype.isEnabled=function(){return this.enabled},t.prototype.onEnableChange=function(e){var r=this;return this.cbGroupEnabled.onValueChange(function(i){r.setEnabled(i,!0),e(i)}),this},t.prototype.hideEnabledCheckbox=function(e){return this.suppressEnabledCheckbox=e,this.refreshChildDisplay(),this.refreshDisabledStyles(),this},t.prototype.hideOpenCloseIcons=function(e){return this.suppressOpenCloseIcons=e,e&&this.toggleGroupExpand(!0),this},t.prototype.refreshDisabledStyles=function(){this.addOrRemoveCssClass("ag-disabled",!this.enabled),this.suppressEnabledCheckbox&&!this.enabled?(this.eTitleBar.classList.add("ag-disabled-group-title-bar"),this.eTitleBar.removeAttribute("tabindex")):(this.eTitleBar.classList.remove("ag-disabled-group-title-bar"),this.eTitleBar.setAttribute("tabindex","0")),this.eContainer.classList.toggle("ag-disabled-group-container",!this.enabled)},t.EVENT_EXPANDED="expanded",t.EVENT_COLLAPSED="collapsed",oi([Te("eTitleBar")],t.prototype,"eTitleBar",void 0),oi([Te("eGroupOpenedIcon")],t.prototype,"eGroupOpenedIcon",void 0),oi([Te("eGroupClosedIcon")],t.prototype,"eGroupClosedIcon",void 0),oi([Te("eToolbar")],t.prototype,"eToolbar",void 0),oi([Te("cbGroupEnabled")],t.prototype,"cbGroupEnabled",void 0),oi([Te("eTitle")],t.prototype,"eTitle",void 0),oi([Te("eContainer")],t.prototype,"eContainer",void 0),oi([Re],t.prototype,"postConstruct",null),t}(Ue),Rm=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ad=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n};!function(o){o.TAB_GUARD="ag-tab-guard",o.TAB_GUARD_TOP="ag-tab-guard-top",o.TAB_GUARD_BOTTOM="ag-tab-guard-bottom"}(As||(As={}));var fo,Tm=function(o){function t(e){var r=o.call(this)||this;r.skipTabGuardFocus=!1;var i=e.comp,n=e.eTopGuard,u=e.eBottomGuard,c=e.focusInnerElement,v=e.onFocusIn,m=e.onFocusOut,C=e.shouldStopEventPropagation,_=e.onTabKeyDown,O=e.handleKeyDown,P=e.eFocusableElement;return r.comp=i,r.eTopGuard=n,r.eBottomGuard=u,r.providedFocusInnerElement=c,r.eFocusableElement=P,r.providedFocusIn=v,r.providedFocusOut=m,r.providedShouldStopEventPropagation=C,r.providedOnTabKeyDown=_,r.providedHandleKeyDown=O,r}return Rm(t,o),t.prototype.postConstruct=function(){var e=this;this.createManagedBean(new ro(this.eFocusableElement,{shouldStopEventPropagation:function(){return e.shouldStopEventPropagation()},onTabKeyDown:function(r){return e.onTabKeyDown(r)},handleKeyDown:function(r){return e.handleKeyDown(r)},onFocusIn:function(r){return e.onFocusIn(r)},onFocusOut:function(r){return e.onFocusOut(r)}})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach(function(r){return e.addManagedListener(r,"focus",e.onFocus.bind(e))})},t.prototype.handleKeyDown=function(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)},t.prototype.tabGuardsAreActive=function(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")},t.prototype.shouldStopEventPropagation=function(){return!!this.providedShouldStopEventPropagation&&this.providedShouldStopEventPropagation()},t.prototype.activateTabGuards=function(){this.comp.setTabIndex(this.getGridTabIndex())},t.prototype.deactivateTabGuards=function(){this.comp.setTabIndex()},t.prototype.onFocus=function(e){if(this.skipTabGuardFocus)this.skipTabGuardFocus=!1;else{var r=e.target===this.eBottomGuard;this.providedFocusInnerElement?this.providedFocusInnerElement(r):this.focusInnerElement(r)}},t.prototype.onFocusIn=function(e){this.providedFocusIn&&this.providedFocusIn(e)||this.deactivateTabGuards()},t.prototype.onFocusOut=function(e){this.providedFocusOut&&this.providedFocusOut(e)||this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards()},t.prototype.onTabKeyDown=function(e){var r=this;if(this.providedOnTabKeyDown)this.providedOnTabKeyDown(e);else if(!e.defaultPrevented){var i=this.tabGuardsAreActive();i&&this.deactivateTabGuards();var n=this.getNextFocusableElement(e.shiftKey);i&&setTimeout(function(){return r.activateTabGuards()},0),n&&(n.focus(),e.preventDefault())}},t.prototype.getGridTabIndex=function(){return(this.gridOptionsService.getNum("tabIndex")||0).toString()},t.prototype.focusInnerElement=function(e){void 0===e&&(e=!1);var r=this.focusService.findFocusableElements(this.eFocusableElement);this.tabGuardsAreActive()&&(r.splice(0,1),r.splice(r.length-1,1)),r.length&&r[e?r.length-1:0].focus({preventScroll:!0})},t.prototype.getNextFocusableElement=function(e){return this.focusService.findNextFocusableElement(this.eFocusableElement,!1,e)},t.prototype.forceFocusOutOfContainer=function(e){void 0===e&&(e=!1);var r=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,r.focus()},Ad([D("focusService")],t.prototype,"focusService",void 0),Ad([Re],t.prototype,"postConstruct",null),t}(we),Om=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Am=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},lu=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return Om(t,o),t.prototype.initialiseTabGuard=function(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.getFocusableElement();var r=[this.eTopGuard,this.eBottomGuard],i={setTabIndex:function(n){r.forEach(function(u){return null!=n?u.setAttribute("tabIndex",n):u.removeAttribute("tabIndex")})}};this.addTabGuards(this.eTopGuard,this.eBottomGuard),this.tabGuardCtrl=this.createManagedBean(new Tm({comp:i,eTopGuard:this.eTopGuard,eBottomGuard:this.eBottomGuard,eFocusableElement:this.eFocusableElement,onFocusIn:e.onFocusIn,onFocusOut:e.onFocusOut,focusInnerElement:e.focusInnerElement,handleKeyDown:e.handleKeyDown,onTabKeyDown:e.onTabKeyDown,shouldStopEventPropagation:e.shouldStopEventPropagation}))},t.prototype.createTabGuard=function(e){var r=document.createElement("div"),i="top"===e?As.TAB_GUARD_TOP:As.TAB_GUARD_BOTTOM;return r.classList.add(As.TAB_GUARD,i),vt(r,"presentation"),r},t.prototype.addTabGuards=function(e,r){this.eFocusableElement.insertAdjacentElement("afterbegin",e),this.eFocusableElement.insertAdjacentElement("beforeend",r)},t.prototype.removeAllChildrenExceptTabGuards=function(){var e=[this.eTopGuard,this.eBottomGuard];Wt(this.getFocusableElement()),this.addTabGuards.apply(this,function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(Am(arguments[t]));return o}(e))},t.prototype.forceFocusOutOfContainer=function(e){void 0===e&&(e=!1),this.tabGuardCtrl.forceFocusOutOfContainer(e)},t.prototype.appendChild=function(e,r){us(e)||(e=e.getGui());var i=this.eBottomGuard;i?i.insertAdjacentElement("beforebegin",e):o.prototype.appendChild.call(this,e,r)},t}(Ue),bm=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ta=function(){return Ta=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},Ta.apply(this,arguments)},Dd=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Fm=function(o){function t(e){void 0===e&&(e=1);var r=o.call(this,'<div class="ag-menu-list" role="tree"></div>')||this;return r.level=e,r.menuItems=[],r}return bm(t,o),t.prototype.postConstruct=function(){var e=this;this.initialiseTabGuard({onTabKeyDown:function(r){return e.onTabKeyDown(r)},handleKeyDown:function(r){return e.handleKeyDown(r)}})},t.prototype.onTabKeyDown=function(e){var r=this.getParentComponent(),i=r&&r.getGui();i&&i.classList.contains("ag-focus-managed")||e.preventDefault(),e.shiftKey&&this.closeIfIsChild(e)},t.prototype.handleKeyDown=function(e){switch(e.key){case ve.UP:case ve.RIGHT:case ve.DOWN:case ve.LEFT:e.preventDefault(),this.handleNavKey(e.key);break;case ve.ESCAPE:var r=this.findTopMenu();r&&this.focusService.focusInto(r.getGui())}},t.prototype.clearActiveItem=function(){this.activeMenuItem&&(this.activeMenuItem.deactivate(),this.activeMenuItem=null)},t.prototype.addMenuItems=function(e){var r=this;e?.forEach(function(i){"separator"===i?r.addSeparator():"string"==typeof i?console.warn("AG Grid: unrecognised menu item "+i):r.addItem(i)})},t.prototype.addItem=function(e){var r=this,i=this.createManagedBean(new Oa(Ta(Ta({},e),{isAnotherSubMenuOpen:function(){return r.menuItems.some(function(n){return n.isSubMenuOpen()})}})));i.setParentComponent(this),es(i.getGui(),this.level),this.menuItems.push(i),this.appendChild(i.getGui()),this.addManagedListener(i,Oa.EVENT_MENU_ITEM_SELECTED,function(n){r.dispatchEvent(n)}),this.addManagedListener(i,Oa.EVENT_MENU_ITEM_ACTIVATED,function(n){r.activeMenuItem&&r.activeMenuItem!==n.menuItem&&r.activeMenuItem.deactivate(),r.activeMenuItem=n.menuItem})},t.prototype.activateFirstItem=function(){var e=this.menuItems.filter(function(r){return!r.isDisabled()})[0];e&&e.activate()},t.prototype.addSeparator=function(){this.appendChild(Sr('\n            <div class="ag-menu-separator" aria-hidden="true">\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n            </div>'))},t.prototype.findTopMenu=function(){var e=this.getParentComponent();if(!e&&this instanceof t)return this;for(;;){var r=e&&e.getParentComponent&&e.getParentComponent();if(!r||!(r instanceof t||r instanceof Oa))break;e=r}return e instanceof t?e:void 0},t.prototype.handleNavKey=function(e){switch(e){case ve.UP:case ve.DOWN:var r=this.findNextItem(e===ve.UP);return void(r&&r!==this.activeMenuItem&&r.activate())}e===(this.gridOptionsService.is("enableRtl")?ve.RIGHT:ve.LEFT)?this.closeIfIsChild():this.openChild()},t.prototype.closeIfIsChild=function(e){var r=this.getParentComponent();r&&r instanceof Oa&&(e&&e.preventDefault(),r.closeSubMenu(),r.getGui().focus())},t.prototype.openChild=function(){this.activeMenuItem&&this.activeMenuItem.openSubMenu(!0)},t.prototype.findNextItem=function(e){var r=this.menuItems.filter(function(v){return!v.isDisabled()});if(r.length){if(!this.activeMenuItem)return e?Mt(r):r[0];e&&r.reverse();for(var i,n=!1,u=0;u<r.length;u++){var c=r[u];if(n){i=c;break}c===this.activeMenuItem&&(n=!0)}return i||this.activeMenuItem}},t.prototype.destroy=function(){this.clearActiveItem(),o.prototype.destroy.call(this)},Dd([D("focusService")],t.prototype,"focusService",void 0),Dd([Re],t.prototype,"postConstruct",null),t}(lu),Pm=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),tf=function(o){function t(e){var r=o.call(this)||this;return r.wrappedComponent=e,r.setTemplateFromElement(e.getGui()),r}return Pm(t,o),t.prototype.postConstruct=function(){var e=this;this.initialiseTabGuard({onTabKeyDown:function(r){return e.onTabKeyDown(r)},handleKeyDown:function(r){return e.handleKeyDown(r)}})},t.prototype.handleKeyDown=function(e){e.key===ve.ESCAPE&&this.closePanel()},t.prototype.onTabKeyDown=function(e){e.defaultPrevented||(this.closePanel(),e.preventDefault())},t.prototype.closePanel=function(){var e=this.parentComponent;e.closeSubMenu(),setTimeout(function(){return e.getGui().focus()},0)},function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);i>3&&n&&Object.defineProperty(t,e,n)}([Re],t.prototype,"postConstruct",null),t}(lu),Lm=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),bd=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Oa=function(o){function t(e){var r=o.call(this)||this;return r.params=e,r.isActive=!1,r.subMenuIsOpen=!1,r.setTemplate('<div class="'+r.getClassName()+'" tabindex="-1" role="treeitem"></div>'),r}return Lm(t,o),t.prototype.init=function(){var e=this;this.addIcon(),this.addName(),this.addShortcut(),this.addSubMenu(),this.addTooltip();var r=this.getGui();this.params.disabled?(this.addCssClass(this.getClassName("disabled")),Ae(r,!0)):(this.addGuiEventListener("click",function(i){return e.onItemSelected(i)}),this.addGuiEventListener("keydown",function(i){(i.key===ve.ENTER||i.key===ve.SPACE)&&(i.preventDefault(),e.onItemSelected(i))}),this.addGuiEventListener("mousedown",function(i){i.stopPropagation(),i.preventDefault()}),this.addGuiEventListener("mouseenter",function(){return e.onMouseEnter()}),this.addGuiEventListener("mouseleave",function(){return e.onMouseLeave()})),this.params.cssClasses&&this.params.cssClasses.forEach(function(i){return e.addCssClass(i)})},t.prototype.isDisabled=function(){return!!this.params.disabled},t.prototype.openSubMenu=function(e){var r=this;if(void 0===e&&(e=!1),this.closeSubMenu(),this.params.subMenu){var n,i=Sr('<div class="ag-menu" role="presentation"></div>');if(this.params.subMenu instanceof Array){var u=Jf(this.getGui()),c=isNaN(u)?1:u+1,v=this.createBean(new Fm(c));v.setParentComponent(this),v.addMenuItems(this.params.subMenu),i.appendChild(v.getGui()),this.addManagedListener(v,t.EVENT_MENU_ITEM_SELECTED,function(re){return r.dispatchEvent(re)}),v.addGuiEventListener("mouseenter",function(){return r.cancelDeactivate()}),n=function(){return r.destroyBean(v)},e&&setTimeout(function(){return v.activateFirstItem()},0)}else{var m=this.params.subMenu,C=this.createBean(new tf(m));C.setParentComponent(this);var _=C.getGui(),O="mouseenter",P=function(){return r.cancelDeactivate()};_.addEventListener(O,P),n=function(){return _.removeEventListener(O,P)},i.appendChild(_),m.afterGuiAttached&&setTimeout(function(){return m.afterGuiAttached()},0)}var L=this.getGui(),z=this.popupService.positionPopupForMenu.bind(this.popupService,{eventSource:L,ePopup:i}),q=this.localeService.getLocaleTextFunc(),Z=this.popupService.addPopup({modal:!0,eChild:i,positionCallback:z,anchorToElement:L,ariaLabel:q("ariaLabelSubMenu","SubMenu")});this.subMenuIsOpen=!0,zi(L,!0),this.hideSubMenu=function(){Z&&Z.hideFunc(),r.subMenuIsOpen=!1,zi(L,!1),n()}}},t.prototype.closeSubMenu=function(){this.hideSubMenu&&(this.hideSubMenu(),this.hideSubMenu=null,zi(this.getGui(),!1))},t.prototype.isSubMenuOpen=function(){return this.subMenuIsOpen},t.prototype.activate=function(e){var r=this;this.cancelActivate(),!this.params.disabled&&(this.isActive=!0,this.addCssClass(this.getClassName("active")),this.getGui().focus(),e&&this.params.subMenu&&window.setTimeout(function(){r.isAlive()&&r.isActive&&r.openSubMenu()},300),this.onItemActivated())},t.prototype.deactivate=function(){this.cancelDeactivate(),this.removeCssClass(this.getClassName("active")),this.isActive=!1,this.subMenuIsOpen&&this.hideSubMenu()},t.prototype.addIcon=function(){if(this.params.checked||this.params.icon||!this.params.isCompact){var e=Sr('<span ref="eIcon" class="'+this.getClassName("part")+" "+this.getClassName("icon")+'" role="presentation"></span>');this.params.checked?e.appendChild(pr("check",this.gridOptionsService)):this.params.icon&&(us(this.params.icon)?e.appendChild(this.params.icon):"string"==typeof this.params.icon?e.innerHTML=this.params.icon:console.warn("AG Grid: menu item icon must be DOM node or string")),this.getGui().appendChild(e)}},t.prototype.addName=function(){if(this.params.name||!this.params.isCompact){var e=Sr('<span ref="eName" class="'+this.getClassName("part")+" "+this.getClassName("text")+'">'+(this.params.name||"")+"</span>");this.getGui().appendChild(e)}},t.prototype.addTooltip=function(){this.params.tooltip&&(this.tooltip=this.params.tooltip,this.gridOptionsService.is("enableBrowserTooltips")?this.getGui().setAttribute("title",this.tooltip):this.createManagedBean(new Tl(this)))},t.prototype.getTooltipParams=function(){return{location:"menu",value:this.tooltip}},t.prototype.addShortcut=function(){if(this.params.shortcut||!this.params.isCompact){var e=Sr('<span ref="eShortcut" class="'+this.getClassName("part")+" "+this.getClassName("shortcut")+'">'+(this.params.shortcut||"")+"</span>");this.getGui().appendChild(e)}},t.prototype.addSubMenu=function(){if(this.params.subMenu||!this.params.isCompact){var e=Sr('<span ref="ePopupPointer" class="'+this.getClassName("part")+" "+this.getClassName("popup-pointer")+'"></span>'),r=this.getGui();if(this.params.subMenu){var i=this.gridOptionsService.is("enableRtl")?"smallLeft":"smallRight";zi(r,!1),e.appendChild(pr(i,this.gridOptionsService))}r.appendChild(e)}},t.prototype.onItemSelected=function(e){if(this.params.action?this.params.action():this.openSubMenu(e&&"keydown"===e.type),!this.params.subMenu||this.params.action){var r={type:t.EVENT_MENU_ITEM_SELECTED,action:this.params.action,checked:this.params.checked,cssClasses:this.params.cssClasses,disabled:this.params.disabled,icon:this.params.icon,name:this.params.name,shortcut:this.params.shortcut,subMenu:this.params.subMenu,tooltip:this.params.tooltip,event:e};this.dispatchEvent(r)}},t.prototype.onItemActivated=function(){var e={type:t.EVENT_MENU_ITEM_ACTIVATED,menuItem:this};this.dispatchEvent(e)},t.prototype.cancelActivate=function(){this.activateTimeoutId&&(window.clearTimeout(this.activateTimeoutId),this.activateTimeoutId=0)},t.prototype.cancelDeactivate=function(){this.deactivateTimeoutId&&(window.clearTimeout(this.deactivateTimeoutId),this.deactivateTimeoutId=0)},t.prototype.onMouseEnter=function(){var e=this;this.cancelDeactivate(),this.params.isAnotherSubMenuOpen()?this.activateTimeoutId=window.setTimeout(function(){return e.activate(!0)},t.ACTIVATION_DELAY):this.activate(!0)},t.prototype.onMouseLeave=function(){var e=this;this.cancelActivate(),this.isSubMenuOpen()?this.deactivateTimeoutId=window.setTimeout(function(){return e.deactivate()},t.ACTIVATION_DELAY):this.deactivate()},t.prototype.getClassName=function(e){var r=this.params.isCompact?"ag-compact-menu-option":"ag-menu-option";return e?r+"-"+e:r},t.EVENT_MENU_ITEM_SELECTED="menuItemSelected",t.EVENT_MENU_ITEM_ACTIVATED="menuItemActivated",t.ACTIVATION_DELAY=80,bd([D("popupService")],t.prototype,"popupService",void 0),bd([Re],t.prototype,"init",null),t}(Ue),Mm=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Aa=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Fd=function(o){function t(e){var r=o.call(this,t.getTemplate(e))||this;return r.closable=!0,r.config=e,r}return Mm(t,o),t.getTemplate=function(e){var r=e&&e.cssIdentifier||"default";return'<div class="ag-panel ag-'+r+'-panel" tabindex="-1">\n            <div ref="eTitleBar" class="ag-panel-title-bar ag-'+r+'-panel-title-bar ag-unselectable">\n                <span ref="eTitle" class="ag-panel-title-bar-title ag-'+r+'-panel-title-bar-title"></span>\n                <div ref="eTitleBarButtons" class="ag-panel-title-bar-buttons ag-'+r+'-panel-title-bar-buttons"></div>\n            </div>\n            <div ref="eContentWrapper" class="ag-panel-content-wrapper ag-'+r+'-panel-content-wrapper"></div>\n        </div>'},t.prototype.postConstruct=function(){var e=this,r=this.config,i=r.component,n=r.closable,u=r.hideTitleBar,c=r.title,v=r.minWidth,m=void 0===v?250:v,C=r.width,_=r.minHeight,O=void 0===_?250:_,P=r.height,L=r.centered,z=r.popup,q=r.x,Z=r.y;this.positionableFeature=new bl(this.getGui(),{minWidth:m,width:C,minHeight:O,height:P,centered:L,x:q,y:Z,popup:z,calculateTopBuffer:function(){return e.positionableFeature.getHeight()-e.getBodyHeight()}}),this.createManagedBean(this.positionableFeature);var re=this.getGui();i&&this.setBodyComponent(i),u?Ze(this.eTitleBar,!1):(c&&this.setTitle(c),this.setClosable(n??this.closable)),this.addManagedListener(this.eTitleBar,"mousedown",function(pe){var Ce=e.gridOptionsService.getDocument();if(re.contains(pe.relatedTarget)||re.contains(Ce.activeElement)||e.eTitleBarButtons.contains(pe.target))pe.preventDefault();else{var be=e.eContentWrapper.querySelector("button, [href], input, select, textarea, [tabindex]");be&&be.focus()}}),(!z||!this.positionableFeature.isPositioned())&&(this.renderComponent&&this.renderComponent(),this.positionableFeature.initialisePosition(),this.eContentWrapper.style.height="0")},t.prototype.renderComponent=function(){var e=this,r=this.getGui();r.focus(),this.close=function(){r.parentElement.removeChild(r),e.destroy()}},t.prototype.getHeight=function(){return this.positionableFeature.getHeight()},t.prototype.setHeight=function(e){this.positionableFeature.setHeight(e)},t.prototype.getWidth=function(){return this.positionableFeature.getWidth()},t.prototype.setWidth=function(e){this.positionableFeature.setWidth(e)},t.prototype.setClosable=function(e){if(e!==this.closable&&(this.closable=e),e){var r=this.closeButtonComp=new Ue(t.CLOSE_BTN_TEMPLATE);this.getContext().createBean(r);var i=r.getGui(),n=pr("close",this.gridOptionsService);n.classList.add("ag-panel-title-bar-button-icon"),i.appendChild(n),this.addTitleBarButton(r),r.addManagedListener(i,"click",this.onBtClose.bind(this))}else if(this.closeButtonComp){(i=this.closeButtonComp.getGui()).parentElement.removeChild(i),this.closeButtonComp=this.destroyBean(this.closeButtonComp)}},t.prototype.setBodyComponent=function(e){e.setParentComponent(this),this.eContentWrapper.appendChild(e.getGui())},t.prototype.addTitleBarButton=function(e,r){var i=this.eTitleBarButtons,n=i.children,u=n.length;null==r&&(r=u),r=Math.max(0,Math.min(r,u)),e.addCssClass("ag-panel-title-bar-button");var c=e.getGui();0===r?i.insertAdjacentElement("afterbegin",c):r===u?i.insertAdjacentElement("beforeend",c):n[r-1].insertAdjacentElement("afterend",c),e.setParentComponent(this)},t.prototype.getBodyHeight=function(){return as(this.eContentWrapper)},t.prototype.getBodyWidth=function(){return Ei(this.eContentWrapper)},t.prototype.setTitle=function(e){this.eTitle.innerText=e},t.prototype.onBtClose=function(){this.close()},t.prototype.destroy=function(){this.closeButtonComp&&(this.closeButtonComp=this.destroyBean(this.closeButtonComp));var e=this.getGui();e&&e.offsetParent&&this.close(),o.prototype.destroy.call(this)},t.CLOSE_BTN_TEMPLATE='<div class="ag-button"></div>',Aa([Te("eContentWrapper")],t.prototype,"eContentWrapper",void 0),Aa([Te("eTitleBar")],t.prototype,"eTitleBar",void 0),Aa([Te("eTitleBarButtons")],t.prototype,"eTitleBarButtons",void 0),Aa([Te("eTitle")],t.prototype,"eTitle",void 0),Aa([Re],t.prototype,"postConstruct",null),t}(Ue),Nm=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),uu=function(){return uu=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},uu.apply(this,arguments)},Gm=function(o){function t(e){var r=o.call(this,uu(uu({},e),{popup:!0}))||this;return r.isMaximizable=!1,r.isMaximized=!1,r.maximizeListeners=[],r.resizeListenerDestroy=null,r.lastPosition={x:0,y:0,width:0,height:0},r}return Nm(t,o),t.prototype.postConstruct=function(){var e=this,r=this.getGui(),i=this.config,n=i.movable,u=i.resizable,c=i.maximizable;this.addCssClass("ag-dialog"),o.prototype.postConstruct.call(this),this.addManagedListener(r,"focusin",function(v){r.contains(v.relatedTarget)||e.popupService.bringPopupToFront(r)}),n&&this.setMovable(n),c&&this.setMaximizable(c),u&&this.setResizable(u)},t.prototype.renderComponent=function(){var e=this.getGui(),r=this.config,i=r.alwaysOnTop,n=r.modal,u=r.title,c=this.localeService.getLocaleTextFunc(),v=this.popupService.addPopup({modal:n,eChild:e,closeOnEsc:!0,closedCallback:this.destroy.bind(this),alwaysOnTop:i,ariaLabel:u||c("ariaLabelDialog","Dialog")});v&&(this.close=v.hideFunc)},t.prototype.toggleMaximize=function(){var e=this.positionableFeature.getPosition();if(this.isMaximized){var r=this.lastPosition,i=r.x,n=r.y,u=r.width,c=r.height;this.setWidth(u),this.setHeight(c),this.positionableFeature.offsetElement(i,n)}else this.lastPosition.width=this.getWidth(),this.lastPosition.height=this.getHeight(),this.lastPosition.x=e.x,this.lastPosition.y=e.y,this.positionableFeature.offsetElement(0,0),this.setHeight("100%"),this.setWidth("100%");this.isMaximized=!this.isMaximized,this.refreshMaximizeIcon()},t.prototype.refreshMaximizeIcon=function(){Ze(this.maximizeIcon,!this.isMaximized),Ze(this.minimizeIcon,this.isMaximized)},t.prototype.clearMaximizebleListeners=function(){this.maximizeListeners.length&&(this.maximizeListeners.forEach(function(e){return e()}),this.maximizeListeners.length=0),this.resizeListenerDestroy&&(this.resizeListenerDestroy(),this.resizeListenerDestroy=null)},t.prototype.destroy=function(){this.maximizeButtonComp=this.destroyBean(this.maximizeButtonComp),this.clearMaximizebleListeners(),o.prototype.destroy.call(this)},t.prototype.setResizable=function(e){this.positionableFeature.setResizable(e)},t.prototype.setMovable=function(e){this.positionableFeature.setMovable(e,this.eTitleBar)},t.prototype.setMaximizable=function(e){var r=this;if(!e)return this.clearMaximizebleListeners(),void(this.maximizeButtonComp&&(this.destroyBean(this.maximizeButtonComp),this.maximizeButtonComp=this.maximizeIcon=this.minimizeIcon=void 0));var i=this.eTitleBar;if(i&&e!==this.isMaximizable){var n=this.buildMaximizeAndMinimizeElements();this.refreshMaximizeIcon(),n.addManagedListener(n.getGui(),"click",this.toggleMaximize.bind(this)),this.addTitleBarButton(n,0),this.maximizeListeners.push(this.addManagedListener(i,"dblclick",this.toggleMaximize.bind(this))),this.resizeListenerDestroy=this.addManagedListener(this,"resize",function(){r.isMaximized=!1,r.refreshMaximizeIcon()})}},t.prototype.buildMaximizeAndMinimizeElements=function(){var e=this.maximizeButtonComp=this.createBean(new Ue('<div class="ag-dialog-button"></span>')),r=e.getGui();return this.maximizeIcon=pr("maximize",this.gridOptionsService),r.appendChild(this.maximizeIcon),this.maximizeIcon.classList.add("ag-panel-title-bar-button-icon"),this.minimizeIcon=pr("minimize",this.gridOptionsService),r.appendChild(this.minimizeIcon),this.minimizeIcon.classList.add("ag-panel-title-bar-button-icon"),e},function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);i>3&&n&&Object.defineProperty(t,e,n)}([D("popupService")],t.prototype,"popupService",void 0),t}(Fd),Hm=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Da=function(){return Da=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},Da.apply(this,arguments)},yn=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Bm=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},ba=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}var e;return Hm(t,o),e=t,t.addKeyboardModeEvents=function(r,i){var n=e.instancesMonitored.get(r);n&&n.length>0?-1===n.indexOf(i)&&n.push(i):(e.instancesMonitored.set(r,[i]),r.addEventListener("keydown",e.toggleKeyboardMode),r.addEventListener("mousedown",e.toggleKeyboardMode))},t.removeKeyboardModeEvents=function(r,i){var n=e.instancesMonitored.get(r),u=[];n&&n.length&&(u=function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(Bm(arguments[t]));return o}(n).filter(function(c){return c!==i}),e.instancesMonitored.set(r,u)),0===u.length&&(r.removeEventListener("keydown",e.toggleKeyboardMode),r.removeEventListener("mousedown",e.toggleKeyboardMode))},t.toggleKeyboardMode=function(r){var i=e.keyboardModeActive,n="keydown"===r.type;if(!(n&&(r.ctrlKey||r.metaKey||r.altKey)||i&&n||!i&&!n)){e.keyboardModeActive=n;var u=r.target.ownerDocument;if(u){var c=e.instancesMonitored.get(u);c&&c.forEach(function(v){v.dispatchEvent({type:n?I.EVENT_KEYBOARD_FOCUS:I.EVENT_MOUSE_FOCUS})})}}},t.prototype.init=function(){var r=this,i=this.clearFocusedCell.bind(this);this.addManagedListener(this.eventService,I.EVENT_COLUMN_PIVOT_MODE_CHANGED,i),this.addManagedListener(this.eventService,I.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverythingChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_COLUMN_GROUP_OPENED,i),this.addManagedListener(this.eventService,I.EVENT_COLUMN_ROW_GROUP_CHANGED,i),this.ctrlsService.whenReady(function(n){r.gridCtrl=n.gridCtrl;var u=r.gridOptionsService.getDocument();e.addKeyboardModeEvents(u,r.gridCtrl),r.addDestroyFunc(function(){return r.unregisterGridCompController(r.gridCtrl)})})},t.prototype.unregisterGridCompController=function(r){var i=this.gridOptionsService.getDocument();e.removeKeyboardModeEvents(i,r)},t.prototype.onColumnEverythingChanged=function(){if(this.focusedCellPosition){var r=this.focusedCellPosition.column,i=this.columnModel.getGridColumn(r.getId());r!==i&&this.clearFocusedCell()}},t.prototype.isKeyboardMode=function(){return e.keyboardModeActive},t.prototype.getFocusCellToUseAfterRefresh=function(){var r=this.gridOptionsService.getDocument();return this.gridOptionsService.is("suppressFocusAfterRefresh")||!this.focusedCellPosition||this.isDomDataMissingInHierarchy(r.activeElement,Go.DOM_DATA_KEY_ROW_CTRL)?null:this.focusedCellPosition},t.prototype.getFocusHeaderToUseAfterRefresh=function(){var r=this.gridOptionsService.getDocument();return this.gridOptionsService.is("suppressFocusAfterRefresh")||!this.focusedHeaderPosition||this.isDomDataMissingInHierarchy(r.activeElement,Es.DOM_DATA_KEY_HEADER_CTRL)?null:this.focusedHeaderPosition},t.prototype.isDomDataMissingInHierarchy=function(r,i){for(var n=r;n;){if(this.gridOptionsService.getDomData(n,i))return!1;n=n.parentNode}return!0},t.prototype.getFocusedCell=function(){return this.focusedCellPosition},t.prototype.getFocusEventParams=function(){var r=this.focusedCellPosition,i=r.rowIndex,n=r.rowPinned,c={rowIndex:i,rowPinned:n,column:r.column,isFullWidthCell:!1},v=this.rowRenderer.getRowByPosition({rowIndex:i,rowPinned:n});return v&&(c.isFullWidthCell=v.isFullWidth()),c},t.prototype.clearFocusedCell=function(){if(null!=this.focusedCellPosition){var r=Da({type:I.EVENT_CELL_FOCUS_CLEARED},this.getFocusEventParams());this.focusedCellPosition=null,this.eventService.dispatchEvent(r)}},t.prototype.setFocusedCell=function(r){var i=r.column,n=r.rowIndex,u=r.rowPinned,c=r.forceBrowserFocus,v=void 0!==c&&c,m=r.preventScrollOnBrowserFocus,C=void 0!==m&&m,_=this.columnModel.getGridColumn(i);if(_){this.focusedCellPosition=_?{rowIndex:n,rowPinned:Xt(u),column:_}:null;var O=Da(Da({type:I.EVENT_CELL_FOCUSED},this.getFocusEventParams()),{forceBrowserFocus:v,preventScrollOnBrowserFocus:C,floating:null});this.eventService.dispatchEvent(O)}else this.focusedCellPosition=null},t.prototype.isCellFocused=function(r){return null!=this.focusedCellPosition&&(this.focusedCellPosition.column===r.column&&this.isRowFocused(r.rowIndex,r.rowPinned))},t.prototype.isRowNodeFocused=function(r){return this.isRowFocused(r.rowIndex,r.rowPinned)},t.prototype.isHeaderWrapperFocused=function(r){if(null==this.focusedHeaderPosition)return!1;var i=r.getColumnGroupChild(),n=r.getRowIndex(),u=r.getPinned(),c=this.focusedHeaderPosition,v=c.column,m=c.headerRowIndex;return i===v&&n===m&&u==v.getPinned()},t.prototype.clearFocusedHeader=function(){this.focusedHeaderPosition=null},t.prototype.getFocusedHeader=function(){return this.focusedHeaderPosition},t.prototype.setFocusedHeader=function(r,i){this.focusedHeaderPosition={headerRowIndex:r,column:i}},t.prototype.focusHeaderPosition=function(r){var i=r.direction,n=r.fromTab,u=r.allowUserOverride,c=r.event,v=r.headerPosition;if(u){var _,m=this.getFocusedHeader(),C=this.headerNavigationService.getHeaderRowCount();if(n){if(_=this.gridOptionsService.getCallback("tabToNextHeader"))v=_({backwards:"Before"===i,previousHeaderPosition:m,nextHeaderPosition:v,headerRowCount:C})}else if((_=this.gridOptionsService.getCallback("navigateToNextHeader"))&&c)v=_({key:c.key,previousHeaderPosition:m,nextHeaderPosition:v,headerRowCount:C,event:c})}return!!v&&(-1===v.headerRowIndex?this.focusGridView(v.column):(this.headerNavigationService.scrollToColumn(v.column,i),this.ctrlsService.getHeaderRowContainerCtrl(v.column.getPinned()).focusHeader(v.headerRowIndex,v.column,c)))},t.prototype.focusFirstHeader=function(){var r=this.columnModel.getAllDisplayedColumns()[0];return!!r&&(r.getParent()&&(r=this.columnModel.getColumnGroupAtLevel(r,0)),this.focusHeaderPosition({headerPosition:{headerRowIndex:0,column:r}}))},t.prototype.focusLastHeader=function(r){var i=this.headerNavigationService.getHeaderRowCount()-1,n=Mt(this.columnModel.getAllDisplayedColumns());return this.focusHeaderPosition({headerPosition:{headerRowIndex:i,column:n},event:r})},t.prototype.isAnyCellFocused=function(){return!!this.focusedCellPosition},t.prototype.isRowFocused=function(r,i){return null!=this.focusedCellPosition&&(this.focusedCellPosition.rowIndex===r&&this.focusedCellPosition.rowPinned===Xt(i))},t.prototype.findFocusableElements=function(r,i,n){void 0===n&&(n=!1);var u=op,c=Yu;i&&(c+=", "+i),n&&(c+=', [tabindex="-1"]');var v=Array.prototype.slice.apply(r.querySelectorAll(u)),m=Array.prototype.slice.apply(r.querySelectorAll(c));if(!m.length)return v;var O;return O=m,v.filter(function(P){return-1===O.indexOf(P)})},t.prototype.focusInto=function(r,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1);var u=this.findFocusableElements(r,null,n),c=i?Mt(u):u[0];return!!c&&(c.focus({preventScroll:!0}),!0)},t.prototype.findFocusableElementBeforeTabGuard=function(r,i){if(!i)return null;var n=this.findFocusableElements(r),u=n.indexOf(i);if(-1===u)return null;for(var c=-1,v=u-1;v>=0;v--)if(n[v].classList.contains(As.TAB_GUARD_TOP)){c=v;break}return c<=0?null:n[c-1]},t.prototype.findNextFocusableElement=function(r,i,n){void 0===r&&(r=this.eGridDiv);var u=this.findFocusableElements(r,i?':not([tabindex="-1"])':null),v=this.gridOptionsService.getDocument().activeElement,C=(i?u.findIndex(function(_){return _.contains(v)}):u.indexOf(v))+(n?-1:1);return C<0||C>=u.length?null:u[C]},t.prototype.isTargetUnderManagedComponent=function(r,i){if(!i)return!1;var n=r.querySelectorAll("."+ro.FOCUS_MANAGED_CLASS);if(!n.length)return!1;for(var u=0;u<n.length;u++)if(n[u].contains(i))return!0;return!1},t.prototype.findTabbableParent=function(r,i){void 0===i&&(i=5);for(var n=0;r&&null===Pn(r)&&++n<=i;)r=r.parentElement;return null===Pn(r)?null:r},t.prototype.focusGridView=function(r,i){if(this.gridOptionsService.is("suppressCellFocus"))return i?this.focusLastHeader():this.focusNextGridCoreContainer(!1);var n=i?this.rowPositionUtils.getLastRow():this.rowPositionUtils.getFirstRow();if(!n)return!1;var u=n.rowIndex,c=n.rowPinned,v=this.getFocusedHeader();if(!r&&v&&(r=v.column),null==u||!r)return!1;if(this.navigationService.ensureCellVisible({rowIndex:u,column:r,rowPinned:c}),this.setFocusedCell({rowIndex:u,column:r,rowPinned:Xt(c),forceBrowserFocus:!0}),this.rangeService){var m={rowIndex:u,rowPinned:c,column:r};this.rangeService.setRangeToCell(m)}return!0},t.prototype.focusNextGridCoreContainer=function(r,i){return void 0===i&&(i=!1),!(i||!this.gridCtrl.focusNextInnerContainer(r))||((i||!r&&!this.gridCtrl.isDetailGrid())&&this.gridCtrl.forceFocusOutOfContainer(r),!1)},t.AG_KEYBOARD_FOCUS="ag-keyboard-focus",t.keyboardModeActive=!1,t.instancesMonitored=new Map,yn([D("eGridDiv")],t.prototype,"eGridDiv",void 0),yn([D("columnModel")],t.prototype,"columnModel",void 0),yn([D("headerNavigationService")],t.prototype,"headerNavigationService",void 0),yn([D("rowRenderer")],t.prototype,"rowRenderer",void 0),yn([D("rowPositionUtils")],t.prototype,"rowPositionUtils",void 0),yn([Ft("rangeService")],t.prototype,"rangeService",void 0),yn([D("navigationService")],t.prototype,"navigationService",void 0),yn([D("ctrlsService")],t.prototype,"ctrlsService",void 0),yn([Re],t.prototype,"init",null),t=e=yn([He("focusService")],t)}(we),Wm=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Fa=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Pd=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n};!function(o){o[o.vertical=0]="vertical",o[o.horizontal=1]="horizontal"}(fo||(fo={}));var Ps,jm=0,zm=function(o){function t(){var r=null!==o&&o.apply(this,arguments)||this;return r.popupList=[],r}var e;return Wm(t,o),e=t,t.prototype.postConstruct=function(){var r=this;this.ctrlsService.whenReady(function(i){r.gridCtrl=i.gridCtrl,r.addManagedListener(r.gridCtrl,I.EVENT_KEYBOARD_FOCUS,function(){r.popupList.forEach(function(n){return n.element.classList.add(ba.AG_KEYBOARD_FOCUS)})}),r.addManagedListener(r.gridCtrl,I.EVENT_MOUSE_FOCUS,function(){r.popupList.forEach(function(n){return n.element.classList.remove(ba.AG_KEYBOARD_FOCUS)})})})},t.prototype.getPopupParent=function(){return this.gridOptionsService.get("popupParent")||this.gridCtrl.getGui()},t.prototype.positionPopupForMenu=function(r){var i=r.eventSource.getBoundingClientRect(),n=this.getParentRect(),u=this.keepXYWithinBounds(r.ePopup,i.top-n.top,fo.vertical),c=r.ePopup.clientWidth>0?r.ePopup.clientWidth:200;r.ePopup.style.minWidth=c+"px";var C,m=n.right-n.left-c;function _(){return i.right-n.left-2}function O(){return i.left-n.left-c}this.gridOptionsService.is("enableRtl")?((C=O())<0&&(C=_()),C>m&&(C=0)):((C=_())>m&&(C=O()),C<0&&(C=0)),r.ePopup.style.left=C+"px",r.ePopup.style.top=u+"px"},t.prototype.positionPopupUnderMouseEvent=function(r){var i=this,n=r.ePopup,u=r.nudgeX,c=r.nudgeY,v=r.skipObserver;this.positionPopup({ePopup:n,nudgeX:u,nudgeY:c,keepWithinBounds:!0,skipObserver:v,updatePosition:function(){return i.calculatePointerAlign(r.mouseEvent)},postProcessCallback:function(){return i.callPostProcessPopup(r.type,r.ePopup,null,r.mouseEvent,r.column,r.rowNode)}})},t.prototype.calculatePointerAlign=function(r){var i=this.getParentRect();return{x:r.clientX-i.left,y:r.clientY-i.top}},t.prototype.positionPopupByComponent=function(r){var i=this,n=r.eventSource.getBoundingClientRect(),u=r.alignSide||"left",c=r.position||"over",v=this.getParentRect();this.positionPopup({ePopup:r.ePopup,nudgeX:r.nudgeX,nudgeY:r.nudgeY,keepWithinBounds:r.keepWithinBounds,updatePosition:function(){var C=n.left-v.left;return"right"===u&&(C-=r.ePopup.offsetWidth-n.width),{x:C,y:"over"===c?n.top-v.top:n.top-v.top+n.height}},postProcessCallback:function(){return i.callPostProcessPopup(r.type,r.ePopup,r.eventSource,null,r.column,r.rowNode)}})},t.prototype.callPostProcessPopup=function(r,i,n,u,c,v){var m=this.gridOptionsService.getCallback("postProcessPopup");m&&m({column:c,rowNode:v,ePopup:i,type:r,eventSource:n,mouseEvent:u})},t.prototype.positionPopup=function(r){var i=this,n=r.ePopup,u=r.keepWithinBounds,c=r.nudgeX,v=r.nudgeY,m=r.skipObserver,C=r.updatePosition,_={width:0,height:0},O=function(L){void 0===L&&(L=!1);var z=C(),q=z.x,Z=z.y;L&&n.clientWidth===_.width&&n.clientHeight===_.height||(_.width=n.clientWidth,_.height=n.clientHeight,c&&(q+=c),v&&(Z+=v),u&&(q=i.keepXYWithinBounds(n,q,fo.horizontal),Z=i.keepXYWithinBounds(n,Z,fo.vertical)),n.style.left=q+"px",n.style.top=Z+"px",r.postProcessCallback&&r.postProcessCallback())};if(O(),!m){var P=this.resizeObserverService.observeResize(n,function(){return O(!0)});setTimeout(function(){return P()},e.WAIT_FOR_POPUP_CONTENT_RESIZE)}},t.prototype.getActivePopups=function(){return this.popupList.map(function(r){return r.element})},t.prototype.getPopupList=function(){return this.popupList},t.prototype.getParentRect=function(){var r=this.gridOptionsService.getDocument(),i=this.getPopupParent();i===r.body?i=r.documentElement:"static"===getComputedStyle(i).position&&(i=i.offsetParent);var n=getComputedStyle(i),u=i.getBoundingClientRect();return{top:u.top+parseFloat(n.borderTopWidth)||0,left:u.left+parseFloat(n.borderLeftWidth)||0,right:u.right+parseFloat(n.borderRightWidth)||0,bottom:u.bottom+parseFloat(n.borderBottomWidth)||0}},t.prototype.keepXYWithinBounds=function(r,i,n){var u=n===fo.vertical,c=u?"clientHeight":"clientWidth",v=u?"top":"left",m=u?"offsetHeight":"offsetWidth",C=u?"scrollTop":"scrollLeft",_=this.gridOptionsService.getDocument(),O=_.documentElement,P=this.getPopupParent(),L=P.getBoundingClientRect(),z=_.documentElement.getBoundingClientRect(),q=P===_.body,Z=r[m],pe=q?(u?un:Ys)(O)+O[C]:P[c];q&&(pe-=Math.abs(z[v]-L[v]));var Ce=pe-Z;return Math.min(Math.max(i,0),Math.abs(Ce))},t.prototype.keepPopupPositionedRelativeTo=function(r){var i=this,n=this.getPopupParent(),u=n.getBoundingClientRect(),c=r.element.getBoundingClientRect(),v=u.top-c.top,m=u.left-c.left,C=v,_=m,O=r.ePopup.style.top,P=parseInt(O.substring(0,O.length-1),10),L=r.ePopup.style.left,z=parseInt(L.substring(0,L.length-1),10);return new ir(function(q){i.getFrameworkOverrides().setInterval(function(){var Z=n.getBoundingClientRect(),re=r.element.getBoundingClientRect();if(0==re.top&&0==re.left&&0==re.height&&0==re.width)r.hidePopup();else{var Ce=Z.top-re.top;if(Ce!=C){var be=i.keepXYWithinBounds(r.ePopup,P+v-Ce,fo.vertical);r.ePopup.style.top=be+"px"}C=Ce;var qe=Z.left-re.left;if(qe!=_){var et=i.keepXYWithinBounds(r.ePopup,z+m-qe,fo.horizontal);r.ePopup.style.left=et+"px"}_=qe}},200).then(function(Z){q(function(){null!=Z&&window.clearInterval(Z)})})})},t.prototype.addPopup=function(r){var i,n=this,u=r.modal,c=r.eChild,v=r.closeOnEsc,m=r.closedCallback,C=r.click,_=r.alwaysOnTop,O=r.afterGuiAttached,P=r.positionCallback,L=r.anchorToElement,z=r.ariaLabel,q=this.gridOptionsService.getDocument(),Z=new ir(function(Et){return Et(function(){})});if(!q)return console.warn("AG Grid: could not find the document, document is empty"),{hideFunc:function(){},stopAnchoringPromise:Z};var re=this.popupList.findIndex(function(Et){return Et.element===c});if(-1!==re){var pe=this.popupList[re];return{hideFunc:pe.hideFunc,stopAnchoringPromise:pe.stopAnchoringPromise}}var Ce=this.getPopupParent();null==c.style.top&&(c.style.top="0px"),null==c.style.left&&(c.style.left="0px");var be=document.createElement("div"),qe=this.environment.getTheme().allThemes;qe.length&&(i=be.classList).add.apply(i,function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(Pd(arguments[t]));return o}(qe)),be.classList.add("ag-popup"),c.classList.add(this.gridOptionsService.is("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),c.hasAttribute("role")||vt(c,"dialog"),wo(c,z),this.focusService.isKeyboardMode()&&c.classList.add(ba.AG_KEYBOARD_FOCUS),be.appendChild(c),Ce.appendChild(be),_?this.setAlwaysOnTop(be,!0):this.bringPopupToFront(be);var et=!1,ze=function(Et){be.contains(q.activeElement)&&(Et.key===ve.ESCAPE&&Gt({keyboardEvent:Et}))},st=function(Et){return Gt({mouseEvent:Et})},nt=function(Et){return Gt({touchEvent:Et})},Gt=function(Et){void 0===Et&&(Et={});var Dr=Et.mouseEvent,Xr=Et.touchEvent,Yt=Et.keyboardEvent;n.isEventFromCurrentPopup({mouseEvent:Dr,touchEvent:Xr},c)||n.isEventSameChainAsOriginalEvent({originalMouseEvent:C,mouseEvent:Dr,touchEvent:Xr})||et||(et=!0,Ce.removeChild(be),q.removeEventListener("keydown",ze),q.removeEventListener("mousedown",st),q.removeEventListener("touchstart",nt),q.removeEventListener("contextmenu",st),n.eventService.removeEventListener(I.EVENT_DRAG_STARTED,st),m&&m(Dr||Xr||Yt),n.popupList=n.popupList.filter(function(Ht){return Ht.element!==c}),Z&&Z.then(function(Ht){return Ht&&Ht()}))};return O&&O({hidePopup:Gt}),window.setTimeout(function(){v&&q.addEventListener("keydown",ze),u&&(q.addEventListener("mousedown",st),n.eventService.addEventListener(I.EVENT_DRAG_STARTED,st),q.addEventListener("touchstart",nt),q.addEventListener("contextmenu",st))},0),P&&P(),L&&(Z=this.keepPopupPositionedRelativeTo({element:L,ePopup:c,hidePopup:Gt})),this.popupList.push({element:c,wrapper:be,hideFunc:Gt,stopAnchoringPromise:Z,instanceId:jm++,isAnchored:!!L}),{hideFunc:Gt,stopAnchoringPromise:Z}},t.prototype.hasAnchoredPopup=function(){return this.popupList.some(function(r){return r.isAnchored})},t.prototype.isEventFromCurrentPopup=function(r,i){var n=r.mouseEvent,u=r.touchEvent,c=n||u;if(!c)return!1;var v=this.popupList.findIndex(function(_){return _.element===i});if(-1===v)return!1;for(var m=v;m<this.popupList.length;m++){if(ul(this.popupList[m].element,c))return!0}return this.isElementWithinCustomPopup(c.target)},t.prototype.isElementWithinCustomPopup=function(r){for(var i=this.gridOptionsService.getDocument();r&&r!==i.body;){if(r.classList.contains("ag-custom-component-popup")||null===r.parentElement)return!0;r=r.parentElement}return!1},t.prototype.isEventSameChainAsOriginalEvent=function(r){var i=r.originalMouseEvent,n=r.mouseEvent,u=r.touchEvent,c=null;if(n?c=n:u&&(c=u.touches[0]),c&&i){var v=n?n.screenX:0,m=n?n.screenY:0,C=Math.abs(i.screenX-v)<5,_=Math.abs(i.screenY-m)<5;if(C&&_)return!0}return!1},t.prototype.getWrapper=function(r){for(;!r.classList.contains("ag-popup")&&r.parentElement;)r=r.parentElement;return r.classList.contains("ag-popup")?r:null},t.prototype.setAlwaysOnTop=function(r,i){var n=this.getWrapper(r);n&&(n.classList.toggle("ag-always-on-top",!!i),i&&this.bringPopupToFront(n))},t.prototype.bringPopupToFront=function(r){var i=this.getPopupParent(),n=Array.prototype.slice.call(i.querySelectorAll(".ag-popup")),u=n.length,c=Array.prototype.slice.call(i.querySelectorAll(".ag-popup.ag-always-on-top")),v=c.length,m=this.getWrapper(r);if(m&&!(u<=1)&&i.contains(r)){var C=n.indexOf(m),_=m.querySelectorAll("div"),O=[];if(_.forEach(function(q){0!==q.scrollTop&&O.push([q,q.scrollTop])}),v)m.classList.contains("ag-always-on-top")?C!==u-1&&Mt(c).insertAdjacentElement("afterend",m):C!==u-v-1&&c[0].insertAdjacentElement("beforebegin",m);else C!==u-1&&Mt(n).insertAdjacentElement("afterend",m);for(;O.length;){var L=O.pop();L[0].scrollTop=L[1]}var z={type:"popupToFront",api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,eWrapper:m};this.eventService.dispatchEvent(z)}},t.WAIT_FOR_POPUP_CONTENT_RESIZE=200,Fa([D("focusService")],t.prototype,"focusService",void 0),Fa([D("ctrlsService")],t.prototype,"ctrlsService",void 0),Fa([D("resizeObserverService")],t.prototype,"resizeObserverService",void 0),Fa([Re],t.prototype,"postConstruct",null),t=e=Fa([He("popupService")],t)}(we),Km=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),rf=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},$m=(function(o){function t(e,r,i){void 0===e&&(e="default"),void 0===r&&(r="listbox");var n=o.call(this,t.getTemplate(e))||this;return n.cssIdentifier=e,n.ariaRole=r,n.listName=i,n.renderedRows=new Map,n.rowHeight=20,n}Km(t,o),t.prototype.postConstruct=function(){var e=this;this.addScrollListener(),this.rowHeight=this.getItemHeight(),this.addResizeObserver(),this.initialiseTabGuard({onFocusIn:function(r){return e.onFocusIn(r)},onFocusOut:function(r){return e.onFocusOut(r)},focusInnerElement:function(r){return e.focusInnerElement(r)},onTabKeyDown:function(r){return e.onTabKeyDown(r)},handleKeyDown:function(r){return e.handleKeyDown(r)}}),this.setAriaProperties(),this.addManagedListener(this.eventService,I.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanged.bind(this))},t.prototype.onGridStylesChanged=function(){this.rowHeight=this.getItemHeight(),this.refresh()},t.prototype.setAriaProperties=function(){var r=this.localeService.getLocaleTextFunc()("ariaDefaultListName",this.listName||"List"),i=this.eContainer;vt(i,this.ariaRole),wo(i,r)},t.prototype.addResizeObserver=function(){var e=this,i=this.resizeObserverService.observeResize(this.getGui(),function(){return e.drawVirtualRows()});this.addDestroyFunc(i)},t.prototype.focusInnerElement=function(e){this.focusRow(e?this.model.getRowCount()-1:0)},t.prototype.onFocusIn=function(e){var r=e.target;return r.classList.contains("ag-virtual-list-item")&&(this.lastFocusedRowIndex=Bu(r)-1),!1},t.prototype.onFocusOut=function(e){return this.getFocusableElement().contains(e.relatedTarget)||(this.lastFocusedRowIndex=null),!1},t.prototype.handleKeyDown=function(e){switch(e.key){case ve.UP:case ve.DOWN:this.navigate(e.key===ve.UP)&&e.preventDefault()}},t.prototype.onTabKeyDown=function(e){this.navigate(e.shiftKey)?e.preventDefault():this.forceFocusOutOfContainer(e.shiftKey)},t.prototype.navigate=function(e){if(null==this.lastFocusedRowIndex)return!1;var r=this.lastFocusedRowIndex+(e?-1:1);return!(r<0||r>=this.model.getRowCount())&&(this.focusRow(r),!0)},t.prototype.getLastFocusedRow=function(){return this.lastFocusedRowIndex},t.prototype.focusRow=function(e){var r=this;this.ensureIndexVisible(e),window.setTimeout(function(){if(r.isAlive()){var i=r.renderedRows.get(e);i&&i.eDiv.focus()}},10)},t.prototype.getComponentAt=function(e){var r=this.renderedRows.get(e);return r&&r.rowComponent},t.prototype.forEachRenderedRow=function(e){this.renderedRows.forEach(function(r,i){return e(r.rowComponent,i)})},t.getTemplate=function(e){return'\n            <div class="ag-virtual-list-viewport ag-'+e+'-virtual-list-viewport" role="presentation">\n                <div class="ag-virtual-list-container ag-'+e+'-virtual-list-container" ref="eContainer"></div>\n            </div>'},t.prototype.getItemHeight=function(){return this.environment.getListItemHeight()},t.prototype.ensureIndexVisible=function(e){var r=this.model.getRowCount();if("number"!=typeof e||e<0||e>=r)console.warn("AG Grid: invalid row index for ensureIndexVisible: "+e);else{var i=e*this.rowHeight,n=i+this.rowHeight,u=this.getGui(),c=u.scrollTop,v=u.offsetHeight,_=c+v<n;if(c>i)u.scrollTop=i;else if(_){var O=n-v;u.scrollTop=O}}},t.prototype.setComponentCreator=function(e){this.componentCreator=e},t.prototype.setComponentUpdater=function(e){this.componentUpdater=e},t.prototype.getRowHeight=function(){return this.rowHeight},t.prototype.getScrollTop=function(){return this.getGui().scrollTop},t.prototype.setRowHeight=function(e){this.rowHeight=e,this.refresh()},t.prototype.refresh=function(e){var r=this;if(null!=this.model&&this.isAlive()){var i=this.model.getRowCount();this.eContainer.style.height=i*this.rowHeight+"px",Fu(function(){return r.eContainer.clientHeight>=i*r.rowHeight},function(){r.isAlive()&&(r.canSoftRefresh(e)?r.drawVirtualRows(!0):(r.clearVirtualRows(),r.drawVirtualRows()))})}},t.prototype.canSoftRefresh=function(e){return!!(e&&this.renderedRows.size&&"function"==typeof this.model.areRowsEqual&&this.componentUpdater)},t.prototype.clearVirtualRows=function(){var e=this;this.renderedRows.forEach(function(r,i){return e.removeRow(i)})},t.prototype.drawVirtualRows=function(e){if(this.isAlive()){var r=this.getGui(),i=r.scrollTop,n=i+r.offsetHeight,u=Math.floor(i/this.rowHeight),c=Math.floor(n/this.rowHeight);this.ensureRowsRendered(u,c,e)}},t.prototype.ensureRowsRendered=function(e,r,i){var n=this;this.renderedRows.forEach(function(c,v){(v<e||v>r)&&v!==n.lastFocusedRowIndex&&n.removeRow(v)}),i&&this.refreshRows();for(var u=e;u<=r;u++)this.renderedRows.has(u)||u<this.model.getRowCount()&&this.insertRow(u)},t.prototype.insertRow=function(e){var r=this,i=this.model.getRow(e),n=document.createElement("div");if(n.classList.add("ag-virtual-list-item","ag-"+this.cssIdentifier+"-virtual-list-item"),vt(n,"tree"===this.ariaRole?"treeitem":"option"),So(n,this.model.getRowCount()),ar(n,e+1),n.setAttribute("tabindex","-1"),"function"==typeof this.model.isRowSelected){var u=this.model.isRowSelected(e);_o(n,!!u),$u(n,u)}n.style.height=this.rowHeight+"px",n.style.top=this.rowHeight*e+"px";var c=this.componentCreator(i,n);c.addGuiEventListener("focusin",function(){return r.lastFocusedRowIndex=e}),n.appendChild(c.getGui()),this.renderedRows.has(e-1)?this.renderedRows.get(e-1).eDiv.insertAdjacentElement("afterend",n):this.renderedRows.has(e+1)?this.renderedRows.get(e+1).eDiv.insertAdjacentElement("beforebegin",n):this.eContainer.appendChild(n),this.renderedRows.set(e,{rowComponent:c,eDiv:n,value:i})},t.prototype.removeRow=function(e){var r=this.renderedRows.get(e);this.eContainer.removeChild(r.eDiv),this.destroyBean(r.rowComponent),this.renderedRows.delete(e)},t.prototype.refreshRows=function(){var e=this,r=this.model.getRowCount();this.renderedRows.forEach(function(i,n){var u,c;if(n>=r)e.removeRow(n);else{var v=e.model.getRow(n);null!==(c=(u=e.model).areRowsEqual)&&void 0!==c&&c.call(u,i.value,v)?e.componentUpdater(v,i.rowComponent):e.removeRow(n)}})},t.prototype.addScrollListener=function(){var e=this;this.addGuiEventListener("scroll",function(){return e.drawVirtualRows()},{passive:!0})},t.prototype.setModel=function(e){this.model=e},t.prototype.destroy=function(){this.isAlive()&&(this.clearVirtualRows(),o.prototype.destroy.call(this))},rf([D("resizeObserverService")],t.prototype,"resizeObserverService",void 0),rf([Te("eContainer")],t.prototype,"eContainer",void 0),rf([Re],t.prototype,"postConstruct",null)}(lu),["mouseover","mouseout","mouseenter","mouseleave"]),Ym=["touchstart","touchend","touchmove","touchcancel"],Id=function(){function o(){this.isOutsideAngular=function(t){return kr($m,t)}}return o.prototype.setTimeout=function(t,e){window.setTimeout(t,e)},o.prototype.setInterval=function(t,e){return new ir(function(r){r(window.setInterval(t,e))})},o.prototype.addEventListener=function(t,e,r,i){var n=kr(Ym,e);t.addEventListener(e,r,{capture:!!i,passive:n})},o.prototype.dispatchEvent=function(t,e,r){e()},o.prototype.frameworkComponent=function(t){return null},o.prototype.isFrameworkComponent=function(t){return!1},o}(),Xm=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ds=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},qm=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},Jm=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return Xm(t,o),t.prototype.getNextCellToFocus=function(e,r,i){return void 0===i&&(i=!1),i?this.getNextCellToFocusWithCtrlPressed(e,r):this.getNextCellToFocusWithoutCtrlPressed(e,r)},t.prototype.getNextCellToFocusWithCtrlPressed=function(e,r){var c,v,i=e===ve.UP,n=e===ve.DOWN,u=e===ve.LEFT;if(i||n)v=i?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow(),c=r.column;else{var m=this.columnModel.getAllDisplayedColumns(),C=this.gridOptionsService.is("enableRtl");v=r.rowIndex,c=u!==C?m[0]:Mt(m)}return{rowIndex:v,rowPinned:null,column:c}},t.prototype.getNextCellToFocusWithoutCtrlPressed=function(e,r){for(var i=r,n=!1;!n;){switch(e){case ve.UP:i=this.getCellAbove(i);break;case ve.DOWN:i=this.getCellBelow(i);break;case ve.RIGHT:i=this.gridOptionsService.is("enableRtl")?this.getCellToLeft(i):this.getCellToRight(i);break;case ve.LEFT:i=this.gridOptionsService.is("enableRtl")?this.getCellToRight(i):this.getCellToLeft(i);break;default:i=null,console.warn("AG Grid: unknown key for navigation "+e)}n=!i||this.isCellGoodToFocusOn(i)}return i},t.prototype.isCellGoodToFocusOn=function(e){var i,r=e.column;switch(e.rowPinned){case"top":i=this.pinnedRowModel.getPinnedTopRow(e.rowIndex);break;case"bottom":i=this.pinnedRowModel.getPinnedBottomRow(e.rowIndex);break;default:i=this.rowModel.getRow(e.rowIndex)}return!!i&&!r.isSuppressNavigable(i)},t.prototype.getCellToLeft=function(e){if(!e)return null;var r=this.columnModel.getDisplayedColBefore(e.column);return r?{rowIndex:e.rowIndex,column:r,rowPinned:e.rowPinned}:null},t.prototype.getCellToRight=function(e){if(!e)return null;var r=this.columnModel.getDisplayedColAfter(e.column);return r?{rowIndex:e.rowIndex,column:r,rowPinned:e.rowPinned}:null},t.prototype.getRowBelow=function(e){var r=e.rowIndex,i=e.rowPinned;if(this.isLastRowInContainer(e))switch(i){case"bottom":return null;case"top":return this.rowModel.isRowsToRender()?{rowIndex:this.paginationProxy.getPageFirstRow(),rowPinned:null}:this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;default:return this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null}var n=this.rowModel.getRow(e.rowIndex);return this.getNextStickyPosition(n)||{rowIndex:r+1,rowPinned:i}},t.prototype.getNextStickyPosition=function(e,r){if(this.gridOptionsService.is("groupRowsSticky")&&e&&e.sticky){var i=function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(qm(arguments[t]));return o}(this.rowRenderer.getStickyTopRowCtrls()).sort(function(v,m){return v.getRowNode().rowIndex-m.getRowNode().rowIndex}),n=r?-1:1,u=i.findIndex(function(v){return v.getRowNode().rowIndex===e.rowIndex}),c=i[u+n];if(c)return{rowIndex:c.getRowNode().rowIndex,rowPinned:null}}},t.prototype.getCellBelow=function(e){if(!e)return null;var r=this.getRowBelow(e);return r?{rowIndex:r.rowIndex,column:e.column,rowPinned:r.rowPinned}:null},t.prototype.isLastRowInContainer=function(e){var r=e.rowPinned,i=e.rowIndex;return"top"===r?this.pinnedRowModel.getPinnedTopRowData().length-1<=i:"bottom"===r?this.pinnedRowModel.getPinnedBottomRowData().length-1<=i:this.paginationProxy.getPageLastRow()<=i},t.prototype.getRowAbove=function(e){var r=e.rowIndex,i=e.rowPinned;if(i?0===r:r===this.paginationProxy.getPageFirstRow())return"top"===i?null:i&&this.rowModel.isRowsToRender()?this.getLastBodyCell():this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null;var u=this.rowModel.getRow(e.rowIndex);return this.getNextStickyPosition(u,!0)||{rowIndex:r-1,rowPinned:i}},t.prototype.getCellAbove=function(e){if(!e)return null;var r=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});return r?{rowIndex:r.rowIndex,column:e.column,rowPinned:r.rowPinned}:null},t.prototype.getLastBodyCell=function(){return{rowIndex:this.paginationProxy.getPageLastRow(),rowPinned:null}},t.prototype.getLastFloatingTopRow=function(){return{rowIndex:this.pinnedRowModel.getPinnedTopRowData().length-1,rowPinned:"top"}},t.prototype.getNextTabbedCell=function(e,r){return r?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)},t.prototype.getNextTabbedCellForwards=function(e){var r=this.columnModel.getAllDisplayedColumns(),i=e.rowIndex,n=e.rowPinned,u=this.columnModel.getDisplayedColAfter(e.column);if(!u){u=r[0];var c=this.getRowBelow(e);if(Je(c)||!c.rowPinned&&!this.paginationProxy.isRowInPage(c))return null;i=c?c.rowIndex:null,n=c?c.rowPinned:null}return{rowIndex:i,column:u,rowPinned:n}},t.prototype.getNextTabbedCellBackwards=function(e){var r=this.columnModel.getAllDisplayedColumns(),i=e.rowIndex,n=e.rowPinned,u=this.columnModel.getDisplayedColBefore(e.column);if(!u){u=Mt(r);var c=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});if(Je(c)||!c.rowPinned&&!this.paginationProxy.isRowInPage(c))return null;i=c?c.rowIndex:null,n=c?c.rowPinned:null}return{rowIndex:i,column:u,rowPinned:n}},Ds([D("columnModel")],t.prototype,"columnModel",void 0),Ds([D("rowModel")],t.prototype,"rowModel",void 0),Ds([D("rowRenderer")],t.prototype,"rowRenderer",void 0),Ds([D("pinnedRowModel")],t.prototype,"pinnedRowModel",void 0),Ds([D("paginationProxy")],t.prototype,"paginationProxy",void 0),t=Ds([He("cellNavigationService")],t)}(we),Zm=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Pa=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},ey=function(o,t){return function(e,r){t(e,r,o)}},ty=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.consuming=!1,e}return Zm(t,o),t.prototype.setBeans=function(e){this.logger=e.create("AlignedGridsService")},t.prototype.init=function(){this.addManagedListener(this.eventService,I.EVENT_COLUMN_MOVED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,I.EVENT_COLUMN_VISIBLE,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,I.EVENT_COLUMN_PINNED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,I.EVENT_COLUMN_GROUP_OPENED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,I.EVENT_COLUMN_RESIZED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,I.EVENT_BODY_SCROLL,this.fireScrollEvent.bind(this))},t.prototype.fireEvent=function(e){if(!this.consuming){var r=this.gridOptionsService.get("alignedGrids");r&&r.forEach(function(i){if(i.api){var n=i.api.__getAlignedGridService();e(n)}})}},t.prototype.onEvent=function(e){this.consuming=!0,e(),this.consuming=!1},t.prototype.fireColumnEvent=function(e){this.fireEvent(function(r){r.onColumnEvent(e)})},t.prototype.fireScrollEvent=function(e){"horizontal"===e.direction&&this.fireEvent(function(r){r.onScrollEvent(e)})},t.prototype.onScrollEvent=function(e){var r=this;this.onEvent(function(){r.ctrlsService.getGridBodyCtrl().getScrollFeature().setHorizontalScrollPosition(e.left)})},t.prototype.getMasterColumns=function(e){var r=[];return e.columns?e.columns.forEach(function(i){r.push(i)}):e.column&&r.push(e.column),r},t.prototype.getColumnIds=function(e){var r=[];return e.columns?e.columns.forEach(function(i){r.push(i.getColId())}):e.column&&r.push(e.column.getColId()),r},t.prototype.onColumnEvent=function(e){var r=this;this.onEvent(function(){switch(e.type){case I.EVENT_COLUMN_MOVED:case I.EVENT_COLUMN_VISIBLE:case I.EVENT_COLUMN_PINNED:case I.EVENT_COLUMN_RESIZED:var i=e;r.processColumnEvent(i);break;case I.EVENT_COLUMN_GROUP_OPENED:var n=e;r.processGroupOpenedEvent(n);break;case I.EVENT_COLUMN_PIVOT_CHANGED:console.warn("AG Grid: pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.")}})},t.prototype.processGroupOpenedEvent=function(e){var r=e.columnGroup,i=null;if(r){var n=r.getGroupId();i=this.columnModel.getProvidedColumnGroup(n)}r&&!i||(this.logger.log("onColumnEvent-> processing "+e+" expanded = "+r.isExpanded()),this.columnModel.setColumnGroupOpened(i,r.isExpanded(),"alignedGridChanged"))},t.prototype.processColumnEvent=function(e){var i,r=this,n=e.column,u=null;if(n&&(u=this.columnModel.getPrimaryColumn(n.getColId())),!n||u){var c=this.getMasterColumns(e);switch(e.type){case I.EVENT_COLUMN_MOVED:var v=e,C=e.columnApi.getColumnState().map(function(re){return{colId:re.colId}});this.columnModel.applyColumnState({state:C,applyOrder:!0},"alignedGridChanged"),this.logger.log("onColumnEvent-> processing "+e.type+" toIndex = "+v.toIndex);break;case I.EVENT_COLUMN_VISIBLE:var _=e;C=e.columnApi.getColumnState().map(function(Ce){return{colId:Ce.colId,hide:Ce.hide}});this.columnModel.applyColumnState({state:C},"alignedGridChanged"),this.logger.log("onColumnEvent-> processing "+e.type+" visible = "+_.visible);break;case I.EVENT_COLUMN_PINNED:var O=e;C=e.columnApi.getColumnState().map(function(Ce){return{colId:Ce.colId,pinned:Ce.pinned}});this.columnModel.applyColumnState({state:C},"alignedGridChanged"),this.logger.log("onColumnEvent-> processing "+e.type+" pinned = "+O.pinned);break;case I.EVENT_COLUMN_RESIZED:var P=e,L={};c.forEach(function(re){r.logger.log("onColumnEvent-> processing "+e.type+" actualWidth = "+re.getActualWidth()),L[re.getId()]={key:re.getColId(),newWidth:re.getActualWidth()}}),null===(i=P.flexColumns)||void 0===i||i.forEach(function(re){L[re.getId()]&&delete L[re.getId()]}),this.columnModel.setColumnWidths(Object.values(L),!1,P.finished,"alignedGridChanged")}var q=this.ctrlsService.getGridBodyCtrl().isVerticalScrollShowing(),Z=this.gridOptionsService.get("alignedGrids");Z&&Z.forEach(function(re){re.api&&re.api.setAlwaysShowVerticalScroll(q)})}},Pa([D("columnModel")],t.prototype,"columnModel",void 0),Pa([D("ctrlsService")],t.prototype,"ctrlsService",void 0),Pa([ey(0,Zr("loggerFactory"))],t.prototype,"setBeans",null),Pa([Re],t.prototype,"init",null),t=Pa([He("alignedGridsService")],t)}(we),ry=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),cu=function(){return cu=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},cu.apply(this,arguments)},Ia=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},iy=function(o,t){return function(e,r){t(e,r,o)}},oy=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return ry(t,o),t.prototype.setBeans=function(e){this.logger=e.create("selectionService"),this.reset()},t.prototype.init=function(){var e=this;this.groupSelectsChildren=this.gridOptionsService.is("groupSelectsChildren"),this.addManagedPropertyListener("groupSelectsChildren",function(r){return e.groupSelectsChildren=r.currentValue}),this.rowSelection=this.gridOptionsService.get("rowSelection"),this.addManagedPropertyListener("rowSelection",function(r){return e.rowSelection=r.currentValue}),this.addManagedListener(this.eventService,I.EVENT_ROW_SELECTED,this.onRowSelected.bind(this))},t.prototype.isMultiselect=function(){return"multiple"===this.rowSelection},t.prototype.setNodeSelected=function(e){var r,i=e.newValue,n=e.clearSelection,u=e.suppressFinishActions,c=e.rangeSelect;e.event;var v=e.node,m=e.source,C=void 0===m?"api":m,_=this.groupSelectsChildren&&!0===e.groupSelectsFiltered;if(void 0===v.id)return console.warn("AG Grid: cannot select node until id for node is known"),0;if(v.rowPinned)return console.warn("AG Grid: cannot select pinned rows"),0;if(v.footer)return this.setNodeSelected(cu(cu({},e),{node:v.sibling}));var O=this.getLastSelectedNode();if(c&&O&&(O!==v&&this.isMultiselect())){var L=this.selectRange(v,O,e.newValue,C);return this.setLastSelectedNode(v),L}var q=0;_&&v.group||v.selectThisNode(i,e.event,C)&&q++;if(this.groupSelectsChildren&&!(null===(r=v.childrenAfterGroup)||void 0===r)&&r.length&&(q+=this.selectChildren(v,i,_,C)),!u){if(i&&(n||!this.isMultiselect())&&(q+=this.clearOtherNodes(v,C)),q>0){this.updateGroupsFromChildrenSelections(C);var pe={type:I.EVENT_SELECTION_CHANGED,source:C};this.eventService.dispatchEvent(pe)}i&&this.setLastSelectedNode(v)}return q},t.prototype.selectRange=function(e,r,i,n){var u=this;void 0===i&&(i=!0);var c=this.rowModel.getNodesInRangeForSelection(e,r),v=0;c.forEach(function(C){C.group&&u.groupSelectsChildren||!1===i&&e===C||C.selectThisNode(i,void 0,n)&&v++}),this.updateGroupsFromChildrenSelections(n);var m={type:I.EVENT_SELECTION_CHANGED,source:n};return this.eventService.dispatchEvent(m),v},t.prototype.selectChildren=function(e,r,i,n){var u=i?e.childrenAfterAggFilter:e.childrenAfterGroup;if(rt.missing(u))return 0;for(var c=0,v=0;v<u.length;v++)c+=u[v].setSelectedParams({newValue:r,clearSelection:!1,suppressFinishActions:!0,groupSelectsFiltered:i,source:n});return c},t.prototype.setLastSelectedNode=function(e){this.lastSelectedNode=e},t.prototype.getLastSelectedNode=function(){return this.lastSelectedNode},t.prototype.getSelectedNodes=function(){var e=[];return Xe(this.selectedNodes,function(r,i){i&&e.push(i)}),e},t.prototype.getSelectedRows=function(){var e=[];return Xe(this.selectedNodes,function(r,i){i&&i.data&&e.push(i.data)}),e},t.prototype.getSelectionCount=function(){return Object.values(this.selectedNodes).length},t.prototype.filterFromSelection=function(e){var r={};Object.entries(this.selectedNodes).forEach(function(i){var n=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n}(i,2),u=n[0],c=n[1];c&&e(c)&&(r[u]=c)}),this.selectedNodes=r},t.prototype.updateGroupsFromChildrenSelections=function(e,r){if(!this.groupSelectsChildren||"clientSide"!==this.rowModel.getType())return!1;var n=this.rowModel.getRootNode();r||(r=new Xc(!0,n)).setInactive();var u=!1;return r.forEachChangedNodeDepthFirst(function(c){if(c!==n){var v=c.calculateSelectedFromChildren();u=c.selectThisNode(null!==v&&v,void 0,e)||u}}),u},t.prototype.clearOtherNodes=function(e,r){var i=this,n={},u=0;return Xe(this.selectedNodes,function(c,v){if(v&&v.id!==e.id){var m=i.selectedNodes[v.id];u+=m.setSelectedParams({newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:r}),i.groupSelectsChildren&&v.parent&&(n[v.parent.id]=v.parent)}}),Xe(n,function(c,v){var m=v.calculateSelectedFromChildren();v.selectThisNode(null!==m&&m,void 0,r)}),u},t.prototype.onRowSelected=function(e){var r=e.node;this.groupSelectsChildren&&r.group||(r.isSelected()?this.selectedNodes[r.id]=r:delete this.selectedNodes[r.id])},t.prototype.syncInRowNode=function(e,r){this.syncInOldRowNode(e,r),this.syncInNewRowNode(e)},t.prototype.syncInOldRowNode=function(e,r){if(me(r)&&e.id!==r.id&&r){var n=r.id;this.selectedNodes[n]==e&&(this.selectedNodes[r.id]=r)}},t.prototype.syncInNewRowNode=function(e){me(this.selectedNodes[e.id])?(e.setSelectedInitialValue(!0),this.selectedNodes[e.id]=e):e.setSelectedInitialValue(!1)},t.prototype.reset=function(){this.logger.log("reset"),this.selectedNodes={},this.lastSelectedNode=null},t.prototype.getBestCostNodeSelection=function(){if("clientSide"===this.rowModel.getType()){var r=this.rowModel.getTopLevelNodes();if(null!==r){var i=[];return function n(u){for(var c=0,v=u.length;c<v;c++){var m=u[c];if(m.isSelected())i.push(m);else{var C=m;C.group&&C.children&&n(C.children)}}}(r),i}}},t.prototype.isEmpty=function(){var e=0;return Xe(this.selectedNodes,function(r,i){i&&e++}),0===e},t.prototype.deselectAllRowNodes=function(e){var r=function(m){return m.selectThisNode(!1,void 0,n)},i="clientSide"===this.rowModel.getType(),n=e.source,u=e.justFiltered,c=e.justCurrentPage;if(c||u){if(!i)return void console.error("AG Grid: selecting just filtered only works when gridOptions.rowModelType='clientSide'");this.getNodesToSelect(u,c).forEach(r)}else Xe(this.selectedNodes,function(m,C){C&&r(C)}),this.reset();i&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(n);var v={type:I.EVENT_SELECTION_CHANGED,source:n};this.eventService.dispatchEvent(v)},t.prototype.getSelectAllState=function(e,r){var i=this,n=0,u=0;return this.getNodesToSelect(e,r).forEach(function(v){i.groupSelectsChildren&&v.group||(v.isSelected()?n++:v.selectable&&u++)}),(0!==n||0!==u)&&(n>0&&u>0?null:n>0)},t.prototype.getNodesToSelect=function(e,r){var i=this;if(void 0===e&&(e=!1),void 0===r&&(r=!1),"clientSide"!==this.rowModel.getType())throw new Error("selectAll only available when rowModelType='clientSide', ie not "+this.rowModel.getType());var n=[];if(r)return this.paginationProxy.forEachNodeOnPage(function(c){if(c.group)if(c.expanded)i.groupSelectsChildren||n.push(c);else{var v=function(m){var C;n.push(m),null!==(C=m.childrenAfterFilter)&&void 0!==C&&C.length&&m.childrenAfterFilter.forEach(v)};v(c)}else n.push(c)}),n;var u=this.rowModel;return e?(u.forEachNodeAfterFilter(function(c){n.push(c)}),n):(u.forEachNode(function(c){n.push(c)}),n)},t.prototype.selectAllRowNodes=function(e){if("clientSide"!==this.rowModel.getType())throw new Error("selectAll only available when rowModelType='clientSide', ie not "+this.rowModel.getType());var r=e.source,i=e.justFiltered,n=e.justCurrentPage;this.getNodesToSelect(i,n).forEach(function(v){return v.selectThisNode(!0,void 0,r)}),"clientSide"===this.rowModel.getType()&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(r);var c={type:I.EVENT_SELECTION_CHANGED,source:r};this.eventService.dispatchEvent(c)},t.prototype.getServerSideSelectionState=function(){return null},t.prototype.setServerSideSelectionState=function(e){},Ia([D("rowModel")],t.prototype,"rowModel",void 0),Ia([D("paginationProxy")],t.prototype,"paginationProxy",void 0),Ia([iy(0,Zr("loggerFactory"))],t.prototype,"setBeans",null),Ia([Re],t.prototype,"init",null),t=Ia([He("selectionService")],t)}(we),nf=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Ld=function(){function o(){}return o.prototype.sizeColumnsToFit=function(t){typeof t>"u"&&console.error("AG Grid: missing parameter to columnApi.sizeColumnsToFit(gridWidth)"),this.columnModel.sizeColumnsToFit(t,"api")},o.prototype.setColumnGroupOpened=function(t,e){this.columnModel.setColumnGroupOpened(t,e,"api")},o.prototype.getColumnGroup=function(t,e){return this.columnModel.getColumnGroup(t,e)},o.prototype.getProvidedColumnGroup=function(t){return this.columnModel.getProvidedColumnGroup(t)},o.prototype.getDisplayNameForColumn=function(t,e){return this.columnModel.getDisplayNameForColumn(t,e)||""},o.prototype.getDisplayNameForColumnGroup=function(t,e){return this.columnModel.getDisplayNameForColumnGroup(t,e)||""},o.prototype.getColumn=function(t){return this.columnModel.getPrimaryColumn(t)},o.prototype.getColumns=function(){return this.columnModel.getAllPrimaryColumns()},o.prototype.applyColumnState=function(t){return this.columnModel.applyColumnState(t,"api")},o.prototype.getColumnState=function(){return this.columnModel.getColumnState()},o.prototype.resetColumnState=function(){this.columnModel.resetColumnState("api")},o.prototype.getColumnGroupState=function(){return this.columnModel.getColumnGroupState()},o.prototype.setColumnGroupState=function(t){this.columnModel.setColumnGroupState(t,"api")},o.prototype.resetColumnGroupState=function(){this.columnModel.resetColumnGroupState("api")},o.prototype.isPinning=function(){return this.columnModel.isPinningLeft()||this.columnModel.isPinningRight()},o.prototype.isPinningLeft=function(){return this.columnModel.isPinningLeft()},o.prototype.isPinningRight=function(){return this.columnModel.isPinningRight()},o.prototype.getDisplayedColAfter=function(t){return this.columnModel.getDisplayedColAfter(t)},o.prototype.getDisplayedColBefore=function(t){return this.columnModel.getDisplayedColBefore(t)},o.prototype.setColumnVisible=function(t,e){this.columnModel.setColumnVisible(t,e,"api")},o.prototype.setColumnsVisible=function(t,e){this.columnModel.setColumnsVisible(t,e,"api")},o.prototype.setColumnPinned=function(t,e){this.columnModel.setColumnPinned(t,e,"api")},o.prototype.setColumnsPinned=function(t,e){this.columnModel.setColumnsPinned(t,e,"api")},o.prototype.getAllGridColumns=function(){return this.columnModel.getAllGridColumns()},o.prototype.getDisplayedLeftColumns=function(){return this.columnModel.getDisplayedLeftColumns()},o.prototype.getDisplayedCenterColumns=function(){return this.columnModel.getDisplayedCenterColumns()},o.prototype.getDisplayedRightColumns=function(){return this.columnModel.getDisplayedRightColumns()},o.prototype.getAllDisplayedColumns=function(){return this.columnModel.getAllDisplayedColumns()},o.prototype.getAllDisplayedVirtualColumns=function(){return this.columnModel.getViewportColumns()},o.prototype.moveColumn=function(t,e){this.columnModel.moveColumn(t,e,"api")},o.prototype.moveColumnByIndex=function(t,e){this.columnModel.moveColumnByIndex(t,e,"api")},o.prototype.moveColumns=function(t,e){this.columnModel.moveColumns(t,e,"api")},o.prototype.moveRowGroupColumn=function(t,e){this.columnModel.moveRowGroupColumn(t,e)},o.prototype.setColumnAggFunc=function(t,e){this.columnModel.setColumnAggFunc(t,e)},o.prototype.setColumnWidth=function(t,e,r,i){void 0===r&&(r=!0),this.columnModel.setColumnWidths([{key:t,newWidth:e}],!1,r,i)},o.prototype.setColumnWidths=function(t,e,r){void 0===e&&(e=!0),this.columnModel.setColumnWidths(t,!1,e,r)},o.prototype.setPivotMode=function(t){this.columnModel.setPivotMode(t)},o.prototype.isPivotMode=function(){return this.columnModel.isPivotMode()},o.prototype.getPivotResultColumn=function(t,e){return this.columnModel.getSecondaryPivotColumn(t,e)},o.prototype.setValueColumns=function(t){this.columnModel.setValueColumns(t,"api")},o.prototype.getValueColumns=function(){return this.columnModel.getValueColumns()},o.prototype.removeValueColumn=function(t){this.columnModel.removeValueColumn(t,"api")},o.prototype.removeValueColumns=function(t){this.columnModel.removeValueColumns(t,"api")},o.prototype.addValueColumn=function(t){this.columnModel.addValueColumn(t,"api")},o.prototype.addValueColumns=function(t){this.columnModel.addValueColumns(t,"api")},o.prototype.setRowGroupColumns=function(t){this.columnModel.setRowGroupColumns(t,"api")},o.prototype.removeRowGroupColumn=function(t){this.columnModel.removeRowGroupColumn(t,"api")},o.prototype.removeRowGroupColumns=function(t){this.columnModel.removeRowGroupColumns(t,"api")},o.prototype.addRowGroupColumn=function(t){this.columnModel.addRowGroupColumn(t,"api")},o.prototype.addRowGroupColumns=function(t){this.columnModel.addRowGroupColumns(t,"api")},o.prototype.getRowGroupColumns=function(){return this.columnModel.getRowGroupColumns()},o.prototype.setPivotColumns=function(t){this.columnModel.setPivotColumns(t,"api")},o.prototype.removePivotColumn=function(t){this.columnModel.removePivotColumn(t,"api")},o.prototype.removePivotColumns=function(t){this.columnModel.removePivotColumns(t,"api")},o.prototype.addPivotColumn=function(t){this.columnModel.addPivotColumn(t,"api")},o.prototype.addPivotColumns=function(t){this.columnModel.addPivotColumns(t,"api")},o.prototype.getPivotColumns=function(){return this.columnModel.getPivotColumns()},o.prototype.getLeftDisplayedColumnGroups=function(){return this.columnModel.getDisplayedTreeLeft()},o.prototype.getCenterDisplayedColumnGroups=function(){return this.columnModel.getDisplayedTreeCentre()},o.prototype.getRightDisplayedColumnGroups=function(){return this.columnModel.getDisplayedTreeRight()},o.prototype.getAllDisplayedColumnGroups=function(){return this.columnModel.getAllDisplayedTrees()},o.prototype.autoSizeColumn=function(t,e){return this.columnModel.autoSizeColumn(t,e,"api")},o.prototype.autoSizeColumns=function(t,e){this.columnModel.autoSizeColumns({columns:t,skipHeader:e})},o.prototype.autoSizeAllColumns=function(t){this.columnModel.autoSizeAllColumns(t,"api")},o.prototype.setPivotResultColumns=function(t){this.columnModel.setSecondaryColumns(t,"api")},o.prototype.getPivotResultColumns=function(){return this.columnModel.getSecondaryColumns()},o.prototype.cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid=function(){setTimeout(rt.removeAllReferences.bind(window,this,"Column API"),100)},o.prototype.getAllColumns=function(){return Vt("28.0","getAllColumns","getColumns"),this.getColumns()},o.prototype.getOriginalColumnGroup=function(t){return Vt("27.0","getOriginalColumnGroup","getProvidedColumnGroup"),this.columnModel.getProvidedColumnGroup(t)},o.prototype.getPrimaryColumns=function(){return Vt("28.0","getPrimaryColumns","getColumns"),this.getColumns()},o.prototype.getSecondaryColumns=function(){return Vt("28.0","getSecondaryColumns","getPivotResultColumns"),this.getPivotResultColumns()},o.prototype.setSecondaryColumns=function(t){Vt("28.0","setSecondaryColumns","setPivotResultColumns"),this.setPivotResultColumns(t)},o.prototype.getSecondaryPivotColumn=function(t,e){return Vt("28.0","getSecondaryPivotColumn","getPivotResultColumn"),this.getPivotResultColumn(t,e)},nf([D("columnModel")],o.prototype,"columnModel",void 0),nf([Mr],o.prototype,"cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid",null),o=nf([He("columnApi")],o)}(),sy=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),La=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},ay=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.initialised=!1,e}return sy(t,o),t.prototype.init=function(){var e=this;this.cellExpressions=this.gridOptionsService.is("enableCellExpressions"),this.isTreeData=this.gridOptionsService.is("treeData"),this.initialised=!0,this.eventService.addEventListener(I.EVENT_CELL_VALUE_CHANGED,function(r){return e.callColumnCellValueChangedHandler(r)},this.gridOptionsService.useAsyncEvents()),this.addManagedPropertyListener("treeData",function(r){return e.isTreeData=r.currentValue})},t.prototype.getValue=function(e,r,i,n){if(void 0===i&&(i=!1),void 0===n&&(n=!1),this.initialised||this.init(),r){var C,u=e.getColDef(),c=u.field,v=e.getColId(),m=r.data,_=r.groupData&&void 0!==r.groupData[v],O=!n&&r.aggData&&void 0!==r.aggData[v];if(i&&u.filterValueGetter?C=this.executeFilterValueGetter(u.filterValueGetter,m,e,r):this.isTreeData&&O?C=r.aggData[v]:this.isTreeData&&u.valueGetter?C=this.executeValueGetter(u.valueGetter,m,e,r):this.isTreeData&&c&&m?C=Za(m,c,e.isFieldContainsDots()):_?C=r.groupData[v]:O?C=r.aggData[v]:u.valueGetter?C=this.executeValueGetter(u.valueGetter,m,e,r):c&&m&&(C=Za(m,c,e.isFieldContainsDots())),this.cellExpressions&&"string"==typeof C&&0===C.indexOf("=")){var P=C.substring(1);C=this.executeValueGetter(P,m,e,r)}if(null==C){var L=this.getOpenedGroup(r,e);if(null!=L)return L}return C}},t.prototype.getOpenedGroup=function(e,r){if(this.gridOptionsService.is("showOpenedGroup")&&r.getColDef().showRowGroup)for(var n=r.getColDef().showRowGroup,u=e.parent;null!=u;){if(u.rowGroupColumn&&(!0===n||n===u.rowGroupColumn.getColId()))return u.key;u=u.parent}},t.prototype.setValue=function(e,r,i,n){var u=this.columnModel.getPrimaryColumn(r);if(!e||!u)return!1;Je(e.data)&&(e.data={});var c=u.getColDef(),v=c.field,m=c.valueSetter;if(Je(v)&&Je(m))return console.warn("AG Grid: you need either field or valueSetter set on colDef for editing to work"),!1;var _,C={node:e,data:e.data,oldValue:this.getValue(u,e),newValue:i,colDef:u.getColDef(),column:u,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};if(C.newValue=i,void 0===(_=me(m)?"function"==typeof m?m(C):this.expressionService.evaluate(m,C):this.setValueUsingField(e.data,v,i,u.isFieldContainsDots()))&&(_=!0),!_)return!1;e.resetQuickFilterAggregateText(),this.valueCache.onDataChanged(),C.newValue=this.getValue(u,e);var O={type:I.EVENT_CELL_VALUE_CHANGED,event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:C.column,api:C.api,columnApi:C.columnApi,colDef:C.colDef,context:C.context,data:e.data,node:e,oldValue:C.oldValue,newValue:C.newValue,value:C.newValue,source:n};return this.eventService.dispatchEvent(O),!0},t.prototype.callColumnCellValueChangedHandler=function(e){var r=e.colDef.onCellValueChanged;"function"==typeof r&&r({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,columnApi:e.columnApi,context:e.context})},t.prototype.setValueUsingField=function(e,r,i,n){if(!r)return!1;var u=!1;if(n)for(var c=r.split("."),v=e;c.length>0&&v;){var m=c.shift();0===c.length?(u=v[m]==i)||(v[m]=i):v=v[m]}else(u=e[r]==i)||(e[r]=i);return!u},t.prototype.executeFilterValueGetter=function(e,r,i,n){var u={data:r,node:n,column:i,colDef:i.getColDef(),api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,getValue:this.getValueCallback.bind(this,n)};return"function"==typeof e?e(u):this.expressionService.evaluate(e,u)},t.prototype.executeValueGetter=function(e,r,i,n){var u=i.getColId(),c=this.valueCache.getValue(n,u);if(void 0!==c)return c;var m,v={data:r,node:n,column:i,colDef:i.getColDef(),api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,getValue:this.getValueCallback.bind(this,n)};return m="function"==typeof e?e(v):this.expressionService.evaluate(e,v),this.valueCache.setValue(n,u,m),m},t.prototype.getValueCallback=function(e,r){var i=this.columnModel.getPrimaryColumn(r);return i?this.getValue(i,e):null},t.prototype.getKeyForNode=function(e,r){var i=this.getValue(e,r),n=e.getColDef().keyCreator,u=i;n&&(u=n({value:i,colDef:e.getColDef(),column:e,node:r,data:r.data,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}));return"string"==typeof u||null==u||"[object Object]"===(u=String(u))&&_t(function(){console.warn("AG Grid: a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (se AG Grid docs) or b) to toString() on the object to return a key")},"getKeyForNode - warn about [object,object]"),u},La([D("expressionService")],t.prototype,"expressionService",void 0),La([D("columnModel")],t.prototype,"columnModel",void 0),La([D("valueCache")],t.prototype,"valueCache",void 0),La([Re],t.prototype,"init",null),t=La([He("valueService")],t)}(we),ly=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Md=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},uy=function(o,t){return function(e,r){t(e,r,o)}},cy=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.expressionToFunctionCache={},e}return ly(t,o),t.prototype.setBeans=function(e){this.logger=e.create("ExpressionService")},t.prototype.evaluate=function(e,r){if("string"==typeof e)return this.evaluateExpression(e,r);console.error("AG Grid: value should be either a string or a function",e)},t.prototype.evaluateExpression=function(e,r){try{return this.createExpressionFunction(e)(r.value,r.context,r.oldValue,r.newValue,r.value,r.node,r.data,r.colDef,r.rowIndex,r.api,r.columnApi,r.getValue,r.column,r.columnGroup)}catch(u){return console.log("Processing of the expression failed"),console.log("Expression = "+e),console.log("Params =",r),console.log("Exception = "+u),null}},t.prototype.createExpressionFunction=function(e){if(this.expressionToFunctionCache[e])return this.expressionToFunctionCache[e];var r=this.createFunctionBody(e),i=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, columnApi, getValue, column, columnGroup",r);return this.expressionToFunctionCache[e]=i,i},t.prototype.createFunctionBody=function(e){return e.indexOf("return")>=0?e:"return "+e+";"},Md([uy(0,Zr("loggerFactory"))],t.prototype,"setBeans",null),t=Md([He("expressionService")],t)}(we),fy=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),dy=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.templateCache={},e.waitingCallbacks={},e}return fy(t,o),t.prototype.getTemplate=function(e,r){var i=this.templateCache[e];if(i)return i;var n=this.waitingCallbacks[e],u=this;if(!n){n=[],this.waitingCallbacks[e]=n;var c=new XMLHttpRequest;c.onload=function(){u.handleHttpResult(this,e)},c.open("GET",e),c.send()}return r&&n.push(r),null},t.prototype.handleHttpResult=function(e,r){if(200===e.status&&null!==e.response){this.templateCache[r]=e.response||e.responseText;for(var i=this.waitingCallbacks[r],n=0;n<i.length;n++){(0,i[n])()}}else console.warn("AG Grid: Unable to get template error "+e.status+" - "+r)},t=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n}([He("templateService")],t),t}(we),hy=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Nd=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},vy=function(o,t){return function(e,r){t(e,r,o)}},gy=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return hy(t,o),t.prototype.setBeans=function(e){this.logging=e.is("debug")},t.prototype.create=function(e){return new of(e,this.isLogging.bind(this))},t.prototype.isLogging=function(){return this.logging},Nd([vy(0,Zr("gridOptionsService"))],t.prototype,"setBeans",null),t=Nd([He("loggerFactory")],t)}(we),of=function(){function o(t,e){this.name=t,this.isLoggingFunc=e}return o.prototype.isLogging=function(){return this.isLoggingFunc()},o.prototype.log=function(t){this.isLoggingFunc()&&console.log("AG Grid."+this.name+": "+t)},o}(),my=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),bs=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},yy=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return my(t,o),t.prototype.setComp=function(e,r,i){var n=this;this.view=e,this.eGridHostDiv=r,this.eGui=i,this.dragAndDropService.addDropTarget({getContainer:function(){return n.eGui},isInterestedIn:function(c){return c===ni.HeaderCell||c===ni.ToolPanel},getIconName:function(){return Vr.ICON_NOT_ALLOWED}}),this.mouseEventService.stampTopLevelGridCompWithGridInstance(r),this.createManagedBean(new Hl(this.view)),this.addRtlSupport(),this.addManagedListener(this,I.EVENT_KEYBOARD_FOCUS,function(){n.view.addOrRemoveKeyboardFocusClass(!0)}),this.addManagedListener(this,I.EVENT_MOUSE_FOCUS,function(){n.view.addOrRemoveKeyboardFocusClass(!1)});var u=this.resizeObserverService.observeResize(this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(function(){return u()}),this.ctrlsService.registerGridCtrl(this)},t.prototype.isDetailGrid=function(){var e;return(null===(e=this.focusService.findTabbableParent(this.getGui())?.getAttribute("row-id"))||void 0===e?void 0:e.startsWith("detail"))||!1},t.prototype.showDropZones=function(){return it.isRegistered(Ne.RowGroupingModule)},t.prototype.showSideBar=function(){return it.isRegistered(Ne.SideBarModule)},t.prototype.showStatusBar=function(){return it.isRegistered(Ne.StatusBarModule)},t.prototype.showWatermark=function(){return it.isRegistered(Ne.EnterpriseCoreModule)},t.prototype.onGridSizeChanged=function(){var e={type:I.EVENT_GRID_SIZE_CHANGED,clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight};this.eventService.dispatchEvent(e)},t.prototype.addRtlSupport=function(){var e=this.gridOptionsService.is("enableRtl")?"ag-rtl":"ag-ltr";this.view.setRtlClass(e)},t.prototype.destroyGridUi=function(){this.view.destroyGridUi()},t.prototype.getGui=function(){return this.eGui},t.prototype.setResizeCursor=function(e){this.view.setCursor(e?"ew-resize":null)},t.prototype.disableUserSelect=function(e){this.view.setUserSelect(e?"none":null)},t.prototype.focusNextInnerContainer=function(e){var r=this.gridOptionsService.getDocument(),i=this.view.getFocusableContainers(),u=i.findIndex(function(c){return c.contains(r.activeElement)})+(e?-1:1);return!(u<=0||u>=i.length)&&this.focusService.focusInto(i[u])},t.prototype.focusInnerElement=function(e){var r=this.view.getFocusableContainers(),i=this.columnModel.getAllDisplayedColumns();if(e){if(r.length>1)return this.focusService.focusInto(Mt(r),!0);var n=Mt(i);if(this.focusService.focusGridView(n,!0))return!0}return 0===this.gridOptionsService.getNum("headerHeight")?this.focusService.focusGridView(i[0]):this.focusService.focusFirstHeader()},t.prototype.forceFocusOutOfContainer=function(e){void 0===e&&(e=!1),this.view.forceFocusOutOfContainer(e)},bs([D("focusService")],t.prototype,"focusService",void 0),bs([D("resizeObserverService")],t.prototype,"resizeObserverService",void 0),bs([D("columnModel")],t.prototype,"columnModel",void 0),bs([D("ctrlsService")],t.prototype,"ctrlsService",void 0),bs([D("mouseEventService")],t.prototype,"mouseEventService",void 0),bs([D("dragAndDropService")],t.prototype,"dragAndDropService",void 0),t}(we),Cy=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ma=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},wy=function(o){function t(e){var r=o.call(this)||this;return r.eGridDiv=e,r}return Cy(t,o),t.prototype.postConstruct=function(){var e=this;this.logger=this.loggerFactory.create("GridComp");var r={destroyGridUi:function(){return e.destroyBean(e)},setRtlClass:function(n){return e.addCssClass(n)},addOrRemoveKeyboardFocusClass:function(n){return e.addOrRemoveCssClass(ba.AG_KEYBOARD_FOCUS,n)},forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:function(n){e.getGui().style.userSelect=n??"",e.getGui().style.webkitUserSelect=n??""},setCursor:function(n){e.getGui().style.cursor=n??""}};this.ctrl=this.createManagedBean(new yy);var i=this.createTemplate();this.setTemplate(i),this.ctrl.setComp(r,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:function(){},focusInnerElement:function(n){return e.ctrl.focusInnerElement(n)}})},t.prototype.insertGridIntoDom=function(){var e=this,r=this.getGui();this.eGridDiv.appendChild(r),this.addDestroyFunc(function(){e.eGridDiv.removeChild(r),e.logger.log("Grid removed from DOM")})},t.prototype.updateLayoutClasses=function(e,r){var i=this.eRootWrapperBody.classList;i.toggle(yr.AUTO_HEIGHT,r.autoHeight),i.toggle(yr.NORMAL,r.normal),i.toggle(yr.PRINT,r.print),this.addOrRemoveCssClass(yr.AUTO_HEIGHT,r.autoHeight),this.addOrRemoveCssClass(yr.NORMAL,r.normal),this.addOrRemoveCssClass(yr.PRINT,r.print)},t.prototype.createTemplate=function(){return'<div class="ag-root-wrapper" role="presentation">\n                '+(this.ctrl.showDropZones()?"<ag-grid-header-drop-zones></ag-grid-header-drop-zones>":"")+'\n                <div class="ag-root-wrapper-body" ref="rootWrapperBody" role="presentation">\n                    <ag-grid-body ref="gridBody"></ag-grid-body>\n                    '+(this.ctrl.showSideBar()?'<ag-side-bar ref="sideBar"></ag-side-bar>':"")+"\n                </div>\n                "+(this.ctrl.showStatusBar()?'<ag-status-bar ref="statusBar"></ag-status-bar>':"")+"\n                <ag-pagination></ag-pagination>\n                "+(this.ctrl.showWatermark()?"<ag-watermark></ag-watermark>":"")+"\n            </div>"},t.prototype.getFocusableElement=function(){return this.eRootWrapperBody},t.prototype.getFocusableContainers=function(){var e=[this.gridBodyComp.getGui()];return this.sideBarComp&&e.push(this.sideBarComp.getGui()),e.filter(function(r){return ls(r)})},Ma([D("loggerFactory")],t.prototype,"loggerFactory",void 0),Ma([Te("gridBody")],t.prototype,"gridBodyComp",void 0),Ma([Te("sideBar")],t.prototype,"sideBarComp",void 0),Ma([Te("rootWrapperBody")],t.prototype,"eRootWrapperBody",void 0),Ma([Re],t.prototype,"postConstruct",null),t}(lu),Sy=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),kd=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Na=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},ka=function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(Na(arguments[t]));return o},_y=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}var e;return Sy(t,o),e=t,t.prototype.progressSort=function(r,i,n){var u=this.getNextSortDirection(r);this.setSortForColumn(r,u,i,n)},t.prototype.setSortForColumn=function(r,i,n,u){"asc"!==i&&"desc"!==i&&(i=null);var v=[r];if(this.gridOptionsService.isColumnsSortingCoupledToGroup()&&r.getColDef().showRowGroup){r.getColDef().field||(v=[]);var C=this.columnModel.getSourceColumnsForGroupColumn(r)?.filter(function(O){return O.getColDef().sortable});C&&(v=ka(v,C))}v.forEach(function(O){return O.setSort(i,u)}),(n||this.gridOptionsService.is("alwaysMultiSort"))&&!this.gridOptionsService.is("suppressMultiSort")||this.clearSortBarTheseColumns(v,u),this.updateSortIndex(r),this.dispatchSortChangedEvents(u)},t.prototype.updateSortIndex=function(r){var i=this.gridOptionsService.isColumnsSortingCoupledToGroup(),n=this.columnModel.getGroupDisplayColumnForGroup(r.getId()),u=i&&n||r,c=this.getColumnsWithSortingOrdered(!0);this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach(function(C){return C.setSortIndex(null)});var v=c.filter(function(C){return C!==u});(u.getSort()?ka(v,[u]):v).forEach(function(C,_){return C.setSortIndex(_)})},t.prototype.onSortChanged=function(r){this.dispatchSortChangedEvents(r)},t.prototype.isSortActive=function(){var i=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter(function(n){return!!n.getSort()});return i&&i.length>0},t.prototype.dispatchSortChangedEvents=function(r){var i={type:I.EVENT_SORT_CHANGED,source:r};this.eventService.dispatchEvent(i)},t.prototype.clearSortBarTheseColumns=function(r,i){this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach(function(n){r.includes(n)||n.setSort(void 0,i)})},t.prototype.getNextSortDirection=function(r){var i;if(i=r.getColDef().sortingOrder?r.getColDef().sortingOrder:this.gridOptionsService.get("sortingOrder")?this.gridOptionsService.get("sortingOrder"):e.DEFAULT_SORTING_ORDER,!Array.isArray(i)||i.length<=0)return console.warn("AG Grid: sortingOrder must be an array with at least one element, currently it's "+i),null;var n=r.getColDef().field?r.getSort():this.getDisplaySortForColumn(r),u=i[0];if("mixed"!==n){var c=i.indexOf(n),v=c<0,m=c==i.length-1;u=v||m?i[0]:i[c+1]}return e.DEFAULT_SORTING_ORDER.indexOf(u)<0?(console.warn("AG Grid: invalid sort type "+u),null):u},t.prototype.getIndexedSortMap=function(r){var i=this;void 0===r&&(r=!1);var n=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter(function(C){return!!C.getSort()});!r&&this.columnModel.isPivotMode()&&(n=n.filter(function(C){return!!C.getAggFunc()||!C.isPrimary()||i.columnModel.getGroupDisplayColumnForGroup(C.getId())}));var u=this.columnModel.getRowGroupColumns().filter(function(C){return!!C.getSort()}),c=this.gridOptionsService.isColumnsSortingCoupledToGroup()&&!!u.length;c&&(n=ka(new Set(n.map(function(C){var _;return null!==(_=i.columnModel.getGroupDisplayColumnForGroup(C.getId()))&&void 0!==_?_:C}))));var v={};n.forEach(function(C,_){return v[C.getId()]=_}),n.sort(function(C,_){var O=C.getSortIndex(),P=_.getSortIndex();return null!=O&&null!=P?O-P:null==O&&null==P?v[C.getId()]>v[_.getId()]?1:-1:null==P?-1:1});var m=new Map;return n.forEach(function(C,_){return m.set(C,_)}),c&&u.forEach(function(C){var _=i.columnModel.getGroupDisplayColumnForGroup(C.getId());m.set(C,m.get(_))}),m},t.prototype.getColumnsWithSortingOrdered=function(r){return void 0===r&&(r=!1),ka(this.getIndexedSortMap(r).entries()).sort(function(i,n){var u=Na(i,2);u[0];var c=u[1],v=Na(n,2);return v[0],c-v[1]}).map(function(i){return Na(i,1)[0]})},t.prototype.getSortModel=function(){return this.getColumnsWithSortingOrdered(!0).map(function(r){return{sort:r.getSort(),colId:r.getId()}})},t.prototype.getSortOptions=function(){return this.getColumnsWithSortingOrdered().map(function(r){return{sort:r.getSort(),column:r}})},t.prototype.canColumnDisplayMixedSort=function(r){var i=this.gridOptionsService.isColumnsSortingCoupledToGroup(),n=!!r.getColDef().showRowGroup;return i&&n},t.prototype.getDisplaySortForColumn=function(r){var i=this.columnModel.getSourceColumnsForGroupColumn(r);if(!this.canColumnDisplayMixedSort(r)||!i?.length)return r.getSort();var u=!!r.getColDef().field?ka([r],i):i,c=u[0].getSort();return u.every(function(m){return m.getSort()==c})?c:"mixed"},t.prototype.getDisplaySortIndexForColumn=function(r){return this.getIndexedSortMap().get(r)},t.DEFAULT_SORTING_ORDER=["asc","desc",null],kd([D("columnModel")],t.prototype,"columnModel",void 0),t=e=kd([He("sortController")],t)}(we),xy=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ry=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return xy(t,o),t.prototype.setMouseOver=function(e){this.selectedColumns=e;var r={type:I.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(r)},t.prototype.clearMouseOver=function(){this.selectedColumns=null;var e={type:I.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(e)},t.prototype.isHovered=function(e){return!!this.selectedColumns&&this.selectedColumns.indexOf(e)>=0},t=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n}([He("columnHoverService")],t),t}(we),Ty=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),sf=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Oy=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.executeNextFuncs=[],e.executeLaterFuncs=[],e.active=!1,e.animationThreadCount=0,e}return Ty(t,o),t.prototype.postConstruct=function(){var e=this;this.ctrlsService.whenReady(function(r){return e.gridBodyCtrl=r.gridBodyCtrl})},t.prototype.isActive=function(){return this.active},t.prototype.start=function(){this.active||this.gridOptionsService.is("suppressColumnMoveAnimation")||this.gridOptionsService.is("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0)},t.prototype.finish=function(){this.active&&(this.flush(),this.active=!1)},t.prototype.executeNextVMTurn=function(e){this.active?this.executeNextFuncs.push(e):e()},t.prototype.executeLaterVMTurn=function(e){this.active?this.executeLaterFuncs.push(e):e()},t.prototype.ensureAnimationCssClassPresent=function(){var e=this;this.animationThreadCount++;var r=this.animationThreadCount;this.gridBodyCtrl.setColumnMovingCss(!0),this.executeLaterFuncs.push(function(){e.animationThreadCount===r&&e.gridBodyCtrl.setColumnMovingCss(!1)})},t.prototype.flush=function(){var e=this.executeNextFuncs;this.executeNextFuncs=[];var r=this.executeLaterFuncs;this.executeLaterFuncs=[],(0!==e.length||0!==r.length)&&(window.setTimeout(function(){return e.forEach(function(i){return i()})},0),window.setTimeout(function(){return r.forEach(function(i){return i()})},300))},sf([D("ctrlsService")],t.prototype,"ctrlsService",void 0),sf([Re],t.prototype,"postConstruct",null),t=sf([He("columnAnimationService")],t)}(we),Ay=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),af=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Dy=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return Ay(t,o),t.prototype.postConstruct=function(){var e=this;this.ctrlsService.whenReady(function(r){e.centerRowContainerCon=r.centerRowContainerCtrl,e.addManagedListener(e.eventService,I.EVENT_BODY_HEIGHT_CHANGED,e.checkPageSize.bind(e)),e.addManagedListener(e.eventService,I.EVENT_SCROLL_VISIBILITY_CHANGED,e.checkPageSize.bind(e)),e.checkPageSize()})},t.prototype.notActive=function(){return!this.gridOptionsService.is("paginationAutoPageSize")||null==this.centerRowContainerCon},t.prototype.checkPageSize=function(){var e=this;if(!this.notActive()){var r=this.centerRowContainerCon.getViewportSizeFeature().getBodyHeight();if(r>0){var i=function(){var n=e.gridOptionsService.getRowHeightAsNumber(),u=Math.floor(r/n);e.gridOptionsService.set("paginationPageSize",u)};this.isBodyRendered?Jr(function(){return i()},50)():(i(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}},af([D("ctrlsService")],t.prototype,"ctrlsService",void 0),af([Re],t.prototype,"postConstruct",null),t=af([He("paginationAutoPageSizeService")],t)}(we),by=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Gd=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Fy=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.cacheVersion=0,e}return by(t,o),t.prototype.init=function(){this.active=this.gridOptionsService.is("valueCache"),this.neverExpires=this.gridOptionsService.is("valueCacheNeverExpires")},t.prototype.onDataChanged=function(){this.neverExpires||this.expire()},t.prototype.expire=function(){this.cacheVersion++},t.prototype.setValue=function(e,r,i){this.active&&(e.__cacheVersion!==this.cacheVersion&&(e.__cacheVersion=this.cacheVersion,e.__cacheData={}),e.__cacheData[r]=i)},t.prototype.getValue=function(e,r){if(this.active&&e.__cacheVersion===this.cacheVersion)return e.__cacheData[r]},Gd([Re],t.prototype,"init",null),t=Gd([He("valueCache")],t)}(we),Py=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),fu=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Ly=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return Py(t,o),t.prototype.init=function(){"clientSide"===this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel),this.addManagedListener(this.eventService,I.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged.bind(this))},t.prototype.onCellValueChanged=function(e){"paste"!==e.source&&this.doChangeDetection(e.node,e.column)},t.prototype.doChangeDetection=function(e,r){if(!this.gridOptionsService.is("suppressChangeDetection")){if(this.clientSideRowModel&&!e.isRowPinned()){var i=this.gridOptionsService.is("aggregateOnlyChangedColumns"),n=new Xc(i,this.clientSideRowModel.getRootNode());n.addParentNode(e.parent,[r]),this.clientSideRowModel.doAggregate(n)}this.rowRenderer.refreshCells()}},fu([D("rowModel")],t.prototype,"rowModel",void 0),fu([D("rowRenderer")],t.prototype,"rowRenderer",void 0),fu([Re],t.prototype,"init",null),t=fu([He("changeDetectionService")],t)}(we),hw=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Hd=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},My=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return hw(t,o),t.prototype.adaptFunction=function(e,r){var i=this.componentMetadataProvider.retrieve(e);return i&&i.functionAdapter?i.functionAdapter(r):null},t.prototype.adaptCellRendererFunction=function(e){return function(){function i(){}return i.prototype.refresh=function(n){return!1},i.prototype.getGui=function(){return this.eGui},i.prototype.init=function(n){var u=e(n),c=typeof u;this.eGui="string"!==c&&"number"!==c&&"boolean"!==c?null!=u?u:Sr("<span></span>"):Sr("<span>"+u+"</span>")},i}()},t.prototype.doesImplementIComponent=function(e){return!!e&&(e.prototype&&"getGui"in e.prototype)},Hd([D("componentMetadataProvider")],t.prototype,"componentMetadataProvider",void 0),t=Hd([He("agComponentUtils")],t)}(we),Ny=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),lf=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},ky=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return Ny(t,o),t.prototype.postConstruct=function(){this.componentMetaData={dateComponent:{mandatoryMethodList:["getDate","setDate"],optionalMethodList:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel"]},detailCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},headerComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},headerGroupComponent:{mandatoryMethodList:[],optionalMethodList:[]},loadingCellRenderer:{mandatoryMethodList:[],optionalMethodList:[]},loadingOverlayComponent:{mandatoryMethodList:[],optionalMethodList:[]},noRowsOverlayComponent:{mandatoryMethodList:[],optionalMethodList:[]},floatingFilterComponent:{mandatoryMethodList:["onParentModelChanged"],optionalMethodList:["afterGuiAttached"]},floatingFilterWrapperComponent:{mandatoryMethodList:[],optionalMethodList:[]},cellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},cellEditor:{mandatoryMethodList:["getValue"],optionalMethodList:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached"]},innerRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},fullWidthCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},groupRowRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},filter:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged"]},filterComponent:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged"]},statusPanel:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"]},toolPanel:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"]},tooltipComponent:{mandatoryMethodList:[],optionalMethodList:[]}}},t.prototype.retrieve=function(e){return this.componentMetaData[e]},lf([D("agComponentUtils")],t.prototype,"agComponentUtils",void 0),lf([Re],t.prototype,"postConstruct",null),t=lf([He("componentMetadataProvider")],t)}(we),Gy=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),uf=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Hy=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},Vd={"ag-theme-custom":{headerHeight:25,headerCellMinWidth:24,listItemHeight:20,rowHeight:25,chartMenuPanelWidth:220},"ag-theme-material":{headerHeight:56,headerCellMinWidth:48,listItemHeight:32,rowHeight:48,chartMenuPanelWidth:240},"ag-theme-balham":{headerHeight:32,headerCellMinWidth:24,listItemHeight:24,rowHeight:28,chartMenuPanelWidth:220},"ag-theme-alpine":{headerHeight:48,headerCellMinWidth:36,listItemHeight:24,rowHeight:42,chartMenuPanelWidth:240}},Wd={headerHeight:["ag-header-row"],headerCellMinWidth:["ag-header-cell"],listItemHeight:["ag-virtual-list-item"],rowHeight:["ag-row"],chartMenuPanelWidth:["ag-chart-docked-container"]},Wy=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.calculatedSizes={},e}return Gy(t,o),t.prototype.postConstruct=function(){var r,e=this,i=null!==(r=this.getTheme().el)&&void 0!==r?r:this.eGridDiv;this.mutationObserver=new MutationObserver(function(){e.calculatedSizes={},e.fireGridStylesChangedEvent()}),this.mutationObserver.observe(i||this.eGridDiv,{attributes:!0,attributeFilter:["class"]})},t.prototype.fireGridStylesChangedEvent=function(){var e={type:I.EVENT_GRID_STYLES_CHANGED};this.eventService.dispatchEvent(e)},t.prototype.getSassVariable=function(e){var r=this.getTheme(),i=r.themeFamily,n=r.el;if(i&&0===i.indexOf("ag-theme"))return this.calculatedSizes||(this.calculatedSizes={}),this.calculatedSizes[i]||(this.calculatedSizes[i]={}),this.calculatedSizes[i][e]??(this.calculatedSizes[i][e]=this.calculateValueForSassProperty(e,i,n),this.calculatedSizes[i][e])},t.prototype.calculateValueForSassProperty=function(e,r,i){var n,u="ag-theme-"+(r.match("material")?"material":r.match("balham")?"balham":r.match("alpine")?"alpine":"custom"),c=Vd[u][e],v=this.gridOptionsService.getDocument();if(i||(i=this.eGridDiv),!Wd[e])return c;var m=Wd[e],C=v.createElement("div"),_=Array.from(i.classList);(n=C.classList).add.apply(n,function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(Hy(arguments[t]));return o}([r],_)),C.style.position="absolute";var O=m.reduce(function(z,q){var Z=v.createElement("div");return Z.style.position="static",Z.classList.add(q),z.appendChild(Z),Z},C),P=0;if(v.body){v.body.appendChild(C);var L=-1!==e.toLowerCase().indexOf("height")?"height":"width";P=parseInt(window.getComputedStyle(O)[L],10),v.body.removeChild(C)}return P||c},t.prototype.isThemeDark=function(){var e=this.getTheme().theme;return!!e&&e.indexOf("dark")>=0},t.prototype.chartMenuPanelWidth=function(){return this.getSassVariable("chartMenuPanelWidth")},t.prototype.getTheme=function(){for(var e=/\bag-(material|(?:theme-([\w\-]*)))\b/g,r=this.eGridDiv,i=null,n=[];r;){if(i=e.exec(r.className)){var u=r.className.match(e);u&&(n=u);break}r=r.parentElement||void 0}if(!i)return{allThemes:n};var c=i[0];return{theme:c,el:r,themeFamily:c.replace(/-dark$/,""),allThemes:n}},t.prototype.getFromTheme=function(e,r){var i;return null!==(i=this.getSassVariable(r))&&void 0!==i?i:e},t.prototype.getDefaultRowHeight=function(){return this.getFromTheme(25,"rowHeight")},t.prototype.getListItemHeight=function(){return this.getFromTheme(20,"listItemHeight")},t.prototype.setRowHeightVariable=function(e){var i=e+"px";this.eGridDiv.style.getPropertyValue("--ag-line-height").trim()!=i&&this.eGridDiv.style.setProperty("--ag-line-height",i)},t.prototype.getMinColWidth=function(){var e=this.getFromTheme(null,"headerCellMinWidth");return me(e)?Math.max(e,10):10},t.prototype.destroy=function(){this.calculatedSizes=null,this.mutationObserver&&this.mutationObserver.disconnect(),o.prototype.destroy.call(this)},uf([D("eGridDiv")],t.prototype,"eGridDiv",void 0),uf([Re],t.prototype,"postConstruct",null),t=uf([He("environment")],t)}(we),Ud=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),hu=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},jd=function(o,t){return function(e,r){t(e,r,o)}},Uy=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.scrollY=0,e.uiBodyHeight=0,e}return Ud(t,o),t.prototype.agWire=function(e){this.logger=e.create("RowContainerHeightService")},t.prototype.postConstruct=function(){this.addManagedListener(this.eventService,I.EVENT_BODY_HEIGHT_CHANGED,this.updateOffset.bind(this)),this.maxDivHeight=sn(),this.logger.log("maxDivHeight = "+this.maxDivHeight)},t.prototype.isStretching=function(){return this.stretching},t.prototype.getDivStretchOffset=function(){return this.divStretchOffset},t.prototype.updateOffset=function(){if(this.stretching){var r=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition().top,i=this.getUiBodyHeight();(r!==this.scrollY||i!==this.uiBodyHeight)&&(this.scrollY=r,this.uiBodyHeight=i,this.calculateOffset())}},t.prototype.calculateOffset=function(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;var e=this.scrollY/this.maxScrollY,r=e*this.pixelsToShave;this.logger.log("Div Stretch Offset = "+r+" ("+this.pixelsToShave+" * "+e+")"),this.setDivStretchOffset(r)},t.prototype.setUiContainerHeight=function(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventService.dispatchEvent({type:I.EVENT_ROW_CONTAINER_HEIGHT_CHANGED}))},t.prototype.clearOffset=function(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)},t.prototype.setDivStretchOffset=function(e){var r="number"==typeof e?Math.floor(e):null;this.divStretchOffset!==r&&(this.divStretchOffset=r,this.eventService.dispatchEvent({type:I.EVENT_HEIGHT_SCALE_CHANGED}))},t.prototype.setModelHeight=function(e){this.modelHeight=e,this.stretching=null!=e&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()},t.prototype.getUiContainerHeight=function(){return this.uiContainerHeight},t.prototype.getRealPixelPosition=function(e){return e-this.divStretchOffset},t.prototype.getUiBodyHeight=function(){var r=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition();return r.bottom-r.top},t.prototype.getScrollPositionForPixel=function(e){if(this.pixelsToShave<=0)return e;var i=e/(this.modelHeight-this.getUiBodyHeight());return this.maxScrollY*i},hu([D("ctrlsService")],t.prototype,"ctrlsService",void 0),hu([jd(0,Zr("loggerFactory"))],t.prototype,"agWire",null),hu([Re],t.prototype,"postConstruct",null),t=hu([He("rowContainerHeightService")],t)}(we),jy=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),pf=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},zy=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return jy(t,o),t.prototype.init=function(){this.groupSelectsChildren=this.gridOptionsService.is("groupSelectsChildren"),this.isRowSelectableFunc=this.gridOptionsService.get("isRowSelectable")},t.prototype.updateSelectableAfterGrouping=function(e){if(this.isRowSelectableFunc){this.recurseDown(e.childrenAfterGroup,function(i){return i.childrenAfterGroup})}},t.prototype.recurseDown=function(e,r){var i=this;e&&e.forEach(function(n){if(n.group){var u;if(n.hasChildren()&&i.recurseDown(r(n),r),i.groupSelectsChildren)u=me((r(n)||[]).find(function(v){return!0===v.selectable}));else u=!!i.isRowSelectableFunc&&i.isRowSelectableFunc(n);n.setRowSelectable(u)}})},pf([Re],t.prototype,"init",null),t=pf([He("selectableService")],t)}(we),Ky=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Mi=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},$y=function(o){function t(){var e=o.call(this)||this;return e.previousAndFirstButtonsDisabled=!1,e.nextButtonDisabled=!1,e.lastButtonDisabled=!1,e.areListenersSetup=!1,e}return Ky(t,o),t.prototype.postConstruct=function(){var e=this.gridOptionsService.is("enableRtl");this.setTemplate(this.getTemplate()),this.btFirst.insertAdjacentElement("afterbegin",pr(e?"last":"first",this.gridOptionsService)),this.btPrevious.insertAdjacentElement("afterbegin",pr(e?"next":"previous",this.gridOptionsService)),this.btNext.insertAdjacentElement("afterbegin",pr(e?"previous":"next",this.gridOptionsService)),this.btLast.insertAdjacentElement("afterbegin",pr(e?"first":"last",this.gridOptionsService)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.onPaginationChanged()},t.prototype.onPaginationChanged=function(){var r=this.gridOptionsService.is("pagination")&&!this.gridOptionsService.is("suppressPaginationPanel");this.setDisplayed(r),r&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateRowLabels(),this.setCurrentPageLabel(),this.setTotalLabels())},t.prototype.setupListeners=function(){var e=this;this.areListenersSetup||(this.addManagedListener(this.eventService,I.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach(function(r){var i=r.el,n=r.fn;e.addManagedListener(i,"click",n),e.addManagedListener(i,"keydown",function(u){(u.key===ve.ENTER||u.key===ve.SPACE)&&(u.preventDefault(),n())})}),this.areListenersSetup=!0)},t.prototype.onBtFirst=function(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToFirstPage()},t.prototype.setCurrentPageLabel=function(){var e=this.paginationProxy.getTotalPages()>0,r=this.paginationProxy.getCurrentPage(),i=e?r+1:0;this.lbCurrent.innerHTML=this.formatNumber(i)},t.prototype.formatNumber=function(e){var r=this.gridOptionsService.getCallback("paginationNumberFormatter");if(r)return r({value:e});var n=this.localeService.getLocaleTextFunc();return Er(e,n("thousandSeparator",","),n("decimalSeparator","."))},t.prototype.getTemplate=function(){var e=this.localeService.getLocaleTextFunc(),r=e("page","Page"),i=e("to","to"),n=e("of","of"),u=e("firstPage","First Page"),c=e("previousPage","Previous Page"),v=e("nextPage","Next Page"),m=e("lastPage","Last Page"),C=this.getCompId();return'<div class="ag-paging-panel ag-unselectable" id="ag-'+C+'">\n                <span class="ag-paging-row-summary-panel" role="status">\n                    <span id="ag-'+C+'-first-row" ref="lbFirstRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-'+C+'-to">'+i+'</span>\n                    <span id="ag-'+C+'-last-row" ref="lbLastRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-'+C+'-of">'+n+'</span>\n                    <span id="ag-'+C+'-row-count" ref="lbRecordCount" class="ag-paging-row-summary-panel-number"></span>\n                </span>\n                <span class="ag-paging-page-summary-panel" role="presentation">\n                    <div ref="btFirst" class="ag-paging-button" role="button" aria-label="'+u+'"></div>\n                    <div ref="btPrevious" class="ag-paging-button" role="button" aria-label="'+c+'"></div>\n                    <span class="ag-paging-description" role="status">\n                        <span id="ag-'+C+'-start-page">'+r+'</span>\n                        <span id="ag-'+C+'-start-page-number" ref="lbCurrent" class="ag-paging-number"></span>\n                        <span id="ag-'+C+'-of-page">'+n+'</span>\n                        <span id="ag-'+C+'-of-page-number" ref="lbTotal" class="ag-paging-number"></span>\n                    </span>\n                    <div ref="btNext" class="ag-paging-button" role="button" aria-label="'+v+'"></div>\n                    <div ref="btLast" class="ag-paging-button" role="button" aria-label="'+m+'"></div>\n                </span>\n            </div>'},t.prototype.onBtNext=function(){this.nextButtonDisabled||this.paginationProxy.goToNextPage()},t.prototype.onBtPrevious=function(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToPreviousPage()},t.prototype.onBtLast=function(){this.lastButtonDisabled||this.paginationProxy.goToLastPage()},t.prototype.enableOrDisableButtons=function(){var e=this.paginationProxy.getCurrentPage(),r=this.paginationProxy.isLastPageFound(),i=this.paginationProxy.getTotalPages();this.previousAndFirstButtonsDisabled=0===e,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);var n=this.isZeroPagesToDisplay(),u=r&&e===i-1;this.nextButtonDisabled=u||n,this.lastButtonDisabled=!r||n||e===i-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)},t.prototype.toggleButtonDisabled=function(e,r){Ae(e,r),e.classList.toggle("ag-disabled",r),r?e.removeAttribute("tabindex"):e.setAttribute("tabindex","0")},t.prototype.updateRowLabels=function(){var u,c,e=this.paginationProxy.getCurrentPage(),r=this.paginationProxy.getPageSize(),i=this.paginationProxy.isLastPageFound(),n=this.paginationProxy.isLastPageFound()?this.paginationProxy.getMasterRowCount():null;if(this.isZeroPagesToDisplay()?u=c=0:(c=(u=r*e+1)+r-1,i&&c>n&&(c=n)),this.lbFirstRowOnPage.innerHTML=this.formatNumber(u),this.rowNodeBlockLoader.isLoading()){var v=this.localeService.getLocaleTextFunc();this.lbLastRowOnPage.innerHTML=v("pageLastRowUnknown","?")}else this.lbLastRowOnPage.innerHTML=this.formatNumber(c)},t.prototype.isZeroPagesToDisplay=function(){var e=this.paginationProxy.isLastPageFound(),r=this.paginationProxy.getTotalPages();return e&&0===r},t.prototype.setTotalLabels=function(){var e=this.paginationProxy.isLastPageFound(),r=this.paginationProxy.getTotalPages(),i=e?this.paginationProxy.getMasterRowCount():null;if(1===i){var n=this.paginationProxy.getRow(0);if(n&&n.group&&!(n.groupData||n.aggData))return void this.setTotalLabelsToZero()}if(e)this.lbTotal.innerHTML=this.formatNumber(r),this.lbRecordCount.innerHTML=this.formatNumber(i);else{var c=this.localeService.getLocaleTextFunc()("more","more");this.lbTotal.innerHTML=c,this.lbRecordCount.innerHTML=c}},t.prototype.setTotalLabelsToZero=function(){this.lbFirstRowOnPage.innerHTML=this.formatNumber(0),this.lbCurrent.innerHTML=this.formatNumber(0),this.lbLastRowOnPage.innerHTML=this.formatNumber(0),this.lbTotal.innerHTML=this.formatNumber(0),this.lbRecordCount.innerHTML=this.formatNumber(0)},Mi([D("paginationProxy")],t.prototype,"paginationProxy",void 0),Mi([D("rowNodeBlockLoader")],t.prototype,"rowNodeBlockLoader",void 0),Mi([Te("btFirst")],t.prototype,"btFirst",void 0),Mi([Te("btPrevious")],t.prototype,"btPrevious",void 0),Mi([Te("btNext")],t.prototype,"btNext",void 0),Mi([Te("btLast")],t.prototype,"btLast",void 0),Mi([Te("lbRecordCount")],t.prototype,"lbRecordCount",void 0),Mi([Te("lbFirstRowOnPage")],t.prototype,"lbFirstRowOnPage",void 0),Mi([Te("lbLastRowOnPage")],t.prototype,"lbLastRowOnPage",void 0),Mi([Te("lbCurrent")],t.prototype,"lbCurrent",void 0),Mi([Te("lbTotal")],t.prototype,"lbTotal",void 0),Mi([Re],t.prototype,"postConstruct",null),t}(Ue),Yy=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Fs=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n};!function(o){o[o.Loading=0]="Loading",o[o.NoRows=1]="NoRows"}(Ps||(Ps={}));var Xy=function(o){function t(){var e=o.call(this,t.TEMPLATE)||this;return e.inProgress=!1,e.destroyRequested=!1,e.manuallyDisplayed=!1,e}return Yy(t,o),t.prototype.updateLayoutClasses=function(e,r){var i=this.eOverlayWrapper.classList;i.toggle(yr.AUTO_HEIGHT,r.autoHeight),i.toggle(yr.NORMAL,r.normal),i.toggle(yr.PRINT,r.print)},t.prototype.postConstruct=function(){this.createManagedBean(new Hl(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.addManagedListener(this.eventService,I.EVENT_ROW_DATA_UPDATED,this.onRowDataUpdated.bind(this)),this.addManagedListener(this.eventService,I.EVENT_NEW_COLUMNS_LOADED,this.onNewColumnsLoaded.bind(this)),this.gridOptionsService.isRowModelType("clientSide")&&!this.gridOptionsService.get("rowData")&&this.showLoadingOverlay(),this.gridApi.registerOverlayWrapperComp(this)},t.prototype.setWrapperTypeClass=function(e){var r=this.eOverlayWrapper.classList;r.toggle("ag-overlay-loading-wrapper",e===Ps.Loading),r.toggle("ag-overlay-no-rows-wrapper",e===Ps.NoRows)},t.prototype.showLoadingOverlay=function(){if(!this.gridOptionsService.is("suppressLoadingOverlay")){var i=this.userComponentFactory.getLoadingOverlayCompDetails({}).newAgStackInstance();this.showOverlay(i,Ps.Loading)}},t.prototype.showNoRowsOverlay=function(){if(!this.gridOptionsService.is("suppressNoRowsOverlay")){var i=this.userComponentFactory.getNoRowsOverlayCompDetails({}).newAgStackInstance();this.showOverlay(i,Ps.NoRows)}},t.prototype.showOverlay=function(e,r){var i=this;this.inProgress||(this.setWrapperTypeClass(r),this.destroyActiveOverlay(),this.inProgress=!0,e&&e.then(function(n){i.inProgress=!1,i.eOverlayWrapper.appendChild(n.getGui()),i.activeOverlay=n,i.destroyRequested&&(i.destroyRequested=!1,i.destroyActiveOverlay())}),this.manuallyDisplayed=this.columnModel.isReady()&&!this.paginationProxy.isEmpty(),this.setDisplayed(!0,{skipAriaHidden:!0}))},t.prototype.destroyActiveOverlay=function(){this.inProgress?this.destroyRequested=!0:this.activeOverlay&&(this.activeOverlay=this.getContext().destroyBean(this.activeOverlay),Wt(this.eOverlayWrapper))},t.prototype.hideOverlay=function(){this.manuallyDisplayed=!1,this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})},t.prototype.destroy=function(){this.destroyActiveOverlay(),o.prototype.destroy.call(this)},t.prototype.showOrHideOverlay=function(){var e=this.paginationProxy.isEmpty(),r=this.gridOptionsService.is("suppressNoRowsOverlay");e&&!r?this.showNoRowsOverlay():this.hideOverlay()},t.prototype.onRowDataUpdated=function(){this.showOrHideOverlay()},t.prototype.onNewColumnsLoaded=function(){this.columnModel.isReady()&&!this.paginationProxy.isEmpty()&&!this.manuallyDisplayed&&this.hideOverlay()},t.TEMPLATE='\n        <div class="ag-overlay" aria-hidden="true">\n            <div class="ag-overlay-panel">\n                <div class="ag-overlay-wrapper" ref="eOverlayWrapper"></div>\n            </div>\n        </div>',Fs([D("userComponentFactory")],t.prototype,"userComponentFactory",void 0),Fs([D("paginationProxy")],t.prototype,"paginationProxy",void 0),Fs([D("gridApi")],t.prototype,"gridApi",void 0),Fs([D("columnModel")],t.prototype,"columnModel",void 0),Fs([Te("eOverlayWrapper")],t.prototype,"eOverlayWrapper",void 0),Fs([Re],t.prototype,"postConstruct",null),t}(Ue),qy=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),vu=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Qy=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return qy(t,o),t.prototype.getFirstRow=function(){var r,e=0;return this.pinnedRowModel.getPinnedTopRowCount()?r="top":this.rowModel.getRowCount()?(r=null,e=this.paginationProxy.getPageFirstRow()):this.pinnedRowModel.getPinnedBottomRowCount()&&(r="bottom"),void 0===r?null:{rowIndex:e,rowPinned:r}},t.prototype.getLastRow=function(){var e,r=null,i=this.pinnedRowModel.getPinnedBottomRowCount(),n=this.pinnedRowModel.getPinnedTopRowCount();return i?(r="bottom",e=i-1):this.rowModel.getRowCount()?(r=null,e=this.paginationProxy.getPageLastRow()):n&&(r="top",e=n-1),void 0===e?null:{rowIndex:e,rowPinned:r}},t.prototype.getRowNode=function(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[e.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[e.rowIndex];default:return this.rowModel.getRow(e.rowIndex)}},t.prototype.sameRow=function(e,r){return!e&&!r||!(e&&!r||!e&&r)&&(e.rowIndex===r.rowIndex&&e.rowPinned==r.rowPinned)},t.prototype.before=function(e,r){switch(e.rowPinned){case"top":if("top"!==r.rowPinned)return!0;break;case"bottom":if("bottom"!==r.rowPinned)return!1;break;default:if(me(r.rowPinned))return"top"!==r.rowPinned}return e.rowIndex<r.rowIndex},t.prototype.rowMax=function(e){var i,r=this;return e.forEach(function(n){(void 0===i||r.before(i,n))&&(i=n)}),i},t.prototype.rowMin=function(e){var i,r=this;return e.forEach(function(n){(void 0===i||r.before(n,i))&&(i=n)}),i},vu([D("rowModel")],t.prototype,"rowModel",void 0),vu([D("pinnedRowModel")],t.prototype,"pinnedRowModel",void 0),vu([D("paginationProxy")],t.prototype,"paginationProxy",void 0),t=vu([He("rowPositionUtils")],t)}(we),Jy=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),eC=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return Jy(t,o),t.prototype.createId=function(e){var r=e.rowIndex,i=e.rowPinned,n=e.column;return this.createIdFromValues({rowIndex:r,column:n,rowPinned:i})},t.prototype.createIdFromValues=function(e){return e.rowIndex+"."+(e.rowPinned??"null")+"."+e.column.getId()},t.prototype.equals=function(e,r){var i=e.column===r.column,n=e.rowPinned===r.rowPinned,u=e.rowIndex===r.rowIndex;return i&&n&&u},t=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n}([He("cellPositionUtils")],t),t}(we),tC=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ga=function o(t){this.cellValueChanges=t},df=function(o){function t(e,r,i,n){var u=o.call(this,e)||this;return u.initialRange=r,u.finalRange=i,u.ranges=n,u}return tC(t,o),t}(Ga),zd=function(){function o(t){this.actionStack=[],this.maxStackSize=t||o.DEFAULT_STACK_SIZE,this.actionStack=new Array(this.maxStackSize)}return o.prototype.pop=function(){return this.actionStack.pop()},o.prototype.push=function(t){t.cellValueChanges&&t.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(t))},o.prototype.clear=function(){this.actionStack=[]},o.prototype.getCurrentStackSize=function(){return this.actionStack.length},o.DEFAULT_STACK_SIZE=10,o}(),rC=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),gu=function(){return gu=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},gu.apply(this,arguments)},Cn=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},iC=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},oC=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.cellValueChanges=[],e.activeCellEdit=null,e.activeRowEdit=null,e.isPasting=!1,e.isRangeInAction=!1,e.onCellValueChanged=function(r){var i={column:r.column,rowIndex:r.rowIndex,rowPinned:r.rowPinned},n=null!==e.activeCellEdit&&e.cellPositionUtils.equals(e.activeCellEdit,i),u=null!==e.activeRowEdit&&e.rowPositionUtils.sameRow(e.activeRowEdit,i);if(n||u||e.isPasting||e.isRangeInAction){var v=r.rowPinned,m=r.rowIndex,C=r.column,_=r.oldValue,O=r.value,P={rowPinned:v,rowIndex:m,columnId:C.getColId(),newValue:O,oldValue:_};e.cellValueChanges.push(P)}},e.clearStacks=function(){e.undoStack.clear(),e.redoStack.clear()},e}return rC(t,o),t.prototype.init=function(){var e=this;if(this.gridOptionsService.is("undoRedoCellEditing")){var r=this.gridOptionsService.getNum("undoRedoCellEditingLimit");r<=0||(this.undoStack=new zd(r),this.redoStack=new zd(r),this.addRowEditingListeners(),this.addCellEditingListeners(),this.addPasteListeners(),this.addFillListeners(),this.addCellKeyListeners(),this.addManagedListener(this.eventService,I.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged),this.addManagedListener(this.eventService,I.EVENT_MODEL_UPDATED,function(i){i.keepUndoRedoStack||e.clearStacks()}),this.addManagedListener(this.eventService,I.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,I.EVENT_NEW_COLUMNS_LOADED,this.clearStacks),this.addManagedListener(this.eventService,I.EVENT_COLUMN_GROUP_OPENED,this.clearStacks),this.addManagedListener(this.eventService,I.EVENT_COLUMN_ROW_GROUP_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,I.EVENT_COLUMN_MOVED,this.clearStacks),this.addManagedListener(this.eventService,I.EVENT_COLUMN_PINNED,this.clearStacks),this.addManagedListener(this.eventService,I.EVENT_COLUMN_VISIBLE,this.clearStacks),this.addManagedListener(this.eventService,I.EVENT_ROW_DRAG_END,this.clearStacks),this.ctrlsService.whenReady(function(){e.gridBodyCtrl=e.ctrlsService.getGridBodyCtrl()}))}},t.prototype.getCurrentUndoStackSize=function(){return this.undoStack?this.undoStack.getCurrentStackSize():0},t.prototype.getCurrentRedoStackSize=function(){return this.redoStack?this.redoStack.getCurrentStackSize():0},t.prototype.undo=function(e){var r={type:I.EVENT_UNDO_STARTED,source:e};this.eventService.dispatchEvent(r);var i=this.undoRedo(this.undoStack,this.redoStack,"initialRange","oldValue","undo"),n={type:I.EVENT_UNDO_ENDED,source:e,operationPerformed:i};this.eventService.dispatchEvent(n)},t.prototype.redo=function(e){var r={type:I.EVENT_REDO_STARTED,source:e};this.eventService.dispatchEvent(r);var i=this.undoRedo(this.redoStack,this.undoStack,"finalRange","newValue","redo"),n={type:I.EVENT_REDO_ENDED,source:e,operationPerformed:i};this.eventService.dispatchEvent(n)},t.prototype.undoRedo=function(e,r,i,n,u){if(!e)return!1;var c=e.pop();return!(!c||!c.cellValueChanges)&&(this.processAction(c,function(v){return v[n]},u),c instanceof df?this.processRange(c.ranges||[c[i]]):this.processCell(c.cellValueChanges),r.push(c),!0)},t.prototype.processAction=function(e,r,i){var n=this;e.cellValueChanges.forEach(function(u){var c=u.rowIndex,v=u.rowPinned,m=u.columnId,C={rowIndex:c,rowPinned:v},_=n.getRowNode(C);_.displayed&&_.setDataValue(m,r(u),i)})},t.prototype.processRange=function(e){var i,r=this;this.rangeService.removeAllCellRanges(!0),e.forEach(function(n,u){if(n){var c=n.startRow,v=n.endRow;u===e.length-1&&(i={rowPinned:c.rowPinned,rowIndex:c.rowIndex,columnId:n.startColumn.getColId()},r.setLastFocusedCell(i));var m={rowStartIndex:c.rowIndex,rowStartPinned:c.rowPinned,rowEndIndex:v.rowIndex,rowEndPinned:v.rowPinned,columnStart:n.startColumn,columns:n.columns};r.rangeService.addCellRange(m)}})},t.prototype.processCell=function(e){var r=e[0],u={rowIndex:r.rowIndex,rowPinned:r.rowPinned},c=this.getRowNode(u),v={rowPinned:r.rowPinned,rowIndex:c.rowIndex,columnId:r.columnId};this.setLastFocusedCell(v,!!this.rangeService)},t.prototype.setLastFocusedCell=function(e,r){var i=e.rowIndex,n=e.columnId,u=e.rowPinned,c=this.gridBodyCtrl.getScrollFeature(),v=this.columnModel.getGridColumn(n);if(v){c.ensureIndexVisible(i),c.ensureColumnVisible(v);var m={rowIndex:i,column:v,rowPinned:u};this.focusService.setFocusedCell(gu(gu({},m),{forceBrowserFocus:!0})),r&&this.rangeService.setRangeToCell(m)}},t.prototype.addRowEditingListeners=function(){var e=this;this.addManagedListener(this.eventService,I.EVENT_ROW_EDITING_STARTED,function(r){e.activeRowEdit={rowIndex:r.rowIndex,rowPinned:r.rowPinned}}),this.addManagedListener(this.eventService,I.EVENT_ROW_EDITING_STOPPED,function(){var r=new Ga(e.cellValueChanges);e.pushActionsToUndoStack(r),e.activeRowEdit=null})},t.prototype.addCellEditingListeners=function(){var e=this;this.addManagedListener(this.eventService,I.EVENT_CELL_EDITING_STARTED,function(r){e.activeCellEdit={column:r.column,rowIndex:r.rowIndex,rowPinned:r.rowPinned}}),this.addManagedListener(this.eventService,I.EVENT_CELL_EDITING_STOPPED,function(r){if(e.activeCellEdit=null,r.valueChanged&&!e.activeRowEdit&&!e.isPasting&&!e.isRangeInAction){var n=new Ga(e.cellValueChanges);e.pushActionsToUndoStack(n)}})},t.prototype.addPasteListeners=function(){var e=this;this.addManagedListener(this.eventService,I.EVENT_PASTE_START,function(){e.isPasting=!0}),this.addManagedListener(this.eventService,I.EVENT_PASTE_END,function(){var r=new Ga(e.cellValueChanges);e.pushActionsToUndoStack(r),e.isPasting=!1})},t.prototype.addFillListeners=function(){var e=this;this.addManagedListener(this.eventService,I.EVENT_FILL_START,function(){e.isRangeInAction=!0}),this.addManagedListener(this.eventService,I.EVENT_FILL_END,function(r){var i=new df(e.cellValueChanges,r.initialRange,r.finalRange);e.pushActionsToUndoStack(i),e.isRangeInAction=!1})},t.prototype.addCellKeyListeners=function(){var e=this;this.addManagedListener(this.eventService,I.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,function(){e.isRangeInAction=!0}),this.addManagedListener(this.eventService,I.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,function(){var r;r=e.rangeService&&e.gridOptionsService.isEnableRangeSelection()?new df(e.cellValueChanges,void 0,void 0,function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(iC(arguments[t]));return o}(e.rangeService.getCellRanges())):new Ga(e.cellValueChanges),e.pushActionsToUndoStack(r),e.isRangeInAction=!1})},t.prototype.pushActionsToUndoStack=function(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()},t.prototype.getRowNode=function(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[e.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[e.rowIndex];default:return this.rowModel.getRow(e.rowIndex)}},Cn([D("focusService")],t.prototype,"focusService",void 0),Cn([D("ctrlsService")],t.prototype,"ctrlsService",void 0),Cn([D("rowModel")],t.prototype,"rowModel",void 0),Cn([D("pinnedRowModel")],t.prototype,"pinnedRowModel",void 0),Cn([D("cellPositionUtils")],t.prototype,"cellPositionUtils",void 0),Cn([D("rowPositionUtils")],t.prototype,"rowPositionUtils",void 0),Cn([D("columnModel")],t.prototype,"columnModel",void 0),Cn([Ft("rangeService")],t.prototype,"rangeService",void 0),Cn([Re],t.prototype,"init",null),t=Cn([He("undoRedoService")],t)}(we),sC=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),hf=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},vw=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return sC(t,o),t.prototype.findHeader=function(e,r){var i,n,u;if(e.column instanceof ti?(n="getDisplayedGroup"+r,i=this.columnModel[n](e.column)):(u="getDisplayedCol"+r,i=this.columnModel[u](e.column)),i){var c=e.headerRowIndex;if(this.getHeaderRowType(c)===Ur.COLUMN_GROUP){var m=i;if(m.isPadding()&&this.isAnyChildSpanningHeaderHeight(m)){var C=this.getColumnVisibleChild(m,c,r),_=C.nextFocusColumn,O=C.nextRow;_&&(i=_,c=O)}}return{column:i,headerRowIndex:c}}},t.prototype.isAnyChildSpanningHeaderHeight=function(e){return!!e&&e.getLeafColumns().some(function(r){return r.isSpanHeaderHeight()})},t.prototype.getColumnVisibleParent=function(e,r){var i=this.getHeaderRowType(r),n=i===Ur.FLOATING_FILTER,u=i===Ur.COLUMN,c=n?e:e.getParent(),v=r-1;if(u&&this.isAnyChildSpanningHeaderHeight(e.getParent())){for(;c&&c.isPadding();)c=c.getParent(),v--;v<0&&(c=e,v=r)}return{nextFocusColumn:c,nextRow:v}},t.prototype.getColumnVisibleChild=function(e,r,i){void 0===i&&(i="After");var u=e,c=r+1;if(this.getHeaderRowType(r)===Ur.COLUMN_GROUP){var v=e.getLeafColumns(),m="After"===i?v[0]:Mt(v);if(this.isAnyChildSpanningHeaderHeight(m.getParent())){u=m;for(var C=m.getParent();C&&C!==e;)C=C.getParent(),c++}else u=e.getDisplayedChildren()[0]}return{nextFocusColumn:u,nextRow:c}},t.prototype.getHeaderRowType=function(e){var r=this.ctrlsService.getHeaderRowContainerCtrl();if(r)return r.getRowType(e)},t.prototype.findColAtEdgeForHeaderRow=function(e,r){var i=this.columnModel.getAllDisplayedColumns(),n=i["start"===r?0:i.length-1];if(n){var c=this.ctrlsService.getHeaderRowContainerCtrl(n.getPinned()).getRowType(e);return c==Ur.COLUMN_GROUP?{headerRowIndex:e,column:this.columnModel.getColumnGroupAtLevel(n,e)}:{headerRowIndex:null==c?-1:e,column:n}}},hf([D("columnModel")],t.prototype,"columnModel",void 0),hf([D("ctrlsService")],t.prototype,"ctrlsService",void 0),t=hf([He("headerPositionUtils")],t)}(we),lC=function(){function o(){}return o.prototype.buildColumnDefs=function(t,e,r){var i=this,n=[],u={};return t.forEach(function(c){for(var m=!0,C=i.createDefFromColumn(c,e,r),_=c.getOriginalParent();_;){var O=null;if(_.isPadding())_=_.getOriginalParent();else{var P=u[_.getGroupId()];if(P){P.children.push(C),m=!1;break}(O=i.createDefFromGroup(_))&&(O.children=[C],u[O.groupId]=O,C=O,_=_.getOriginalParent())}}m&&n.push(C)}),n},o.prototype.createDefFromGroup=function(t){var e=jn(t.getColGroupDef(),["children"]);return e&&(e.groupId=t.getGroupId()),e},o.prototype.createDefFromColumn=function(t,e,r){var i=jn(t.getColDef());return i.colId=t.getColId(),i.width=t.getActualWidth(),i.rowGroup=t.isRowGroupActive(),i.rowGroupIndex=t.isRowGroupActive()?e.indexOf(t):null,i.pivot=t.isPivotActive(),i.pivotIndex=t.isPivotActive()?r.indexOf(t):null,i.aggFunc=t.isValueActive()?t.getAggFunc():null,i.hide=!t.isVisible()||void 0,i.pinned=t.isPinned()?t.getPinned():null,i.sort=t.getSort()?t.getSort():null,i.sortIndex=null!=t.getSortIndex()?t.getSortIndex():null,i},o=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n}([He("columnDefFactory")],o),o}(),vf=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},uC=function(){function o(){}return o.prototype.getInitialRowClasses=function(t){var e=[];return me(t.extraCssClass)&&e.push(t.extraCssClass),e.push("ag-row"),e.push(t.rowFocused?"ag-row-focus":"ag-row-no-focus"),t.fadeRowIn&&e.push("ag-opacity-zero"),e.push(t.rowIsEven?"ag-row-even":"ag-row-odd"),t.rowNode.isRowPinned()&&e.push("ag-row-pinned"),t.rowNode.isSelected()&&e.push("ag-row-selected"),t.rowNode.footer&&e.push("ag-row-footer"),e.push("ag-row-level-"+t.rowLevel),t.rowNode.stub&&e.push("ag-row-loading"),t.fullWidthRow&&e.push("ag-full-width-row"),t.expandable&&(e.push("ag-row-group"),e.push(t.rowNode.expanded?"ag-row-group-expanded":"ag-row-group-contracted")),t.rowNode.dragging&&e.push("ag-row-dragging"),sl(e,this.processClassesFromGridOptions(t.rowNode)),sl(e,this.preProcessRowClassRules(t.rowNode)),e.push(t.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),t.firstRowOnPage&&e.push("ag-row-first"),t.lastRowOnPage&&e.push("ag-row-last"),t.fullWidthRow&&("left"===t.pinned&&e.push("ag-cell-last-left-pinned"),"right"===t.pinned&&e.push("ag-cell-first-right-pinned")),e},o.prototype.processClassesFromGridOptions=function(t){var e=[],r=function(v){"string"==typeof v?e.push(v):Array.isArray(v)&&v.forEach(function(m){return e.push(m)})},i=this.gridOptionsService.get("rowClass");if(i){if("function"==typeof i)return console.warn("AG Grid: rowClass should not be a function, please use getRowClass instead"),[];r(i)}var n=this.gridOptionsService.getCallback("getRowClass");n&&r(n({data:t.data,node:t,rowIndex:t.rowIndex}));return e},o.prototype.preProcessRowClassRules=function(t){var e=[];return this.processRowClassRules(t,function(r){e.push(r)},function(r){}),e},o.prototype.processRowClassRules=function(t,e,r){var i={data:t.data,node:t,rowIndex:t.rowIndex,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};this.stylingService.processClassRules(this.gridOptionsService.get("rowClassRules"),i,e,r)},o.prototype.calculateRowLevel=function(t){return t.group?t.level:t.parent?t.parent.level+1:0},vf([D("stylingService")],o.prototype,"stylingService",void 0),vf([D("gridOptionsService")],o.prototype,"gridOptionsService",void 0),o=vf([He("rowCssClassCalculator")],o)}(),Kd=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ha=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},qi=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return Kd(t,o),t.prototype.init=function(){var e=this;this.isAccentedSort=this.gridOptionsService.is("accentedSort"),this.primaryColumnsSortGroups=this.gridOptionsService.isColumnsSortingCoupledToGroup(),this.addManagedPropertyListener("accentedSort",function(r){return e.isAccentedSort=r.currentValue}),this.addManagedPropertyListener("autoGroupColumnDef",function(){return e.primaryColumnsSortGroups=e.gridOptionsService.isColumnsSortingCoupledToGroup()})},t.prototype.doFullSort=function(e,r){var n=e.map(function(u,c){return{currentPos:c,rowNode:u}});return n.sort(this.compareRowNodes.bind(this,r)),n.map(function(u){return u.rowNode})},t.prototype.compareRowNodes=function(e,r,i){for(var n=r.rowNode,u=i.rowNode,c=0,v=e.length;c<v;c++){var m=e[c],C="desc"===m.sort,_=this.getValue(n,m.column),O=this.getValue(u,m.column),P=void 0,L=this.getComparator(m,n);if(P=L?L(_,O,n,u,C):rt.defaultComparator(_,O,this.isAccentedSort),!isNaN(P)&&0!==P)return"asc"===m.sort?P:-1*P}return r.currentPos-i.currentPos},t.prototype.getComparator=function(e,r){var i=e.column,n=i.getColDef().comparator;if(null!=n)return n;if(i.getColDef().showRowGroup){var u=!r.group&&i.getColDef().field;if(u){var c=this.columnModel.getPrimaryColumn(u);if(c)return c.getColDef().comparator}}},t.prototype.getValue=function(e,r){var i,n;if(!this.primaryColumnsSortGroups)return this.valueService.getValue(r,e,!1,!1);if(e.rowGroupColumn===r){if(this.gridOptionsService.isGroupUseEntireRow(this.columnModel.isPivotActive())){if(r.getColDef().keyCreator)return e.key;var m=null===(i=e.allLeafChildren)||void 0===i?void 0:i[0];return m?this.valueService.getValue(r,m,!1,!1):void 0}var C=this.columnModel.getGroupDisplayColumnForGroup(r.getId());return C?null===(n=e.groupData)||void 0===n?void 0:n[C.getId()]:void 0}return e.group&&r.getColDef().showRowGroup?void 0:this.valueService.getValue(r,e,!1,!1)},Ha([D("valueService")],t.prototype,"valueService",void 0),Ha([D("columnModel")],t.prototype,"columnModel",void 0),Ha([Re],t.prototype,"init",null),t=Ha([He("rowNodeSorter")],t)}(we),cC=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),fC=function(o){function t(){var r=null!==o&&o.apply(this,arguments)||this;return r.ready=!1,r.readyCallbacks=[],r}var e;return cC(t,o),e=t,t.prototype.checkReady=function(){if(this.ready=null!=this.gridCtrl&&null!=this.gridBodyCtrl&&null!=this.centerRowContainerCtrl&&null!=this.leftRowContainerCtrl&&null!=this.rightRowContainerCtrl&&null!=this.bottomCenterRowContainerCtrl&&null!=this.bottomLeftRowContainerCtrl&&null!=this.bottomRightRowContainerCtrl&&null!=this.topCenterRowContainerCtrl&&null!=this.topLeftRowContainerCtrl&&null!=this.topRightRowContainerCtrl&&null!=this.stickyTopCenterRowContainerCtrl&&null!=this.stickyTopLeftRowContainerCtrl&&null!=this.stickyTopRightRowContainerCtrl&&null!=this.centerHeaderRowContainerCtrl&&null!=this.leftHeaderRowContainerCtrl&&null!=this.rightHeaderRowContainerCtrl&&null!=this.fakeHScrollComp&&null!=this.fakeVScrollComp&&null!=this.gridHeaderCtrl,this.ready){var r=this.createReadyParams();this.readyCallbacks.forEach(function(i){return i(r)}),this.readyCallbacks.length=0}},t.prototype.whenReady=function(r){this.ready?r(this.createReadyParams()):this.readyCallbacks.push(r)},t.prototype.createReadyParams=function(){return{centerRowContainerCtrl:this.centerRowContainerCtrl,leftRowContainerCtrl:this.leftRowContainerCtrl,rightRowContainerCtrl:this.rightRowContainerCtrl,bottomCenterRowContainerCtrl:this.bottomCenterRowContainerCtrl,bottomLeftRowContainerCtrl:this.bottomLeftRowContainerCtrl,bottomRightRowContainerCtrl:this.bottomRightRowContainerCtrl,topCenterRowContainerCtrl:this.topCenterRowContainerCtrl,topLeftRowContainerCtrl:this.topLeftRowContainerCtrl,topRightRowContainerCtrl:this.topRightRowContainerCtrl,stickyTopCenterRowContainerCtrl:this.stickyTopCenterRowContainerCtrl,stickyTopLeftRowContainerCtrl:this.stickyTopLeftRowContainerCtrl,stickyTopRightRowContainerCtrl:this.stickyTopRightRowContainerCtrl,centerHeaderRowContainerCtrl:this.centerHeaderRowContainerCtrl,leftHeaderRowContainerCtrl:this.leftHeaderRowContainerCtrl,rightHeaderRowContainerCtrl:this.rightHeaderRowContainerCtrl,fakeHScrollComp:this.fakeHScrollComp,fakeVScrollComp:this.fakeVScrollComp,gridBodyCtrl:this.gridBodyCtrl,gridCtrl:this.gridCtrl,gridHeaderCtrl:this.gridHeaderCtrl}},t.prototype.registerFakeHScrollComp=function(r){this.fakeHScrollComp=r,this.checkReady()},t.prototype.registerFakeVScrollComp=function(r){this.fakeVScrollComp=r,this.checkReady()},t.prototype.registerGridHeaderCtrl=function(r){this.gridHeaderCtrl=r,this.checkReady()},t.prototype.registerCenterRowContainerCtrl=function(r){this.centerRowContainerCtrl=r,this.checkReady()},t.prototype.registerLeftRowContainerCtrl=function(r){this.leftRowContainerCtrl=r,this.checkReady()},t.prototype.registerRightRowContainerCtrl=function(r){this.rightRowContainerCtrl=r,this.checkReady()},t.prototype.registerTopCenterRowContainerCtrl=function(r){this.topCenterRowContainerCtrl=r,this.checkReady()},t.prototype.registerTopLeftRowContainerCon=function(r){this.topLeftRowContainerCtrl=r,this.checkReady()},t.prototype.registerTopRightRowContainerCtrl=function(r){this.topRightRowContainerCtrl=r,this.checkReady()},t.prototype.registerStickyTopCenterRowContainerCtrl=function(r){this.stickyTopCenterRowContainerCtrl=r,this.checkReady()},t.prototype.registerStickyTopLeftRowContainerCon=function(r){this.stickyTopLeftRowContainerCtrl=r,this.checkReady()},t.prototype.registerStickyTopRightRowContainerCtrl=function(r){this.stickyTopRightRowContainerCtrl=r,this.checkReady()},t.prototype.registerBottomCenterRowContainerCtrl=function(r){this.bottomCenterRowContainerCtrl=r,this.checkReady()},t.prototype.registerBottomLeftRowContainerCtrl=function(r){this.bottomLeftRowContainerCtrl=r,this.checkReady()},t.prototype.registerBottomRightRowContainerCtrl=function(r){this.bottomRightRowContainerCtrl=r,this.checkReady()},t.prototype.registerHeaderContainer=function(r,i){switch(i){case"left":this.leftHeaderRowContainerCtrl=r;break;case"right":this.rightHeaderRowContainerCtrl=r;break;default:this.centerHeaderRowContainerCtrl=r}this.checkReady()},t.prototype.registerGridBodyCtrl=function(r){this.gridBodyCtrl=r,this.checkReady()},t.prototype.registerGridCtrl=function(r){this.gridCtrl=r,this.checkReady()},t.prototype.getFakeHScrollComp=function(){return this.fakeHScrollComp},t.prototype.getFakeVScrollComp=function(){return this.fakeVScrollComp},t.prototype.getGridHeaderCtrl=function(){return this.gridHeaderCtrl},t.prototype.getGridCtrl=function(){return this.gridCtrl},t.prototype.getCenterRowContainerCtrl=function(){return this.centerRowContainerCtrl},t.prototype.getTopCenterRowContainerCtrl=function(){return this.topCenterRowContainerCtrl},t.prototype.getBottomCenterRowContainerCtrl=function(){return this.bottomCenterRowContainerCtrl},t.prototype.getStickyTopCenterRowContainerCtrl=function(){return this.stickyTopCenterRowContainerCtrl},t.prototype.getGridBodyCtrl=function(){return this.gridBodyCtrl},t.prototype.getHeaderRowContainerCtrls=function(){return[this.leftHeaderRowContainerCtrl,this.rightHeaderRowContainerCtrl,this.centerHeaderRowContainerCtrl]},t.prototype.getHeaderRowContainerCtrl=function(r){switch(r){case"left":return this.leftHeaderRowContainerCtrl;case"right":return this.rightHeaderRowContainerCtrl;default:return this.centerHeaderRowContainerCtrl}},t.NAME="ctrlsService",t=e=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n}([He(e.NAME)],t),t}(we),pC=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),hC=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.registry={},e}return pC(t,o),t.prototype.register=function(e){this.registry[e.controllerName]=e.controllerClass},t.prototype.getInstance=function(e){var r=this.registry[e];if(null!=r)return new r},t=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n}([He("ctrlsFactory")],t),t}(we),vC=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),mu=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},yu=function(o){function t(e,r){var i=o.call(this,e)||this;return i.direction=r,i.hideTimeout=null,i}return vC(t,o),t.prototype.postConstruct=function(){this.addManagedListener(this.eventService,I.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.onScrollVisibilityChanged(),this.addOrRemoveCssClass("ag-apple-scrollbar",rs()||on())},t.prototype.initialiseInvisibleScrollbar=function(){void 0===this.invisibleScrollbar&&(this.invisibleScrollbar=an(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))},t.prototype.addActiveListenerToggles=function(){var e=this,n=this.getGui();["mouseenter","mousedown","touchstart"].forEach(function(u){return e.addManagedListener(n,u,function(){return e.addOrRemoveCssClass("ag-scrollbar-active",!0)})}),["mouseleave","touchend"].forEach(function(u){return e.addManagedListener(n,u,function(){return e.addOrRemoveCssClass("ag-scrollbar-active",!1)})})},t.prototype.onScrollVisibilityChanged=function(){void 0===this.invisibleScrollbar&&this.initialiseInvisibleScrollbar(),this.setScrollVisible()},t.prototype.hideAndShowInvisibleScrollAsNeeded=function(){var e=this;this.addManagedListener(this.eventService,I.EVENT_BODY_SCROLL,function(r){r.direction===e.direction&&(null!==e.hideTimeout&&(window.clearTimeout(e.hideTimeout),e.hideTimeout=null),e.addOrRemoveCssClass("ag-scrollbar-scrolling",!0))}),this.addManagedListener(this.eventService,I.EVENT_BODY_SCROLL_END,function(){e.hideTimeout=window.setTimeout(function(){e.addOrRemoveCssClass("ag-scrollbar-scrolling",!1),e.hideTimeout=null},400)})},t.prototype.getViewport=function(){return this.eViewport},t.prototype.getContainer=function(){return this.eContainer},mu([Te("eViewport")],t.prototype,"eViewport",void 0),mu([Te("eContainer")],t.prototype,"eContainer",void 0),mu([D("scrollVisibleService")],t.prototype,"scrollVisibleService",void 0),mu([D("ctrlsService")],t.prototype,"ctrlsService",void 0),t}(Ue),gf=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Va=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},gC=function(o){function t(){return o.call(this,t.TEMPLATE,"horizontal")||this}return gf(t,o),t.prototype.postConstruct=function(){var e=this;o.prototype.postConstruct.call(this);var r=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedListener(this.eventService,I.EVENT_DISPLAYED_COLUMNS_CHANGED,r),this.addManagedListener(this.eventService,I.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,r),this.addManagedListener(this.eventService,I.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedPropertyListener("domLayout",r),this.ctrlsService.registerFakeHScrollComp(this),this.createManagedBean(new Mc(function(i){return e.eContainer.style.width=i+"px"}))},t.prototype.initialiseInvisibleScrollbar=function(){void 0===this.invisibleScrollbar&&(this.enableRtl=this.gridOptionsService.is("enableRtl"),o.prototype.initialiseInvisibleScrollbar.call(this),this.invisibleScrollbar&&this.refreshCompBottom())},t.prototype.onPinnedRowDataChanged=function(){this.refreshCompBottom()},t.prototype.refreshCompBottom=function(){if(this.invisibleScrollbar){var e=this.pinnedRowModel.getPinnedBottomTotalHeight();this.getGui().style.bottom=e+"px"}},t.prototype.onScrollVisibilityChanged=function(){o.prototype.onScrollVisibilityChanged.call(this),this.setFakeHScrollSpacerWidths()},t.prototype.setFakeHScrollSpacerWidths=function(){var e=this.scrollVisibleService.isVerticalScrollShowing(),r=this.columnModel.getDisplayedColumnsRightWidth(),i=!this.enableRtl&&e,n=this.gridOptionsService.getScrollbarWidth();i&&(r+=n),ci(this.eRightSpacer,r),this.eRightSpacer.classList.toggle("ag-scroller-corner",r<=n);var u=this.columnModel.getDisplayedColumnsLeftWidth();this.enableRtl&&e&&(u+=n),ci(this.eLeftSpacer,u),this.eLeftSpacer.classList.toggle("ag-scroller-corner",u<=n)},t.prototype.setScrollVisible=function(){var e=this.scrollVisibleService.isHorizontalScrollShowing(),r=this.invisibleScrollbar,i=this.gridOptionsService.is("suppressHorizontalScroll"),n=e&&this.gridOptionsService.getScrollbarWidth()||0,c=i?0:0===n&&r?16:n;this.addOrRemoveCssClass("ag-scrollbar-invisible",r),kn(this.getGui(),c),kn(this.eViewport,c),kn(this.eContainer,c),this.setDisplayed(e,{skipAriaHidden:!0})},t.TEMPLATE='<div class="ag-body-horizontal-scroll" aria-hidden="true">\n            <div class="ag-horizontal-left-spacer" ref="eLeftSpacer"></div>\n            <div class="ag-body-horizontal-scroll-viewport" ref="eViewport">\n                <div class="ag-body-horizontal-scroll-container" ref="eContainer"></div>\n            </div>\n            <div class="ag-horizontal-right-spacer" ref="eRightSpacer"></div>\n        </div>',Va([Te("eLeftSpacer")],t.prototype,"eLeftSpacer",void 0),Va([Te("eRightSpacer")],t.prototype,"eRightSpacer",void 0),Va([D("columnModel")],t.prototype,"columnModel",void 0),Va([D("pinnedRowModel")],t.prototype,"pinnedRowModel",void 0),Va([Re],t.prototype,"postConstruct",null),t}(yu),mC=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Cu=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},yC=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return mC(t,o),t.prototype.postConstruct=function(){var e=this.checkContainerWidths.bind(this);this.addManagedListener(this.eventService,I.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,I.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,e),this.addManagedPropertyListener("domLayout",e)},t.prototype.checkContainerWidths=function(){var e=this.gridOptionsService.isDomLayout("print"),r=e?0:this.columnModel.getDisplayedColumnsLeftWidth(),i=e?0:this.columnModel.getDisplayedColumnsRightWidth();r!=this.leftWidth&&(this.leftWidth=r,this.eventService.dispatchEvent({type:I.EVENT_LEFT_PINNED_WIDTH_CHANGED})),i!=this.rightWidth&&(this.rightWidth=i,this.eventService.dispatchEvent({type:I.EVENT_RIGHT_PINNED_WIDTH_CHANGED}))},t.prototype.getPinnedRightWidth=function(){return this.rightWidth},t.prototype.getPinnedLeftWidth=function(){return this.leftWidth},Cu([D("columnModel")],t.prototype,"columnModel",void 0),Cu([Re],t.prototype,"postConstruct",null),t=Cu([He("pinnedWidthService")],t)}(we),CC=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),wu=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},wC=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.events=[],e}return CC(t,o),t.prototype.postConstruct=function(){"clientSide"==this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel)},t.prototype.dispatchExpanded=function(e){var r=this;if(null!=this.clientSideRowModel){this.events.push(e);null==this.dispatchExpandedDebounced&&(this.dispatchExpandedDebounced=this.animationFrameService.debounce(function(){r.clientSideRowModel&&r.clientSideRowModel.onRowGroupOpened(),r.events.forEach(function(n){return r.eventService.dispatchEvent(n)}),r.events=[]})),this.dispatchExpandedDebounced()}else this.eventService.dispatchEvent(e)},wu([D("animationFrameService")],t.prototype,"animationFrameService",void 0),wu([D("rowModel")],t.prototype,"rowModel",void 0),wu([Re],t.prototype,"postConstruct",null),t=wu([He("rowNodeEventThrottle")],t)}(we),mf=function(){return mf=Object.assign||function(o){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},mf.apply(this,arguments)},po=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},$d=function(o,t){return function(e,r){t(e,r,o)}},SC=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n};function Yd(o){return!0===o||"true"===o}var Qd,EC=function(){function o(){this.destroyed=!1,this.domDataKey="__AG_"+Math.random().toString(),this.propertyEventService=new Yn}return Object.defineProperty(o.prototype,"context",{get:function(){return this.gridOptions.context},enumerable:!1,configurable:!0}),o.prototype.agWire=function(t,e){this.gridOptions.api=t,this.gridOptions.columnApi=e,this.api=t,this.columnApi=e},o.prototype.init=function(){this.gridOptionLookup=new Set(function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(SC(arguments[t]));return o}(Jo.ALL_PROPERTIES,Jo.EVENT_CALLBACKS));var t=!this.is("suppressAsyncEvents");this.eventService.addGlobalListener(this.globalEventHandler.bind(this),t),this.getScrollbarWidth()},o.prototype.destroy=function(){this.gridOptions.api=null,this.gridOptions.columnApi=null,this.destroyed=!0},o.prototype.is=function(t){return Yd(this.gridOptions[t])},o.prototype.get=function(t){return this.gridOptions[t]},o.prototype.getNum=function(t){return function xC(o){return"number"==typeof o?o:"string"==typeof o?parseInt(o,10):void 0}(this.gridOptions[t])},o.prototype.getCallback=function(t){return this.mergeGridCommonParams(this.gridOptions[t])},o.prototype.exists=function(t){return me(this.gridOptions[t])},o.prototype.mergeGridCommonParams=function(t){var e=this;if(t){return function(i){var n=i;return n.api=e.api,n.columnApi=e.columnApi,n.context=e.context,t(n)}}return t},o.prototype.set=function(t,e,r,i){if(void 0===r&&(r=!1),void 0===i&&(i={}),this.gridOptionLookup.has(t)){var n=this.gridOptions[t];if(r||n!==e){this.gridOptions[t]=e;var u=mf({type:t,currentValue:e,previousValue:n},i);this.propertyEventService.dispatchEvent(u)}}},o.prototype.addEventListener=function(t,e){this.propertyEventService.addEventListener(t,e)},o.prototype.removeEventListener=function(t,e){this.propertyEventService.removeEventListener(t,e)},o.prototype.globalEventHandler=function(t,e){if(!this.destroyed){var r=Jo.getCallbackForEvent(t);"function"==typeof this.gridOptions[r]&&this.gridOptions[r](e)}},o.prototype.getScrollbarWidth=function(){if(null==this.scrollbarWidth){var e="number"==typeof this.gridOptions.scrollbarWidth&&this.gridOptions.scrollbarWidth>=0?this.gridOptions.scrollbarWidth:Zn();null!=e&&(this.scrollbarWidth=e,this.eventService.dispatchEvent({type:I.EVENT_SCROLLBAR_WIDTH_CHANGED}))}return this.scrollbarWidth},o.prototype.isRowModelType=function(t){return this.gridOptions.rowModelType===t||"clientSide"===t&&Je(this.gridOptions.rowModelType)},o.prototype.isDomLayout=function(t){var e;return(null!==(e=this.gridOptions.domLayout)&&void 0!==e?e:"normal")===t},o.prototype.isRowSelection=function(){return"single"===this.gridOptions.rowSelection||"multiple"===this.gridOptions.rowSelection},o.prototype.useAsyncEvents=function(){return!this.is("suppressAsyncEvents")},o.prototype.isGetRowHeightFunction=function(){return"function"==typeof this.gridOptions.getRowHeight},o.prototype.getRowHeightForNode=function(t,e,r){if(void 0===e&&(e=!1),null==r&&(r=this.environment.getDefaultRowHeight()),this.isGetRowHeightFunction()){if(e)return{height:r,estimated:!0};var i={node:t,data:t.data},n=this.getCallback("getRowHeight")(i);if(this.isNumeric(n))return 0===n&&_t(function(){return console.warn("AG Grid: The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead.")},"invalidRowHeight"),{height:Math.max(1,n),estimated:!1}}return t.detail&&this.is("masterDetail")?this.getMasterDetailRowHeight():{height:this.gridOptions.rowHeight&&this.isNumeric(this.gridOptions.rowHeight)?this.gridOptions.rowHeight:r,estimated:!1}},o.prototype.getMasterDetailRowHeight=function(){return this.is("detailRowAutoHeight")?{height:1,estimated:!1}:this.isNumeric(this.gridOptions.detailRowHeight)?{height:this.gridOptions.detailRowHeight,estimated:!1}:{height:300,estimated:!1}},o.prototype.getRowHeightAsNumber=function(){if(!this.gridOptions.rowHeight||Je(this.gridOptions.rowHeight))return this.environment.getDefaultRowHeight();var t=this.gridOptions.rowHeight;return t&&this.isNumeric(t)?(this.environment.setRowHeightVariable(t),t):(console.warn("AG Grid row height must be a number if not using standard row model"),this.environment.getDefaultRowHeight())},o.prototype.isNumeric=function(t){return!isNaN(t)&&"number"==typeof t&&isFinite(t)},o.prototype.getDomDataKey=function(){return this.domDataKey},o.prototype.getDomData=function(t,e){var r=t[this.getDomDataKey()];return r?r[e]:void 0},o.prototype.setDomData=function(t,e,r){var i=this.getDomDataKey(),n=t[i];Je(n)&&(n={},t[i]=n),n[e]=r},o.prototype.getDocument=function(){var t=null;return this.gridOptions.getDocument&&me(this.gridOptions.getDocument)?t=this.gridOptions.getDocument():this.eGridDiv&&(t=this.eGridDiv.ownerDocument),t&&me(t)?t:document},o.prototype.getRootNode=function(){return this.eGridDiv.getRootNode()},o.prototype.getRowIdFunc=function(){var t=this.getCallback("getRowId");if(t)return t;var e=this.gridOptions.getRowNodeId;return e?function(r){return e(r.data)}:void 0},o.prototype.getAsyncTransactionWaitMillis=function(){return me(this.gridOptions.asyncTransactionWaitMillis)?this.gridOptions.asyncTransactionWaitMillis:50},o.prototype.isAnimateRows=function(){return!this.is("ensureDomOrder")&&this.is("animateRows")},o.prototype.isTreeData=function(){return this.is("treeData")&&it.assertRegistered(Ne.RowGroupingModule,"Tree Data")},o.prototype.isMasterDetail=function(){return this.is("masterDetail")&&it.assertRegistered(Ne.MasterDetailModule,"masterDetail")},o.prototype.isEnableRangeSelection=function(){return this.is("enableRangeSelection")&&it.isRegistered(Ne.RangeSelectionModule)},o.prototype.isColumnsSortingCoupledToGroup=function(){var t=this.gridOptions.autoGroupColumnDef;return this.isRowModelType("clientSide")&&!t?.comparator&&!this.isTreeData()},o.prototype.getGroupAggFiltering=function(){var t=this.gridOptions.groupAggFiltering;return"function"==typeof t?this.getCallback("groupAggFiltering"):Yd(t)?function(){return!0}:void 0},o.prototype.isGroupMultiAutoColumn=function(){return this.gridOptions.groupDisplayType?Qn("multipleColumns",this.gridOptions.groupDisplayType):this.is("groupHideOpenParents")},o.prototype.isGroupUseEntireRow=function(t){return!t&&(!!this.gridOptions.groupDisplayType&&Qn("groupRows",this.gridOptions.groupDisplayType))},po([D("gridOptions")],o.prototype,"gridOptions",void 0),po([D("eventService")],o.prototype,"eventService",void 0),po([D("environment")],o.prototype,"environment",void 0),po([D("eGridDiv")],o.prototype,"eGridDiv",void 0),po([$d(0,Zr("gridApi")),$d(1,Zr("columnApi"))],o.prototype,"agWire",null),po([Re],o.prototype,"init",null),po([Mr],o.prototype,"destroy",null),o=po([He("gridOptionsService")],o)}(),wn=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),RC=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return wn(t,o),t.prototype.getLocaleTextFunc=function(){var e=this.gridOptionsService.getCallback("getLocaleText");if(e)return function(n,u,c){return e({key:n,defaultValue:u,variableValues:c})};var r=this.gridOptionsService.get("localeTextFunc");if(r)return r;var i=this.gridOptionsService.get("localeText");return function(n,u,c){var v=i&&i[n];if(v&&c&&c.length)for(var m=0;!(m>=c.length);){if(-1===v.indexOf("${variable}"))break;v=v.replace("${variable}",c[m++])}return v??u}},t=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n}([He("localeService")],t),t}(we),Wa=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),OC=function(o){function t(){return o.call(this,t.TEMPLATE,"vertical")||this}return Wa(t,o),t.prototype.postConstruct=function(){o.prototype.postConstruct.call(this),this.createManagedBean(new sd(this.eContainer)),this.ctrlsService.registerFakeVScrollComp(this)},t.prototype.setScrollVisible=function(){var e=this.scrollVisibleService.isVerticalScrollShowing(),r=this.invisibleScrollbar,i=e&&this.gridOptionsService.getScrollbarWidth()||0,n=0===i&&r?16:i;this.addOrRemoveCssClass("ag-scrollbar-invisible",r),ci(this.getGui(),n),ci(this.eViewport,n),ci(this.eContainer,n),this.setDisplayed(e,{skipAriaHidden:!0})},t.TEMPLATE='<div class="ag-body-vertical-scroll" aria-hidden="true">\n            <div class="ag-body-vertical-scroll-viewport" ref="eViewport">\n                <div class="ag-body-vertical-scroll-container" ref="eContainer"></div>\n            </div>\n        </div>',function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);i>3&&n&&Object.defineProperty(t,e,n)}([Re],t.prototype,"postConstruct",null),t}(yu),Xd=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},qd=function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(Xd(arguments[t]));return o},Ua=function(){function o(t,e,r){e?(this.gridOptions=e,(new yf).create(t,e,function(i){var n=new wy(t);i.createBean(n)},void 0,r)):console.error("AG Grid: no gridOptions provided to the grid")}return o.prototype.destroy=function(){this.gridOptions&&this.gridOptions.api&&this.gridOptions.api.destroy()},o}(),yf=function(){function o(){}return o.prototype.create=function(t,e,r,i,n){var u=this,c=!!e.debug,v=this.getRegisteredModules(n),m=this.createBeansList(e.rowModelType,v),C=this.createProvidedBeans(t,e,n);if(m){var _={providedBeanInstances:C,beanClasses:m,debug:c},O=new of("AG Grid",function(){return e.debug}),P=new of("Context",function(){return _.debug}),L=new Kn(_,P),z=L.getBean("beans");this.registerModuleUserComponents(z,v),this.registerStackComponents(z,v),this.registerControllers(z,v),r(L),z.ctrlsService.whenReady(function(){u.setColumnsAndData(z),u.dispatchGridReadyEvent(z);var q=it.isRegistered(Ne.EnterpriseCoreModule);O.log("initialised successfully, enterprise = "+q)}),i&&i(L)}},o.prototype.registerControllers=function(t,e){e.forEach(function(r){r.controllers&&r.controllers.forEach(function(i){return t.ctrlsFactory.register(i)})})},o.prototype.registerStackComponents=function(t,e){var r=this.createAgStackComponentsList(e);t.agStackComponentsRegistry.setupComponents(r)},o.prototype.getRegisteredModules=function(t){var e=t?t.modules:null,r=it.getRegisteredModules(),i=[],n={};function u(c,v){(function m(C){n[C.moduleName]||(n[C.moduleName]=!0,i.push(C),it.register(C,c))})(v),v.dependantModules&&v.dependantModules.forEach(u.bind(null,c))}return e&&e.forEach(u.bind(null,!0)),r&&r.forEach(u.bind(null,!it.isPackageBased())),i},o.prototype.registerModuleUserComponents=function(t,e){this.extractModuleEntity(e,function(i){return i.userComponents?i.userComponents:[]}).forEach(function(i){t.userComponentRegistry.registerDefaultComponent(i.componentName,i.componentClass)})},o.prototype.createProvidedBeans=function(t,e,r){var i=r?r.frameworkOverrides:null;Je(i)&&(i=new Id);var n={gridOptions:e,eGridDiv:t,globalEventListener:r?r.globalEventListener:null,frameworkOverrides:i};return r&&r.providedBeanInstances&&Object.assign(n,r.providedBeanInstances),n},o.prototype.createAgStackComponentsList=function(t){var e=[{componentName:"AgCheckbox",componentClass:vs},{componentName:"AgRadioButton",componentClass:fc},{componentName:"AgToggleButton",componentClass:_m},{componentName:"AgInputTextField",componentClass:Bn},{componentName:"AgInputTextArea",componentClass:xm},{componentName:"AgInputNumberField",componentClass:hc},{componentName:"AgInputRange",componentClass:Ts},{componentName:"AgSelect",componentClass:ia},{componentName:"AgSlider",componentClass:au},{componentName:"AgGridBody",componentClass:Zg},{componentName:"AgHeaderRoot",componentClass:X0},{componentName:"AgSortIndicator",componentClass:ms},{componentName:"AgPagination",componentClass:$y},{componentName:"AgOverlayWrapper",componentClass:Xy},{componentName:"AgGroupComponent",componentClass:Em},{componentName:"AgPanel",componentClass:Fd},{componentName:"AgDialog",componentClass:Gm},{componentName:"AgRowContainer",componentClass:xs},{componentName:"AgFakeHorizontalScroll",componentClass:gC},{componentName:"AgFakeVerticalScroll",componentClass:OC}],r=this.extractModuleEntity(t,function(i){return i.agStackComponents?i.agStackComponents:[]});return e=e.concat(r)},o.prototype.createBeansList=function(t,e){void 0===t&&(t="clientSide");var r=e.filter(function(v){return!v.rowModel||v.rowModel===t}),i={clientSide:Ne.ClientSideRowModelModule,infinite:Ne.InfiniteRowModelModule,serverSide:Ne.ServerSideRowModelModule,viewport:Ne.ViewportRowModelModule};if(i[t]){if(it.assertRegistered(i[t],"rowModelType = '"+t+"'")){var n=[Wr,Qy,eC,vw,Dy,Lo,Vv,My,ky,rm,ng,Uy,Q0,RC,Eh,gm,Kp,Dh,Yn,EC,zm,oy,sg,Hu,j0,Cm,dm,cy,cl,dy,ty,o0,Fy,ay,gy,Yf,sm,Z0,Vr,Ld,ba,i0,Wy,Jm,Rd,Sm,t0,_y,Ry,Oy,zy,_i,Ly,nm,oC,Zt,lC,uC,ym,qi,fC,yC,wC,hC],u=this.extractModuleEntity(r,function(v){return v.beans?v.beans:[]});n.push.apply(n,qd(u));var c=[];return n.forEach(function(v){c.indexOf(v)<0&&c.push(v)}),c}}else console.error("AG Grid: could not find row model for rowModelType = "+t)},o.prototype.extractModuleEntity=function(t,e){return[].concat.apply([],qd(t.map(e)))},o.prototype.setColumnsAndData=function(t){var e=t.gridOptionsService.get("columnDefs");t.columnModel.setColumnDefs(e||[],"gridInitializing"),t.rowModel.start()},o.prototype.dispatchGridReadyEvent=function(t){var e={type:I.EVENT_GRID_READY};t.eventService.dispatchEvent(e)},o}(),De=function(){function o(){}return o.prototype.wrap=function(t,e,r,i){var n=this;void 0===r&&(r=[]);var u=this.createWrapper(t,i);return e.forEach(function(c){n.createMethod(u,c,!0)}),r.forEach(function(c){n.createMethod(u,c,!1)}),u},o.prototype.unwrap=function(t){return t},o.prototype.createMethod=function(t,e,r){t.addMethod(e,this.createMethodProxy(t,e,r))},o.prototype.createMethodProxy=function(t,e,r){return function(){return t.hasMethod(e)?t.callMethod(e,arguments):(r&&console.warn("AG Grid: Framework component is missing the method "+e+"()"),null)}},o}();!function(o){o.InsideBase="insideBase",o.InsideEnd="insideEnd",o.Center="center",o.OutsideEnd="outsideEnd"}(Qd||(Qd={}));var Is=typeof global>"u"?{}:global;Is.HTMLElement=typeof HTMLElement>"u"?{}:HTMLElement,Is.HTMLButtonElement=typeof HTMLButtonElement>"u"?{}:HTMLButtonElement,Is.HTMLSelectElement=typeof HTMLSelectElement>"u"?{}:HTMLSelectElement,Is.HTMLInputElement=typeof HTMLInputElement>"u"?{}:HTMLInputElement,Is.Node=typeof Node>"u"?{}:Node,Is.MouseEvent=typeof MouseEvent>"u"?{}:MouseEvent;var Sn,AC=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},Jd=function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(AC(arguments[t]));return o},DC=function(){function o(t,e,r,i,n,u){this.nextId=0,this.allNodesMap={},this.rootNode=t,this.gridOptionsService=e,this.eventService=r,this.columnModel=i,this.beans=u,this.selectionService=n,this.rootNode.group=!0,this.rootNode.level=-1,this.rootNode.id=o.ROOT_NODE_ID,this.rootNode.allLeafChildren=[],this.rootNode.childrenAfterGroup=[],this.rootNode.childrenAfterSort=[],this.rootNode.childrenAfterAggFilter=[],this.rootNode.childrenAfterFilter=[],this.postConstruct()}return o.prototype.postConstruct=function(){this.suppressParentsInRowNodes=this.gridOptionsService.is("suppressParentsInRowNodes"),this.isRowMasterFunc=this.gridOptionsService.get("isRowMaster"),this.doingTreeData=this.gridOptionsService.isTreeData(),this.doingMasterDetail=this.gridOptionsService.isMasterDetail()},o.prototype.getCopyOfNodesMap=function(){return rt.cloneObject(this.allNodesMap)},o.prototype.getRowNode=function(t){return this.allNodesMap[t]},o.prototype.setRowData=function(t){var e=this;if("string"!=typeof t){var r=this.rootNode,i=this.rootNode.sibling;r.childrenAfterFilter=null,r.childrenAfterGroup=null,r.childrenAfterAggFilter=null,r.childrenAfterSort=null,r.childrenMapped=null,r.updateHasChildren(),this.nextId=0,this.allNodesMap={},t?r.allLeafChildren=t.map(function(n){return e.createNode(n,e.rootNode,o.TOP_LEVEL)}):(r.allLeafChildren=[],r.childrenAfterGroup=[]),i&&(i.childrenAfterFilter=r.childrenAfterFilter,i.childrenAfterGroup=r.childrenAfterGroup,i.childrenAfterAggFilter=r.childrenAfterAggFilter,i.childrenAfterSort=r.childrenAfterSort,i.childrenMapped=r.childrenMapped,i.allLeafChildren=r.allLeafChildren)}else console.warn("AG Grid: rowData must be an array, however you passed in a string. If you are loading JSON, make sure you convert the JSON string to JavaScript objects first")},o.prototype.updateRowData=function(t,e){var r={remove:[],update:[],add:[]},i=[];return this.executeRemove(t,r,i),this.executeUpdate(t,r,i),this.executeAdd(t,r),this.updateSelection(i,"rowDataChanged"),e&&rt.sortRowNodesByOrder(this.rootNode.allLeafChildren,e),r},o.prototype.updateSelection=function(t,e){var r=t.length>0;if(r&&t.forEach(function(n){n.setSelected(!1,!1,!0,e)}),this.selectionService.updateGroupsFromChildrenSelections(e),r){var i={type:I.EVENT_SELECTION_CHANGED,source:e};this.eventService.dispatchEvent(i)}},o.prototype.executeAdd=function(t,e){var i,r=this,n=t.add,u=t.addIndex;if(!rt.missingOrEmpty(n)){var c=n.map(function(L){return r.createNode(L,r.rootNode,o.TOP_LEVEL)});if("number"==typeof u&&u>=0){var v=this.rootNode.allLeafChildren,m=v.length,C=u;if(this.doingTreeData&&u>0&&m>0)for(var _=0;_<m;_++)if((null===(i=v[_])||void 0===i?void 0:i.rowIndex)==u-1){C=_+1;break}var O=v.slice(0,C),P=v.slice(C,v.length);this.rootNode.allLeafChildren=Jd(O,c,P)}else this.rootNode.allLeafChildren=Jd(this.rootNode.allLeafChildren,c);this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren),e.add=c}},o.prototype.executeRemove=function(t,e,r){var i=this,n=t.remove;if(!rt.missingOrEmpty(n)){var u={};n.forEach(function(c){var v=i.lookupRowNode(c);v&&(v.isSelected()&&r.push(v),v.clearRowTopAndRowIndex(),u[v.id]=!0,delete i.allNodesMap[v.id],e.remove.push(v))}),this.rootNode.allLeafChildren=this.rootNode.allLeafChildren.filter(function(c){return!u[c.id]}),this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren)}},o.prototype.executeUpdate=function(t,e,r){var i=this,n=t.update;rt.missingOrEmpty(n)||n.forEach(function(u){var c=i.lookupRowNode(u);c&&(c.updateData(u),!c.selectable&&c.isSelected()&&r.push(c),i.setMasterForRow(c,u,o.TOP_LEVEL,!1),e.update.push(c))})},o.prototype.lookupRowNode=function(t){var r,e=this.gridOptionsService.getRowIdFunc();if(e){var i=e({data:t,level:0});if(!(r=this.allNodesMap[i]))return console.error("AG Grid: could not find row id="+i+", data item was not found for this id"),null}else if(!(r=this.rootNode.allLeafChildren.find(function(n){return n.data===t})))return console.error("AG Grid: could not find data item as object was not found",t),console.error("Consider using getRowId to help the Grid find matching row data"),null;return r||null},o.prototype.createNode=function(t,e,r){var i=new wt(this.beans);return i.group=!1,this.setMasterForRow(i,t,r,!0),e&&!this.suppressParentsInRowNodes&&(i.parent=e),i.level=r,i.setDataAndId(t,this.nextId.toString()),this.allNodesMap[i.id]&&console.warn("AG Grid: duplicate node id '"+i.id+"' detected from getRowId callback, this could cause issues in your grid."),this.allNodesMap[i.id]=i,this.nextId++,i},o.prototype.setMasterForRow=function(t,e,r,i){if(this.doingTreeData)t.setMaster(!1),i&&(t.expanded=!1);else if(this.doingMasterDetail?this.isRowMasterFunc?t.setMaster(this.isRowMasterFunc(e)):t.setMaster(!0):t.setMaster(!1),i){var n=this.columnModel.getRowGroupColumns(),c=r+(n?n.length:0);t.expanded=!!t.master&&this.isExpanded(c)}},o.prototype.isExpanded=function(t){var e=this.gridOptionsService.getNum("groupDefaultExpanded");return-1===e||t<e},o.TOP_LEVEL=0,o.ROOT_NODE_ID="ROOT_NODE_ID",o}(),bC=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),vi=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},FC=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n},xu=function(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(FC(arguments[t]));return o};!function(o){o[o.Normal=0]="Normal",o[o.AfterFilter=1]="AfterFilter",o[o.AfterFilterAndSort=2]="AfterFilterAndSort",o[o.PivotNodes=3]="PivotNodes"}(Sn||(Sn={}));var Ou,PC=function(o){function t(){var e=null!==o&&o.apply(this,arguments)||this;return e.onRowHeightChanged_debounced=rt.debounce(e.onRowHeightChanged.bind(e),100),e.rowsToDisplay=[],e}return bC(t,o),t.prototype.init=function(){var e=this.refreshModel.bind(this,{step:bt.EVERYTHING}),r=!this.gridOptionsService.is("suppressAnimationFrame"),i=this.refreshModel.bind(this,{step:bt.EVERYTHING,afterColumnsChanged:!0,keepRenderedRows:!0,animate:r});this.addManagedListener(this.eventService,I.EVENT_NEW_COLUMNS_LOADED,i),this.addManagedListener(this.eventService,I.EVENT_COLUMN_ROW_GROUP_CHANGED,e),this.addManagedListener(this.eventService,I.EVENT_COLUMN_VALUE_CHANGED,this.onValueChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_COLUMN_PIVOT_CHANGED,this.refreshModel.bind(this,{step:bt.PIVOT})),this.addManagedListener(this.eventService,I.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_COLUMN_PIVOT_MODE_CHANGED,e),this.addManagedListener(this.eventService,I.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanges.bind(this));var n=this.refreshModel.bind(this,{step:bt.MAP,keepRenderedRows:!0,animate:r});this.addManagedPropertyListener("groupRemoveSingleChildren",n),this.addManagedPropertyListener("groupRemoveLowestSingleChildren",n),this.rootNode=new wt(this.beans),this.nodeManager=new DC(this.rootNode,this.gridOptionsService,this.eventService,this.columnModel,this.selectionService,this.beans)},t.prototype.start=function(){var e=this.gridOptionsService.get("rowData");e&&this.setRowData(e)},t.prototype.ensureRowHeightsValid=function(e,r,i,n){var u,c=!1;do{u=!1;for(var v=this.getRowIndexAtPixel(e),m=this.getRowIndexAtPixel(r),C=Math.max(v,i),_=Math.min(m,n),O=C;O<=_;O++){var P=this.getRow(O);if(P.rowHeightEstimated){var L=this.gridOptionsService.getRowHeightForNode(P);P.setRowHeight(L.height),u=!0,c=!0}}u&&this.setRowTopAndRowIndex()}while(u);return c},t.prototype.setRowTopAndRowIndex=function(){for(var e=this.environment.getDefaultRowHeight(),r=0,i=new Set,n=this.gridOptionsService.isDomLayout("normal"),u=0;u<this.rowsToDisplay.length;u++){var c=this.rowsToDisplay[u];if(null!=c.id&&i.add(c.id),null==c.rowHeight){var v=this.gridOptionsService.getRowHeightForNode(c,n,e);c.setRowHeight(v.height,v.estimated)}c.setRowTop(r),c.setRowIndex(u),r+=c.rowHeight}return i},t.prototype.clearRowTopAndRowIndex=function(e,r){var i=e.isActive(),n=function(c){c&&null!=c.id&&!r.has(c.id)&&c.clearRowTopAndRowIndex()},u=function(c){if(n(c),n(c.detailNode),n(c.sibling),c.hasChildren()&&c.childrenAfterGroup){var v=-1==c.level;i&&!v&&!c.expanded||c.childrenAfterGroup.forEach(u)}};u(this.rootNode)},t.prototype.ensureRowsAtPixel=function(e,r,i){var n=this;void 0===i&&(i=0);var u=this.getRowIndexAtPixel(r),c=this.getRow(u),v=!this.gridOptionsService.is("suppressAnimationFrame");return c!==e[0]&&(e.forEach(function(m){rt.removeFromArray(n.rootNode.allLeafChildren,m)}),e.forEach(function(m,C){rt.insertIntoArray(n.rootNode.allLeafChildren,m,Math.max(u+i,0)+C)}),this.refreshModel({step:bt.EVERYTHING,keepRenderedRows:!0,keepEditingRows:!0,animate:v}),!0)},t.prototype.highlightRowAtPixel=function(e,r){var i=null!=r?this.getRowIndexAtPixel(r):null,n=null!=i?this.getRow(i):null;if(n&&e&&n!==e&&null!=r){var u=this.getHighlightPosition(r,n);this.lastHighlightedRow&&this.lastHighlightedRow!==n&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null),n.setHighlighted(u),this.lastHighlightedRow=n}else this.lastHighlightedRow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null)},t.prototype.getHighlightPosition=function(e,r){if(!r){var i=this.getRowIndexAtPixel(e);if(!(r=this.getRow(i||0)))return hn.Below}return e-r.rowTop<r.rowHeight/2?hn.Above:hn.Below},t.prototype.getLastHighlightedRowNode=function(){return this.lastHighlightedRow},t.prototype.isLastRowIndexKnown=function(){return!0},t.prototype.getRowCount=function(){return this.rowsToDisplay?this.rowsToDisplay.length:0},t.prototype.getTopLevelRowCount=function(){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return 1;var r=this.rootNode.childrenAfterAggFilter;return r?r.length:0},t.prototype.getTopLevelRowDisplayedIndex=function(e){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return e;var i=this.rootNode.childrenAfterSort[e];if(this.gridOptionsService.is("groupHideOpenParents"))for(;i.expanded&&i.childrenAfterSort&&i.childrenAfterSort.length>0;)i=i.childrenAfterSort[0];return i.rowIndex},t.prototype.getRowBounds=function(e){if(rt.missing(this.rowsToDisplay))return null;var r=this.rowsToDisplay[e];return r?{rowTop:r.rowTop,rowHeight:r.rowHeight}:null},t.prototype.onRowGroupOpened=function(){var e=this.gridOptionsService.isAnimateRows();this.refreshModel({step:bt.MAP,keepRenderedRows:!0,animate:e})},t.prototype.onFilterChanged=function(e){if(!e.afterDataChange){var r=this.gridOptionsService.isAnimateRows(),n=0===e.columns.length||e.columns.some(function(u){return u.isPrimary()})?bt.FILTER:bt.FILTER_AGGREGATES;this.refreshModel({step:n,keepRenderedRows:!0,animate:r})}},t.prototype.onSortChanged=function(){var e=this.gridOptionsService.isAnimateRows();this.refreshModel({step:bt.SORT,keepRenderedRows:!0,animate:e,keepEditingRows:!0})},t.prototype.getType=function(){return"clientSide"},t.prototype.onValueChanged=function(){this.columnModel.isPivotActive()?this.refreshModel({step:bt.PIVOT}):this.refreshModel({step:bt.AGGREGATE})},t.prototype.createChangePath=function(e){var r=rt.missingOrEmpty(e),i=new Xc(!1,this.rootNode);return(r||this.gridOptionsService.isTreeData())&&i.setInactive(),i},t.prototype.isSuppressModelUpdateAfterUpdateTransaction=function(e){if(!this.gridOptionsService.is("suppressModelUpdateAfterUpdateTransaction")||null==e.rowNodeTransactions)return!1;var r=e.rowNodeTransactions.filter(function(n){return null!=n.add&&n.add.length>0||null!=n.remove&&n.remove.length>0});return null==r||0==r.length},t.prototype.buildRefreshModelParams=function(e){var r=bt.EVERYTHING,i={everything:bt.EVERYTHING,group:bt.EVERYTHING,filter:bt.FILTER,map:bt.MAP,aggregate:bt.AGGREGATE,sort:bt.SORT,pivot:bt.PIVOT};if(rt.exists(e)&&(r=i[e]),!rt.missing(r))return{step:r,keepRenderedRows:!0,keepEditingRows:!0,animate:!this.gridOptionsService.is("suppressAnimationFrame")};console.error("AG Grid: invalid step "+e+", available steps are "+Object.keys(i).join(", "))},t.prototype.refreshModel=function(e){var r="object"==typeof e&&"step"in e?e:this.buildRefreshModelParams(e);if(r&&!this.isSuppressModelUpdateAfterUpdateTransaction(r)){var i=this.createChangePath(r.rowNodeTransactions);switch(r.step){case bt.EVERYTHING:this.doRowGrouping(r.groupState,r.rowNodeTransactions,r.rowNodeOrder,i,!!r.afterColumnsChanged);case bt.FILTER:this.doFilter(i);case bt.PIVOT:this.doPivot(i);case bt.AGGREGATE:this.doAggregate(i);case bt.FILTER_AGGREGATES:this.doFilterAggregates(i);case bt.SORT:this.doSort(r.rowNodeTransactions,i);case bt.MAP:this.doRowsToDisplay()}var n=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(i,n);var u={type:I.EVENT_MODEL_UPDATED,animate:r.animate,keepRenderedRows:r.keepRenderedRows,newData:r.newData,newPage:!1,keepUndoRedoStack:r.keepUndoRedoStack};this.eventService.dispatchEvent(u)}},t.prototype.isEmpty=function(){var e=rt.missing(this.rootNode.allLeafChildren)||0===this.rootNode.allLeafChildren.length;return rt.missing(this.rootNode)||e||!this.columnModel.isReady()},t.prototype.isRowsToRender=function(){return rt.exists(this.rowsToDisplay)&&this.rowsToDisplay.length>0},t.prototype.getNodesInRangeForSelection=function(e,r){var u,i=!r,n=!1,c=[],v=this.gridOptionsService.is("groupSelectsChildren");return this.forEachNodeAfterFilterAndSort(function(m){var C=i&&!n;if(i||(m===r||m===e)&&(i=!0),!(m.group&&v)){var O=i&&!n,P=m.isParentOfNode(u);(O||P)&&c.push(m)}C&&(m===r||m===e)&&(n=!0,u=m===r?r:e)}),c},t.prototype.setDatasource=function(e){console.error("AG Grid: should never call setDatasource on clientSideRowController")},t.prototype.getTopLevelNodes=function(){return this.rootNode?this.rootNode.childrenAfterGroup:null},t.prototype.getRootNode=function(){return this.rootNode},t.prototype.getRow=function(e){return this.rowsToDisplay[e]},t.prototype.isRowPresent=function(e){return this.rowsToDisplay.indexOf(e)>=0},t.prototype.getRowIndexAtPixel=function(e){if(this.isEmpty()||0===this.rowsToDisplay.length)return-1;var r=0,i=this.rowsToDisplay.length-1;if(e<=0)return 0;if(rt.last(this.rowsToDisplay).rowTop<=e)return this.rowsToDisplay.length-1;for(var u=-1,c=-1;;){var v=Math.floor((r+i)/2),m=this.rowsToDisplay[v];if(this.isRowInPixel(m,e))return v;if(m.rowTop<e?r=v+1:m.rowTop>e&&(i=v-1),u===r&&c===i)return v;u=r,c=i}},t.prototype.isRowInPixel=function(e,r){var i=e.rowTop,n=e.rowTop+e.rowHeight;return i<=r&&n>r},t.prototype.forEachLeafNode=function(e){this.rootNode.allLeafChildren&&this.rootNode.allLeafChildren.forEach(function(r,i){return e(r,i)})},t.prototype.forEachNode=function(e,r){void 0===r&&(r=!1),this.recursivelyWalkNodesAndCallback({nodes:xu(this.rootNode.childrenAfterGroup||[]),callback:e,recursionType:Sn.Normal,index:0,includeFooterNodes:r})},t.prototype.forEachNodeAfterFilter=function(e,r){void 0===r&&(r=!1),this.recursivelyWalkNodesAndCallback({nodes:xu(this.rootNode.childrenAfterAggFilter||[]),callback:e,recursionType:Sn.AfterFilter,index:0,includeFooterNodes:r})},t.prototype.forEachNodeAfterFilterAndSort=function(e,r){void 0===r&&(r=!1),this.recursivelyWalkNodesAndCallback({nodes:xu(this.rootNode.childrenAfterSort||[]),callback:e,recursionType:Sn.AfterFilterAndSort,index:0,includeFooterNodes:r})},t.prototype.forEachPivotNode=function(e,r){void 0===r&&(r=!1),this.recursivelyWalkNodesAndCallback({nodes:[this.rootNode],callback:e,recursionType:Sn.PivotNodes,index:0,includeFooterNodes:r})},t.prototype.recursivelyWalkNodesAndCallback=function(e){var r,i=e.nodes,n=e.callback,u=e.recursionType,c=e.includeFooterNodes,v=e.index,m=i[0];c&&null!==(r=m?.parent)&&void 0!==r&&r.sibling&&i.push(m.parent.sibling);for(var C=0;C<i.length;C++){var _=i[C];if(n(_,v++),_.hasChildren()&&!_.footer){var O=null;switch(u){case Sn.Normal:O=_.childrenAfterGroup;break;case Sn.AfterFilter:O=_.childrenAfterAggFilter;break;case Sn.AfterFilterAndSort:O=_.childrenAfterSort;break;case Sn.PivotNodes:O=_.leafGroup?null:_.childrenAfterSort}O&&(v=this.recursivelyWalkNodesAndCallback({nodes:xu(O),callback:n,recursionType:u,index:v,includeFooterNodes:c}))}}return v},t.prototype.doAggregate=function(e){this.aggregationStage&&this.aggregationStage.execute({rowNode:this.rootNode,changedPath:e})},t.prototype.doFilterAggregates=function(e){this.filterAggregatesStage?this.filterAggregatesStage.execute({rowNode:this.rootNode,changedPath:e}):this.rootNode.childrenAfterAggFilter=this.rootNode.childrenAfterFilter},t.prototype.expandOrCollapseAll=function(e){var r=this.gridOptionsService.isTreeData(),i=this.columnModel.isPivotActive(),n=function(v){v&&v.forEach(function(m){var C=function(){m.expanded=e,n(m.childrenAfterGroup)};r?rt.exists(m.childrenAfterGroup)&&C():i?!m.leafGroup&&C():m.group&&C()})};this.rootNode&&n(this.rootNode.childrenAfterGroup),this.refreshModel({step:bt.MAP});var u=e?"expandAll":"collapseAll",c={type:I.EVENT_EXPAND_COLLAPSE_ALL,source:u};this.eventService.dispatchEvent(c)},t.prototype.doSort=function(e,r){this.sortStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,changedPath:r})},t.prototype.doRowGrouping=function(e,r,i,n,u){if(this.groupStage){if(r?this.groupStage.execute({rowNode:this.rootNode,rowNodeTransactions:r,rowNodeOrder:i,changedPath:n}):(this.groupStage.execute({rowNode:this.rootNode,changedPath:n,afterColumnsChanged:u}),this.restoreGroupState(e)),this.gridOptionsService.is("groupSelectsChildren")&&this.selectionService.updateGroupsFromChildrenSelections("rowGroupChanged",n)){var v={type:I.EVENT_SELECTION_CHANGED,source:"rowGroupChanged"};this.eventService.dispatchEvent(v)}}else this.rootNode.childrenAfterGroup=this.rootNode.allLeafChildren,this.rootNode.sibling&&(this.rootNode.sibling.childrenAfterGroup=this.rootNode.childrenAfterGroup),this.rootNode.updateHasChildren()},t.prototype.restoreGroupState=function(e){e&&rt.traverseNodesWithKey(this.rootNode.childrenAfterGroup,function(r,i){"boolean"==typeof e[i]&&(r.expanded=e[i])})},t.prototype.doFilter=function(e){this.filterStage.execute({rowNode:this.rootNode,changedPath:e})},t.prototype.doPivot=function(e){this.pivotStage&&this.pivotStage.execute({rowNode:this.rootNode,changedPath:e})},t.prototype.getGroupState=function(){if(!this.rootNode.childrenAfterGroup||!this.gridOptionsService.is("rememberGroupStateWhenNewData"))return null;var e={};return rt.traverseNodesWithKey(this.rootNode.childrenAfterGroup,function(r,i){return e[i]=r.expanded}),e},t.prototype.getCopyOfNodesMap=function(){return this.nodeManager.getCopyOfNodesMap()},t.prototype.getRowNode=function(e){if("string"==typeof e&&0==e.indexOf(wt.ID_PREFIX_ROW_GROUP)){var i=void 0;return this.forEachNode(function(n){n.id===e&&(i=n)}),i}return this.nodeManager.getRowNode(e)},t.prototype.setRowData=function(e){var r=this.getGroupState();this.nodeManager.setRowData(e),this.selectionService.reset(),this.filterManager.onNewRowsLoaded("rowDataUpdated");var i={type:I.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(i),this.refreshModel({step:bt.EVERYTHING,groupState:r,newData:!0})},t.prototype.batchUpdateRowData=function(e,r){var i=this;if(null==this.applyAsyncTransactionsTimeout){this.rowDataTransactionBatch=[];var n=this.gridOptionsService.getAsyncTransactionWaitMillis();this.applyAsyncTransactionsTimeout=window.setTimeout(function(){i.executeBatchUpdateRowData()},n)}this.rowDataTransactionBatch.push({rowDataTransaction:e,callback:r})},t.prototype.flushAsyncTransactions=function(){null!=this.applyAsyncTransactionsTimeout&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())},t.prototype.executeBatchUpdateRowData=function(){var e=this;this.valueCache.onDataChanged();var r=[],i=[],n=!1;if(this.rowDataTransactionBatch&&this.rowDataTransactionBatch.forEach(function(c){var v=e.nodeManager.updateRowData(c.rowDataTransaction,void 0);i.push(v),c.callback&&r.push(c.callback.bind(null,v)),"number"==typeof c.rowDataTransaction.addIndex&&(n=!0)}),this.commonUpdateRowData(i,void 0,n),r.length>0&&window.setTimeout(function(){r.forEach(function(c){return c()})},0),i.length>0){var u={type:I.EVENT_ASYNC_TRANSACTIONS_FLUSHED,results:i};this.eventService.dispatchEvent(u)}this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0},t.prototype.updateRowData=function(e,r){this.valueCache.onDataChanged();var i=this.nodeManager.updateRowData(e,r),n="number"==typeof e.addIndex;return this.commonUpdateRowData([i],r,n),i},t.prototype.createRowNodeOrder=function(){if(!this.gridOptionsService.is("suppressMaintainUnsortedOrder")){var r={};if(this.rootNode&&this.rootNode.allLeafChildren)for(var i=0;i<this.rootNode.allLeafChildren.length;i++){r[this.rootNode.allLeafChildren[i].id]=i}return r}},t.prototype.commonUpdateRowData=function(e,r,i){var n=!this.gridOptionsService.is("suppressAnimationFrame");i&&(r=this.createRowNodeOrder()),this.refreshModel({step:bt.EVERYTHING,rowNodeTransactions:e,rowNodeOrder:r,keepRenderedRows:!0,keepEditingRows:!0,animate:n}),this.filterManager.onNewRowsLoaded("rowDataUpdated");var u={type:I.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(u)},t.prototype.doRowsToDisplay=function(){this.rowsToDisplay=this.flattenStage.execute({rowNode:this.rootNode})},t.prototype.onRowHeightChanged=function(){this.refreshModel({step:bt.MAP,keepRenderedRows:!0,keepEditingRows:!0,keepUndoRedoStack:!0})},t.prototype.onRowHeightChangedDebounced=function(){this.onRowHeightChanged_debounced()},t.prototype.resetRowHeights=function(){var e=this.resetRowHeightsForAllRowNodes();this.rootNode.setRowHeight(this.rootNode.rowHeight,!0),e&&this.onRowHeightChanged()},t.prototype.resetRowHeightsForAllRowNodes=function(){var e=!1;return this.forEachNode(function(r){r.setRowHeight(r.rowHeight,!0);var i=r.detailNode;i&&i.setRowHeight(i.rowHeight,!0),e=!0}),e},t.prototype.onGridStylesChanges=function(){this.columnModel.isAutoRowHeightActive()||this.resetRowHeights()},vi([D("columnModel")],t.prototype,"columnModel",void 0),vi([D("selectionService")],t.prototype,"selectionService",void 0),vi([D("filterManager")],t.prototype,"filterManager",void 0),vi([D("valueCache")],t.prototype,"valueCache",void 0),vi([D("beans")],t.prototype,"beans",void 0),vi([D("filterStage")],t.prototype,"filterStage",void 0),vi([D("sortStage")],t.prototype,"sortStage",void 0),vi([D("flattenStage")],t.prototype,"flattenStage",void 0),vi([Ft("groupStage")],t.prototype,"groupStage",void 0),vi([Ft("aggregationStage")],t.prototype,"aggregationStage",void 0),vi([Ft("pivotStage")],t.prototype,"pivotStage",void 0),vi([Ft("filterAggregatesStage")],t.prototype,"filterAggregatesStage",void 0),vi([Re],t.prototype,"init",null),t=vi([He("rowModel")],t)}(we),IC=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Cf=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Zd=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return IC(t,o),t.prototype.execute=function(e){var r=e.changedPath;this.filterService.filter(r)},Cf([D("filterService")],t.prototype,"filterService",void 0),t=Cf([He("filterStage")],t)}(we),eh=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ja=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},th=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return eh(t,o),t.prototype.execute=function(e){var r=this,i=this.sortController.getSortOptions(),n=rt.exists(i)&&i.length>0,u=n&&rt.exists(e.rowNodeTransactions)&&this.gridOptionsService.is("deltaSort"),c=i.some(function(v){return!!r.columnModel.getGroupDisplayColumnForGroup(v.column.getId())});this.sortService.sort(i,n,u,e.rowNodeTransactions,e.changedPath,c)},ja([D("sortService")],t.prototype,"sortService",void 0),ja([D("sortController")],t.prototype,"sortController",void 0),ja([D("columnModel")],t.prototype,"columnModel",void 0),t=ja([He("sortStage")],t)}(we),LC=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Eu=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},rh=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return LC(t,o),t.prototype.execute=function(e){var r=e.rowNode,i=[],n={value:0},u=this.columnModel.isPivotMode(),c=u&&r.leafGroup,v=c?[r]:r.childrenAfterSort;this.recursivelyAddToRowsToDisplay(v,i,n,u,0);var m=i.length>0;return!c&&m&&this.gridOptionsService.is("groupIncludeTotalFooter")&&(r.createFooter(),this.addRowNodeToRowsToDisplay(r.sibling,i,n,0)),i},t.prototype.recursivelyAddToRowsToDisplay=function(e,r,i,n,u){if(!rt.missingOrEmpty(e))for(var c=this.gridOptionsService.is("groupHideOpenParents"),v=this.gridOptionsService.is("groupRemoveSingleChildren"),m=!v&&this.gridOptionsService.is("groupRemoveLowestSingleChildren"),C=0;C<e.length;C++){var _=e[C],O=_.hasChildren(),P=n&&!O,L=v&&O&&1===_.childrenAfterGroup.length,z=m&&O&&_.leafGroup&&1===_.childrenAfterGroup.length,q=n&&_.leafGroup,Z=c&&_.expanded&&!_.master&&!q;if(!(P||Z||L||z)&&this.addRowNodeToRowsToDisplay(_,r,i,u),!n||!_.leafGroup)if(O){var pe=L||z;if(_.expanded||pe){var Ce=pe?u:u+1;this.recursivelyAddToRowsToDisplay(_.childrenAfterSort,r,i,n,Ce),this.gridOptionsService.is("groupIncludeFooter")&&this.addRowNodeToRowsToDisplay(_.sibling,r,i,u)}}else if(_.master&&_.expanded){var be=this.createDetailNode(_);this.addRowNodeToRowsToDisplay(be,r,i,u)}}},t.prototype.addRowNodeToRowsToDisplay=function(e,r,i,n){var u=this.gridOptionsService.isGroupMultiAutoColumn();r.push(e),e.setUiLevel(u?0:n)},t.prototype.createDetailNode=function(e){if(rt.exists(e.detailNode))return e.detailNode;var r=new wt(this.beans);return r.detail=!0,r.selectable=!1,r.parent=e,rt.exists(e.id)&&(r.id="detail_"+e.id),r.data=e.data,r.level=e.level+1,e.detailNode=r,r},Eu([D("columnModel")],t.prototype,"columnModel",void 0),Eu([D("beans")],t.prototype,"beans",void 0),t=Eu([He("flattenStage")],t)}(we),ih=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),za=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},MC=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return ih(t,o),t.prototype.init=function(){this.postSortFunc=this.getPostSortFunc()},t.prototype.sort=function(e,r,i,n,u,c){var v=this,m=this.gridOptionsService.is("groupMaintainOrder"),C=this.columnModel.getAllGridColumns().some(function(L){return L.isRowGroupActive()}),_={};i&&n&&(_=this.calculateDirtyNodes(n));var O=this.columnModel.isPivotMode();u&&u.forEachChangedNodeDepthFirst(function(L){v.pullDownGroupDataForHideOpenParents(L.childrenAfterAggFilter,!0);var z=O&&L.leafGroup;if(m&&C&&!L.leafGroup&&!c){var Z=L.childrenAfterAggFilter.slice(0);if(L.childrenAfterSort){var re={};L.childrenAfterSort.forEach(function(Ce,be){re[Ce.id]=be}),Z.sort(function(Ce,be){var qe,et;return(null!==(qe=re[Ce.id])&&void 0!==qe?qe:0)-(null!==(et=re[be.id])&&void 0!==et?et:0)})}L.childrenAfterSort=Z}else L.childrenAfterSort=!r||z?L.childrenAfterAggFilter.slice(0):i?v.doDeltaSort(L,_,u,e):v.rowNodeSorter.doFullSort(L.childrenAfterAggFilter,e);if(L.sibling&&(L.sibling.childrenAfterSort=L.childrenAfterSort),v.updateChildIndexes(L),v.postSortFunc){var pe={nodes:L.childrenAfterSort};v.postSortFunc(pe)}}),this.updateGroupDataForHideOpenParents(u)},t.prototype.getPostSortFunc=function(){var e=this.gridOptionsService.getCallback("postSortRows");if(e)return e;var r=this.gridOptionsService.get("postSort");return r?function(i){return r(i.nodes)}:void 0},t.prototype.calculateDirtyNodes=function(e){var r={},i=function(n){n&&n.forEach(function(u){return r[u.id]=!0})};return e&&e.forEach(function(n){i(n.add),i(n.update),i(n.remove)}),r},t.prototype.doDeltaSort=function(e,r,i,n){var u=this,c=e.childrenAfterAggFilter,v=e.childrenAfterSort;if(!v)return this.rowNodeSorter.doFullSort(c,n);var m={},C=[];c.forEach(function(L){r[L.id]||!i.canSkip(L)?C.push(L):m[L.id]=!0});var _=v.filter(function(L){return m[L.id]}),O=function(L,z){return{currentPos:z,rowNode:L}},P=C.map(O).sort(function(L,z){return u.rowNodeSorter.compareRowNodes(n,L,z)});return this.mergeSortedArrays(n,P,_.map(O)).map(function(L){return L.rowNode})},t.prototype.mergeSortedArrays=function(e,r,i){for(var n=[],u=0,c=0;u<r.length&&c<i.length;){this.rowNodeSorter.compareRowNodes(e,r[u],i[c])<0?n.push(r[u++]):n.push(i[c++])}for(;u<r.length;)n.push(r[u++]);for(;c<i.length;)n.push(i[c++]);return n},t.prototype.updateChildIndexes=function(e){if(!rt.missing(e.childrenAfterSort))for(var r=e.childrenAfterSort,i=0;i<r.length;i++){var n=r[i],u=0===i,c=i===e.childrenAfterSort.length-1;n.setFirstChild(u),n.setLastChild(c),n.setChildIndex(i)}},t.prototype.updateGroupDataForHideOpenParents=function(e){var r=this;if(this.gridOptionsService.is("groupHideOpenParents")){if(this.gridOptionsService.isTreeData()){return rt.doOnce(function(){return console.warn("AG Grid: The property hideOpenParents dose not work with Tree Data. This is because Tree Data has values at the group level, it doesn't make sense to hide them (as opposed to Row Grouping, which only has Aggregated Values at the group level).")},"sortService.hideOpenParentsWithTreeData"),!1}var n=function(u){r.pullDownGroupDataForHideOpenParents(u.childrenAfterSort,!1),u.childrenAfterSort.forEach(function(c){c.hasChildren()&&n(c)})};e&&e.executeFromRootNode(function(u){return n(u)})}},t.prototype.pullDownGroupDataForHideOpenParents=function(e,r){var i=this;!this.gridOptionsService.is("groupHideOpenParents")||rt.missing(e)||e.forEach(function(n){i.columnModel.getGroupDisplayColumns().forEach(function(c){var v=c.getColDef().showRowGroup;if("string"==typeof v){var m=v,C=i.columnModel.getPrimaryColumn(m);if(!(C===n.rowGroupColumn))if(r)n.setGroupValue(c.getId(),void 0);else{var O=n.getFirstChildOfFirstChild(C);O&&n.setGroupValue(c.getId(),O.key)}}else console.error("AG Grid: groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup")})})},za([D("columnModel")],t.prototype,"columnModel",void 0),za([D("rowNodeSorter")],t.prototype,"rowNodeSorter",void 0),za([Re],t.prototype,"init",null),t=za([He("sortService")],t)}(we),nh=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),oh=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},NC=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return nh(t,o),t.prototype.filter=function(e){var r=this.filterManager.isColumnFilterPresent()||this.filterManager.isQuickFilterPresent()||this.filterManager.isExternalFilterPresent();this.filterNodes(r,e)},t.prototype.filterNodes=function(e,r){var i=this,n=function(m,C){m.hasChildren()&&e&&!C?m.childrenAfterFilter=m.childrenAfterGroup.filter(function(_){var O=_.childrenAfterFilter&&_.childrenAfterFilter.length>0,P=_.data&&i.filterManager.doesRowPassFilter({rowNode:_});return O||P}):m.childrenAfterFilter=m.childrenAfterGroup,m.sibling&&(m.sibling.childrenAfterFilter=m.childrenAfterFilter)};if(this.doingTreeDataFiltering()){var u=function(m,C){if(m.childrenAfterGroup)for(var _=0;_<m.childrenAfterGroup.length;_++){var O=m.childrenAfterGroup[_],P=C||i.filterManager.doesRowPassFilter({rowNode:O});O.childrenAfterGroup?u(m.childrenAfterGroup[_],P):n(O,P)}n(m,C)};r.executeFromRootNode(function(m){return u(m,!1)})}else{r.forEachChangedNodeDepthFirst(function(m){return n(m,!1)},!0)}},t.prototype.doingTreeDataFiltering=function(){return this.gridOptionsService.isTreeData()&&!this.gridOptionsService.is("excludeChildrenWhenTreeDataFiltering")},oh([D("filterManager")],t.prototype,"filterManager",void 0),t=oh([He("filterService")],t)}(we),sh=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ka=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},lh=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return sh(t,o),t.prototype.postConstruct=function(){"clientSide"===this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel)},t.prototype.isActive=function(){var e=this.gridOptionsService.exists("getRowId"),r=this.gridOptionsService.is("immutableData");return!this.gridOptionsService.is("resetRowDataOnUpdate")&&(e||r)},t.prototype.setRowData=function(e){var r=this.createTransactionForRowData(e);if(r){var i=function(o,t){var e="function"==typeof Symbol&&o[Symbol.iterator];if(!e)return o;var i,u,r=e.call(o),n=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)n.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return n}(r,2),n=i[0],u=i[1];this.clientSideRowModel.updateRowData(n,u)}},t.prototype.createTransactionForRowData=function(e){if(rt.missing(this.clientSideRowModel))console.error("AG Grid: ImmutableService only works with ClientSideRowModel");else{var r=this.gridOptionsService.getRowIdFunc();if(null!=r){var i={remove:[],update:[],add:[]},n=this.clientSideRowModel.getCopyOfNodesMap(),c=this.gridOptionsService.is("suppressMaintainUnsortedOrder")?void 0:{};return rt.exists(e)&&e.forEach(function(v,m){var C=r({data:v,level:0}),_=n[C];(c&&(c[C]=m),_)?(_.data!==v&&i.update.push(v),n[C]=void 0):i.add.push(v)}),rt.iterateObject(n,function(v,m){m&&i.remove.push(m.data)}),[i,c]}console.error("AG Grid: ImmutableService requires getRowId() callback to be implemented, your row data needs IDs!")}},Ka([D("rowModel")],t.prototype,"rowModel",void 0),Ka([D("rowRenderer")],t.prototype,"rowRenderer",void 0),Ka([Re],t.prototype,"postConstruct",null),t=Ka([He("immutableService")],t)}(we),uh={version:"29.3.5",moduleName:Ne.ClientSideRowModelModule,rowModel:"clientSide",beans:[PC,Zd,th,rh,MC,NC,lh]},ch=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Wn=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},Ru=function(o){function t(e,r,i){var n=o.call(this,e)||this;return n.parentCache=r,n.params=i,n.startRow=e*i.blockSize,n.endRow=n.startRow+i.blockSize,n}return ch(t,o),t.prototype.postConstruct=function(){this.createRowNodes()},t.prototype.getBlockStateJson=function(){return{id:""+this.getId(),state:{blockNumber:this.getId(),startRow:this.getStartRow(),endRow:this.getEndRow(),pageStatus:this.getState()}}},t.prototype.setDataAndId=function(e,r,i){!e.id&&e.alreadyRendered&&(e.alreadyRendered=!1),rt.exists(r)?e.setDataAndId(r,i.toString()):e.setDataAndId(void 0,void 0)},t.prototype.loadFromDatasource=function(){var e=this,r=this.createLoadParams();rt.missing(this.params.datasource.getRows)?console.warn("AG Grid: datasource is missing getRows method"):window.setTimeout(function(){e.params.datasource.getRows(r)},0)},t.prototype.processServerFail=function(){},t.prototype.createLoadParams=function(){return{startRow:this.getStartRow(),endRow:this.getEndRow(),successCallback:this.pageLoaded.bind(this,this.getVersion()),failCallback:this.pageLoadFailed.bind(this,this.getVersion()),sortModel:this.params.sortModel,filterModel:this.params.filterModel,context:this.gridOptionsService.context}},t.prototype.forEachNode=function(e,r,i){var n=this;this.rowNodes.forEach(function(u,c){n.startRow+c<i&&e(u,r.next())})},t.prototype.getLastAccessed=function(){return this.lastAccessed},t.prototype.getRow=function(e,r){void 0===r&&(r=!1),r||(this.lastAccessed=this.params.lastAccessedSequence.next());var i=e-this.startRow;return this.rowNodes[i]},t.prototype.getStartRow=function(){return this.startRow},t.prototype.getEndRow=function(){return this.endRow},t.prototype.createRowNodes=function(){this.rowNodes=[];for(var e=0;e<this.params.blockSize;e++){var r=this.startRow+e,i=new wt(this.beans);i.setRowHeight(this.params.rowHeight),i.uiLevel=0,i.setRowIndex(r),i.setRowTop(this.params.rowHeight*r),this.rowNodes.push(i)}},t.prototype.processServerResult=function(e){var r=this;this.rowNodes.forEach(function(n,u){var c=e.rowData?e.rowData[u]:void 0;r.setDataAndId(n,c,r.startRow+u)});var i=null!=e.rowCount&&e.rowCount>=0?e.rowCount:void 0;this.parentCache.pageLoaded(this,i)},t.prototype.destroyRowNodes=function(){this.rowNodes.forEach(function(e){e.clearRowTopAndRowIndex()})},Wn([D("beans")],t.prototype,"beans",void 0),Wn([Re],t.prototype,"postConstruct",null),Wn([Mr],t.prototype,"destroyRowNodes",null),t}(qc),GC=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Tu=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},ho=function(o,t){return function(e,r){t(e,r,o)}},fh=function(o){function t(e){var r=o.call(this)||this;return r.lastRowIndexKnown=!1,r.blocks={},r.blockCount=0,r.rowCount=e.initialRowCount,r.params=e,r}return GC(t,o),t.prototype.setBeans=function(e){this.logger=e.create("InfiniteCache")},t.prototype.getRow=function(e,r){void 0===r&&(r=!1);var i=Math.floor(e/this.params.blockSize),n=this.blocks[i];if(!n){if(r)return;n=this.createBlock(i)}return n.getRow(e)},t.prototype.createBlock=function(e){var r=this.createBean(new Ru(e,this,this.params));return this.blocks[r.getId()]=r,this.blockCount++,this.purgeBlocksIfNeeded(r),this.params.rowNodeBlockLoader.addBlock(r),r},t.prototype.refreshCache=function(){0==this.blockCount?this.purgeCache():(this.getBlocksInOrder().forEach(function(r){return r.setStateWaitingToLoad()}),this.params.rowNodeBlockLoader.checkBlockToLoad())},t.prototype.destroyAllBlocks=function(){var e=this;this.getBlocksInOrder().forEach(function(r){return e.destroyBlock(r)})},t.prototype.getRowCount=function(){return this.rowCount},t.prototype.isLastRowIndexKnown=function(){return this.lastRowIndexKnown},t.prototype.pageLoaded=function(e,r){this.isAlive()&&(this.logger.log("onPageLoaded: page = "+e.getId()+", lastRow = "+r),this.checkRowCount(e,r),this.onCacheUpdated())},t.prototype.purgeBlocksIfNeeded=function(e){var r=this,i=this.getBlocksInOrder().filter(function(m){return m!=e});i.sort(function(m,C){return C.getLastAccessed()-m.getLastAccessed()});var u=this.params.maxBlocksInCache>0,c=u?this.params.maxBlocksInCache-1:null,v=t.MAX_EMPTY_BLOCKS_TO_KEEP-1;i.forEach(function(m,C){if(m.getState()===Ru.STATE_WAITING_TO_LOAD&&C>=v||!!u&&C>=c){if(r.isBlockCurrentlyDisplayed(m)||r.isBlockFocused(m))return;r.removeBlockFromCache(m)}})},t.prototype.isBlockFocused=function(e){var r=this.focusService.getFocusCellToUseAfterRefresh();if(!r||null!=r.rowPinned)return!1;var i=e.getStartRow(),n=e.getEndRow();return r.rowIndex>=i&&r.rowIndex<n},t.prototype.isBlockCurrentlyDisplayed=function(e){var r=e.getStartRow(),i=e.getEndRow()-1;return this.rowRenderer.isRangeInRenderedViewport(r,i)},t.prototype.removeBlockFromCache=function(e){e&&this.destroyBlock(e)},t.prototype.checkRowCount=function(e,r){if("number"==typeof r&&r>=0)this.rowCount=r,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){var n=(e.getId()+1)*this.params.blockSize+this.params.overflowSize;this.rowCount<n&&(this.rowCount=n)}},t.prototype.setRowCount=function(e,r){this.rowCount=e,rt.exists(r)&&(this.lastRowIndexKnown=r),this.lastRowIndexKnown||this.rowCount%this.params.blockSize==0&&this.rowCount++,this.onCacheUpdated()},t.prototype.forEachNodeDeep=function(e){var r=this,i=new cs;this.getBlocksInOrder().forEach(function(n){return n.forEachNode(e,i,r.rowCount)})},t.prototype.getBlocksInOrder=function(){return rt.getAllValuesInObject(this.blocks).sort(function(i,n){return i.getId()-n.getId()})},t.prototype.destroyBlock=function(e){delete this.blocks[e.getId()],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)},t.prototype.onCacheUpdated=function(){if(this.isAlive()){this.destroyAllBlocksPastVirtualRowCount();var e={type:I.EVENT_STORE_UPDATED};this.eventService.dispatchEvent(e)}},t.prototype.destroyAllBlocksPastVirtualRowCount=function(){var e=this,r=[];this.getBlocksInOrder().forEach(function(i){i.getId()*e.params.blockSize>=e.rowCount&&r.push(i)}),r.length>0&&r.forEach(function(i){return e.destroyBlock(i)})},t.prototype.purgeCache=function(){var e=this;this.getBlocksInOrder().forEach(function(r){return e.removeBlockFromCache(r)}),this.lastRowIndexKnown=!1,0===this.rowCount&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()},t.prototype.getRowNodesInRange=function(e,r){var i=this,n=[],u=-1,c=!1,v=new cs;rt.missing(e)&&(c=!0);var m=!1;return this.getBlocksInOrder().forEach(function(_){if(!m){if(c&&u+1!==_.getId())return void(m=!0);u=_.getId(),_.forEachNode(function(O){var P=O===e||O===r;(c||P)&&n.push(O),P&&(c=!c)},v,i.rowCount)}}),m||c?[]:n},t.MAX_EMPTY_BLOCKS_TO_KEEP=2,Tu([D("rowRenderer")],t.prototype,"rowRenderer",void 0),Tu([D("focusService")],t.prototype,"focusService",void 0),Tu([ho(0,Zr("loggerFactory"))],t.prototype,"setBeans",null),Tu([Mr],t.prototype,"destroyAllBlocks",null),t}(we),HC=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),vo=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},$a=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return HC(t,o),t.prototype.getRowBounds=function(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}},t.prototype.ensureRowHeightsValid=function(e,r,i,n){return!1},t.prototype.init=function(){var e=this;this.gridOptionsService.isRowModelType("infinite")&&(this.rowHeight=this.gridOptionsService.getRowHeightAsNumber(),this.addEventListeners(),this.addDestroyFunc(function(){return e.destroyCache()}),this.verifyProps())},t.prototype.verifyProps=function(){if(this.gridOptionsService.exists("initialGroupOrderComparator")||this.gridOptionsService.exists("defaultGroupOrderComparator")){rt.doOnce(function(){return console.warn("AG Grid: initialGroupOrderComparator cannot be used with Infinite Row Model. If using Infinite Row Model, then sorting is done on the server side, nothing to do with the client.")},"IRM.InitialGroupOrderComparator")}},t.prototype.start=function(){this.setDatasource(this.gridOptionsService.get("datasource"))},t.prototype.destroyDatasource=function(){this.datasource&&(this.getContext().destroyBean(this.datasource),this.rowRenderer.datasourceChanged(),this.datasource=null)},t.prototype.addEventListeners=function(){this.addManagedListener(this.eventService,I.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,I.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverything.bind(this)),this.addManagedListener(this.eventService,I.EVENT_STORE_UPDATED,this.onCacheUpdated.bind(this))},t.prototype.onFilterChanged=function(){this.reset()},t.prototype.onSortChanged=function(){this.reset()},t.prototype.onColumnEverything=function(){(!this.cacheParams||this.isSortModelDifferent())&&this.reset()},t.prototype.isSortModelDifferent=function(){return!rt.jsonEquals(this.cacheParams.sortModel,this.sortController.getSortModel())},t.prototype.getType=function(){return"infinite"},t.prototype.setDatasource=function(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()},t.prototype.isEmpty=function(){return!this.infiniteCache},t.prototype.isRowsToRender=function(){return!!this.infiniteCache},t.prototype.getNodesInRangeForSelection=function(e,r){return this.infiniteCache?this.infiniteCache.getRowNodesInRange(e,r):[]},t.prototype.reset=function(){if(this.datasource){null!=this.gridOptionsService.getRowIdFunc()||this.selectionService.reset(),this.resetCache();var i=this.createModelUpdatedEvent();this.eventService.dispatchEvent(i)}},t.prototype.createModelUpdatedEvent=function(){return{type:I.EVENT_MODEL_UPDATED,newPage:!1,newData:!1,keepRenderedRows:!0,animate:!1}},t.prototype.resetCache=function(){this.destroyCache(),this.cacheParams={datasource:this.datasource,filterModel:this.filterManager.getFilterModel(),sortModel:this.sortController.getSortModel(),rowNodeBlockLoader:this.rowNodeBlockLoader,initialRowCount:this.defaultIfInvalid(this.gridOptionsService.getNum("infiniteInitialRowCount"),1),maxBlocksInCache:this.gridOptionsService.getNum("maxBlocksInCache"),rowHeight:this.gridOptionsService.getRowHeightAsNumber(),overflowSize:this.defaultIfInvalid(this.gridOptionsService.getNum("cacheOverflowSize"),1),blockSize:this.defaultIfInvalid(this.gridOptionsService.getNum("cacheBlockSize"),100),lastAccessedSequence:new cs},this.infiniteCache=this.createBean(new fh(this.cacheParams))},t.prototype.defaultIfInvalid=function(e,r){return e>0?e:r},t.prototype.destroyCache=function(){this.infiniteCache&&(this.infiniteCache=this.destroyBean(this.infiniteCache))},t.prototype.onCacheUpdated=function(){var e=this.createModelUpdatedEvent();this.eventService.dispatchEvent(e)},t.prototype.getRow=function(e){if(this.infiniteCache&&!(e>=this.infiniteCache.getRowCount()))return this.infiniteCache.getRow(e)},t.prototype.getRowNode=function(e){var r;return this.forEachNode(function(i){i.id===e&&(r=i)}),r},t.prototype.forEachNode=function(e){this.infiniteCache&&this.infiniteCache.forEachNodeDeep(e)},t.prototype.getTopLevelRowCount=function(){return this.getRowCount()},t.prototype.getTopLevelRowDisplayedIndex=function(e){return e},t.prototype.getRowIndexAtPixel=function(e){if(0!==this.rowHeight){var r=Math.floor(e/this.rowHeight),i=this.getRowCount()-1;return r>i?i:r}return 0},t.prototype.getRowCount=function(){return this.infiniteCache?this.infiniteCache.getRowCount():0},t.prototype.isRowPresent=function(e){return!!this.getRowNode(e.id)},t.prototype.refreshCache=function(){this.infiniteCache&&this.infiniteCache.refreshCache()},t.prototype.purgeCache=function(){this.infiniteCache&&this.infiniteCache.purgeCache()},t.prototype.isLastRowIndexKnown=function(){return!!this.infiniteCache&&this.infiniteCache.isLastRowIndexKnown()},t.prototype.setRowCount=function(e,r){this.infiniteCache&&this.infiniteCache.setRowCount(e,r)},vo([D("filterManager")],t.prototype,"filterManager",void 0),vo([D("sortController")],t.prototype,"sortController",void 0),vo([D("selectionService")],t.prototype,"selectionService",void 0),vo([D("rowRenderer")],t.prototype,"rowRenderer",void 0),vo([D("rowNodeBlockLoader")],t.prototype,"rowNodeBlockLoader",void 0),vo([Re],t.prototype,"init",null),vo([Mr],t.prototype,"destroyDatasource",null),t=vo([He("rowModel")],t)}(we),ur={version:"29.3.5",moduleName:Ne.InfiniteRowModelModule,rowModel:"infinite",beans:[$a]},Lt=function(){function o(){}return o.prototype.setBeans=function(t){this.beans=t},o.prototype.getFileName=function(t){var e=this.getDefaultFileExtension();return(null==t||!t.length)&&(t=this.getDefaultFileName()),-1===t.indexOf(".")?t+"."+e:t},o.prototype.getData=function(t){var e=this.createSerializingSession(t);return this.beans.gridSerializer.serialize(e,t)},o}(),Ar=function(){function o(t){this.groupColumns=[];var e=t.columnModel,r=t.valueService,i=t.gridOptionsService,n=t.processCellCallback,u=t.processHeaderCallback,c=t.processGroupHeaderCallback,v=t.processRowGroupCallback;this.columnModel=e,this.valueService=r,this.gridOptionsService=i,this.processCellCallback=n,this.processHeaderCallback=u,this.processGroupHeaderCallback=c,this.processRowGroupCallback=v}return o.prototype.prepare=function(t){this.groupColumns=t.filter(function(e){return!!e.getColDef().showRowGroup})},o.prototype.extractHeaderValue=function(t){return this.getHeaderName(this.processHeaderCallback,t)??""},o.prototype.extractRowCellValue=function(t,e,r,i,n){var c=this.gridOptionsService.is("groupHideOpenParents")&&!n.footer||!this.shouldRenderGroupSummaryCell(n,t,e)?this.valueService.getValue(t,n):this.createValueForGroupNode(n);return this.processCell({accumulatedRowIndex:r,rowNode:n,column:t,value:c,processCellCallback:this.processCellCallback,type:i})??""},o.prototype.shouldRenderGroupSummaryCell=function(t,e,r){var i;if(!(t&&t.group))return!1;if(-1!==this.groupColumns.indexOf(e)){if(null!==(i=t.groupData)&&void 0!==i&&i[e.getId()])return!0;if(t.footer&&-1===t.level){var c=e.getColDef();return null==c||!0===c.showRowGroup||c.showRowGroup===this.columnModel.getRowGroupColumns()[0].getId()}}var m=this.gridOptionsService.isGroupUseEntireRow(this.columnModel.isPivotMode());return 0===r&&m},o.prototype.getHeaderName=function(t,e){return t?t({column:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}):this.columnModel.getDisplayNameForColumn(e,"csv",!0)},o.prototype.createValueForGroupNode=function(t){if(this.processRowGroupCallback)return this.processRowGroupCallback({node:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context});var e=t.footer,r=[t.key];if(!this.gridOptionsService.isGroupMultiAutoColumn())for(;t.parent;)t=t.parent,r.push(t.key);var i=r.reverse().join(" -> ");return e?"Total "+i:i},o.prototype.processCell=function(t){var e=t.accumulatedRowIndex,r=t.rowNode,i=t.column,n=t.value,u=t.processCellCallback,c=t.type;return u?u({accumulatedRowIndex:e,column:i,node:r,value:n,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,type:c}):n??""},o}(),wf=function(){function o(){}return o.download=function(t,e){var r=document.defaultView||window;if(r){var i=document.createElement("a"),n=r.URL.createObjectURL(e);i.setAttribute("href",n),i.setAttribute("download",t),i.style.display="none",document.body.appendChild(i),i.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:r})),document.body.removeChild(i),r.setTimeout(function(){r.URL.revokeObjectURL(n)},0)}else console.warn("AG Grid: There is no `window` associated with the current `document`")},o}(),Ni=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),BC=function(o){function t(e){var r=o.call(this,e)||this;r.isFirstLine=!0,r.result="";var i=e.suppressQuotes,n=e.columnSeparator;return r.suppressQuotes=i,r.columnSeparator=n,r}return Ni(t,o),t.prototype.addCustomContent=function(e){var r=this;e&&("string"==typeof e?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,"\r\n"),this.result+=e):e.forEach(function(i){r.beginNewLine(),i.forEach(function(n,u){0!==u&&(r.result+=r.columnSeparator),r.result+=r.putInQuotes(n.data.value||""),n.mergeAcross&&r.appendEmptyCells(n.mergeAcross)})}))},t.prototype.onNewHeaderGroupingRow=function(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}},t.prototype.onNewHeaderGroupingRowColumn=function(e,r,i,n){0!=i&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(r),this.appendEmptyCells(n)},t.prototype.appendEmptyCells=function(e){for(var r=1;r<=e;r++)this.result+=this.columnSeparator+this.putInQuotes("")},t.prototype.onNewHeaderRow=function(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}},t.prototype.onNewHeaderRowColumn=function(e,r){0!=r&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))},t.prototype.onNewBodyRow=function(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}},t.prototype.onNewBodyRowColumn=function(e,r,i){0!=r&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractRowCellValue(e,r,r,"csv",i))},t.prototype.putInQuotes=function(e){return this.suppressQuotes?e:null==e?'""':("string"==typeof e?r=e:"function"==typeof e.toString?r=e.toString():(console.warn("AG Grid: unknown value type during csv conversion"),r=""),'"'+r.replace(/"/g,'""')+'"');var r},t.prototype.parse=function(){return this.result},t.prototype.beginNewLine=function(){this.isFirstLine||(this.result+="\r\n"),this.isFirstLine=!1},t}(Ar),ki=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Qi=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},VC=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return ki(t,o),t.prototype.postConstruct=function(){this.setBeans({gridSerializer:this.gridSerializer,gridOptionsService:this.gridOptionsService})},t.prototype.getMergedParams=function(e){var r=this.gridOptionsService.get("defaultCsvExportParams");return Object.assign({},r,e)},t.prototype.export=function(e){if(this.isExportSuppressed())return console.warn("AG Grid: Export cancelled. Export is not allowed as per your configuration."),"";var r=this.getMergedParams(e),i=this.getData(r),n=new Blob(["\ufeff",i],{type:"text/plain"});return wf.download(this.getFileName(r.fileName),n),i},t.prototype.exportDataAsCsv=function(e){return this.export(e)},t.prototype.getDataAsCsv=function(e,r){void 0===r&&(r=!1);var i=r?Object.assign({},e):this.getMergedParams(e);return this.getData(i)},t.prototype.getDefaultFileName=function(){return"export.csv"},t.prototype.getDefaultFileExtension=function(){return"csv"},t.prototype.createSerializingSession=function(e){var r=this,i=r.columnModel,n=r.valueService,u=r.gridOptionsService,c=e,v=c.processCellCallback,m=c.processHeaderCallback,C=c.processGroupHeaderCallback,_=c.processRowGroupCallback,O=c.suppressQuotes,P=c.columnSeparator;return new BC({columnModel:i,valueService:n,gridOptionsService:u,processCellCallback:v||void 0,processHeaderCallback:m||void 0,processGroupHeaderCallback:C||void 0,processRowGroupCallback:_||void 0,suppressQuotes:O||!1,columnSeparator:P||","})},t.prototype.isExportSuppressed=function(){return this.gridOptionsService.is("suppressCsvExport")},Qi([D("columnModel")],t.prototype,"columnModel",void 0),Qi([D("valueService")],t.prototype,"valueService",void 0),Qi([D("gridSerializer")],t.prototype,"gridSerializer",void 0),Qi([D("gridOptionsService")],t.prototype,"gridOptionsService",void 0),Qi([Re],t.prototype,"postConstruct",null),t=Qi([He("csvCreator")],t)}(Lt),WC=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),_n=function(o,t,e,r){var u,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(o,t,e,r);else for(var c=o.length-1;c>=0;c--)(u=o[c])&&(n=(i<3?u(n):i>3?u(t,e,n):u(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n};!function(o){o[o.HEADER_GROUPING=0]="HEADER_GROUPING",o[o.HEADER=1]="HEADER",o[o.BODY=2]="BODY"}(Ou||(Ou={}));var UC=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return WC(t,o),t.prototype.serialize=function(e,r){void 0===r&&(r={});var i=this.getColumnsToExport(r.allColumns,r.columnKeys);return rt.compose(this.prepareSession(i),this.prependContent(r),this.exportColumnGroups(r,i),this.exportHeaders(r,i),this.processPinnedTopRows(r,i),this.processRows(r,i),this.processPinnedBottomRows(r,i),this.appendContent(r))(e).parse()},t.prototype.processRow=function(e,r,i,n){var u=r.shouldRowBeSkipped||function(){return!1},c=this.gridOptionsService.context,v=this.gridOptionsService.api,m=this.gridOptionsService.columnApi,C=this.gridOptionsService.is("groupRemoveSingleChildren"),_=this.gridOptionsService.is("groupRemoveLowestSingleChildren"),P=null!=r.rowPositions||!!r.onlySelected,L=this.gridOptionsService.is("groupHideOpenParents")&&!P,z=this.columnModel.isPivotMode()?n.leafGroup:!n.group,q=!!n.footer,Z=r.skipGroups||r.skipRowGroups,re=_&&n.leafGroup,pe=1===n.allChildrenCount&&(C||re);if((Z&&r.skipGroups&&rt.doOnce(function(){return console.warn("AG Grid: Since v25.2 `skipGroups` has been renamed to `skipRowGroups`.")},"gridSerializer-skipGroups"),!(!z&&!q&&(r.skipRowGroups||pe||L)||r.onlySelected&&!n.isSelected()||r.skipPinnedTop&&"top"===n.rowPinned||r.skipPinnedBottom&&"bottom"===n.rowPinned))&&((!(-1===n.level)||z||q)&&!u({node:n,api:v,columnApi:m,context:c}))){var qe=e.onNewBodyRow();if(i.forEach(function(ze,st){qe.onColumn(ze,st,n)}),r.getCustomContentBelowRow){var et=r.getCustomContentBelowRow({node:n,api:v,columnApi:m,context:c});et&&e.addCustomContent(et)}}},t.prototype.appendContent=function(e){return function(r){var i=e.customFooter||e.appendContent;return i&&(e.customFooter&&rt.doOnce(function(){return console.warn("AG Grid: Since version 25.2.0 the `customFooter` param has been deprecated. Use `appendContent` instead.")},"gridSerializer-customFooter"),r.addCustomContent(i)),r}},t.prototype.prependContent=function(e){return function(r){var i=e.customHeader||e.prependContent;return i&&(e.customHeader&&rt.doOnce(function(){return console.warn("AG Grid: Since version 25.2.0 the `customHeader` param has been deprecated. Use `prependContent` instead.")},"gridSerializer-customHeader"),r.addCustomContent(i)),r}},t.prototype.prepareSession=function(e){return function(r){return r.prepare(e),r}},t.prototype.exportColumnGroups=function(e,r){var i=this;return function(n){if(e.skipColumnGroupHeaders)e.columnGroups&&rt.doOnce(function(){return console.warn("AG Grid: Since v25.2 the `columnGroups` param has deprecated, and groups are exported by default.")},"gridSerializer-columnGroups");else{var u=new Uf,c=i.displayedGroupCreator.createDisplayedGroups(r,i.columnModel.getGridBalancedTree(),u,null);i.recursivelyAddHeaderGroups(c,n,e.processGroupHeaderCallback)}return n}},t.prototype.exportHeaders=function(e,r){return function(i){if(e.skipHeader||e.skipColumnHeaders)e.skipHeader&&rt.doOnce(function(){return console.warn("AG Grid: Since v25.2 the `skipHeader` param has been renamed to `skipColumnHeaders`.")},"gridSerializer-skipHeader");else{var n=i.onNewHeaderRow();r.forEach(function(u,c){n.onColumn(u,c,void 0)})}return i}},t.prototype.processPinnedTopRows=function(e,r){var i=this;return function(n){var u=i.processRow.bind(i,n,e,r);return e.rowPositions?e.rowPositions.filter(function(c){return"top"===c.rowPinned}).sort(function(c,v){return c.rowIndex-v.rowIndex}).map(function(c){return i.pinnedRowModel.getPinnedTopRow(c.rowIndex)}).forEach(u):i.pinnedRowModel.forEachPinnedTopRow(u),n}},t.prototype.processRows=function(e,r){var i=this;return function(n){var u=i.rowModel,c=u.getType(),v="clientSide"===c,m="serverSide"===c,C=!v&&e.onlySelected,_=i.processRow.bind(i,n,e,r),O=e.exportedRows,P=void 0===O?"filteredAndSorted":O;if(e.rowPositions)e.rowPositions.filter(function(z){return null==z.rowPinned}).sort(function(z,q){return z.rowIndex-q.rowIndex}).map(function(z){return u.getRow(z.rowIndex)}).forEach(_);else if(i.columnModel.isPivotMode())v?u.forEachPivotNode(_,!0):u.forEachNode(_);else if(e.onlySelectedAllPages||C){var L=i.selectionService.getSelectedNodes();i.replicateSortedOrder(L),L.forEach(_)}else"all"===P?u.forEachNode(_):v?u.forEachNodeAfterFilterAndSort(_,!0):m?u.forEachNodeAfterFilterAndSort(_):u.forEachNode(_);return n}},t.prototype.replicateSortedOrder=function(e){var r=this,i=this.sortController.getSortOptions(),n=function(u,c){var v,m,C,_;return null!=u.rowIndex&&null!=c.rowIndex?u.rowIndex-c.rowIndex:u.level===c.level?(null===(v=u.parent)||void 0===v?void 0:v.id)===(null===(m=c.parent)||void 0===m?void 0:m.id)?r.rowNodeSorter.compareRowNodes(i,{rowNode:u,currentPos:null!==(C=u.rowIndex)&&void 0!==C?C:-1},{rowNode:c,currentPos:null!==(_=c.rowIndex)&&void 0!==_?_:-1}):n(u.parent,c.parent):u.level>c.level?n(u.parent,c):n(u,c.parent)};e.sort(n)},t.prototype.processPinnedBottomRows=function(e,r){var i=this;return function(n){var u=i.processRow.bind(i,n,e,r);return e.rowPositions?e.rowPositions.filter(function(c){return"bottom"===c.rowPinned}).sort(function(c,v){return c.rowIndex-v.rowIndex}).map(function(c){return i.pinnedRowModel.getPinnedBottomRow(c.rowIndex)}).forEach(u):i.pinnedRowModel.forEachPinnedBottomRow(u),n}},t.prototype.getColumnsToExport=function(e,r){void 0===e&&(e=!1);var i=this.columnModel.isPivotMode();return r&&r.length?this.columnModel.getGridColumns(r):e&&!i?(this.gridOptionsService.isTreeData()?this.columnModel.getGridColumns([Jt]):[]).concat(this.columnModel.getAllPrimaryColumns()||[]):this.columnModel.getAllDisplayedColumns()},t.prototype.recursivelyAddHeaderGroups=function(e,r,i){var n=[];e.forEach(function(u){var c=u;c.getChildren&&c.getChildren().forEach(function(v){return n.push(v)})}),e.length>0&&e[0]instanceof ti&&this.doAddHeaderHeader(r,e,i),n&&n.length>0&&this.recursivelyAddHeaderGroups(n,r,i)},t.prototype.doAddHeaderHeader=function(e,r,i){var n=this,u=e.onNewHeaderGroupingRow(),c=0;r.forEach(function(v){var C,m=v;C=i?i({columnGroup:m,api:n.gridOptionsService.api,columnApi:n.gridOptionsService.columnApi,context:n.gridOptionsService.context}):n.columnModel.getDisplayNameForColumnGroup(m,"header");var _=m.getLeafColumns().reduce(function(O,P,L,z){var q=rt.last(O);return"open"===P.getColumnGroupShow()?(!q||null!=q[1])&&(q=[L],O.push(q)):q&&null==q[1]&&(q[1]=L-1),L===z.length-1&&q&&null==q[1]&&(q[1]=L),O},[]);u.onColumn(m,C||"",c++,m.getLeafColumns().length-1,_)})},_n([D("displayedGroupCreator")],t.prototype,"displayedGroupCreator",void 0),_n([D("columnModel")],t.prototype,"columnModel",void 0),_n([D("rowModel")],t.prototype,"rowModel",void 0),_n([D("pinnedRowModel")],t.prototype,"pinnedRowModel",void 0),_n([D("selectionService")],t.prototype,"selectionService",void 0),_n([D("rowNodeSorter")],t.prototype,"rowNodeSorter",void 0),_n([D("sortController")],t.prototype,"sortController",void 0),t=_n([He("gridSerializer")],t)}(we),ww={version:"29.3.5",moduleName:Ne.CsvExportModule,beans:[VC,UC]},zC=(function(){function o(){}o.createHeader=function(t){void 0===t&&(t={});var i=["version"];return t.version||(t.version="1.0"),t.encoding&&i.push("encoding"),t.standalone&&i.push("standalone"),"<?xml "+i.map(function(u){return u+'="'+t[u]+'"'}).join(" ")+" ?>"},o.createXml=function(t,e){var r=this,i="";t.properties&&(t.properties.prefixedAttributes&&t.properties.prefixedAttributes.forEach(function(u){Object.keys(u.map).forEach(function(c){i+=r.returnAttributeIfPopulated(u.prefix+c,u.map[c],e)})}),t.properties.rawMap&&Object.keys(t.properties.rawMap).forEach(function(u){i+=r.returnAttributeIfPopulated(u,t.properties.rawMap[u],e)}));var n="<"+t.name+i;return t.children||null!=t.textNode?null!=t.textNode?n+">"+t.textNode+"</"+t.name+">\r\n":(n+=">\r\n",t.children&&t.children.forEach(function(u){n+=r.createXml(u,e)}),n+"</"+t.name+">\r\n"):n+"/>\r\n"},o.returnAttributeIfPopulated=function(t,e,r){if(!e&&""!==e&&0!==e)return"";var i=e;return"boolean"==typeof e&&r&&(i=r(e))," "+t+'="'+i+'"'}}(),new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117])),KC=(function(){function o(){}o.addFolders=function(t){t.forEach(this.addFolder.bind(this))},o.addFolder=function(t){this.folders.push({path:t,created:new Date,isBase64:!1})},o.addFile=function(t,e,r){void 0===r&&(r=!1),this.files.push({path:t,created:new Date,content:e,isBase64:r})},o.getContent=function(t){void 0===t&&(t="application/zip");var e=this.buildFileStream(),r=this.buildUint8Array(e);return this.clearStream(),new Blob([r],{type:t})},o.clearStream=function(){this.folders=[],this.files=[]},o.buildFileStream=function(t){var e,r;void 0===t&&(t="");var i=this.folders.concat(this.files),n=i.length,u="",c=0,v=0;try{for(var m=function(o){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&o[t],r=0;if(e)return e.call(o);if(o&&"number"==typeof o.length)return{next:function(){return o&&r>=o.length&&(o=void 0),{value:o&&o[r++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(i),C=m.next();!C.done;C=m.next()){var _=C.value,O=this.getHeader(_,c),P=O.fileHeader,L=O.folderHeader,z=O.content;c+=P.length+z.length,v+=L.length,t+=P+z,u+=L}}catch(Z){e={error:Z}}finally{try{C&&!C.done&&(r=m.return)&&r.call(m)}finally{if(e)throw e.error}}return t+u+this.buildFolderEnd(n,v,c)},o.getHeader=function(t,e){var r=t.content,i=t.path,n=t.created,u=t.isBase64,c=rt.utf8_encode,v=rt.decToHex,m=c(i),C=m!==i,_=this.convertTime(n),O=this.convertDate(n),P="";if(C){var L=v(1,1)+v(this.getFromCrc32Table(m),4)+m;P="up"+v(L.length,2)+L}var z=r?this.getConvertedContent(r,u):{size:0,content:""},q=z.size,Z=z.content,re="\n\0"+(C?"\0\b":"\0\0")+"\0\0"+v(_,2)+v(O,2)+v(q?this.getFromCrc32Table(Z):0,4)+v(q,4)+v(q,4)+v(m.length,2)+v(P.length,2);return{fileHeader:"PK\x03\x04"+re+m+P,folderHeader:"PK\x01\x02\x14\0"+re+"\0\0\0\0\0\0"+(r?"\0\0\0\0":"\x10\0\0\0")+v(e,4)+m+P,content:Z||""}},o.getConvertedContent=function(t,e){return void 0===e&&(e=!1),e&&(t=t.split(";base64,")[1]),{size:(t=e?atob(t):t).length,content:t}},o.buildFolderEnd=function(t,e,r){var i=rt.decToHex;return"PK\x05\x06\0\0\0\0"+i(t,2)+i(t,2)+i(e,4)+i(r,4)+"\0\0"},o.buildUint8Array=function(t){for(var e=new Uint8Array(t.length),r=0;r<e.length;r++)e[r]=t.charCodeAt(r);return e},o.getFromCrc32Table=function(t){if(!t.length)return 0;for(var e=t.length,r=new Uint8Array(e),i=0;i<e;i++)r[i]=t.charCodeAt(i);var n=-1,u=0;for(i=0;i<e;i++)u=r[i],n=n>>>8^zC[255&(n^u)];return-1^n},o.convertTime=function(t){var e=t.getHours();return e<<=6,e|=t.getMinutes(),e<<=5,e|=t.getSeconds()/2},o.convertDate=function(t){var e=t.getFullYear()-1980;return e<<=4,e|=t.getMonth()+1,e<<=5,e|=t.getDate()},o.folders=[],o.files=[]}(),[uh,ur,ww]);it.registerModules(KC);class Wo extends Id{constructor(t){super(),this._ngZone=t}setEmitterUsedCallback(t){this.isEmitterUsed=t}setTimeout(t,e){this._ngZone?this._ngZone.runOutsideAngular(()=>{window.setTimeout(()=>{t()},e)}):window.setTimeout(()=>{t()},e)}setInterval(t,e){return new ir(r=>{this._ngZone?this._ngZone.runOutsideAngular(()=>{r(window.setInterval(()=>{t()},e))}):r(window.setInterval(()=>{t()},e))})}addEventListener(t,e,r,i){this.isOutsideAngular(e)&&this._ngZone?this._ngZone.runOutsideAngular(()=>{t.addEventListener(e,r,i)}):t.addEventListener(e,r,i)}dispatchEvent(t,e,r=!1){this.isOutsideAngular(t)?this._ngZone?this._ngZone.runOutsideAngular(e):e():(this.isEmitterUsed(t)||r)&&(!Se.R0b.isInAngularZone()&&this._ngZone?this._ngZone.run(e):e())}isFrameworkComponent(t){if(!t)return!1;const e=t.prototype;return e&&"agInit"in e}}Wo.\u0275fac=function(t){return new(t||Wo)(Se.LFG(Se.R0b))},Wo.\u0275prov=Se.Yz7({token:Wo,factory:Wo.\u0275fac});class xn extends De{setViewContainerRef(t){this.viewContainerRef=t}setComponentFactoryResolver(t){this.componentFactoryResolver=t}createWrapper(t){let e=this;let i=new class r extends $C{init(u){super.init(u),this._componentRef.changeDetectorRef.detectChanges()}createComponent(){return e.createComponent(t)}hasMethod(u){return null!=i.getFrameworkComponentInstance()[u]}callMethod(u,c){const v=this.getFrameworkComponentInstance();return i.getFrameworkComponentInstance()[u].apply(v,c)}addMethod(u,c){i[u]=c}};return i}createComponent(t){let e=this.componentFactoryResolver.resolveComponentFactory(t);return this.viewContainerRef.createComponent(e)}}xn.\u0275fac=function(){let o;return function(e){return(o||(o=Se.n5z(xn)))(e||xn)}}(),xn.\u0275prov=Se.Yz7({token:xn,factory:xn.\u0275fac});class $C{init(t){this._params=t,this._componentRef=this.createComponent(),this._agAwareComponent=this._componentRef.instance,this._frameworkComponentInstance=this._componentRef.instance,this._eGui=this._componentRef.location.nativeElement,this._agAwareComponent.agInit(this._params)}getGui(){return this._eGui}destroy(){this._frameworkComponentInstance&&"function"==typeof this._frameworkComponentInstance.destroy&&this._frameworkComponentInstance.destroy(),this._componentRef&&this._componentRef.destroy()}getFrameworkComponentInstance(){return this._frameworkComponentInstance}}class Xa{constructor(t,e,r,i,n){this.viewContainerRef=e,this.angularFrameworkOverrides=r,this.frameworkComponentWrapper=i,this.componentFactoryResolver=n,this._initialised=!1,this._destroyed=!1,this._fullyReady=ir.resolve(!0),this.statusBar=void 0,this.sideBar=void 0,this.suppressContextMenu=void 0,this.preventDefaultOnContextMenu=void 0,this.allowContextMenuWithControlKey=void 0,this.suppressMenuHide=void 0,this.enableBrowserTooltips=void 0,this.tooltipShowDelay=void 0,this.tooltipHideDelay=void 0,this.tooltipMouseTrack=void 0,this.popupParent=void 0,this.copyHeadersToClipboard=void 0,this.copyGroupHeadersToClipboard=void 0,this.clipboardDelimiter=void 0,this.suppressCopyRowsToClipboard=void 0,this.suppressCopySingleCellRanges=void 0,this.suppressLastEmptyLineOnPaste=void 0,this.suppressClipboardPaste=void 0,this.suppressClipboardApi=void 0,this.suppressCutToClipboard=void 0,this.columnDefs=void 0,this.defaultColDef=void 0,this.defaultColGroupDef=void 0,this.columnTypes=void 0,this.maintainColumnOrder=void 0,this.suppressFieldDotNotation=void 0,this.headerHeight=void 0,this.groupHeaderHeight=void 0,this.floatingFiltersHeight=void 0,this.pivotHeaderHeight=void 0,this.pivotGroupHeaderHeight=void 0,this.allowDragFromColumnsToolPanel=void 0,this.suppressMovableColumns=void 0,this.suppressColumnMoveAnimation=void 0,this.suppressDragLeaveHidesColumns=void 0,this.suppressRowGroupHidesColumns=void 0,this.colResizeDefault=void 0,this.suppressAutoSize=void 0,this.autoSizePadding=void 0,this.skipHeaderOnAutoSize=void 0,this.components=void 0,this.frameworkComponents=void 0,this.editType=void 0,this.singleClickEdit=void 0,this.suppressClickEdit=void 0,this.readOnlyEdit=void 0,this.stopEditingWhenCellsLoseFocus=void 0,this.enterMovesDown=void 0,this.enterMovesDownAfterEdit=void 0,this.enableCellEditingOnBackspace=void 0,this.undoRedoCellEditing=void 0,this.undoRedoCellEditingLimit=void 0,this.defaultCsvExportParams=void 0,this.suppressCsvExport=void 0,this.defaultExcelExportParams=void 0,this.suppressExcelExport=void 0,this.excelStyles=void 0,this.quickFilterText=void 0,this.cacheQuickFilter=void 0,this.excludeHiddenColumnsFromQuickFilter=void 0,this.excludeChildrenWhenTreeDataFiltering=void 0,this.enableCharts=void 0,this.chartThemes=void 0,this.customChartThemes=void 0,this.chartThemeOverrides=void 0,this.enableChartToolPanelsButton=void 0,this.suppressChartToolPanelsButton=void 0,this.chartToolPanelsDef=void 0,this.loadingCellRenderer=void 0,this.loadingCellRendererFramework=void 0,this.loadingCellRendererParams=void 0,this.loadingCellRendererSelector=void 0,this.localeText=void 0,this.masterDetail=void 0,this.keepDetailRows=void 0,this.keepDetailRowsCount=void 0,this.detailCellRenderer=void 0,this.detailCellRendererFramework=void 0,this.detailCellRendererParams=void 0,this.detailRowHeight=void 0,this.detailRowAutoHeight=void 0,this.context=void 0,this.alignedGrids=void 0,this.tabIndex=void 0,this.rowBuffer=void 0,this.valueCache=void 0,this.valueCacheNeverExpires=void 0,this.enableCellExpressions=void 0,this.suppressParentsInRowNodes=void 0,this.suppressTouch=void 0,this.suppressFocusAfterRefresh=void 0,this.suppressAsyncEvents=void 0,this.suppressBrowserResizeObserver=void 0,this.suppressPropertyNamesCheck=void 0,this.suppressChangeDetection=void 0,this.debug=void 0,this.overlayLoadingTemplate=void 0,this.loadingOverlayComponent=void 0,this.loadingOverlayComponentFramework=void 0,this.loadingOverlayComponentParams=void 0,this.suppressLoadingOverlay=void 0,this.overlayNoRowsTemplate=void 0,this.noRowsOverlayComponent=void 0,this.noRowsOverlayComponentFramework=void 0,this.noRowsOverlayComponentParams=void 0,this.suppressNoRowsOverlay=void 0,this.pagination=void 0,this.paginationPageSize=void 0,this.paginationAutoPageSize=void 0,this.paginateChildRows=void 0,this.suppressPaginationPanel=void 0,this.pivotMode=void 0,this.pivotPanelShow=void 0,this.pivotColumnGroupTotals=void 0,this.pivotRowTotals=void 0,this.pivotSuppressAutoColumn=void 0,this.suppressExpandablePivotGroups=void 0,this.functionsReadOnly=void 0,this.aggFuncs=void 0,this.suppressAggFuncInHeader=void 0,this.suppressAggAtRootLevel=void 0,this.aggregateOnlyChangedColumns=void 0,this.suppressAggFilteredOnly=void 0,this.removePivotHeaderRowWhenSingleValueColumn=void 0,this.animateRows=void 0,this.enableCellChangeFlash=void 0,this.cellFlashDelay=void 0,this.cellFadeDelay=void 0,this.allowShowChangeAfterFilter=void 0,this.domLayout=void 0,this.ensureDomOrder=void 0,this.enableRtl=void 0,this.suppressColumnVirtualisation=void 0,this.suppressMaxRenderedRowRestriction=void 0,this.suppressRowVirtualisation=void 0,this.rowDragManaged=void 0,this.suppressRowDrag=void 0,this.suppressMoveWhenRowDragging=void 0,this.rowDragEntireRow=void 0,this.rowDragMultiRow=void 0,this.rowDragText=void 0,this.fullWidthCellRenderer=void 0,this.fullWidthCellRendererFramework=void 0,this.fullWidthCellRendererParams=void 0,this.embedFullWidthRows=void 0,this.groupDisplayType=void 0,this.groupDefaultExpanded=void 0,this.autoGroupColumnDef=void 0,this.groupMaintainOrder=void 0,this.groupSelectsChildren=void 0,this.groupAggFiltering=void 0,this.groupIncludeFooter=void 0,this.groupIncludeTotalFooter=void 0,this.groupSuppressBlankHeader=void 0,this.groupSelectsFiltered=void 0,this.showOpenedGroup=void 0,this.groupRemoveSingleChildren=void 0,this.groupRemoveLowestSingleChildren=void 0,this.groupHideOpenParents=void 0,this.groupAllowUnbalanced=void 0,this.rowGroupPanelShow=void 0,this.groupRowRenderer=void 0,this.groupRowRendererFramework=void 0,this.groupRowRendererParams=void 0,this.suppressMakeColumnVisibleAfterUnGroup=void 0,this.treeData=void 0,this.rowGroupPanelSuppressSort=void 0,this.groupRowsSticky=void 0,this.rememberGroupStateWhenNewData=void 0,this.pinnedTopRowData=void 0,this.pinnedBottomRowData=void 0,this.rowModelType=void 0,this.rowData=void 0,this.immutableData=void 0,this.asyncTransactionWaitMillis=void 0,this.suppressModelUpdateAfterUpdateTransaction=void 0,this.datasource=void 0,this.cacheOverflowSize=void 0,this.infiniteInitialRowCount=void 0,this.serverSideInitialRowCount=void 0,this.serverSideStoreType=void 0,this.suppressServerSideInfiniteScroll=void 0,this.cacheBlockSize=void 0,this.maxBlocksInCache=void 0,this.maxConcurrentDatasourceRequests=void 0,this.blockLoadDebounceMillis=void 0,this.purgeClosedRowNodes=void 0,this.serverSideDatasource=void 0,this.serverSideSortAllLevels=void 0,this.serverSideFilterAllLevels=void 0,this.serverSideSortOnServer=void 0,this.serverSideFilterOnServer=void 0,this.serverSideSortingAlwaysResets=void 0,this.serverSideFilteringAlwaysResets=void 0,this.viewportDatasource=void 0,this.viewportRowModelPageSize=void 0,this.viewportRowModelBufferSize=void 0,this.alwaysShowHorizontalScroll=void 0,this.alwaysShowVerticalScroll=void 0,this.debounceVerticalScrollbar=void 0,this.suppressHorizontalScroll=void 0,this.suppressScrollOnNewData=void 0,this.suppressScrollWhenPopupsAreOpen=void 0,this.suppressAnimationFrame=void 0,this.suppressMiddleClickScrolls=void 0,this.suppressPreventDefaultOnMouseWheel=void 0,this.scrollbarWidth=void 0,this.rowSelection=void 0,this.rowMultiSelectWithClick=void 0,this.suppressRowDeselection=void 0,this.suppressRowClickSelection=void 0,this.suppressCellSelection=void 0,this.suppressCellFocus=void 0,this.suppressMultiRangeSelection=void 0,this.enableCellTextSelection=void 0,this.enableRangeSelection=void 0,this.enableRangeHandle=void 0,this.enableFillHandle=void 0,this.fillHandleDirection=void 0,this.suppressClearOnFillReduction=void 0,this.sortingOrder=void 0,this.accentedSort=void 0,this.unSortIcon=void 0,this.suppressMultiSort=void 0,this.alwaysMultiSort=void 0,this.multiSortKey=void 0,this.suppressMaintainUnsortedOrder=void 0,this.icons=void 0,this.rowHeight=void 0,this.rowStyle=void 0,this.rowClass=void 0,this.rowClassRules=void 0,this.suppressRowHoverHighlight=void 0,this.suppressRowTransform=void 0,this.columnHoverHighlight=void 0,this.deltaSort=void 0,this.treeDataDisplayType=void 0,this.functionsPassive=void 0,this.enableGroupEdit=void 0,this.getContextMenuItems=void 0,this.getMainMenuItems=void 0,this.postProcessPopup=void 0,this.processCellForClipboard=void 0,this.processHeaderForClipboard=void 0,this.processGroupHeaderForClipboard=void 0,this.processCellFromClipboard=void 0,this.sendToClipboard=void 0,this.processDataFromClipboard=void 0,this.isExternalFilterPresent=void 0,this.doesExternalFilterPass=void 0,this.getChartToolbarItems=void 0,this.createChartContainer=void 0,this.navigateToNextHeader=void 0,this.tabToNextHeader=void 0,this.navigateToNextCell=void 0,this.tabToNextCell=void 0,this.localeTextFunc=void 0,this.getLocaleText=void 0,this.getDocument=void 0,this.paginationNumberFormatter=void 0,this.groupRowAggNodes=void 0,this.getGroupRowAgg=void 0,this.isGroupOpenByDefault=void 0,this.initialGroupOrderComparator=void 0,this.defaultGroupOrderComparator=void 0,this.processSecondaryColDef=void 0,this.processSecondaryColGroupDef=void 0,this.processPivotResultColDef=void 0,this.processPivotResultColGroupDef=void 0,this.getDataPath=void 0,this.getChildCount=void 0,this.getServerSideGroupLevelParams=void 0,this.getServerSideStoreParams=void 0,this.isServerSideGroupOpenByDefault=void 0,this.isApplyServerSideTransaction=void 0,this.isServerSideGroup=void 0,this.getServerSideGroupKey=void 0,this.getBusinessKeyForNode=void 0,this.getRowNodeId=void 0,this.getRowId=void 0,this.resetRowDataOnUpdate=void 0,this.processRowPostCreate=void 0,this.isRowSelectable=void 0,this.isRowMaster=void 0,this.fillOperation=void 0,this.postSort=void 0,this.postSortRows=void 0,this.getRowStyle=void 0,this.getRowClass=void 0,this.getRowHeight=void 0,this.isFullWidthCell=void 0,this.isFullWidthRow=void 0,this.toolPanelVisibleChanged=new Se.vpe,this.toolPanelSizeChanged=new Se.vpe,this.pasteStart=new Se.vpe,this.pasteEnd=new Se.vpe,this.columnVisible=new Se.vpe,this.columnPinned=new Se.vpe,this.columnResized=new Se.vpe,this.columnMoved=new Se.vpe,this.columnValueChanged=new Se.vpe,this.columnPivotModeChanged=new Se.vpe,this.columnPivotChanged=new Se.vpe,this.columnGroupOpened=new Se.vpe,this.newColumnsLoaded=new Se.vpe,this.gridColumnsChanged=new Se.vpe,this.displayedColumnsChanged=new Se.vpe,this.virtualColumnsChanged=new Se.vpe,this.columnEverythingChanged=new Se.vpe,this.componentStateChanged=new Se.vpe,this.cellValueChanged=new Se.vpe,this.cellEditRequest=new Se.vpe,this.rowValueChanged=new Se.vpe,this.cellEditingStarted=new Se.vpe,this.cellEditingStopped=new Se.vpe,this.rowEditingStarted=new Se.vpe,this.rowEditingStopped=new Se.vpe,this.undoStarted=new Se.vpe,this.undoEnded=new Se.vpe,this.redoStarted=new Se.vpe,this.redoEnded=new Se.vpe,this.filterOpened=new Se.vpe,this.filterChanged=new Se.vpe,this.filterModified=new Se.vpe,this.chartCreated=new Se.vpe,this.chartRangeSelectionChanged=new Se.vpe,this.chartOptionsChanged=new Se.vpe,this.chartDestroyed=new Se.vpe,this.cellKeyDown=new Se.vpe,this.cellKeyPress=new Se.vpe,this.gridReady=new Se.vpe,this.firstDataRendered=new Se.vpe,this.gridSizeChanged=new Se.vpe,this.modelUpdated=new Se.vpe,this.virtualRowRemoved=new Se.vpe,this.viewportChanged=new Se.vpe,this.bodyScroll=new Se.vpe,this.bodyScrollEnd=new Se.vpe,this.dragStarted=new Se.vpe,this.dragStopped=new Se.vpe,this.paginationChanged=new Se.vpe,this.rowDragEnter=new Se.vpe,this.rowDragMove=new Se.vpe,this.rowDragLeave=new Se.vpe,this.rowDragEnd=new Se.vpe,this.columnRowGroupChanged=new Se.vpe,this.rowGroupOpened=new Se.vpe,this.expandOrCollapseAll=new Se.vpe,this.pinnedRowDataChanged=new Se.vpe,this.rowDataChanged=new Se.vpe,this.rowDataUpdated=new Se.vpe,this.asyncTransactionsFlushed=new Se.vpe,this.storeRefreshed=new Se.vpe,this.cellClicked=new Se.vpe,this.cellDoubleClicked=new Se.vpe,this.cellFocused=new Se.vpe,this.cellMouseOver=new Se.vpe,this.cellMouseOut=new Se.vpe,this.cellMouseDown=new Se.vpe,this.rowClicked=new Se.vpe,this.rowDoubleClicked=new Se.vpe,this.rowSelected=new Se.vpe,this.selectionChanged=new Se.vpe,this.cellContextMenu=new Se.vpe,this.rangeSelectionChanged=new Se.vpe,this.sortChanged=new Se.vpe,this.columnRowGroupChangeRequest=new Se.vpe,this.columnPivotChangeRequest=new Se.vpe,this.columnValueChangeRequest=new Se.vpe,this.columnAggFuncChangeRequest=new Se.vpe,this._nativeElement=t.nativeElement}ngAfterViewInit(){this.frameworkComponentWrapper.setViewContainerRef(this.viewContainerRef),this.frameworkComponentWrapper.setComponentFactoryResolver(this.componentFactoryResolver),this.angularFrameworkOverrides.setEmitterUsedCallback(this.isEmitterUsed.bind(this)),this.gridOptions=Jo.copyAttributesToGridOptions(this.gridOptions,this),this.gridParams={globalEventListener:this.globalEventListener.bind(this),frameworkOverrides:this.angularFrameworkOverrides,providedBeanInstances:{frameworkComponentWrapper:this.frameworkComponentWrapper},modules:this.modules||[]},new Ua(this._nativeElement,this.gridOptions,this.gridParams),this.gridOptions.api&&(this.api=this.gridOptions.api),this.gridOptions.columnApi&&(this.columnApi=this.gridOptions.columnApi),this._initialised=!0,this._fullyReady.resolveNow(null,t=>t)}ngOnChanges(t){this._initialised&&Jo.processOnChange(t,this.api)}ngOnDestroy(){this._initialised&&(this._destroyed=!0,this.api&&this.api.destroy())}isEmitterUsed(t){const e=this[t],r=!!e&&e.observers&&e.observers.length>0,i=`on${t.charAt(0).toUpperCase()}${t.substring(1)}`,n=!!this.gridOptions&&!!this.gridOptions[i];return r||n}globalEventListener(t,e){if(this._destroyed)return;const r=this[t];r&&this.isEmitterUsed(t)&&("gridReady"===t?this._fullyReady.then(i=>{r.emit(e)}):r.emit(e))}}Xa.\u0275fac=function(t){return new(t||Xa)(Se.Y36(Se.SBq),Se.Y36(Se.s_b),Se.Y36(Wo),Se.Y36(xn),Se.Y36(Se._Vd))},Xa.\u0275cmp=Se.Xpm({type:Xa,selectors:[["ag-grid-angular"]],inputs:{gridOptions:"gridOptions",modules:"modules",statusBar:"statusBar",sideBar:"sideBar",suppressContextMenu:"suppressContextMenu",preventDefaultOnContextMenu:"preventDefaultOnContextMenu",allowContextMenuWithControlKey:"allowContextMenuWithControlKey",suppressMenuHide:"suppressMenuHide",enableBrowserTooltips:"enableBrowserTooltips",tooltipShowDelay:"tooltipShowDelay",tooltipHideDelay:"tooltipHideDelay",tooltipMouseTrack:"tooltipMouseTrack",popupParent:"popupParent",copyHeadersToClipboard:"copyHeadersToClipboard",copyGroupHeadersToClipboard:"copyGroupHeadersToClipboard",clipboardDelimiter:"clipboardDelimiter",suppressCopyRowsToClipboard:"suppressCopyRowsToClipboard",suppressCopySingleCellRanges:"suppressCopySingleCellRanges",suppressLastEmptyLineOnPaste:"suppressLastEmptyLineOnPaste",suppressClipboardPaste:"suppressClipboardPaste",suppressClipboardApi:"suppressClipboardApi",suppressCutToClipboard:"suppressCutToClipboard",columnDefs:"columnDefs",defaultColDef:"defaultColDef",defaultColGroupDef:"defaultColGroupDef",columnTypes:"columnTypes",maintainColumnOrder:"maintainColumnOrder",suppressFieldDotNotation:"suppressFieldDotNotation",headerHeight:"headerHeight",groupHeaderHeight:"groupHeaderHeight",floatingFiltersHeight:"floatingFiltersHeight",pivotHeaderHeight:"pivotHeaderHeight",pivotGroupHeaderHeight:"pivotGroupHeaderHeight",allowDragFromColumnsToolPanel:"allowDragFromColumnsToolPanel",suppressMovableColumns:"suppressMovableColumns",suppressColumnMoveAnimation:"suppressColumnMoveAnimation",suppressDragLeaveHidesColumns:"suppressDragLeaveHidesColumns",suppressRowGroupHidesColumns:"suppressRowGroupHidesColumns",colResizeDefault:"colResizeDefault",suppressAutoSize:"suppressAutoSize",autoSizePadding:"autoSizePadding",skipHeaderOnAutoSize:"skipHeaderOnAutoSize",components:"components",frameworkComponents:"frameworkComponents",editType:"editType",singleClickEdit:"singleClickEdit",suppressClickEdit:"suppressClickEdit",readOnlyEdit:"readOnlyEdit",stopEditingWhenCellsLoseFocus:"stopEditingWhenCellsLoseFocus",enterMovesDown:"enterMovesDown",enterMovesDownAfterEdit:"enterMovesDownAfterEdit",enableCellEditingOnBackspace:"enableCellEditingOnBackspace",undoRedoCellEditing:"undoRedoCellEditing",undoRedoCellEditingLimit:"undoRedoCellEditingLimit",defaultCsvExportParams:"defaultCsvExportParams",suppressCsvExport:"suppressCsvExport",defaultExcelExportParams:"defaultExcelExportParams",suppressExcelExport:"suppressExcelExport",excelStyles:"excelStyles",quickFilterText:"quickFilterText",cacheQuickFilter:"cacheQuickFilter",excludeHiddenColumnsFromQuickFilter:"excludeHiddenColumnsFromQuickFilter",excludeChildrenWhenTreeDataFiltering:"excludeChildrenWhenTreeDataFiltering",enableCharts:"enableCharts",chartThemes:"chartThemes",customChartThemes:"customChartThemes",chartThemeOverrides:"chartThemeOverrides",enableChartToolPanelsButton:"enableChartToolPanelsButton",suppressChartToolPanelsButton:"suppressChartToolPanelsButton",chartToolPanelsDef:"chartToolPanelsDef",loadingCellRenderer:"loadingCellRenderer",loadingCellRendererFramework:"loadingCellRendererFramework",loadingCellRendererParams:"loadingCellRendererParams",loadingCellRendererSelector:"loadingCellRendererSelector",localeText:"localeText",masterDetail:"masterDetail",keepDetailRows:"keepDetailRows",keepDetailRowsCount:"keepDetailRowsCount",detailCellRenderer:"detailCellRenderer",detailCellRendererFramework:"detailCellRendererFramework",detailCellRendererParams:"detailCellRendererParams",detailRowHeight:"detailRowHeight",detailRowAutoHeight:"detailRowAutoHeight",context:"context",alignedGrids:"alignedGrids",tabIndex:"tabIndex",rowBuffer:"rowBuffer",valueCache:"valueCache",valueCacheNeverExpires:"valueCacheNeverExpires",enableCellExpressions:"enableCellExpressions",suppressParentsInRowNodes:"suppressParentsInRowNodes",suppressTouch:"suppressTouch",suppressFocusAfterRefresh:"suppressFocusAfterRefresh",suppressAsyncEvents:"suppressAsyncEvents",suppressBrowserResizeObserver:"suppressBrowserResizeObserver",suppressPropertyNamesCheck:"suppressPropertyNamesCheck",suppressChangeDetection:"suppressChangeDetection",debug:"debug",overlayLoadingTemplate:"overlayLoadingTemplate",loadingOverlayComponent:"loadingOverlayComponent",loadingOverlayComponentFramework:"loadingOverlayComponentFramework",loadingOverlayComponentParams:"loadingOverlayComponentParams",suppressLoadingOverlay:"suppressLoadingOverlay",overlayNoRowsTemplate:"overlayNoRowsTemplate",noRowsOverlayComponent:"noRowsOverlayComponent",noRowsOverlayComponentFramework:"noRowsOverlayComponentFramework",noRowsOverlayComponentParams:"noRowsOverlayComponentParams",suppressNoRowsOverlay:"suppressNoRowsOverlay",pagination:"pagination",paginationPageSize:"paginationPageSize",paginationAutoPageSize:"paginationAutoPageSize",paginateChildRows:"paginateChildRows",suppressPaginationPanel:"suppressPaginationPanel",pivotMode:"pivotMode",pivotPanelShow:"pivotPanelShow",pivotColumnGroupTotals:"pivotColumnGroupTotals",pivotRowTotals:"pivotRowTotals",pivotSuppressAutoColumn:"pivotSuppressAutoColumn",suppressExpandablePivotGroups:"suppressExpandablePivotGroups",functionsReadOnly:"functionsReadOnly",aggFuncs:"aggFuncs",suppressAggFuncInHeader:"suppressAggFuncInHeader",suppressAggAtRootLevel:"suppressAggAtRootLevel",aggregateOnlyChangedColumns:"aggregateOnlyChangedColumns",suppressAggFilteredOnly:"suppressAggFilteredOnly",removePivotHeaderRowWhenSingleValueColumn:"removePivotHeaderRowWhenSingleValueColumn",animateRows:"animateRows",enableCellChangeFlash:"enableCellChangeFlash",cellFlashDelay:"cellFlashDelay",cellFadeDelay:"cellFadeDelay",allowShowChangeAfterFilter:"allowShowChangeAfterFilter",domLayout:"domLayout",ensureDomOrder:"ensureDomOrder",enableRtl:"enableRtl",suppressColumnVirtualisation:"suppressColumnVirtualisation",suppressMaxRenderedRowRestriction:"suppressMaxRenderedRowRestriction",suppressRowVirtualisation:"suppressRowVirtualisation",rowDragManaged:"rowDragManaged",suppressRowDrag:"suppressRowDrag",suppressMoveWhenRowDragging:"suppressMoveWhenRowDragging",rowDragEntireRow:"rowDragEntireRow",rowDragMultiRow:"rowDragMultiRow",rowDragText:"rowDragText",fullWidthCellRenderer:"fullWidthCellRenderer",fullWidthCellRendererFramework:"fullWidthCellRendererFramework",fullWidthCellRendererParams:"fullWidthCellRendererParams",embedFullWidthRows:"embedFullWidthRows",groupDisplayType:"groupDisplayType",groupDefaultExpanded:"groupDefaultExpanded",autoGroupColumnDef:"autoGroupColumnDef",groupMaintainOrder:"groupMaintainOrder",groupSelectsChildren:"groupSelectsChildren",groupAggFiltering:"groupAggFiltering",groupIncludeFooter:"groupIncludeFooter",groupIncludeTotalFooter:"groupIncludeTotalFooter",groupSuppressBlankHeader:"groupSuppressBlankHeader",groupSelectsFiltered:"groupSelectsFiltered",showOpenedGroup:"showOpenedGroup",groupRemoveSingleChildren:"groupRemoveSingleChildren",groupRemoveLowestSingleChildren:"groupRemoveLowestSingleChildren",groupHideOpenParents:"groupHideOpenParents",groupAllowUnbalanced:"groupAllowUnbalanced",rowGroupPanelShow:"rowGroupPanelShow",groupRowRenderer:"groupRowRenderer",groupRowRendererFramework:"groupRowRendererFramework",groupRowRendererParams:"groupRowRendererParams",suppressMakeColumnVisibleAfterUnGroup:"suppressMakeColumnVisibleAfterUnGroup",treeData:"treeData",rowGroupPanelSuppressSort:"rowGroupPanelSuppressSort",groupRowsSticky:"groupRowsSticky",rememberGroupStateWhenNewData:"rememberGroupStateWhenNewData",pinnedTopRowData:"pinnedTopRowData",pinnedBottomRowData:"pinnedBottomRowData",rowModelType:"rowModelType",rowData:"rowData",immutableData:"immutableData",asyncTransactionWaitMillis:"asyncTransactionWaitMillis",suppressModelUpdateAfterUpdateTransaction:"suppressModelUpdateAfterUpdateTransaction",datasource:"datasource",cacheOverflowSize:"cacheOverflowSize",infiniteInitialRowCount:"infiniteInitialRowCount",serverSideInitialRowCount:"serverSideInitialRowCount",serverSideStoreType:"serverSideStoreType",suppressServerSideInfiniteScroll:"suppressServerSideInfiniteScroll",cacheBlockSize:"cacheBlockSize",maxBlocksInCache:"maxBlocksInCache",maxConcurrentDatasourceRequests:"maxConcurrentDatasourceRequests",blockLoadDebounceMillis:"blockLoadDebounceMillis",purgeClosedRowNodes:"purgeClosedRowNodes",serverSideDatasource:"serverSideDatasource",serverSideSortAllLevels:"serverSideSortAllLevels",serverSideFilterAllLevels:"serverSideFilterAllLevels",serverSideSortOnServer:"serverSideSortOnServer",serverSideFilterOnServer:"serverSideFilterOnServer",serverSideSortingAlwaysResets:"serverSideSortingAlwaysResets",serverSideFilteringAlwaysResets:"serverSideFilteringAlwaysResets",viewportDatasource:"viewportDatasource",viewportRowModelPageSize:"viewportRowModelPageSize",viewportRowModelBufferSize:"viewportRowModelBufferSize",alwaysShowHorizontalScroll:"alwaysShowHorizontalScroll",alwaysShowVerticalScroll:"alwaysShowVerticalScroll",debounceVerticalScrollbar:"debounceVerticalScrollbar",suppressHorizontalScroll:"suppressHorizontalScroll",suppressScrollOnNewData:"suppressScrollOnNewData",suppressScrollWhenPopupsAreOpen:"suppressScrollWhenPopupsAreOpen",suppressAnimationFrame:"suppressAnimationFrame",suppressMiddleClickScrolls:"suppressMiddleClickScrolls",suppressPreventDefaultOnMouseWheel:"suppressPreventDefaultOnMouseWheel",scrollbarWidth:"scrollbarWidth",rowSelection:"rowSelection",rowMultiSelectWithClick:"rowMultiSelectWithClick",suppressRowDeselection:"suppressRowDeselection",suppressRowClickSelection:"suppressRowClickSelection",suppressCellSelection:"suppressCellSelection",suppressCellFocus:"suppressCellFocus",suppressMultiRangeSelection:"suppressMultiRangeSelection",enableCellTextSelection:"enableCellTextSelection",enableRangeSelection:"enableRangeSelection",enableRangeHandle:"enableRangeHandle",enableFillHandle:"enableFillHandle",fillHandleDirection:"fillHandleDirection",suppressClearOnFillReduction:"suppressClearOnFillReduction",sortingOrder:"sortingOrder",accentedSort:"accentedSort",unSortIcon:"unSortIcon",suppressMultiSort:"suppressMultiSort",alwaysMultiSort:"alwaysMultiSort",multiSortKey:"multiSortKey",suppressMaintainUnsortedOrder:"suppressMaintainUnsortedOrder",icons:"icons",rowHeight:"rowHeight",rowStyle:"rowStyle",rowClass:"rowClass",rowClassRules:"rowClassRules",suppressRowHoverHighlight:"suppressRowHoverHighlight",suppressRowTransform:"suppressRowTransform",columnHoverHighlight:"columnHoverHighlight",deltaSort:"deltaSort",treeDataDisplayType:"treeDataDisplayType",functionsPassive:"functionsPassive",enableGroupEdit:"enableGroupEdit",getContextMenuItems:"getContextMenuItems",getMainMenuItems:"getMainMenuItems",postProcessPopup:"postProcessPopup",processCellForClipboard:"processCellForClipboard",processHeaderForClipboard:"processHeaderForClipboard",processGroupHeaderForClipboard:"processGroupHeaderForClipboard",processCellFromClipboard:"processCellFromClipboard",sendToClipboard:"sendToClipboard",processDataFromClipboard:"processDataFromClipboard",isExternalFilterPresent:"isExternalFilterPresent",doesExternalFilterPass:"doesExternalFilterPass",getChartToolbarItems:"getChartToolbarItems",createChartContainer:"createChartContainer",navigateToNextHeader:"navigateToNextHeader",tabToNextHeader:"tabToNextHeader",navigateToNextCell:"navigateToNextCell",tabToNextCell:"tabToNextCell",localeTextFunc:"localeTextFunc",getLocaleText:"getLocaleText",getDocument:"getDocument",paginationNumberFormatter:"paginationNumberFormatter",groupRowAggNodes:"groupRowAggNodes",getGroupRowAgg:"getGroupRowAgg",isGroupOpenByDefault:"isGroupOpenByDefault",initialGroupOrderComparator:"initialGroupOrderComparator",defaultGroupOrderComparator:"defaultGroupOrderComparator",processSecondaryColDef:"processSecondaryColDef",processSecondaryColGroupDef:"processSecondaryColGroupDef",processPivotResultColDef:"processPivotResultColDef",processPivotResultColGroupDef:"processPivotResultColGroupDef",getDataPath:"getDataPath",getChildCount:"getChildCount",getServerSideGroupLevelParams:"getServerSideGroupLevelParams",getServerSideStoreParams:"getServerSideStoreParams",isServerSideGroupOpenByDefault:"isServerSideGroupOpenByDefault",isApplyServerSideTransaction:"isApplyServerSideTransaction",isServerSideGroup:"isServerSideGroup",getServerSideGroupKey:"getServerSideGroupKey",getBusinessKeyForNode:"getBusinessKeyForNode",getRowNodeId:"getRowNodeId",getRowId:"getRowId",resetRowDataOnUpdate:"resetRowDataOnUpdate",processRowPostCreate:"processRowPostCreate",isRowSelectable:"isRowSelectable",isRowMaster:"isRowMaster",fillOperation:"fillOperation",postSort:"postSort",postSortRows:"postSortRows",getRowStyle:"getRowStyle",getRowClass:"getRowClass",getRowHeight:"getRowHeight",isFullWidthCell:"isFullWidthCell",isFullWidthRow:"isFullWidthRow"},outputs:{toolPanelVisibleChanged:"toolPanelVisibleChanged",toolPanelSizeChanged:"toolPanelSizeChanged",pasteStart:"pasteStart",pasteEnd:"pasteEnd",columnVisible:"columnVisible",columnPinned:"columnPinned",columnResized:"columnResized",columnMoved:"columnMoved",columnValueChanged:"columnValueChanged",columnPivotModeChanged:"columnPivotModeChanged",columnPivotChanged:"columnPivotChanged",columnGroupOpened:"columnGroupOpened",newColumnsLoaded:"newColumnsLoaded",gridColumnsChanged:"gridColumnsChanged",displayedColumnsChanged:"displayedColumnsChanged",virtualColumnsChanged:"virtualColumnsChanged",columnEverythingChanged:"columnEverythingChanged",componentStateChanged:"componentStateChanged",cellValueChanged:"cellValueChanged",cellEditRequest:"cellEditRequest",rowValueChanged:"rowValueChanged",cellEditingStarted:"cellEditingStarted",cellEditingStopped:"cellEditingStopped",rowEditingStarted:"rowEditingStarted",rowEditingStopped:"rowEditingStopped",undoStarted:"undoStarted",undoEnded:"undoEnded",redoStarted:"redoStarted",redoEnded:"redoEnded",filterOpened:"filterOpened",filterChanged:"filterChanged",filterModified:"filterModified",chartCreated:"chartCreated",chartRangeSelectionChanged:"chartRangeSelectionChanged",chartOptionsChanged:"chartOptionsChanged",chartDestroyed:"chartDestroyed",cellKeyDown:"cellKeyDown",cellKeyPress:"cellKeyPress",gridReady:"gridReady",firstDataRendered:"firstDataRendered",gridSizeChanged:"gridSizeChanged",modelUpdated:"modelUpdated",virtualRowRemoved:"virtualRowRemoved",viewportChanged:"viewportChanged",bodyScroll:"bodyScroll",bodyScrollEnd:"bodyScrollEnd",dragStarted:"dragStarted",dragStopped:"dragStopped",paginationChanged:"paginationChanged",rowDragEnter:"rowDragEnter",rowDragMove:"rowDragMove",rowDragLeave:"rowDragLeave",rowDragEnd:"rowDragEnd",columnRowGroupChanged:"columnRowGroupChanged",rowGroupOpened:"rowGroupOpened",expandOrCollapseAll:"expandOrCollapseAll",pinnedRowDataChanged:"pinnedRowDataChanged",rowDataChanged:"rowDataChanged",rowDataUpdated:"rowDataUpdated",asyncTransactionsFlushed:"asyncTransactionsFlushed",storeRefreshed:"storeRefreshed",cellClicked:"cellClicked",cellDoubleClicked:"cellDoubleClicked",cellFocused:"cellFocused",cellMouseOver:"cellMouseOver",cellMouseOut:"cellMouseOut",cellMouseDown:"cellMouseDown",rowClicked:"rowClicked",rowDoubleClicked:"rowDoubleClicked",rowSelected:"rowSelected",selectionChanged:"selectionChanged",cellContextMenu:"cellContextMenu",rangeSelectionChanged:"rangeSelectionChanged",sortChanged:"sortChanged",columnRowGroupChangeRequest:"columnRowGroupChangeRequest",columnPivotChangeRequest:"columnPivotChangeRequest",columnValueChangeRequest:"columnValueChangeRequest",columnAggFuncChangeRequest:"columnAggFuncChangeRequest"},features:[Se._Bn([Wo,xn]),Se.TTD],decls:0,vars:0,template:function(t,e){},encapsulation:2});class Uo{}Uo.\u0275fac=function(t){return new(t||Uo)},Uo.\u0275mod=Se.oAB({type:Uo}),Uo.\u0275inj=Se.cJS({})},80574:(vh,Ns,qr)=>{qr.d(Ns,{NC:()=>Ht,P6:()=>Bw});var Se={version:"0.18.5"},Xt=1200,me=1252,Je=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ve={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ht=function(s){-1!=Je.indexOf(s)&&(me=Ve[0]=s)};var ct=function(s){Xt=s,ht(s)};function Fr(){ct(1200),function $e(){ht(1252)}()}function yo(s){for(var l=[],a=0;a<s.length>>1;++a)l[a]=String.fromCharCode(s.charCodeAt(2*a+1)+(s.charCodeAt(2*a)<<8));return l.join("")}var Xe,Tn=function(l){return String.fromCharCode(l)},Un=function(l){return String.fromCharCode(l)};var or=null,jn=!0,On="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Yo(s){for(var l="",a=0,f=0,p=0,d=0,h=0,g=0,y=0,w=0;w<s.length;)d=(a=s.charCodeAt(w++))>>2,h=(3&a)<<4|(f=s.charCodeAt(w++))>>4,g=(15&f)<<2|(p=s.charCodeAt(w++))>>6,y=63&p,isNaN(f)?g=y=64:isNaN(p)&&(y=64),l+=On.charAt(d)+On.charAt(h)+On.charAt(g)+On.charAt(y);return l}function yi(s){var l="",a=0,f=0,p=0,h=0,g=0,y=0;s=s.replace(/[^\w\+\/\=]/g,"");for(var w=0;w<s.length;)a=On.indexOf(s.charAt(w++))<<2|(h=On.indexOf(s.charAt(w++)))>>4,l+=String.fromCharCode(a),f=(15&h)<<4|(g=On.indexOf(s.charAt(w++)))>>2,64!==g&&(l+=String.fromCharCode(f)),p=(3&g)<<6|(y=On.indexOf(s.charAt(w++))),64!==y&&(l+=String.fromCharCode(p));return l}var St=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),en=function(){if(typeof Buffer<"u"){var s=!Buffer.from;if(!s)try{Buffer.from("foo","utf8")}catch{s=!0}return s?function(l,a){return a?new Buffer(l,a):new Buffer(l)}:Buffer.from.bind(Buffer)}return function(){}}();function Ir(s){return St?Buffer.alloc?Buffer.alloc(s):new Buffer(s):typeof Uint8Array<"u"?new Uint8Array(s):new Array(s)}function Qr(s){return St?Buffer.allocUnsafe?Buffer.allocUnsafe(s):new Buffer(s):typeof Uint8Array<"u"?new Uint8Array(s):new Array(s)}var Ci=function(l){return St?en(l,"binary"):l.split("").map(function(a){return 255&a.charCodeAt(0)})};function ks(s){if(typeof ArrayBuffer>"u")return Ci(s);for(var l=new ArrayBuffer(s.length),a=new Uint8Array(l),f=0;f!=s.length;++f)a[f]=255&s.charCodeAt(f);return l}function zn(s){if(Array.isArray(s))return s.map(function(f){return String.fromCharCode(f)}).join("");for(var l=[],a=0;a<s.length;++a)l[a]=String.fromCharCode(s[a]);return l.join("")}var fr=St?function(s){return Buffer.concat(s.map(function(l){return Buffer.isBuffer(l)?l:en(l)}))}:function(s){if(typeof Uint8Array<"u"){var l=0,a=0;for(l=0;l<s.length;++l)a+=s[l].length;var f=new Uint8Array(a),p=0;for(l=0,a=0;l<s.length;a+=p,++l)if(p=s[l].length,s[l]instanceof Uint8Array)f.set(s[l],a);else{if("string"==typeof s[l])throw"wtf";f.set(new Uint8Array(s[l]),a)}return f}return[].concat.apply([],s.map(function(d){return Array.isArray(d)?d:[].slice.call(d)}))};var Lr=/\u0000/g,_t=/[\u0001-\u0006]/g;function An(s){for(var l="",a=s.length-1;a>=0;)l+=s.charAt(a--);return l}function si(s,l){var a=""+s;return a.length>=l?a:Qt("0",l-a.length)+a}function tl(s,l){var a=""+s;return a.length>=l?a:Qt(" ",l-a.length)+a}function Xo(s,l){var a=""+s;return a.length>=l?a:a+Qt(" ",l-a.length)}var bu=Math.pow(2,32);function Jr(s,l){return s>bu||s<-bu?function Au(s,l){var a=""+Math.round(s);return a.length>=l?a:Qt("0",l-a.length)+a}(s,l):function Du(s,l){var a=""+s;return a.length>=l?a:Qt("0",l-a.length)+a}(Math.round(s),l)}function qo(s,l){return l=l||0,s.length>=7+l&&103==(32|s.charCodeAt(l))&&101==(32|s.charCodeAt(l+1))&&110==(32|s.charCodeAt(l+2))&&101==(32|s.charCodeAt(l+3))&&114==(32|s.charCodeAt(l+4))&&97==(32|s.charCodeAt(l+5))&&108==(32|s.charCodeAt(l+6))}var Fu=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Pu=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var ot={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Af={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},mh={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function rl(s,l,a){for(var f=s<0?-1:1,p=s*f,d=0,h=1,g=0,y=1,w=0,S=0,E=Math.floor(p);w<l&&(g=(E=Math.floor(p))*h+d,S=E*w+y,!(p-E<5e-8));)p=1/(p-E),d=h,h=g,y=w,w=S;if(S>l&&(w>l?(S=y,g=d):(S=w,g=h)),!a)return[0,f*g,S];var R=Math.floor(f*g/S);return[R,f*g-R*S,S]}function Kn(s,l,a){if(s>2958465||s<0)return null;var f=0|s,p=Math.floor(86400*(s-f)),d=0,h=[],g={D:f,T:p,u:86400*(s-f)-p,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(g.u)<1e-6&&(g.u=0),l&&l.date1904&&(f+=1462),g.u>.9999&&(g.u=0,86400==++p&&(g.T=p=0,++f,++g.D)),60===f)h=a?[1317,10,29]:[1900,2,29],d=3;else if(0===f)h=a?[1317,8,29]:[1900,1,0],d=6;else{f>60&&--f;var y=new Date(1900,0,1);y.setDate(y.getDate()+f-1),h=[y.getFullYear(),y.getMonth()+1,y.getDate()],d=y.getDay(),f<60&&(d=(d+6)%7),a&&(d=function il(s,l){l[0]-=581;var a=s.getDay();return s<60&&(a=(a+6)%7),a}(y,h))}return g.y=h[0],g.m=h[1],g.d=h[2],g.S=p%60,p=Math.floor(p/60),g.M=p%60,p=Math.floor(p/60),g.H=p,g.q=d,g}var Iu=new Date(1899,11,31,0,0,0),Re=Iu.getTime(),Mr=new Date(1900,2,1,0,0,0);function He(s,l){var a=s.getTime();return l?a-=1262304e5:s>=Mr&&(a+=864e5),(a-(Re+6e4*(s.getTimezoneOffset()-Iu.getTimezoneOffset())))/864e5}function D(s){return-1==s.indexOf(".")?s:s.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Hi(s){var a,l=Math.floor(Math.log(Math.abs(s))*Math.LOG10E);return a=l>=-4&&l<=-1?s.toPrecision(10+l):Math.abs(l)<=9?function Df(s){var l=s<0?12:11,a=D(s.toFixed(12));return a.length<=l||(a=s.toPrecision(10)).length<=l?a:s.toExponential(5)}(s):10===l?s.toFixed(10).substr(0,12):function Zr(s){var l=D(s.toFixed(11));return l.length>(s<0?12:11)||"0"===l||"-0"===l?s.toPrecision(6):l}(s),D(function Ft(s){return-1==s.indexOf("E")?s:s.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(a.toUpperCase()))}function $n(s,l){switch(typeof s){case"string":return s;case"boolean":return s?"TRUE":"FALSE";case"number":return(0|s)===s?s.toString(10):Hi(s);case"undefined":return"";case"object":if(null==s)return"";if(s instanceof Date)return Si(14,He(s,l&&l.date1904),l)}throw new Error("unsupported value in General format: "+s)}function Yn(s,l,a,f){var y,p="",d=0,h=0,g=a.y,w=0;switch(s){case 98:g=a.y+543;case 121:switch(l.length){case 1:case 2:y=g%100,w=2;break;default:y=g%1e4,w=4}break;case 109:switch(l.length){case 1:case 2:y=a.m,w=l.length;break;case 3:return Pu[a.m-1][1];case 5:return Pu[a.m-1][0];default:return Pu[a.m-1][2]}break;case 100:switch(l.length){case 1:case 2:y=a.d,w=l.length;break;case 3:return Fu[a.q][0];default:return Fu[a.q][1]}break;case 104:switch(l.length){case 1:case 2:y=1+(a.H+11)%12,w=l.length;break;default:throw"bad hour format: "+l}break;case 72:switch(l.length){case 1:case 2:y=a.H,w=l.length;break;default:throw"bad hour format: "+l}break;case 77:switch(l.length){case 1:case 2:y=a.M,w=l.length;break;default:throw"bad minute format: "+l}break;case 115:if("s"!=l&&"ss"!=l&&".0"!=l&&".00"!=l&&".000"!=l)throw"bad second format: "+l;return 0!==a.u||"s"!=l&&"ss"!=l?(h=f>=2?3===f?1e3:100:1===f?10:1,(d=Math.round(h*(a.S+a.u)))>=60*h&&(d=0),"s"===l?0===d?"0":""+d/h:(p=si(d,2+f),"ss"===l?p.substr(0,2):"."+p.substr(2,l.length-1))):si(a.S,l.length);case 90:switch(l){case"[h]":case"[hh]":y=24*a.D+a.H;break;case"[m]":case"[mm]":y=60*(24*a.D+a.H)+a.M;break;case"[s]":case"[ss]":y=60*(60*(24*a.D+a.H)+a.M)+Math.round(a.S+a.u);break;default:throw"bad abstime format: "+l}w=3===l.length?1:2;break;case 101:y=g,w=1}return w>0?si(y,w):""}function Ne(s){if(s.length<=3)return s;for(var a=s.length%3,f=s.substr(0,a);a!=s.length;a+=3)f+=(f.length>0?",":"")+s.substr(a,3);return f}var bf=/%/g;function Ff(s,l){var a,f=s.indexOf("E")-s.indexOf(".")-1;if(s.match(/^#+0.0E\+0$/)){if(0==l)return"0.0E+0";if(l<0)return"-"+Ff(s,-l);var p=s.indexOf(".");-1===p&&(p=s.indexOf("E"));var d=Math.floor(Math.log(l)*Math.LOG10E)%p;if(d<0&&(d+=p),-1===(a=(l/Math.pow(10,d)).toPrecision(f+1+(p+d)%p)).indexOf("e")){var h=Math.floor(Math.log(l)*Math.LOG10E);for(-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(h-a.length+d):a+="E+"+(h-d);"0."===a.substr(0,2);)a=(a=a.charAt(0)+a.substr(2,p)+"."+a.substr(2+p)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(g,y,w,S){return y+w+S.substr(0,(p+d)%p)+"."+S.substr(d)+"E"})}else a=l.toExponential(f);return s.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),s.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}var Pf=/# (\?+)( ?)\/( ?)(\d+)/;var Kt=/^#*0*\.([0#]+)/,Lf=/\).*[0#]/,tr=/\(###\) ###\\?-####/;function ei(s){for(var a,l="",f=0;f!=s.length;++f)switch(a=s.charCodeAt(f)){case 35:break;case 63:l+=" ";break;case 48:l+="0";break;default:l+=String.fromCharCode(a)}return l}function Lu(s,l){var a=Math.pow(10,l);return""+Math.round(s*a)/a}function Mf(s,l){var a=s-Math.floor(s),f=Math.pow(10,l);return l<(""+Math.round(a*f)).length?0:Math.round(a*f)}function Ai(s,l,a){if(40===s.charCodeAt(0)&&!l.match(Lf)){var f=l.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?Ai("n",f,a):"("+Ai("n",f,-a)+")"}if(44===l.charCodeAt(l.length-1))return function nl(s,l,a){for(var f=l.length-1;44===l.charCodeAt(f-1);)--f;return wi(s,l.substr(0,f),a/Math.pow(10,3*(l.length-f)))}(s,l,a);if(-1!==l.indexOf("%"))return function it(s,l,a){var f=l.replace(bf,""),p=l.length-f.length;return wi(s,f,a*Math.pow(10,2*p))+Qt("%",p)}(s,l,a);if(-1!==l.indexOf("E"))return Ff(l,a);if(36===l.charCodeAt(0))return"$"+Ai(s,l.substr(" "==l.charAt(1)?2:1),a);var p,d,h,g,y=Math.abs(a),w=a<0?"-":"";if(l.match(/^00+$/))return w+Jr(y,l.length);if(l.match(/^[#?]+$/))return"0"===(p=Jr(a,0))&&(p=""),p.length>l.length?p:ei(l.substr(0,l.length-p.length))+p;if(d=l.match(Pf))return function yh(s,l,a){var f=parseInt(s[4],10),p=Math.round(l*f),d=Math.floor(p/f),h=p-d*f,g=f;return a+(0===d?"":""+d)+" "+(0===h?Qt(" ",s[1].length+1+s[4].length):tl(h,s[1].length)+s[2]+"/"+s[3]+si(g,s[4].length))}(d,y,w);if(l.match(/^#+0+$/))return w+Jr(y,l.length-l.indexOf("0"));if(d=l.match(Kt))return p=Lu(a,d[1].length).replace(/^([^\.]+)$/,"$1."+ei(d[1])).replace(/\.$/,"."+ei(d[1])).replace(/\.(\d*)$/,function(A,x){return"."+x+Qt("0",ei(d[1]).length-x.length)}),-1!==l.indexOf("0.")?p:p.replace(/^0\./,".");if(l=l.replace(/^#+([0.])/,"$1"),d=l.match(/^(0*)\.(#*)$/))return w+Lu(y,d[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,d[1].length?"0.":".");if(d=l.match(/^#{1,3},##0(\.?)$/))return w+Ne(Jr(y,0));if(d=l.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+Ai(s,l,-a):Ne(""+(Math.floor(a)+function Mt(s,l){return l<(""+Math.round((s-Math.floor(s))*Math.pow(10,l))).length?1:0}(a,d[1].length)))+"."+si(Mf(a,d[1].length),d[1].length);if(d=l.match(/^#,#*,#0/))return Ai(s,l.replace(/^#,#*,/,""),a);if(d=l.match(/^([0#]+)(\\?-([0#]+))+$/))return p=An(Ai(s,l.replace(/[\\-]/g,""),a)),h=0,An(An(l.replace(/\\/g,"")).replace(/[0#]/g,function(A){return h<p.length?p.charAt(h++):"0"===A?"0":""}));if(l.match(tr))return"("+(p=Ai(s,"##########",a)).substr(0,3)+") "+p.substr(3,3)+"-"+p.substr(6);var S="";if(d=l.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(d[4].length,7),g=rl(y,Math.pow(10,h)-1,!1),p=""+w," "==(S=wi("n",d[1],g[1])).charAt(S.length-1)&&(S=S.substr(0,S.length-1)+"0"),p+=S+d[2]+"/"+d[3],(S=Xo(g[2],h)).length<d[4].length&&(S=ei(d[4].substr(d[4].length-S.length))+S),p+=S;if(d=l.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(Math.max(d[1].length,d[4].length),7),w+((g=rl(y,Math.pow(10,h)-1,!0))[0]||(g[1]?"":"0"))+" "+(g[1]?tl(g[1],h)+d[2]+"/"+d[3]+Xo(g[2],h):Qt(" ",2*h+1+d[2].length+d[3].length));if(d=l.match(/^[#0?]+$/))return p=Jr(a,0),l.length<=p.length?p:ei(l.substr(0,l.length-p.length))+p;if(d=l.match(/^([#0?]+)\.([#0]+)$/)){p=""+a.toFixed(Math.min(d[2].length,10)).replace(/([^0])0+$/,"$1"),h=p.indexOf(".");var E=l.indexOf(".")-h,R=l.length-p.length-E;return ei(l.substr(0,E)+p+l.substr(l.length-R))}if(d=l.match(/^00,000\.([#0]*0)$/))return h=Mf(a,d[1].length),a<0?"-"+Ai(s,l,-a):Ne(function Xn(s){return s<2147483647&&s>-2147483648?""+(s>=0?0|s:s-1|0):""+Math.floor(s)}(a)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(A){return"00,"+(A.length<3?si(0,3-A.length):"")+A})+"."+si(h,d[1].length);switch(l){case"###,##0.00":return Ai(s,"#,##0.00",a);case"###,###":case"##,###":case"#,###":var T=Ne(Jr(y,0));return"0"!==T?w+T:"";case"###,###.00":return Ai(s,"###,##0.00",a).replace(/^0\./,".");case"#,###.00":return Ai(s,"#,##0.00",a).replace(/^0\./,".")}throw new Error("unsupported format |"+l+"|")}function Nr(s,l){var a,f=s.indexOf("E")-s.indexOf(".")-1;if(s.match(/^#+0.0E\+0$/)){if(0==l)return"0.0E+0";if(l<0)return"-"+Nr(s,-l);var p=s.indexOf(".");-1===p&&(p=s.indexOf("E"));var d=Math.floor(Math.log(l)*Math.LOG10E)%p;if(d<0&&(d+=p),!(a=(l/Math.pow(10,d)).toPrecision(f+1+(p+d)%p)).match(/[Ee]/)){var h=Math.floor(Math.log(l)*Math.LOG10E);-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(h-a.length+d):a+="E+"+(h-d),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(g,y,w,S){return y+w+S.substr(0,(p+d)%p)+"."+S.substr(d)+"E"})}else a=l.toExponential(f);return s.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),s.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}function Di(s,l,a){if(40===s.charCodeAt(0)&&!l.match(Lf)){var f=l.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?Di("n",f,a):"("+Di("n",f,-a)+")"}if(44===l.charCodeAt(l.length-1))return function Nf(s,l,a){for(var f=l.length-1;44===l.charCodeAt(f-1);)--f;return wi(s,l.substr(0,f),a/Math.pow(10,3*(l.length-f)))}(s,l,a);if(-1!==l.indexOf("%"))return function Ch(s,l,a){var f=l.replace(bf,""),p=l.length-f.length;return wi(s,f,a*Math.pow(10,2*p))+Qt("%",p)}(s,l,a);if(-1!==l.indexOf("E"))return Nr(l,a);if(36===l.charCodeAt(0))return"$"+Di(s,l.substr(" "==l.charAt(1)?2:1),a);var p,d,h,g,y=Math.abs(a),w=a<0?"-":"";if(l.match(/^00+$/))return w+si(y,l.length);if(l.match(/^[#?]+$/))return p=""+a,0===a&&(p=""),p.length>l.length?p:ei(l.substr(0,l.length-p.length))+p;if(d=l.match(Pf))return function If(s,l,a){return a+(0===l?"":""+l)+Qt(" ",s[1].length+2+s[4].length)}(d,y,w);if(l.match(/^#+0+$/))return w+si(y,l.length-l.indexOf("0"));if(d=l.match(Kt))return p=(p=(""+a).replace(/^([^\.]+)$/,"$1."+ei(d[1])).replace(/\.$/,"."+ei(d[1]))).replace(/\.(\d*)$/,function(A,x){return"."+x+Qt("0",ei(d[1]).length-x.length)}),-1!==l.indexOf("0.")?p:p.replace(/^0\./,".");if(l=l.replace(/^#+([0.])/,"$1"),d=l.match(/^(0*)\.(#*)$/))return w+(""+y).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,d[1].length?"0.":".");if(d=l.match(/^#{1,3},##0(\.?)$/))return w+Ne(""+y);if(d=l.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+Di(s,l,-a):Ne(""+a)+"."+Qt("0",d[1].length);if(d=l.match(/^#,#*,#0/))return Di(s,l.replace(/^#,#*,/,""),a);if(d=l.match(/^([0#]+)(\\?-([0#]+))+$/))return p=An(Di(s,l.replace(/[\\-]/g,""),a)),h=0,An(An(l.replace(/\\/g,"")).replace(/[0#]/g,function(A){return h<p.length?p.charAt(h++):"0"===A?"0":""}));if(l.match(tr))return"("+(p=Di(s,"##########",a)).substr(0,3)+") "+p.substr(3,3)+"-"+p.substr(6);var S="";if(d=l.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(d[4].length,7),g=rl(y,Math.pow(10,h)-1,!1),p=""+w," "==(S=wi("n",d[1],g[1])).charAt(S.length-1)&&(S=S.substr(0,S.length-1)+"0"),p+=S+d[2]+"/"+d[3],(S=Xo(g[2],h)).length<d[4].length&&(S=ei(d[4].substr(d[4].length-S.length))+S),p+=S;if(d=l.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(Math.max(d[1].length,d[4].length),7),w+((g=rl(y,Math.pow(10,h)-1,!0))[0]||(g[1]?"":"0"))+" "+(g[1]?tl(g[1],h)+d[2]+"/"+d[3]+Xo(g[2],h):Qt(" ",2*h+1+d[2].length+d[3].length));if(d=l.match(/^[#0?]+$/))return p=""+a,l.length<=p.length?p:ei(l.substr(0,l.length-p.length))+p;if(d=l.match(/^([#0]+)\.([#0]+)$/)){p=""+a.toFixed(Math.min(d[2].length,10)).replace(/([^0])0+$/,"$1"),h=p.indexOf(".");var E=l.indexOf(".")-h,R=l.length-p.length-E;return ei(l.substr(0,E)+p+l.substr(l.length-R))}if(d=l.match(/^00,000\.([#0]*0)$/))return a<0?"-"+Di(s,l,-a):Ne(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(A){return"00,"+(A.length<3?si(0,3-A.length):"")+A})+"."+si(0,d[1].length);switch(l){case"###,###":case"##,###":case"#,###":var T=Ne(""+y);return"0"!==T?w+T:"";default:if(l.match(/\.[0#?]*$/))return Di(s,l.slice(0,l.lastIndexOf(".")),a)+ei(l.slice(l.lastIndexOf(".")))}throw new Error("unsupported format |"+l+"|")}function wi(s,l,a){return(0|a)===a?Di(s,l,a):Ai(s,l,a)}var ol=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function kr(s){for(var l=0,a="",f="";l<s.length;)switch(a=s.charAt(l)){case"G":qo(s,l)&&(l+=6),l++;break;case'"':for(;34!==s.charCodeAt(++l)&&l<s.length;);++l;break;case"\\":case"_":l+=2;break;case"@":++l;break;case"B":case"b":if("1"===s.charAt(l+1)||"2"===s.charAt(l+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===s.substr(l,3).toUpperCase()||"AM/PM"===s.substr(l,5).toUpperCase()||"\u4e0a\u5348/\u4e0b\u5348"===s.substr(l,5).toUpperCase())return!0;++l;break;case"[":for(f=a;"]"!==s.charAt(l++)&&l<s.length;)f+=s.charAt(l);if(f.match(ol))return!0;break;case".":case"0":case"#":for(;l<s.length&&("0#?.,E+-%".indexOf(a=s.charAt(++l))>-1||"\\"==a&&"-"==s.charAt(l+1)&&"0#".indexOf(s.charAt(l+2))>-1););break;case"?":for(;s.charAt(++l)===a;);break;case"*":++l,(" "==s.charAt(l)||"*"==s.charAt(l))&&++l;break;case"(":case")":++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;l<s.length&&"0123456789".indexOf(s.charAt(++l))>-1;);break;default:++l}return!1}var sl=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Gf(s,l){if(null==l)return!1;var a=parseFloat(l[2]);switch(l[1]){case"=":if(s==a)return!0;break;case">":if(s>a)return!0;break;case"<":if(s<a)return!0;break;case"<>":if(s!=a)return!0;break;case">=":if(s>=a)return!0;break;case"<=":if(s<=a)return!0}return!1}function Sh(s,l){var a=function wh(s){for(var l=[],a=!1,f=0,p=0;f<s.length;++f)switch(s.charCodeAt(f)){case 34:a=!a;break;case 95:case 42:case 92:++f;break;case 59:l[l.length]=s.substr(p,f-p),p=f+1}if(l[l.length]=s.substr(p),!0===a)throw new Error("Format |"+s+"| unterminated string ");return l}(s),f=a.length,p=a[f-1].indexOf("@");if(f<4&&p>-1&&--f,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if("number"!=typeof l)return[4,4===a.length||p>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=p>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=p>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=p>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"]}var d=l>0?a[0]:l<0?a[1]:a[2];if(-1===a[0].indexOf("[")&&-1===a[1].indexOf("["))return[f,d];if(null!=a[0].match(/\[[=<>]/)||null!=a[1].match(/\[[=<>]/)){var h=a[0].match(sl),g=a[1].match(sl);return Gf(l,h)?[f,a[0]]:Gf(l,g)?[f,a[1]]:[f,a[null!=h&&null!=g?2:1]]}return[f,d]}function Si(s,l,a){null==a&&(a={});var f="";switch(typeof s){case"string":f="m/d/yy"==s&&a.dateNF?a.dateNF:s;break;case"number":null==(f=14==s&&a.dateNF?a.dateNF:(null!=a.table?a.table:ot)[s])&&(f=a.table&&a.table[Af[s]]||ot[Af[s]]),null==f&&(f=mh[s]||"General")}if(qo(f,0))return $n(l,a);l instanceof Date&&(l=He(l,a.date1904));var p=Sh(f,l);if(qo(p[1]))return $n(l,a);if(!0===l)l="TRUE";else if(!1===l)l="FALSE";else if(""===l||null==l)return"";return function kf(s,l,a,f){for(var w,S,E,p=[],d="",h=0,g="",y="t",R="H";h<s.length;)switch(g=s.charAt(h)){case"G":if(!qo(s,h))throw new Error("unrecognized character "+g+" in "+s);p[p.length]={t:"G",v:"General"},h+=7;break;case'"':for(d="";34!==(E=s.charCodeAt(++h))&&h<s.length;)d+=String.fromCharCode(E);p[p.length]={t:"t",v:d},++h;break;case"\\":var T=s.charAt(++h),A="("===T||")"===T?T:"t";p[p.length]={t:A,v:T},++h;break;case"_":p[p.length]={t:"t",v:" "},h+=2;break;case"@":p[p.length]={t:"T",v:l},++h;break;case"B":case"b":if("1"===s.charAt(h+1)||"2"===s.charAt(h+1)){if(null==w&&null==(w=Kn(l,a,"2"===s.charAt(h+1))))return"";p[p.length]={t:"X",v:s.substr(h,2)},y=g,h+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":g=g.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(l<0||null==w&&null==(w=Kn(l,a)))return"";for(d=g;++h<s.length&&s.charAt(h).toLowerCase()===g;)d+=g;"m"===g&&"h"===y.toLowerCase()&&(g="M"),"h"===g&&(g=R),p[p.length]={t:g,v:d},y=g;break;case"A":case"a":case"\u4e0a":var x={t:g,v:g};if(null==w&&(w=Kn(l,a)),"A/P"===s.substr(h,3).toUpperCase()?(null!=w&&(x.v=w.H>=12?"P":"A"),x.t="T",R="h",h+=3):"AM/PM"===s.substr(h,5).toUpperCase()?(null!=w&&(x.v=w.H>=12?"PM":"AM"),x.t="T",h+=5,R="h"):"\u4e0a\u5348/\u4e0b\u5348"===s.substr(h,5).toUpperCase()?(null!=w&&(x.v=w.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),x.t="T",h+=5,R="h"):(x.t="t",++h),null==w&&"T"===x.t)return"";p[p.length]=x,y=g;break;case"[":for(d=g;"]"!==s.charAt(h++)&&h<s.length;)d+=s.charAt(h);if("]"!==d.slice(-1))throw'unterminated "[" block: |'+d+"|";if(d.match(ol)){if(null==w&&null==(w=Kn(l,a)))return"";p[p.length]={t:"Z",v:d.toLowerCase()},y=d.charAt(1)}else d.indexOf("$")>-1&&(d=(d.match(/\$([^-\[\]]*)/)||[])[1]||"$",kr(s)||(p[p.length]={t:"t",v:d}));break;case".":if(null!=w){for(d=g;++h<s.length&&"0"===(g=s.charAt(h));)d+=g;p[p.length]={t:"s",v:d};break}case"0":case"#":for(d=g;++h<s.length&&"0#?.,E+-%".indexOf(g=s.charAt(h))>-1;)d+=g;p[p.length]={t:"n",v:d};break;case"?":for(d=g;s.charAt(++h)===g;)d+=g;p[p.length]={t:g,v:d},y=g;break;case"*":++h,(" "==s.charAt(h)||"*"==s.charAt(h))&&++h;break;case"(":case")":p[p.length]={t:1===f?"t":g,v:g},++h;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(d=g;h<s.length&&"0123456789".indexOf(s.charAt(++h))>-1;)d+=s.charAt(h);p[p.length]={t:"D",v:d};break;case" ":p[p.length]={t:g,v:g},++h;break;case"$":p[p.length]={t:"t",v:"$"},++h;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(g))throw new Error("unrecognized character "+g+" in "+s);p[p.length]={t:"t",v:g},++h}var G,b=0,H=0;for(h=p.length-1,y="t";h>=0;--h)switch(p[h].t){case"h":case"H":p[h].t=R,y="h",b<1&&(b=1);break;case"s":(G=p[h].v.match(/\.0+$/))&&(H=Math.max(H,G[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":y=p[h].t;break;case"m":"s"===y&&(p[h].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&p[h].v.match(/[Hh]/)&&(b=1),b<2&&p[h].v.match(/[Mm]/)&&(b=2),b<3&&p[h].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:w.u>=.5&&(w.u=0,++w.S),w.S>=60&&(w.S=0,++w.M),w.M>=60&&(w.M=0,++w.H);break;case 2:w.u>=.5&&(w.u=0,++w.S),w.S>=60&&(w.S=0,++w.M)}var Q,N="";for(h=0;h<p.length;++h)switch(p[h].t){case"t":case"T":case" ":case"D":break;case"X":p[h].v="",p[h].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":p[h].v=Yn(p[h].t.charCodeAt(0),p[h].v,w,H),p[h].t="t";break;case"n":case"?":for(Q=h+1;null!=p[Q]&&("?"===(g=p[Q].t)||"D"===g||(" "===g||"t"===g)&&null!=p[Q+1]&&("?"===p[Q+1].t||"t"===p[Q+1].t&&"/"===p[Q+1].v)||"("===p[h].t&&(" "===g||"n"===g||")"===g)||"t"===g&&("/"===p[Q].v||" "===p[Q].v&&null!=p[Q+1]&&"?"==p[Q+1].t));)p[h].v+=p[Q].v,p[Q]={v:"",t:";"},++Q;N+=p[h].v,h=Q-1;break;case"G":p[h].t="t",p[h].v=$n(l,a)}var ce,K,ie="";if(N.length>0){40==N.charCodeAt(0)?(ce=l<0&&45===N.charCodeAt(0)?-l:l,K=wi("n",N,ce)):(K=wi("n",N,ce=l<0&&f>1?-l:l),ce<0&&p[0]&&"t"==p[0].t&&(K=K.substr(1),p[0].v="-"+p[0].v)),Q=K.length-1;var te=p.length;for(h=0;h<p.length;++h)if(null!=p[h]&&"t"!=p[h].t&&p[h].v.indexOf(".")>-1){te=h;break}var J=p.length;if(te===p.length&&-1===K.indexOf("E")){for(h=p.length-1;h>=0;--h)null==p[h]||-1==="n?".indexOf(p[h].t)||(Q>=p[h].v.length-1?(Q-=p[h].v.length,p[h].v=K.substr(Q+1,p[h].v.length)):Q<0?p[h].v="":(p[h].v=K.substr(0,Q+1),Q=-1),p[h].t="t",J=h);Q>=0&&J<p.length&&(p[J].v=K.substr(0,Q+1)+p[J].v)}else if(te!==p.length&&-1===K.indexOf("E")){for(Q=K.indexOf(".")-1,h=te;h>=0;--h)if(null!=p[h]&&-1!=="n?".indexOf(p[h].t)){for(S=p[h].v.indexOf(".")>-1&&h===te?p[h].v.indexOf(".")-1:p[h].v.length-1,ie=p[h].v.substr(S+1);S>=0;--S)Q>=0&&("0"===p[h].v.charAt(S)||"#"===p[h].v.charAt(S))&&(ie=K.charAt(Q--)+ie);p[h].v=ie,p[h].t="t",J=h}for(Q>=0&&J<p.length&&(p[J].v=K.substr(0,Q+1)+p[J].v),Q=K.indexOf(".")+1,h=te;h<p.length;++h)if(null!=p[h]&&(-1!=="n?(".indexOf(p[h].t)||h===te)){for(S=p[h].v.indexOf(".")>-1&&h===te?p[h].v.indexOf(".")+1:0,ie=p[h].v.substr(0,S);S<p[h].v.length;++S)Q<K.length&&(ie+=K.charAt(Q++));p[h].v=ie,p[h].t="t",J=h}}}for(h=0;h<p.length;++h)null!=p[h]&&"n?".indexOf(p[h].t)>-1&&(ce=f>1&&l<0&&h>0&&"-"===p[h-1].v?-l:l,p[h].v=wi(p[h].t,p[h].v,ce),p[h].t="t");var fe="";for(h=0;h!==p.length;++h)null!=p[h]&&(fe+=p[h].v);return fe}(p[1],l,a,p[0])}function Bi(s,l){if("number"!=typeof l){l=+l||-1;for(var a=0;a<392;++a)if(null!=ot[a]){if(ot[a]==s){l=a;break}}else l<0&&(l=a);l<0&&(l=391)}return ot[l]=s,l}function Gs(s){for(var l=0;392!=l;++l)void 0!==s[l]&&Bi(s[l],l)}function qn(){ot=function Of(s){return s||(s={}),s[0]="General",s[1]="0",s[2]="0.00",s[3]="#,##0",s[4]="#,##0.00",s[9]="0%",s[10]="0.00%",s[11]="0.00E+00",s[12]="# ?/?",s[13]="# ??/??",s[14]="m/d/yy",s[15]="d-mmm-yy",s[16]="d-mmm",s[17]="mmm-yy",s[18]="h:mm AM/PM",s[19]="h:mm:ss AM/PM",s[20]="h:mm",s[21]="h:mm:ss",s[22]="m/d/yy h:mm",s[37]="#,##0 ;(#,##0)",s[38]="#,##0 ;[Red](#,##0)",s[39]="#,##0.00;(#,##0.00)",s[40]="#,##0.00;[Red](#,##0.00)",s[45]="mm:ss",s[46]="[h]:mm:ss",s[47]="mmss.0",s[48]="##0.0E+0",s[49]="@",s[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',s}()}var al=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var Hf=function(){var s={};s.version="1.2.0";var a=function l(){for(var K=0,te=new Array(256),J=0;256!=J;++J)K=1&(K=1&(K=1&(K=1&(K=1&(K=1&(K=1&(K=1&(K=J)?-306674912^K>>>1:K>>>1)?-306674912^K>>>1:K>>>1)?-306674912^K>>>1:K>>>1)?-306674912^K>>>1:K>>>1)?-306674912^K>>>1:K>>>1)?-306674912^K>>>1:K>>>1)?-306674912^K>>>1:K>>>1)?-306674912^K>>>1:K>>>1,te[J]=K;return typeof Int32Array<"u"?new Int32Array(te):te}();var p=function f(K){var te=0,J=0,fe=0,he=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(fe=0;256!=fe;++fe)he[fe]=K[fe];for(fe=0;256!=fe;++fe)for(J=K[fe],te=256+fe;te<4096;te+=256)J=he[te]=J>>>8^K[255&J];var ee=[];for(fe=1;16!=fe;++fe)ee[fe-1]=typeof Int32Array<"u"?he.subarray(256*fe,256*fe+256):he.slice(256*fe,256*fe+256);return ee}(a),d=p[0],h=p[1],g=p[2],y=p[3],w=p[4],S=p[5],E=p[6],R=p[7],T=p[8],A=p[9],x=p[10],b=p[11],H=p[12],G=p[13],N=p[14];return s.table=a,s.bstr=function Q(K,te){for(var J=-1^te,fe=0,he=K.length;fe<he;)J=J>>>8^a[255&(J^K.charCodeAt(fe++))];return~J},s.buf=function ie(K,te){for(var J=-1^te,fe=K.length-15,he=0;he<fe;)J=N[K[he++]^255&J]^G[K[he++]^J>>8&255]^H[K[he++]^J>>16&255]^b[K[he++]^J>>>24]^x[K[he++]]^A[K[he++]]^T[K[he++]]^R[K[he++]]^E[K[he++]]^S[K[he++]]^w[K[he++]]^y[K[he++]]^g[K[he++]]^h[K[he++]]^d[K[he++]]^a[K[he++]];for(fe+=15;he<fe;)J=J>>>8^a[255&(J^K[he++])];return~J},s.str=function ce(K,te){for(var J=-1^te,fe=0,he=K.length,ee=0,Ie=0;fe<he;)(ee=K.charCodeAt(fe++))<128?J=J>>>8^a[255&(J^ee)]:ee<2048?J=(J=J>>>8^a[255&(J^(192|ee>>6&31))])>>>8^a[255&(J^(128|63&ee))]:ee>=55296&&ee<57344?(ee=64+(1023&ee),Ie=1023&K.charCodeAt(fe++),J=(J=(J=(J=J>>>8^a[255&(J^(240|ee>>8&7))])>>>8^a[255&(J^(128|ee>>2&63))])>>>8^a[255&(J^(128|Ie>>6&15|(3&ee)<<4))])>>>8^a[255&(J^(128|63&Ie))]):J=(J=(J=J>>>8^a[255&(J^(224|ee>>12&15))])>>>8^a[255&(J^(128|ee>>6&63))])>>>8^a[255&(J^(128|63&ee))];return~J},s}(),tt=function(){var y,l={};function f(F){if("/"==F.charAt(F.length-1))return-1===F.slice(0,-1).indexOf("/")?F:f(F.slice(0,-1));var B=F.lastIndexOf("/");return-1===B?F:F.slice(0,B+1)}function p(F){if("/"==F.charAt(F.length-1))return p(F.slice(0,-1));var B=F.lastIndexOf("/");return-1===B?F:F.slice(B+1)}function d(F,B){"string"==typeof B&&(B=new Date(B));var M=B.getHours();M=(M=M<<6|B.getMinutes())<<5|B.getSeconds()>>>1,F.write_shift(2,M);var k=B.getFullYear()-1980;k=(k=k<<4|B.getMonth()+1)<<5|B.getDate(),F.write_shift(2,k)}function g(F){Br(F,0);for(var B={},M=0;F.l<=F.length-4;){var k=F.read_shift(2),V=F.read_shift(2),W=F.l+V,ne={};if(21589===k)1&(M=F.read_shift(1))&&(ne.mtime=F.read_shift(4)),V>5&&(2&M&&(ne.atime=F.read_shift(4)),4&M&&(ne.ctime=F.read_shift(4))),ne.mtime&&(ne.mt=new Date(1e3*ne.mtime));F.l=W,B[k]=ne}return B}function w(){return y||(y={})}function S(F,B){if(80==F[0]&&75==F[1])return Fw(F,B);if(109==(32|F[0])&&105==(32|F[1]))return function eS(F,B){if("mime-version:"!=je(F.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var M=B&&B.root||"",k=(St&&Buffer.isBuffer(F)?F.toString("binary"):je(F)).split("\r\n"),V=0,W="";for(V=0;V<k.length;++V)if(W=k[V],/^Content-Location:/i.test(W)&&(W=W.slice(W.indexOf("file")),M||(M=W.slice(0,W.lastIndexOf("/")+1)),W.slice(0,M.length)!=M))for(;M.length>0&&(M=(M=M.slice(0,M.length-1)).slice(0,M.lastIndexOf("/")+1),W.slice(0,M.length)!=M););var ne=(k[1]||"").match(/boundary="(.*?)"/);if(!ne)throw new Error("MAD cannot find boundary");var ge="--"+(ne[1]||""),se=[],oe=[],le={FileIndex:se,FullPaths:oe};K(le);var Oe,Le=0;for(V=0;V<k.length;++V){var Ye=k[V];Ye!==ge&&Ye!==ge+"--"||(Le++&&Zw(le,k.slice(Oe,V),M),Oe=V)}return le}(F,B);if(F.length<512)throw new Error("CFB file size "+F.length+" < 512");var M,V,W,ne,ge,se,k=512,oe=[],le=F.slice(0,512);Br(le,0);var Oe=function E(F){if(80==F[F.l]&&75==F[F.l+1])return[0,0];F.chk(Ke,"Header Signature: "),F.l+=16;var B=F.read_shift(2,"u");return[F.read_shift(2,"u"),B]}(le);switch(M=Oe[0]){case 3:k=512;break;case 4:k=4096;break;case 0:if(0==Oe[1])return Fw(F,B);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}512!==k&&Br(le=F.slice(0,k),28);var Le=F.slice(0,k);!function R(F,B){var M=9;switch(F.l+=2,M=F.read_shift(2)){case 9:if(3!=B)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(4!=B)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}F.chk("0600","Mini Sector Shift: "),F.chk("000000000000","Reserved: ")}(le,M);var Ye=le.read_shift(4,"i");if(3===M&&0!==Ye)throw new Error("# Directory Sectors: Expected 0 saw "+Ye);le.l+=4,ne=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),ge=le.read_shift(4,"i"),V=le.read_shift(4,"i"),se=le.read_shift(4,"i"),W=le.read_shift(4,"i");for(var Me=-1,Ge=0;Ge<109&&!((Me=le.read_shift(4,"i"))<0);++Ge)oe[Ge]=Me;var mt=function T(F,B){for(var M=Math.ceil(F.length/B)-1,k=[],V=1;V<M;++V)k[V-1]=F.slice(V*B,(V+1)*B);return k[M-1]=F.slice(M*B),k}(F,k);b(se,W,mt,k,oe);var nr=function G(F,B,M,k){var V=F.length,W=[],ne=[],ge=[],se=[],oe=k-1,le=0,Oe=0,Le=0,Ye=0;for(le=0;le<V;++le)if(ge=[],(Le=le+B)>=V&&(Le-=V),!ne[Le]){se=[];var Me=[];for(Oe=Le;Oe>=0;){Me[Oe]=!0,ne[Oe]=!0,ge[ge.length]=Oe,se.push(F[Oe]);var Ge=M[Math.floor(4*Oe/k)];if(k<4+(Ye=4*Oe&oe))throw new Error("FAT boundary crossed: "+Oe+" 4 "+k);if(!F[Ge]||Me[Oe=Zn(F[Ge],Ye)])break}W[Le]={nodes:ge,data:zu([se])}}return W}(mt,ne,oe,k);nr[ne].name="!Directory",V>0&&ge!==Ie&&(nr[ge].name="!MiniFAT"),nr[oe[0]].name="!FAT",nr.fat_addrs=oe,nr.ssz=k;var br=[],Zi=[],Ef=[];(function N(F,B,M,k,V,W,ne,ge){for(var Ye,se=0,oe=k.length?2:0,le=B[F].data,Oe=0,Le=0;Oe<le.length;Oe+=128){var Me=le.slice(Oe,Oe+128);Br(Me,64),Le=Me.read_shift(2),Ye=Ws(Me,0,Le-oe),k.push(Ye);var Ge={name:Ye,type:Me.read_shift(1),color:Me.read_shift(1),L:Me.read_shift(4,"i"),R:Me.read_shift(4,"i"),C:Me.read_shift(4,"i"),clsid:Me.read_shift(16),state:Me.read_shift(4,"i"),start:0,size:0};0!==Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)&&(Ge.ct=Q(Me,Me.l-8)),0!==Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)&&(Ge.mt=Q(Me,Me.l-8)),Ge.start=Me.read_shift(4,"i"),Ge.size=Me.read_shift(4,"i"),Ge.size<0&&Ge.start<0&&(Ge.size=Ge.type=0,Ge.start=Ie,Ge.name=""),5===Ge.type?(se=Ge.start,V>0&&se!==Ie&&(B[se].name="!StreamData")):Ge.size>=4096?(Ge.storage="fat",void 0===B[Ge.start]&&(B[Ge.start]=H(M,Ge.start,B.fat_addrs,B.ssz)),B[Ge.start].name=Ge.name,Ge.content=B[Ge.start].data.slice(0,Ge.size)):(Ge.storage="minifat",Ge.size<0?Ge.size=0:se!==Ie&&Ge.start!==Ie&&B[se]&&(Ge.content=x(Ge,B[se].data,(B[ge]||{}).data))),Ge.content&&Br(Ge.content,0),W[Ye]=Ge,ne.push(Ge)}})(ne,nr,mt,br,V,{},Zi,ge),function A(F,B,M){for(var k=0,V=0,W=0,ne=0,ge=0,se=M.length,oe=[],le=[];k<se;++k)oe[k]=le[k]=k,B[k]=M[k];for(;ge<le.length;++ge)k=le[ge],V=F[k].L,W=F[k].R,ne=F[k].C,oe[k]===k&&(-1!==V&&oe[V]!==V&&(oe[k]=oe[V]),-1!==W&&oe[W]!==W&&(oe[k]=oe[W])),-1!==ne&&(oe[ne]=k),-1!==V&&k!=oe[k]&&(oe[V]=oe[k],le.lastIndexOf(V)<ge&&le.push(V)),-1!==W&&k!=oe[k]&&(oe[W]=oe[k],le.lastIndexOf(W)<ge&&le.push(W));for(k=1;k<se;++k)oe[k]===k&&(-1!==W&&oe[W]!==W?oe[k]=oe[W]:-1!==V&&oe[V]!==V&&(oe[k]=oe[V]));for(k=1;k<se;++k)if(0!==F[k].type){if((ge=k)!=oe[ge])do{ge=oe[ge],B[k]=B[ge]+"/"+B[k]}while(0!==ge&&-1!==oe[ge]&&ge!=oe[ge]);oe[k]=-1}for(B[0]+="/",k=1;k<se;++k)2!==F[k].type&&(B[k]+="/")}(Zi,Ef,br),br.shift();var Rf={FileIndex:Zi,FullPaths:Ef};return B&&B.raw&&(Rf.raw={header:Le,sectors:mt}),Rf}function x(F,B,M){for(var k=F.start,V=F.size,W=[],ne=k;M&&V>0&&ne>=0;)W.push(B.slice(ne*ee,ne*ee+ee)),V-=ee,ne=Zn(M,4*ne);return 0===W.length?de(0):fr(W).slice(0,F.size)}function b(F,B,M,k,V){var W=Ie;if(F===Ie){if(0!==B)throw new Error("DIFAT chain shorter than expected")}else if(-1!==F){var ne=M[F],ge=(k>>>2)-1;if(!ne)return;for(var se=0;se<ge&&(W=Zn(ne,4*se))!==Ie;++se)V.push(W);b(Zn(ne,k-4),B-1,M,k,V)}}function H(F,B,M,k,V){var W=[],ne=[];V||(V=[]);var ge=k-1,se=0,oe=0;for(se=B;se>=0;){V[se]=!0,W[W.length]=se,ne.push(F[se]);var le=M[Math.floor(4*se/k)];if(k<4+(oe=4*se&ge))throw new Error("FAT boundary crossed: "+se+" 4 "+k);if(!F[le])break;se=Zn(F[le],oe)}return{nodes:W,data:zu([ne])}}function Q(F,B){return new Date(1e3*(wr(F,B+4)/1e7*Math.pow(2,32)+wr(F,B)/1e7-11644473600))}function K(F,B){var M=B||{},k=M.root||"Root Entry";if(F.FullPaths||(F.FullPaths=[]),F.FileIndex||(F.FileIndex=[]),F.FullPaths.length!==F.FileIndex.length)throw new Error("inconsistent CFB structure");0===F.FullPaths.length&&(F.FullPaths[0]=k+"/",F.FileIndex[0]={name:k,type:5}),M.CLSID&&(F.FileIndex[0].clsid=M.CLSID),function te(F){var B="\x01Sh33tJ5";if(!tt.find(F,"/"+B)){var M=de(4);M[0]=55,M[1]=M[3]=50,M[2]=54,F.FileIndex.push({name:B,type:2,content:M,size:4,L:69,R:69,C:69}),F.FullPaths.push(F.FullPaths[0]+B),J(F)}}(F)}function J(F,B){K(F);for(var M=!1,k=!1,V=F.FullPaths.length-1;V>=0;--V){var W=F.FileIndex[V];switch(W.type){case 0:k?M=!0:(F.FileIndex.pop(),F.FullPaths.pop());break;case 1:case 2:case 5:k=!0,isNaN(W.R*W.L*W.C)&&(M=!0),W.R>-1&&W.L>-1&&W.R==W.L&&(M=!0);break;default:M=!0}}if(M||B){var ne=new Date(1987,1,19),ge=0,se=Object.create?Object.create(null):{},oe=[];for(V=0;V<F.FullPaths.length;++V)se[F.FullPaths[V]]=!0,0!==F.FileIndex[V].type&&oe.push([F.FullPaths[V],F.FileIndex[V]]);for(V=0;V<oe.length;++V){var le=f(oe[V][0]);(k=se[le])||(oe.push([le,{name:p(le).replace("/",""),type:1,clsid:ut,ct:ne,mt:ne,content:null}]),se[le]=!0)}for(oe.sort(function(Ye,Me){return function a(F,B){for(var M=F.split("/"),k=B.split("/"),V=0,W=0,ne=Math.min(M.length,k.length);V<ne;++V){if(W=M[V].length-k[V].length)return W;if(M[V]!=k[V])return M[V]<k[V]?-1:1}return M.length-k.length}(Ye[0],Me[0])}),F.FullPaths=[],F.FileIndex=[],V=0;V<oe.length;++V)F.FullPaths[V]=oe[V][0],F.FileIndex[V]=oe[V][1];for(V=0;V<oe.length;++V){var Oe=F.FileIndex[V],Le=F.FullPaths[V];if(Oe.name=p(Le).replace("/",""),Oe.L=Oe.R=Oe.C=-(Oe.color=1),Oe.size=Oe.content?Oe.content.length:0,Oe.start=0,Oe.clsid=Oe.clsid||ut,0===V)Oe.C=oe.length>1?1:-1,Oe.size=0,Oe.type=5;else if("/"==Le.slice(-1)){for(ge=V+1;ge<oe.length&&f(F.FullPaths[ge])!=Le;++ge);for(Oe.C=ge>=oe.length?-1:ge,ge=V+1;ge<oe.length&&f(F.FullPaths[ge])!=f(Le);++ge);Oe.R=ge>=oe.length?-1:ge,Oe.type=1}else f(F.FullPaths[V+1]||"")==f(Le)&&(Oe.R=V+1),Oe.type=2}}}function fe(F,B){var M=B||{};if("mad"==M.fileType)return function tS(F,B){for(var M=B||{},k=M.boundary||"SheetJS",V=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(k="------="+k).slice(2)+'"',"","",""],W=F.FullPaths[0],ne=W,ge=F.FileIndex[0],se=1;se<F.FullPaths.length;++se)if(ne=F.FullPaths[se].slice(W.length),(ge=F.FileIndex[se]).size&&ge.content&&"\x01Sh33tJ5"!=ne){ne=ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(mt){return"_x"+mt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(mt){return"_u"+mt.charCodeAt(0).toString(16)+"_"});for(var oe=ge.content,le=St&&Buffer.isBuffer(oe)?oe.toString("binary"):je(oe),Oe=0,Le=Math.min(1024,le.length),Ye=0,Me=0;Me<=Le;++Me)(Ye=le.charCodeAt(Me))>=32&&Ye<128&&++Oe;var Ge=Oe>=4*Le/5;V.push(k),V.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+ne),V.push("Content-Transfer-Encoding: "+(Ge?"quoted-printable":"base64")),V.push("Content-Type: "+Xw(ge,ne)),V.push(""),V.push(Ge?Qw(le):qw(le))}return V.push(k+"--\r\n"),V.join("\r\n")}(F,M);if("zip"===(J(F),M.fileType))return function Yw(F,B){var M=B||{},k=[],V=[],W=de(1),ne=M.compression?8:0,ge=0,se=!1;se&&(ge|=8);var oe=0,le=0,Oe=0,Le=0,Ye=F.FullPaths[0],Me=Ye,Ge=F.FileIndex[0],mt=[],nr=0;for(oe=1;oe<F.FullPaths.length;++oe)if(Me=F.FullPaths[oe].slice(Ye.length),(Ge=F.FileIndex[oe]).size&&Ge.content&&"\x01Sh33tJ5"!=Me){var Gi=Oe,br=de(Me.length);for(le=0;le<Me.length;++le)br.write_shift(1,127&Me.charCodeAt(le));br=br.slice(0,br.l),mt[Le]=Hf.buf(Ge.content,0);var Zi=Ge.content;8==ne&&(Zi=X(Zi)),(W=de(30)).write_shift(4,67324752),W.write_shift(2,20),W.write_shift(2,ge),W.write_shift(2,ne),Ge.mt?d(W,Ge.mt):W.write_shift(4,0),W.write_shift(-4,8&ge?0:mt[Le]),W.write_shift(4,8&ge?0:Zi.length),W.write_shift(4,8&ge?0:Ge.content.length),W.write_shift(2,br.length),W.write_shift(2,0),Oe+=W.length,k.push(W),Oe+=br.length,k.push(br),Oe+=Zi.length,k.push(Zi),8&ge&&((W=de(12)).write_shift(-4,mt[Le]),W.write_shift(4,Zi.length),W.write_shift(4,Ge.content.length),Oe+=W.l,k.push(W)),(W=de(46)).write_shift(4,33639248),W.write_shift(2,0),W.write_shift(2,20),W.write_shift(2,ge),W.write_shift(2,ne),W.write_shift(4,0),W.write_shift(-4,mt[Le]),W.write_shift(4,Zi.length),W.write_shift(4,Ge.content.length),W.write_shift(2,br.length),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(4,0),W.write_shift(4,Gi),nr+=W.l,V.push(W),nr+=br.length,V.push(br),++Le}return W=de(22),W.write_shift(4,101010256),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,Le),W.write_shift(2,Le),W.write_shift(4,nr),W.write_shift(4,Oe),W.write_shift(2,0),fr([fr(k),fr(V),W])}(F,M);var k=function(Ye){for(var Me=0,Ge=0,mt=0;mt<Ye.FileIndex.length;++mt){var nr=Ye.FileIndex[mt];if(nr.content){var Gi=nr.content.length;Gi>0&&(Gi<4096?Me+=Gi+63>>6:Ge+=Gi+511>>9)}}for(var br=Ye.FullPaths.length+3>>2,Ef=Me+127>>7,Rf=(Me+7>>3)+Ge+br+Ef,Ja=Rf+127>>7,JC=Ja<=109?0:Math.ceil((Ja-109)/127);Rf+Ja+JC+127>>7>Ja;)JC=++Ja<=109?0:Math.ceil((Ja-109)/127);var $o=[1,JC,Ja,Ef,br,Ge,Me,0];return Ye.FileIndex[0].size=Me<<6,$o[7]=(Ye.FileIndex[0].start=$o[0]+$o[1]+$o[2]+$o[3]+$o[4]+$o[5])+($o[6]+7>>3),$o}(F),V=de(k[7]<<9),W=0,ne=0;for(W=0;W<8;++W)V.write_shift(1,ke[W]);for(W=0;W<8;++W)V.write_shift(2,0);for(V.write_shift(2,62),V.write_shift(2,3),V.write_shift(2,65534),V.write_shift(2,9),V.write_shift(2,6),W=0;W<3;++W)V.write_shift(2,0);for(V.write_shift(4,0),V.write_shift(4,k[2]),V.write_shift(4,k[0]+k[1]+k[2]+k[3]-1),V.write_shift(4,0),V.write_shift(4,4096),V.write_shift(4,k[3]?k[0]+k[1]+k[2]-1:Ie),V.write_shift(4,k[3]),V.write_shift(-4,k[1]?k[0]-1:Ie),V.write_shift(4,k[1]),W=0;W<109;++W)V.write_shift(-4,W<k[2]?k[1]+W:-1);if(k[1])for(ne=0;ne<k[1];++ne){for(;W<236+127*ne;++W)V.write_shift(-4,W<k[2]?k[1]+W:-1);V.write_shift(-4,ne===k[1]-1?Ie:ne+1)}var ge=function(Ye){for(ne+=Ye;W<ne-1;++W)V.write_shift(-4,W+1);Ye&&(++W,V.write_shift(-4,Ie))};for(ne=W=0,ne+=k[1];W<ne;++W)V.write_shift(-4,Qe.DIFSECT);for(ne+=k[2];W<ne;++W)V.write_shift(-4,Qe.FATSECT);ge(k[3]),ge(k[4]);for(var se=0,oe=0,le=F.FileIndex[0];se<F.FileIndex.length;++se)(le=F.FileIndex[se]).content&&(!((oe=le.content.length)<4096)&&(le.start=ne,ge(oe+511>>9)));for(ge(k[6]+7>>3);511&V.l;)V.write_shift(-4,Qe.ENDOFCHAIN);for(ne=W=0,se=0;se<F.FileIndex.length;++se)(le=F.FileIndex[se]).content&&((oe=le.content.length)&&!(oe>=4096)&&(le.start=ne,ge(oe+63>>6)));for(;511&V.l;)V.write_shift(-4,Qe.ENDOFCHAIN);for(W=0;W<k[4]<<2;++W){var Oe=F.FullPaths[W];if(Oe&&0!==Oe.length){le=F.FileIndex[W],0===W&&(le.start=le.size?le.start-1:Ie);var Le=0===W&&M.root||le.name;if(oe=2*(Le.length+1),V.write_shift(64,Le,"utf16le"),V.write_shift(2,oe),V.write_shift(1,le.type),V.write_shift(1,le.color),V.write_shift(-4,le.L),V.write_shift(-4,le.R),V.write_shift(-4,le.C),le.clsid)V.write_shift(16,le.clsid,"hex");else for(se=0;se<4;++se)V.write_shift(4,0);V.write_shift(4,le.state||0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,le.start),V.write_shift(4,le.size),V.write_shift(4,0)}else{for(se=0;se<17;++se)V.write_shift(4,0);for(se=0;se<3;++se)V.write_shift(4,-1);for(se=0;se<12;++se)V.write_shift(4,0)}}for(W=1;W<F.FileIndex.length;++W)if((le=F.FileIndex[W]).size>=4096)if(V.l=le.start+1<<9,St&&Buffer.isBuffer(le.content))le.content.copy(V,V.l,0,le.size),V.l+=le.size+511&-512;else{for(se=0;se<le.size;++se)V.write_shift(1,le.content[se]);for(;511&se;++se)V.write_shift(1,0)}for(W=1;W<F.FileIndex.length;++W)if((le=F.FileIndex[W]).size>0&&le.size<4096)if(St&&Buffer.isBuffer(le.content))le.content.copy(V,V.l,0,le.size),V.l+=le.size+63&-64;else{for(se=0;se<le.size;++se)V.write_shift(1,le.content[se]);for(;63&se;++se)V.write_shift(1,0)}if(St)V.l=V.length;else for(;V.l<V.length;)V.write_shift(1,0);return V}l.version="1.2.1";var Ee,ee=64,Ie=-2,Ke="d0cf11e0a1b11ae1",ke=[208,207,17,224,161,177,26,225],ut="00000000000000000000000000000000",Qe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Ie,FREESECT:-1,HEADER_SIGNATURE:Ke,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ut,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function je(F){for(var B=new Array(F.length),M=0;M<F.length;++M)B[M]=String.fromCharCode(F[M]);return B.join("")}function X(F){return Ee?Ee.deflateRawSync(F):Tt(F)}var F,B,Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ye=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Be=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];for(var Pe=typeof Uint8Array<"u",xe=Pe?new Uint8Array(256):[],Rt=0;Rt<256;++Rt)xe[Rt]=(B=void 0,255&((B=139536&((F=Rt)<<1|F<<11)|558144&(F<<5|F<<15))>>16|B>>8|B));function U(F,B){var M=xe[255&F];return B<=8?M>>>8-B:(M=M<<8|xe[F>>8&255],B<=16?M>>>16-B:(M=M<<8|xe[F>>16&255])>>>24-B)}function jt(F,B){var M=7&B,k=B>>>3;return(F[k]|(M<=6?0:F[k+1]<<8))>>>M&3}function At(F,B){var M=7&B,k=B>>>3;return(F[k]|(M<=5?0:F[k+1]<<8))>>>M&7}function Dt(F,B){var M=7&B,k=B>>>3;return(F[k]|(M<=3?0:F[k+1]<<8))>>>M&31}function We(F,B){var M=7&B,k=B>>>3;return(F[k]|(M<=1?0:F[k+1]<<8))>>>M&127}function _r(F,B,M){var k=7&B,V=B>>>3,W=(1<<M)-1,ne=F[V]>>>k;return M<8-k||(ne|=F[V+1]<<8-k,M<16-k)||(ne|=F[V+2]<<16-k,M<24-k)||(ne|=F[V+3]<<24-k),ne&W}function En(F,B,M){var k=7&B,V=B>>>3;return k<=5?F[V]|=(7&M)<<k:(F[V]|=M<<k&255,F[V+1]=(7&M)>>8-k),B+3}function go(F,B,M){return M=(1&M)<<(7&B),F[B>>>3]|=M,B+1}function zo(F,B,M){var V=B>>>3;return M<<=7&B,F[V]|=255&M,M>>>=8,F[V+1]=M,B+8}function _f(F,B,M){var V=B>>>3;return M<<=7&B,F[V]|=255&M,M>>>=8,F[V+1]=255&M,F[V+2]=M>>>8,B+16}function Ls(F,B){var M=F.length,k=2*M>B?2*M:B+5,V=0;if(M>=B)return F;if(St){var W=Qr(k);if(F.copy)F.copy(W);else for(;V<F.length;++V)W[V]=F[V];return W}if(Pe){var ne=new Uint8Array(k);if(ne.set)ne.set(F);else for(;V<M;++V)ne[V]=F[V];return ne}return F.length=k,F}function Ji(F){for(var B=new Array(F),M=0;M<F;++M)B[M]=0;return B}function Ko(F,B,M){var k=1,V=0,W=0,ne=0,ge=0,se=F.length,oe=Pe?new Uint16Array(32):Ji(32);for(W=0;W<32;++W)oe[W]=0;for(W=se;W<M;++W)F[W]=0;se=F.length;var le=Pe?new Uint16Array(se):Ji(se);for(W=0;W<se;++W)oe[V=F[W]]++,k<V&&(k=V),le[W]=0;for(oe[0]=0,W=1;W<=k;++W)oe[W+16]=ge=ge+oe[W-1]<<1;for(W=0;W<se;++W)0!=(ge=F[W])&&(le[W]=oe[ge+16]++);var Oe=0;for(W=0;W<se;++W)if(0!=(Oe=F[W]))for(ge=U(le[W],k)>>k-Oe,ne=(1<<k+4-Oe)-1;ne>=0;--ne)B[ge|ne<<Oe]=15&Oe|W<<4;return k}var Ms=Pe?new Uint16Array(512):Ji(512),xf=Pe?new Uint16Array(32):Ji(32);if(!Pe){for(var Oi=0;Oi<512;++Oi)Ms[Oi]=0;for(Oi=0;Oi<32;++Oi)xf[Oi]=0}!function(){for(var F=[],B=0;B<32;B++)F.push(5);Ko(F,xf,32);var M=[];for(B=0;B<=143;B++)M.push(8);for(;B<=255;B++)M.push(9);for(;B<=279;B++)M.push(7);for(;B<=287;B++)M.push(8);Ko(M,Ms,288)}();var mo=function(){for(var B=Pe?new Uint8Array(32768):[],M=0,k=0;M<Be.length-1;++M)for(;k<Be[M+1];++k)B[k]=M;for(;k<32768;++k)B[k]=29;var V=Pe?new Uint8Array(259):[];for(M=0,k=0;M<ye.length-1;++M)for(;k<ye[M+1];++k)V[k]=M;return function(se,oe){return se.length<8?function W(ge,se){for(var oe=0;oe<ge.length;){var le=Math.min(65535,ge.length-oe),Oe=oe+le==ge.length;for(se.write_shift(1,+Oe),se.write_shift(2,le),se.write_shift(2,65535&~le);le-- >0;)se[se.l++]=ge[oe++]}return se.l}(se,oe):function ne(ge,se){for(var oe=0,le=0,Oe=Pe?new Uint16Array(32768):[];le<ge.length;){var Le=Math.min(65535,ge.length-le);if(Le<10){for(7&(oe=En(se,oe,+(le+Le==ge.length)))&&(oe+=8-(7&oe)),se.l=oe/8|0,se.write_shift(2,Le),se.write_shift(2,65535&~Le);Le-- >0;)se[se.l++]=ge[le++];oe=8*se.l}else{oe=En(se,oe,+(le+Le==ge.length)+2);for(var Ye=0;Le-- >0;){var Me=ge[le],Ge=-1,mt=0;if((Ge=Oe[Ye=32767&(Ye<<5^Me)])&&((Ge|=-32768&le)>le&&(Ge-=32768),Ge<le))for(;ge[Ge+mt]==ge[le+mt]&&mt<250;)++mt;if(mt>2){(Me=V[mt])<=22?oe=zo(se,oe,xe[Me+1]>>1)-1:(zo(se,oe,3),zo(se,oe+=5,xe[Me-23]>>5),oe+=3);var nr=Me<8?0:Me-4>>2;nr>0&&(_f(se,oe,mt-ye[Me]),oe+=nr),Me=B[le-Ge],oe=zo(se,oe,xe[Me]>>3),oe-=3;var Gi=Me<4?0:Me-2>>1;Gi>0&&(_f(se,oe,le-Ge-Be[Me]),oe+=Gi);for(var br=0;br<mt;++br)Oe[Ye]=32767&le,Ye=32767&(Ye<<5^ge[le]),++le;Le-=mt-1}else Me<=143?Me+=48:oe=go(se,oe,1),oe=zo(se,oe,xe[Me]),Oe[Ye]=32767&le,++le}oe=zo(se,oe,0)-1}}return se.l=(oe+7)/8|0,se.l}(se,oe)}}();function Tt(F){var B=de(50+Math.floor(1.1*F.length)),M=mo(F,B);return B.slice(0,M)}var xr=Pe?new Uint16Array(32768):Ji(32768),Rn=Pe?new Uint16Array(32768):Ji(32768),jr=Pe?new Uint16Array(128):Ji(128),Qa=1,Aw=1;function zw(F,B){var M=Dt(F,B)+257,k=Dt(F,B+=5)+1,V=function zt(F,B){var M=7&B,k=B>>>3;return(F[k]|(M<=4?0:F[k+1]<<8))>>>M&15}(F,B+=5)+4;B+=4;for(var W=0,ne=Pe?new Uint8Array(19):Ji(19),ge=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],se=1,oe=Pe?new Uint8Array(8):Ji(8),le=Pe?new Uint8Array(8):Ji(8),Oe=ne.length,Le=0;Le<V;++Le)ne[Y[Le]]=W=At(F,B),se<W&&(se=W),oe[W]++,B+=3;var Ye=0;for(oe[0]=0,Le=1;Le<=se;++Le)le[Le]=Ye=Ye+oe[Le-1]<<1;for(Le=0;Le<Oe;++Le)0!=(Ye=ne[Le])&&(ge[Le]=le[Ye]++);var Me=0;for(Le=0;Le<Oe;++Le)if(0!=(Me=ne[Le])){Ye=xe[ge[Le]]>>8-Me;for(var Ge=(1<<7-Me)-1;Ge>=0;--Ge)jr[Ye|Ge<<Me]=7&Me|Le<<3}var mt=[];for(se=1;mt.length<M+k;)switch(Ye=jr[We(F,B)],B+=7&Ye,Ye>>>=3){case 16:for(W=3+jt(F,B),B+=2,Ye=mt[mt.length-1];W-- >0;)mt.push(Ye);break;case 17:for(W=3+At(F,B),B+=3;W-- >0;)mt.push(0);break;case 18:for(W=11+We(F,B),B+=7;W-- >0;)mt.push(0);break;default:mt.push(Ye),se<Ye&&(se=Ye)}var nr=mt.slice(0,M),Gi=mt.slice(M);for(Le=M;Le<286;++Le)nr[Le]=0;for(Le=k;Le<30;++Le)Gi[Le]=0;return Qa=Ko(nr,xr,286),Aw=Ko(Gi,Rn,30),B}function Dw(F,B){var k=function Kw(F,B){if(3==F[0]&&!(3&F[1]))return[Ir(B),2];for(var M=0,k=0,V=Qr(B||1<<18),W=0,ne=V.length>>>0,ge=0,se=0;!(1&k);)if(k=At(F,M),M+=3,k>>>1)for(k>>1==1?(ge=9,se=5):(M=zw(F,M),ge=Qa,se=Aw);;){!B&&ne<W+32767&&(ne=(V=Ls(V,W+32767)).length);var le=_r(F,M,ge),Oe=k>>>1==1?Ms[le]:xr[le];if(M+=15&Oe,(Oe>>>=4)>>>8&255){if(256==Oe)break;var Le=(Oe-=257)<8?0:Oe-4>>2;Le>5&&(Le=0);var Ye=W+ye[Oe];Le>0&&(Ye+=_r(F,M,Le),M+=Le),le=_r(F,M,se),M+=15&(Oe=k>>>1==1?xf[le]:Rn[le]);var Me=(Oe>>>=4)<4?0:Oe-2>>1,Ge=Be[Oe];for(Me>0&&(Ge+=_r(F,M,Me),M+=Me),!B&&ne<Ye&&(ne=(V=Ls(V,Ye+100)).length);W<Ye;)V[W]=V[W-Ge],++W}else V[W++]=Oe}else{7&M&&(M+=8-(7&M));var oe=F[M>>>3]|F[1+(M>>>3)]<<8;if(M+=32,oe>0)for(!B&&ne<W+oe&&(ne=(V=Ls(V,W+oe)).length);oe-- >0;)V[W++]=F[M>>>3],M+=8}return B?[V,M+7>>>3]:[V.slice(0,W),M+7>>>3]}(F.slice(F.l||0),B);return F.l+=k[1],k[0]}function bw(F,B){if(!F)throw new Error(B);typeof console<"u"&&console.error(B)}function Fw(F,B){var M=F;Br(M,0);var W={FileIndex:[],FullPaths:[]};K(W,{root:B.root});for(var ne=M.length-4;(80!=M[ne]||75!=M[ne+1]||5!=M[ne+2]||6!=M[ne+3])&&ne>=0;)--ne;M.l=ne+4,M.l+=4;var ge=M.read_shift(2);M.l+=6;var se=M.read_shift(4);for(M.l=se,ne=0;ne<ge;++ne){M.l+=20;var oe=M.read_shift(4),le=M.read_shift(4),Oe=M.read_shift(2),Le=M.read_shift(2),Ye=M.read_shift(2);M.l+=8;var Me=M.read_shift(4),Ge=g(M.slice(M.l+Oe,M.l+Oe+Le));M.l+=Oe+Le+Ye;var mt=M.l;M.l=Me+4,$w(M,oe,le,W,Ge),M.l=mt}return W}function $w(F,B,M,k,V){F.l+=2;var W=F.read_shift(2),ne=F.read_shift(2),ge=function h(F){var B=65535&F.read_shift(2),M=65535&F.read_shift(2),k=new Date,V=31&M,W=15&(M>>>=5);M>>>=4,k.setMilliseconds(0),k.setFullYear(M+1980),k.setMonth(W-1),k.setDate(V);var ne=31&B,ge=63&(B>>>=5);return B>>>=6,k.setHours(B),k.setMinutes(ge),k.setSeconds(ne<<1),k}(F);if(8257&W)throw new Error("Unsupported ZIP encryption");F.read_shift(4);for(var oe=F.read_shift(4),le=F.read_shift(4),Oe=F.read_shift(2),Le=F.read_shift(2),Ye="",Me=0;Me<Oe;++Me)Ye+=String.fromCharCode(F[F.l++]);if(Le){var Ge=g(F.slice(F.l,F.l+Le));(Ge[21589]||{}).mt&&(ge=Ge[21589].mt),((V||{})[21589]||{}).mt&&(ge=V[21589].mt)}F.l+=Le;var mt=F.slice(F.l,F.l+oe);switch(ne){case 8:mt=function ae(F,B){if(!Ee)return Dw(F,B);var k=new(0,Ee.InflateRaw),V=k._processChunk(F.slice(F.l),k._finishFlushFlag);return F.l+=k.bytesRead,V}(F,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ne)}var nr=!1;8&W&&(134695760==F.read_shift(4)&&(F.read_shift(4),nr=!0),oe=F.read_shift(4),le=F.read_shift(4)),oe!=B&&bw(nr,"Bad compressed size: "+B+" != "+oe),le!=M&&bw(nr,"Bad uncompressed size: "+M+" != "+le),QC(k,Ye,mt,{unsafe:!0,mt:ge})}var hh={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Xw(F,B){if(F.ctype)return F.ctype;var M=F.name||"",k=M.match(/\.([^\.]+)$/);return k&&hh[k[1]]||B&&((k=(M=B).match(/[\.\\]([^\.\\])+$/))&&hh[k[1]])?hh[k[1]]:"application/octet-stream"}function qw(F){for(var B=Yo(F),M=[],k=0;k<B.length;k+=76)M.push(B.slice(k,k+76));return M.join("\r\n")+"\r\n"}function Qw(F){var B=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(oe){var le=oe.charCodeAt(0).toString(16).toUpperCase();return"="+(1==le.length?"0"+le:le)});"\n"==(B=B.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(B="=0D"+B.slice(1));for(var M=[],k=(B=B.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),V=0;V<k.length;++V){var W=k[V];if(0!=W.length)for(var ne=0;ne<W.length;){var ge=76,se=W.slice(ne,ne+ge);"="==se.charAt(ge-1)?ge--:"="==se.charAt(ge-2)?ge-=2:"="==se.charAt(ge-3)&&(ge-=3),se=W.slice(ne,ne+ge),(ne+=ge)<W.length&&(se+="="),M.push(se)}else M.push("")}return M.join("\r\n")}function Zw(F,B,M){for(var ne,k="",V="",W="",ge=0;ge<10;++ge){var se=B[ge];if(!se||se.match(/^\s*$/))break;var oe=se.match(/^(.*?):\s*([^\s].*)$/);if(oe)switch(oe[1].toLowerCase()){case"content-location":k=oe[2].trim();break;case"content-type":W=oe[2].trim();break;case"content-transfer-encoding":V=oe[2].trim()}}switch(++ge,V.toLowerCase()){case"base64":ne=Ci(yi(B.slice(ge).join("")));break;case"quoted-printable":ne=function Jw(F){for(var B=[],M=0;M<F.length;++M){for(var k=F[M];M<=F.length&&"="==k.charAt(k.length-1);)k=k.slice(0,k.length-1)+F[++M];B.push(k)}for(var V=0;V<B.length;++V)B[V]=B[V].replace(/[=][0-9A-Fa-f]{2}/g,function(W){return String.fromCharCode(parseInt(W.slice(1),16))});return Ci(B.join("\r\n"))}(B.slice(ge));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+V)}var le=QC(F,k.slice(M.length),ne,{unsafe:!0});W&&(le.ctype=W)}function QC(F,B,M,k){var V=k&&k.unsafe;V||K(F);var W=!V&&tt.find(F,B);if(!W){var ne=F.FullPaths[0];B.slice(0,ne.length)==ne?ne=B:("/"!=ne.slice(-1)&&(ne+="/"),ne=(ne+B).replace("//","/")),W={name:p(B),type:2},F.FileIndex.push(W),F.FullPaths.push(ne),V||tt.utils.cfb_gc(F)}return W.content=M,W.size=M?M.length:0,k&&(k.CLSID&&(W.clsid=k.CLSID),k.mt&&(W.mt=k.mt),k.ct&&(W.ct=k.ct)),W}return l.find=function he(F,B){var M=F.FullPaths.map(function(se){return se.toUpperCase()}),k=M.map(function(se){var oe=se.split("/");return oe[oe.length-("/"==se.slice(-1)?2:1)]}),V=!1;47===B.charCodeAt(0)?(V=!0,B=M[0].slice(0,-1)+B):V=-1!==B.indexOf("/");var W=B.toUpperCase(),ne=!0===V?M.indexOf(W):k.indexOf(W);if(-1!==ne)return F.FileIndex[ne];var ge=!W.match(_t);for(W=W.replace(Lr,""),ge&&(W=W.replace(_t,"!")),ne=0;ne<M.length;++ne)if((ge?M[ne].replace(_t,"!"):M[ne]).replace(Lr,"")==W||(ge?k[ne].replace(_t,"!"):k[ne]).replace(Lr,"")==W)return F.FileIndex[ne];return null},l.read=function ce(F,B){var M=B&&B.type;switch(M||St&&Buffer.isBuffer(F)&&(M="buffer"),M||"base64"){case"file":return function ie(F,B){return w(),S(y.readFileSync(F),B)}(F,B);case"base64":return S(Ci(yi(F)),B);case"binary":return S(Ci(F),B)}return S(F,B)},l.parse=S,l.write=function pt(F,B){var M=fe(F,B);switch(B&&B.type||"buffer"){case"file":return w(),y.writeFileSync(B.filename,M),M;case"binary":return"string"==typeof M?M:je(M);case"base64":return Yo("string"==typeof M?M:je(M));case"buffer":if(St)return Buffer.isBuffer(M)?M:en(M);case"array":return"string"==typeof M?Ci(M):M}return M},l.writeFile=function Ot(F,B,M){w();var k=fe(F,M);y.writeFileSync(B,k)},l.utils={cfb_new:function rS(F){var B={};return K(B,F),B},cfb_add:QC,cfb_del:function iS(F,B){K(F);var M=tt.find(F,B);if(M)for(var k=0;k<F.FileIndex.length;++k)if(F.FileIndex[k]==M)return F.FileIndex.splice(k,1),F.FullPaths.splice(k,1),!0;return!1},cfb_mov:function nS(F,B,M){K(F);var k=tt.find(F,B);if(k)for(var V=0;V<F.FileIndex.length;++V)if(F.FileIndex[V]==k)return F.FileIndex[V].name=p(M),F.FullPaths[V]=M,!0;return!1},cfb_gc:function oS(F){J(F,!0)},ReadShift:an,CheckField:np,prep_blob:Br,bconcat:fr,use_zlib:function j(F){try{var M=new(0,F.InflateRaw);if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),!M.bytesRead)throw new Error("zlib does not expose bytesRead");Ee=F}catch(k){console.error("cannot use native zlib: "+(k.message||k))}},_deflateRaw:Tt,_inflateRaw:Dw,consts:Qe},l}();let Dn;function Co(s){return"string"==typeof s?ks(s):Array.isArray(s)?function Za(s){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(s)}(s):s}function we(s,l,a){if(typeof Dn<"u"&&Dn.writeFileSync)return a?Dn.writeFileSync(s,l,a):Dn.writeFileSync(s,l);if(typeof Deno<"u"){if(a&&"string"==typeof l)switch(a){case"utf8":l=new TextEncoder(a).encode(l);break;case"binary":l=ks(l);break;default:throw new Error("Unsupported encoding "+a)}return Deno.writeFileSync(s,l)}var f="utf8"==a?ji(l):l;if(typeof IE_SaveFile<"u")return IE_SaveFile(f,s);if(typeof Blob<"u"){var p=new Blob([Co(f)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(p,s);if(typeof saveAs<"u")return saveAs(p,s);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var d=URL.createObjectURL(p);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(d)},6e4),chrome.downloads.download({url:d,filename:s,saveAs:!0});var h=document.createElement("a");if(null!=h.download)return h.download=s,h.href=d,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(d)},6e4),d}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var g=File(s);return g.open("w"),g.encoding="binary",Array.isArray(l)&&(l=zn(l)),g.write(l),g.close(),l}catch(y){if(!y.message||!y.message.match(/onstruct/))throw y}throw new Error("cannot save file "+s)}function qt(s){for(var l=Object.keys(s),a=[],f=0;f<l.length;++f)Object.prototype.hasOwnProperty.call(s,l[f])&&a.push(l[f]);return a}function Bf(s,l){for(var a=[],f=qt(s),p=0;p!==f.length;++p)null==a[s[f[p]][l]]&&(a[s[f[p]][l]]=f[p]);return a}function cl(s){for(var l=[],a=qt(s),f=0;f!==a.length;++f)l[s[a[f]]]=a[f];return l}function Hs(s){for(var l=[],a=qt(s),f=0;f!==a.length;++f)l[s[a[f]]]=parseInt(a[f],10);return l}var fl=new Date(1899,11,30,0,0,0);function Cr(s,l){var a=s.getTime();return l&&(a-=1263168e5),(a-(fl.getTime()+6e4*(s.getTimezoneOffset()-fl.getTimezoneOffset())))/864e5}var Vi=new Date,Mu=fl.getTime()+6e4*(Vi.getTimezoneOffset()-fl.getTimezoneOffset()),Vf=Vi.getTimezoneOffset();function Nu(s){var l=new Date;return l.setTime(24*s*60*60*1e3+Mu),l.getTimezoneOffset()!==Vf&&l.setTime(l.getTime()+6e4*(l.getTimezoneOffset()-Vf)),l}var ku=new Date("2017-02-19T19:06:09.000Z"),pl=isNaN(ku.getFullYear())?new Date("2/19/17"):ku,xh=2017==pl.getFullYear();function rr(s,l){var a=new Date(s);if(xh)return l>0?a.setTime(a.getTime()+60*a.getTimezoneOffset()*1e3):l<0&&a.setTime(a.getTime()-60*a.getTimezoneOffset()*1e3),a;if(s instanceof Date)return s;if(1917==pl.getFullYear()&&!isNaN(a.getFullYear())){var f=a.getFullYear();return s.indexOf(""+f)>-1||a.setFullYear(a.getFullYear()+100),a}var p=s.match(/\d+/g)||["2017","2","19","0","0","0"],d=new Date(+p[0],+p[1]-1,+p[2],+p[3]||0,+p[4]||0,+p[5]||0);return s.indexOf("Z")>-1&&(d=new Date(d.getTime()-60*d.getTimezoneOffset()*1e3)),d}function rn(s,l){if(St&&Buffer.isBuffer(s)){if(l){if(255==s[0]&&254==s[1])return ji(s.slice(2).toString("utf16le"));if(254==s[1]&&255==s[2])return ji(yo(s.slice(2).toString("binary")))}return s.toString("binary")}if(typeof TextDecoder<"u")try{if(l){if(255==s[0]&&254==s[1])return ji(new TextDecoder("utf-16le").decode(s.slice(2)));if(254==s[0]&&255==s[1])return ji(new TextDecoder("utf-16be").decode(s.slice(2)))}var a={"\u20ac":"\x80","\u201a":"\x82",\u0192:"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87",\u02c6:"\x88","\u2030":"\x89",\u0160:"\x8a","\u2039":"\x8b",\u0152:"\x8c",\u017d:"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99",\u0161:"\x9a","\u203a":"\x9b",\u0153:"\x9c",\u017e:"\x9e",\u0178:"\x9f"};return Array.isArray(s)&&(s=new Uint8Array(s)),new TextDecoder("latin1").decode(s).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(d){return a[d]||d})}catch{}for(var f=[],p=0;p!=s.length;++p)f.push(String.fromCharCode(s[p]));return f.join("")}function Bt(s){if(typeof JSON<"u"&&!Array.isArray(s))return JSON.parse(JSON.stringify(s));if("object"!=typeof s||null==s)return s;if(s instanceof Date)return new Date(s.getTime());var l={};for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(l[a]=Bt(s[a]));return l}function Qt(s,l){for(var a="";a.length<l;)a+=s;return a}function Vt(s){var l=Number(s);if(!isNaN(l))return isFinite(l)?l:NaN;if(!/\d/.test(s))return l;var a=1,f=s.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return a*=100,""});return isNaN(l=Number(f))&&(f=f.replace(/[(](.*)[)]/,function(p,d){return a=-a,d}),isNaN(l=Number(f)))?l:l/a}var Eh=["january","february","march","april","may","june","july","august","september","october","november","december"];function Qn(s){var l=new Date(s),a=new Date(NaN),f=l.getYear(),p=l.getMonth(),d=l.getDate();if(isNaN(d))return a;var h=s.toLowerCase();if(h.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((h=h.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Eh.indexOf(h))return a}else if(h.match(/[a-z]/))return a;return f<0||f>8099?a:(p>0||d>1)&&101!=f?l:s.match(/[^-0-9:,\/\\]/)?a:l}function yt(s,l,a){if(s.FullPaths){var f;if("string"==typeof a)return f=St?en(a):function gh(s){for(var l=[],a=0,f=s.length+250,p=Ir(s.length+255),d=0;d<s.length;++d){var h=s.charCodeAt(d);if(h<128)p[a++]=h;else if(h<2048)p[a++]=192|h>>6&31,p[a++]=128|63&h;else if(h>=55296&&h<57344){h=64+(1023&h);var g=1023&s.charCodeAt(++d);p[a++]=240|h>>8&7,p[a++]=128|h>>2&63,p[a++]=128|g>>6&15|(3&h)<<4,p[a++]=128|63&g}else p[a++]=224|h>>12&15,p[a++]=128|h>>6&63,p[a++]=128|63&h;a>f&&(l.push(p.slice(0,a)),a=0,p=Ir(65535),f=65530)}return l.push(p.slice(0,a)),fr(l)}(a),tt.utils.cfb_add(s,l,f);tt.utils.cfb_add(s,l,a)}else s.file(l,a)}function dl(){return tt.utils.cfb_new()}var sr='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n';var Gu=cl({"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"}),Hu=/[&<>'"]/g,Ah=/[\u0000-\u0008\u000b-\u001f]/g;function kt(s){return(s+"").replace(Hu,function(a){return Gu[a]}).replace(Ah,function(a){return"_x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Yf(s){return kt(s).replace(/ /g,"_x0020_")}var Xf=/[\u0000-\u001f]/g;function qf(s){return(s+"").replace(Hu,function(a){return Gu[a]}).replace(/\n/g,"<br/>").replace(Xf,function(a){return"&#x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+";"})}function Zt(s){switch(s){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ui(s){for(var l="",a=0,f=0,p=0,d=0,h=0,g=0;a<s.length;)(f=s.charCodeAt(a++))<128?l+=String.fromCharCode(f):(p=s.charCodeAt(a++),f>191&&f<224?(h=(31&f)<<6,h|=63&p,l+=String.fromCharCode(h)):(d=s.charCodeAt(a++),f<240?l+=String.fromCharCode((15&f)<<12|(63&p)<<6|63&d):(g=((7&f)<<18|(63&p)<<12|(63&d)<<6|63&(h=s.charCodeAt(a++)))-65536,l+=String.fromCharCode(55296+(g>>>10&1023)),l+=String.fromCharCode(56320+(1023&g)))));return l}function xi(s){var a,f,g,l=Ir(2*s.length),p=1,d=0,h=0;for(f=0;f<s.length;f+=p)p=1,(g=s.charCodeAt(f))<128?a=g:g<224?(a=64*(31&g)+(63&s.charCodeAt(f+1)),p=2):g<240?(a=4096*(15&g)+64*(63&s.charCodeAt(f+1))+(63&s.charCodeAt(f+2)),p=3):(p=4,a=262144*(7&g)+4096*(63&s.charCodeAt(f+1))+64*(63&s.charCodeAt(f+2))+(63&s.charCodeAt(f+3)),h=55296+((a-=65536)>>>10&1023),a=56320+(1023&a)),0!==h&&(l[d++]=255&h,l[d++]=h>>>8,h=0),l[d++]=a%256,l[d++]=a>>>8;return l.slice(0,d).toString("ucs2")}function hl(s){return en(s,"binary").toString("utf8")}var Vs="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",vt=St&&(hl(Vs)==Ui(Vs)&&hl||xi(Vs)==Ui(Vs)&&xi)||Ui,ji=St?function(s){return en(s,"utf8").toString("binary")}:function(s){for(var l=[],a=0,f=0,p=0;a<s.length;)switch(f=s.charCodeAt(a++),!0){case f<128:l.push(String.fromCharCode(f));break;case f<2048:l.push(String.fromCharCode(192+(f>>6))),l.push(String.fromCharCode(128+(63&f)));break;case f>=55296&&f<57344:f-=55296,p=s.charCodeAt(a++)-56320+(f<<10),l.push(String.fromCharCode(240+(p>>18&7))),l.push(String.fromCharCode(144+(p>>12&63))),l.push(String.fromCharCode(128+(p>>6&63))),l.push(String.fromCharCode(128+(63&p)));break;default:l.push(String.fromCharCode(224+(f>>12))),l.push(String.fromCharCode(128+(f>>6&63))),l.push(String.fromCharCode(128+(63&f)))}return l.join("")},Bu=function(){var s=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(l){return[new RegExp("&"+l[0]+";","ig"),l[1]]});return function(a){for(var f=a.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),p=0;p<s.length;++p)f=f.replace(s[p][0],s[p][1]);return f}}();var Uu=/(^\s|\s$|\n)/;function Hr(s,l){return"<"+s+(l.match(Uu)?' xml:space="preserve"':"")+">"+l+"</"+s+">"}function es(s){return qt(s).map(function(l){return" "+l+'="'+s[l]+'"'}).join("")}function Ae(s,l,a){return"<"+s+(null!=a?es(a):"")+(null!=l?(l.match(Uu)?' xml:space="preserve"':"")+">"+l+"</"+s:"/")+">"}function ts(s,l){try{return s.toISOString().replace(/\.\d*/,"")}catch(a){if(l)throw a}return""}var ar={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Fn=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ai={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};var gl=function(s){for(var l=[],f=0;f<s[0].length;++f)if(s[0][f])for(var p=0,d=s[0][f].length;p<d;p+=10240)l.push.apply(l,s[0][f].slice(p,p+10240));return l},zu=St?function(s){return s[0].length>0&&Buffer.isBuffer(s[0][0])?Buffer.concat(s[0].map(function(l){return Buffer.isBuffer(l)?l:en(l)})):gl(s)}:gl,Ku=function(s,l,a){for(var f=[],p=l;p<a;p+=2)f.push(String.fromCharCode(sn(s,p)));return f.join("").replace(Lr,"")},Ws=St?function(s,l,a){return Buffer.isBuffer(s)?s.toString("utf16le",l,a).replace(Lr,""):Ku(s,l,a)}:Ku,_o=function(s,l,a){for(var f=[],p=l;p<l+a;++p)f.push(("0"+s[p].toString(16)).slice(-2));return f.join("")},$u=St?function(s,l,a){return Buffer.isBuffer(s)?s.toString("hex",l,l+a):_o(s,l,a)}:_o,ep=function(s,l,a){for(var f=[],p=l;p<a;p++)f.push(String.fromCharCode(Pn(s,p)));return f.join("")},Jn=St?function(l,a,f){return Buffer.isBuffer(l)?l.toString("utf8",a,f):ep(l,a,f)}:ep,Us=function(s,l){var a=wr(s,l);return a>0?Jn(s,l+4,l+4+a-1):""},js=Us,ml=function(s,l){var a=wr(s,l);return a>0?Jn(s,l+4,l+4+a-1):""},zs=ml,yl=function(s,l){var a=2*wr(s,l);return a>0?Jn(s,l+4,l+4+a-1):""},Ks=yl,Cl=function(l,a){var f=wr(l,a);return f>0?Ws(l,a+4,a+4+f):""},Fi=Cl,wl=function(s,l){var a=wr(s,l);return a>0?Jn(s,l+4,l+4+a):""},xo=wl,Sl=function(s,l){return function ju(s,l){for(var a=1-2*(s[l+7]>>>7),f=((127&s[l+7])<<4)+(s[l+6]>>>4&15),p=15&s[l+6],d=5;d>=0;--d)p=256*p+s[l+d];return 2047==f?0==p?a*(1/0):NaN:(0==f?f=-1022:(f-=1023,p+=Math.pow(2,52)),a*Math.pow(2,f-52)*p)}(s,l)},rs=Sl,on=function(l){return Array.isArray(l)||typeof Uint8Array<"u"&&l instanceof Uint8Array};function $s(){Ws=function(s,l,a){return Xe.utils.decode(1200,s.slice(l,a)).replace(Lr,"")},Jn=function(s,l,a){return Xe.utils.decode(65001,s.slice(l,a))},js=function(s,l){var a=wr(s,l);return a>0?Xe.utils.decode(me,s.slice(l+4,l+4+a-1)):""},zs=function(s,l){var a=wr(s,l);return a>0?Xe.utils.decode(Xt,s.slice(l+4,l+4+a-1)):""},Ks=function(s,l){var a=2*wr(s,l);return a>0?Xe.utils.decode(1200,s.slice(l+4,l+4+a-1)):""},Fi=function(s,l){var a=wr(s,l);return a>0?Xe.utils.decode(1200,s.slice(l+4,l+4+a)):""},xo=function(s,l){var a=wr(s,l);return a>0?Xe.utils.decode(65001,s.slice(l+4,l+4+a)):""}}St&&(js=function(l,a){if(!Buffer.isBuffer(l))return Us(l,a);var f=l.readUInt32LE(a);return f>0?l.toString("utf8",a+4,a+4+f-1):""},zs=function(l,a){if(!Buffer.isBuffer(l))return ml(l,a);var f=l.readUInt32LE(a);return f>0?l.toString("utf8",a+4,a+4+f-1):""},Ks=function(l,a){if(!Buffer.isBuffer(l))return yl(l,a);var f=2*l.readUInt32LE(a);return l.toString("utf16le",a+4,a+4+f-1)},Fi=function(l,a){if(!Buffer.isBuffer(l))return Cl(l,a);var f=l.readUInt32LE(a);return l.toString("utf16le",a+4,a+4+f)},xo=function(l,a){if(!Buffer.isBuffer(l))return wl(l,a);var f=l.readUInt32LE(a);return l.toString("utf8",a+4,a+4+f)},rs=function(l,a){return Buffer.isBuffer(l)?l.readDoubleLE(a):Sl(l,a)},on=function(l){return Buffer.isBuffer(l)||Array.isArray(l)||typeof Uint8Array<"u"&&l instanceof Uint8Array}),typeof Xe<"u"&&$s();var Pn=function(s,l){return s[l]},sn=function(s,l){return 256*s[l+1]+s[l]},tp=function(s,l){var a=256*s[l+1]+s[l];return a<32768?a:-1*(65535-a+1)},wr=function(s,l){return s[l+3]*(1<<24)+(s[l+2]<<16)+(s[l+1]<<8)+s[l]},Zn=function(s,l){return s[l+3]<<24|s[l+2]<<16|s[l+1]<<8|s[l]},rp=function(s,l){return s[l]<<24|s[l+1]<<16|s[l+2]<<8|s[l+3]};function an(s,l){var f,p,h,g,y,w,a="",d=[];switch(l){case"dbcs":if(w=this.l,St&&Buffer.isBuffer(this))a=this.slice(this.l,this.l+2*s).toString("utf16le");else for(y=0;y<s;++y)a+=String.fromCharCode(sn(this,w)),w+=2;s*=2;break;case"utf8":a=Jn(this,this.l,this.l+s);break;case"utf16le":s*=2,a=Ws(this,this.l,this.l+s);break;case"wstr":if(!(typeof Xe<"u"))return an.call(this,s,"dbcs");a=Xe.utils.decode(Xt,this.slice(this.l,this.l+2*s)),s*=2;break;case"lpstr-ansi":a=js(this,this.l),s=4+wr(this,this.l);break;case"lpstr-cp":a=zs(this,this.l),s=4+wr(this,this.l);break;case"lpwstr":a=Ks(this,this.l),s=4+2*wr(this,this.l);break;case"lpp4":s=4+wr(this,this.l),a=Fi(this,this.l),2&s&&(s+=2);break;case"8lpp4":s=4+wr(this,this.l),a=xo(this,this.l),3&s&&(s+=4-(3&s));break;case"cstr":for(s=0,a="";0!==(h=Pn(this,this.l+s++));)d.push(Tn(h));a=d.join("");break;case"_wstr":for(s=0,a="";0!==(h=sn(this,this.l+s));)d.push(Tn(h)),s+=2;s+=2,a=d.join("");break;case"dbcs-cont":for(a="",w=this.l,y=0;y<s;++y){if(this.lens&&-1!==this.lens.indexOf(w))return h=Pn(this,w),this.l=w+1,g=an.call(this,s-y,h?"dbcs-cont":"sbcs-cont"),d.join("")+g;d.push(Tn(sn(this,w))),w+=2}a=d.join(""),s*=2;break;case"cpstr":if(typeof Xe<"u"){a=Xe.utils.decode(Xt,this.slice(this.l,this.l+s));break}case"sbcs-cont":for(a="",w=this.l,y=0;y!=s;++y){if(this.lens&&-1!==this.lens.indexOf(w))return h=Pn(this,w),this.l=w+1,g=an.call(this,s-y,h?"dbcs-cont":"sbcs-cont"),d.join("")+g;d.push(Tn(Pn(this,w))),w+=1}a=d.join("");break;default:switch(s){case 1:return f=Pn(this,this.l),this.l++,f;case 2:return f=("i"===l?tp:sn)(this,this.l),this.l+=2,f;case 4:case-4:return"i"!==l&&128&this[this.l+3]?(p=wr(this,this.l),this.l+=4,p):(f=(s>0?Zn:rp)(this,this.l),this.l+=4,f);case 8:case-8:if("f"===l)return p=8==s?rs(this,this.l):rs([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,p;s=8;case 16:a=$u(this,this.l,s)}}return this.l+=s,a}var Ph=function(s,l,a){s[a]=255&l,s[a+1]=l>>>8&255,s[a+2]=l>>>16&255,s[a+3]=l>>>24&255},is=function(s,l,a){s[a]=255&l,s[a+1]=l>>8&255,s[a+2]=l>>16&255,s[a+3]=l>>24&255},ip=function(s,l,a){s[a]=255&l,s[a+1]=l>>>8&255};function Ih(s,l,a){var f=0,p=0;if("dbcs"===a){for(p=0;p!=l.length;++p)ip(this,l.charCodeAt(p),this.l+2*p);f=2*l.length}else if("sbcs"===a){if(typeof Xe<"u"&&874==me)for(p=0;p!=l.length;++p){var d=Xe.utils.encode(me,l.charAt(p));this[this.l+p]=d[0]}else for(l=l.replace(/[^\x00-\x7F]/g,"_"),p=0;p!=l.length;++p)this[this.l+p]=255&l.charCodeAt(p);f=l.length}else{if("hex"===a){for(;p<s;++p)this[this.l++]=parseInt(l.slice(2*p,2*p+2),16)||0;return this}if("utf16le"===a){var h=Math.min(this.l+s,this.length);for(p=0;p<Math.min(l.length,s);++p){var g=l.charCodeAt(p);this[this.l++]=255&g,this[this.l++]=g>>8}for(;this.l<h;)this[this.l++]=0;return this}switch(s){case 1:f=1,this[this.l]=255&l;break;case 2:f=2,this[this.l]=255&l,l>>>=8,this[this.l+1]=255&l;break;case 3:f=3,this[this.l]=255&l,l>>>=8,this[this.l+1]=255&l,l>>>=8,this[this.l+2]=255&l;break;case 4:f=4,Ph(this,l,this.l);break;case 8:if(f=8,"f"===a){!function Zf(s,l,a){var f=(l<0||1/l==-1/0?1:0)<<7,p=0,d=0,h=f?-l:l;isFinite(h)?0==h?p=d=0:(p=Math.floor(Math.log(h)/Math.LN2),d=h*Math.pow(2,52-p),p<=-1023&&(!isFinite(d)||d<Math.pow(2,52))?p=-1022:(d-=Math.pow(2,52),p+=1023)):(p=2047,d=isNaN(l)?26985:0);for(var g=0;g<=5;++g,d/=256)s[a+g]=255&d;s[a+6]=(15&p)<<4|15&d,s[a+7]=p>>4|f}(this,l,this.l);break}case 16:break;case-4:f=4,is(this,l,this.l)}}return this.l+=f,this}function np(s,l){var a=$u(this,this.l,s.length>>1);if(a!==s)throw new Error(l+"Expected "+s+" saw "+a);this.l+=s.length>>1}function Br(s,l){s.l=l,s.read_shift=an,s.chk=np,s.write_shift=Ih}function Er(s,l){s.l+=l}function de(s){var l=Ir(s);return Br(l,0),l}function ri(){var s=[],l=St?256:2048,a=function(w){var S=de(w);return Br(S,0),S},f=a(l),p=function(){f&&(f.length>f.l&&((f=f.slice(0,f.l)).l=f.length),f.length>0&&s.push(f),f=null)},d=function(w){return f&&w<f.length-f.l?f:(p(),f=a(Math.max(w+1,l)))};return{next:d,push:function(w){p(),null==(f=w).l&&(f.l=f.length),d(l)},end:function(){return p(),fr(s)},_bufs:s}}function _e(s,l,a,f){var d,p=+l;if(!isNaN(p)){f||(f=Ua[p].p||(a||[]).length||0),d=1+(p>=128?1:0)+1,f>=128&&++d,f>=16384&&++d,f>=2097152&&++d;var h=s.next(d);p<=127?h.write_shift(1,p):(h.write_shift(1,128+(127&p)),h.write_shift(1,p>>7));for(var g=0;4!=g;++g){if(!(f>=128)){h.write_shift(1,f);break}h.write_shift(1,128+(127&f)),f>>=7}f>0&&on(a)&&s.push(a)}}function Eo(s,l,a){var f=Bt(s);if(l.s?(f.cRel&&(f.c+=l.s.c),f.rRel&&(f.r+=l.s.r)):(f.cRel&&(f.c+=l.c),f.rRel&&(f.r+=l.r)),!a||a.biff<12){for(;f.c>=256;)f.c-=256;for(;f.r>=65536;)f.r-=65536}return f}function ns(s,l,a){var f=Bt(s);return f.s=Eo(f.s,l.s,a),f.e=Eo(f.e,l.s,a),f}function Ro(s,l){if(s.cRel&&s.c<0)for(s=Bt(s);s.c<0;)s.c+=l>8?16384:256;if(s.rRel&&s.r<0)for(s=Bt(s);s.r<0;)s.r+=l>8?1048576:l>5?65536:16384;var a=at(s);return!s.cRel&&null!=s.cRel&&(a=function op(s){return s.replace(/^([A-Z])/,"$$$1")}(a)),!s.rRel&&null!=s.rRel&&(a=function Lh(s){return s.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(a)),a}function os(s,l){return 0!=s.s.r||s.s.rRel||s.e.r!=(l.biff>=12?1048575:l.biff>=8?65536:16384)||s.e.rRel?0!=s.s.c||s.s.cRel||s.e.c!=(l.biff>=12?16383:255)||s.e.cRel?Ro(s.s,l.biff)+":"+Ro(s.e,l.biff):(s.s.rRel?"":"$")+lr(s.s.r)+":"+(s.e.rRel?"":"$")+lr(s.e.r):(s.s.cRel?"":"$")+$t(s.s.c)+":"+(s.e.cRel?"":"$")+$t(s.e.c)}function ln(s){return parseInt(function Mh(s){return s.replace(/\$(\d+)$/,"$1")}(s),10)-1}function lr(s){return""+(s+1)}function ss(s){for(var l=function Yu(s){return s.replace(/^\$([A-Z])/,"$1")}(s),a=0,f=0;f!==l.length;++f)a=26*a+l.charCodeAt(f)-64;return a-1}function $t(s){if(s<0)throw new Error("invalid column "+s);var l="";for(++s;s;s=Math.floor((s-1)/26))l=String.fromCharCode((s-1)%26+65)+l;return l}function Ze(s){for(var l=0,a=0,f=0;f<s.length;++f){var p=s.charCodeAt(f);p>=48&&p<=57?l=10*l+(p-48):p>=65&&p<=90&&(a=26*a+(p-64))}return{c:a-1,r:l-1}}function at(s){for(var l=s.c+1,a="";l;l=(l-1)/26|0)a=String.fromCharCode((l-1)%26+65)+a;return a+(s.r+1)}function mr(s){var l=s.indexOf(":");return-1==l?{s:Ze(s),e:Ze(s)}:{s:Ze(s.slice(0,l)),e:Ze(s.slice(l+1))}}function lt(s,l){return typeof l>"u"||"number"==typeof l?lt(s.s,s.e):("string"!=typeof s&&(s=at(s)),"string"!=typeof l&&(l=at(l)),s==l?s:s+":"+l)}function Ct(s){var l={s:{c:0,r:0},e:{c:0,r:0}},a=0,f=0,p=0,d=s.length;for(a=0;f<d&&!((p=s.charCodeAt(f)-64)<1||p>26);++f)a=26*a+p;for(l.s.c=--a,a=0;f<d&&!((p=s.charCodeAt(f)-48)<0||p>9);++f)a=10*a+p;if(l.s.r=--a,f===d||10!=p)return l.e.c=l.s.c,l.e.r=l.s.r,l;for(++f,a=0;f!=d&&!((p=s.charCodeAt(f)-64)<1||p>26);++f)a=26*a+p;for(l.e.c=--a,a=0;f!=d&&!((p=s.charCodeAt(f)-48)<0||p>9);++f)a=10*a+p;return l.e.r=--a,l}function as(s,l){var a="d"==s.t&&l instanceof Date;if(null!=s.z)try{return s.w=Si(s.z,a?Cr(l):l)}catch{}try{return s.w=Si((s.XF||{}).numFmtId||(a?14:0),a?Cr(l):l)}catch{return""+l}}function Ei(s,l,a){return null==s||null==s.t||"z"==s.t?"":void 0!==s.w?s.w:("d"==s.t&&!s.z&&a&&a.dateNF&&(s.z=a.dateNF),"e"==s.t?ir[s.v]||s.v:as(s,null==l?s.v:l))}function un(s,l){var a=l&&l.sheet?l.sheet:"Sheet1",f={};return f[a]=s,{SheetNames:[a],Sheets:f}}function Ys(s,l,a){var f=a||{},p=s?Array.isArray(s):f.dense;null!=or&&null==p&&(p=or);var d=s||(p?[]:{}),h=0,g=0;if(d&&null!=f.origin){if("number"==typeof f.origin)h=f.origin;else{var y="string"==typeof f.origin?Ze(f.origin):f.origin;h=y.r,g=y.c}d["!ref"]||(d["!ref"]="A1:A1")}var w={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(d["!ref"]){var S=Ct(d["!ref"]);w.s.c=S.s.c,w.s.r=S.s.r,w.e.c=Math.max(w.e.c,S.e.c),w.e.r=Math.max(w.e.r,S.e.r),-1==h&&(w.e.r=h=S.e.r+1)}for(var E=0;E!=l.length;++E)if(l[E]){if(!Array.isArray(l[E]))throw new Error("aoa_to_sheet expects an array of arrays");for(var R=0;R!=l[E].length;++R)if(!(typeof l[E][R]>"u")){var T={v:l[E][R]},A=h+E,x=g+R;if(w.s.r>A&&(w.s.r=A),w.s.c>x&&(w.s.c=x),w.e.r<A&&(w.e.r=A),w.e.c<x&&(w.e.c=x),!l[E][R]||"object"!=typeof l[E][R]||Array.isArray(l[E][R])||l[E][R]instanceof Date)if(Array.isArray(T.v)&&(T.f=l[E][R][1],T.v=T.v[0]),null===T.v)if(T.f)T.t="n";else if(f.nullError)T.t="e",T.v=0;else{if(!f.sheetStubs)continue;T.t="z"}else"number"==typeof T.v?T.t="n":"boolean"==typeof T.v?T.t="b":T.v instanceof Date?(T.z=f.dateNF||ot[14],f.cellDates?(T.t="d",T.w=Si(T.z,Cr(T.v))):(T.t="n",T.v=Cr(T.v),T.w=Si(T.z,T.v))):T.t="s";else T=l[E][R];if(p)d[A]||(d[A]=[]),d[A][x]&&d[A][x].z&&(T.z=d[A][x].z),d[A][x]=T;else{var b=at({c:x,r:A});d[b]&&d[b].z&&(T.z=d[b].z),d[b]=T}}}return w.s.c<1e7&&(d["!ref"]=lt(w)),d}function cn(s,l){return Ys(null,s,l)}function li(s,l){return l||(l=de(4)),l.write_shift(4,s),l}function Wt(s){var l=s.read_shift(4);return 0===l?"":s.read_shift(l,"dbcs")}function Rr(s,l){var a=!1;return null==l&&(a=!0,l=de(4+2*s.length)),l.write_shift(4,s.length),s.length>0&&l.write_shift(0,s,"dbcs"),a?l.slice(0,l.l):l}function Ln(s){return{ich:s.read_shift(2),ifnt:s.read_shift(2)}}function Sr(s,l){var a=s.l,f=s.read_shift(1),p=Wt(s),d=[],h={t:p,h:p};if(1&f){for(var g=s.read_shift(4),y=0;y!=g;++y)d.push(Ln(s));h.r=d}else h.r=[{ich:0,ifnt:0}];return s.l=a+l,h}var kh=Sr;function qu(s,l){var a=!1;return null==l&&(a=!0,l=de(23+4*s.t.length)),l.write_shift(1,1),Rr(s.t,l),l.write_shift(4,1),function ls(s,l){return l||(l=de(4)),l.write_shift(2,s.ich||0),l.write_shift(2,s.ifnt||0),l}({ich:0,ifnt:0},l),a?l.slice(0,l.l):l}function ui(s){var l=s.read_shift(4),a=s.read_shift(2);return a+=s.read_shift(1)<<16,s.l++,{c:l,iStyleRef:a}}function Mn(s,l){return null==l&&(l=de(8)),l.write_shift(-4,s.c),l.write_shift(3,s.iStyleRef||s.s),l.write_shift(1,0),l}function Nn(s){var l=s.read_shift(2);return l+=s.read_shift(1)<<16,s.l++,{c:-1,iStyleRef:l}}function eo(s,l){return null==l&&(l=de(4)),l.write_shift(3,s.iStyleRef||s.s),l.write_shift(1,0),l}var Gh=Wt,_l=Rr;function xl(s){var l=s.read_shift(4);return 0===l||4294967295===l?"":s.read_shift(l,"dbcs")}function qs(s,l){var a=!1;return null==l&&(a=!0,l=de(127)),l.write_shift(4,s.length>0?s.length:4294967295),s.length>0&&l.write_shift(0,s,"dbcs"),a?l.slice(0,l.l):l}var Qs=Wt,ci=xl,Qu=qs;function kn(s){var l=s.slice(s.l,s.l+4),a=1&l[0],f=2&l[0];s.l+=4;var p=0===f?rs([0,0,0,0,252&l[0],l[1],l[2],l[3]],0):Zn(l,0)>>2;return a?p/100:p}function El(s,l){null==l&&(l=de(4));var a=0,f=0,p=100*s;if(s==(0|s)&&s>=-(1<<29)&&s<1<<29?f=1:p==(0|p)&&p>=-(1<<29)&&p<1<<29&&(f=1,a=1),!f)throw new Error("unsupported RkNumber "+s);l.write_shift(-4,((a?p:s)<<2)+(a+2))}function us(s){var l={s:{},e:{}};return l.s.r=s.read_shift(4),l.e.r=s.read_shift(4),l.s.c=s.read_shift(4),l.e.c=s.read_shift(4),l}var to=us,fn=function sp(s,l){return l||(l=de(16)),l.write_shift(4,s.s.r),l.write_shift(4,s.e.r),l.write_shift(4,s.s.c),l.write_shift(4,s.e.c),l};function Tr(s){if(s.length-s.l<8)throw"XLS Xnum Buffer underflow";return s.read_shift(8,"f")}function To(s,l){return(l||de(8)).write_shift(8,s,"f")}function ii(s,l){if(l||(l=de(8)),!s||s.auto)return l.write_shift(4,0),l.write_shift(4,0),l;null!=s.index?(l.write_shift(1,2),l.write_shift(1,s.index)):null!=s.theme?(l.write_shift(1,6),l.write_shift(1,s.theme)):(l.write_shift(1,5),l.write_shift(1,0));var a=s.tint||0;if(a>0?a*=32767:a<0&&(a*=32768),l.write_shift(2,a),s.rgb&&null==s.theme){var f=s.rgb||"FFFFFF";"number"==typeof f&&(f=("000000"+f.toString(16)).slice(-6)),l.write_shift(1,parseInt(f.slice(0,2),16)),l.write_shift(1,parseInt(f.slice(2,4),16)),l.write_shift(1,parseInt(f.slice(4,6),16)),l.write_shift(1,255)}else l.write_shift(2,0),l.write_shift(1,0),l.write_shift(1,0);return l}var Ju=2,fi=3,ea={1:{n:"CodePage",t:Ju},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:fi},5:{n:"LineCount",t:fi},6:{n:"ParagraphCount",t:fi},7:{n:"SlideCount",t:fi},8:{n:"NoteCount",t:fi},9:{n:"HiddenCount",t:fi},10:{n:"MultimediaClipCount",t:fi},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:fi},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:fi,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},tc={1:{n:"CodePage",t:Ju},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:fi},15:{n:"WordCount",t:fi},16:{n:"CharCount",t:fi},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:fi},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}};function rt(s){return s.map(function(l){return[l>>16&255,l>>8&255,255&l]})}var Pi=Bt(rt([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),ir={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},rc={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},fs={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Tl(s,l){var p,a=function I(s){for(var l=[],a=qt(s),f=0;f!==a.length;++f)null==l[s[a[f]]]&&(l[s[a[f]]]=[]),l[s[a[f]]].push(a[f]);return l}(rc),f=[];f[f.length]=sr,f[f.length]=Ae("Types",null,{xmlns:ar.CT,"xmlns:xsd":ar.xsd,"xmlns:xsi":ar.xsi}),f=f.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(y){return Ae("Default",null,{Extension:y[0],ContentType:y[1]})}));var d=function(y){s[y]&&s[y].length>0&&(p=s[y][0],f[f.length]=Ae("Override",null,{PartName:("/"==p[0]?"":"/")+p,ContentType:fs[y][l.bookType]||fs[y].xlsx}))},h=function(y){(s[y]||[]).forEach(function(w){f[f.length]=Ae("Override",null,{PartName:("/"==w[0]?"":"/")+w,ContentType:fs[y][l.bookType]||fs[y].xlsx})})},g=function(y){(s[y]||[]).forEach(function(w){f[f.length]=Ae("Override",null,{PartName:("/"==w[0]?"":"/")+w,ContentType:a[y][0]})})};return d("workbooks"),h("sheets"),h("charts"),g("themes"),["strs","styles"].forEach(d),["coreprops","extprops","custprops"].forEach(g),g("vba"),g("comments"),g("threadedcomments"),g("drawings"),h("metadata"),g("people"),f.length>2&&(f[f.length]="</Types>",f[1]=f[1].replace("/>",">")),f.join("")}var gt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ra(s){var l=s.lastIndexOf("/");return s.slice(0,l+1)+"_rels/"+s.slice(l+1)+".rels"}function ps(s){var l=[sr,Ae("Relationships",null,{xmlns:ar.RELS})];return qt(s["!id"]).forEach(function(a){l[l.length]=Ae("Relationship",null,s["!id"][a])}),l.length>2&&(l[l.length]="</Relationships>",l[1]=l[1].replace("/>",">")),l.join("")}function Ue(s,l,a,f,p,d){if(p||(p={}),s["!id"]||(s["!id"]={}),s["!idx"]||(s["!idx"]=1),l<0)for(l=s["!idx"];s["!id"]["rId"+l];++l);if(s["!idx"]=l+1,p.Id="rId"+l,p.Type=f,p.Target=a,d?p.TargetMode=d:[gt.HLINK,gt.XPATH,gt.XMISS].indexOf(p.Type)>-1&&(p.TargetMode="External"),s["!id"][p.Id])throw new Error("Cannot rewrite rId "+l);return s["!id"][p.Id]=p,s[("/"+p.Target).replace("//","/")]=p,l}function dp(s,l,a){return['  <rdf:Description rdf:about="'+s+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(a||"odf")+"#"+l+'"/>\n',"  </rdf:Description>\n"].join("")}function zh(s,l){return['  <rdf:Description rdf:about="'+s+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+l+'"/>\n',"  </rdf:Description>\n"].join("")}function ic(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Se.version+"</meta:generator></office:meta></office:document-meta>"}var Gn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Al(s,l,a,f,p){null!=p[s]||null==l||""===l||(p[s]=l,l=kt(l),f[f.length]=a?Ae(s,l,a):Hr(s,l))}function nc(s,l){var a=l||{},f=[sr,Ae("cp:coreProperties",null,{"xmlns:cp":ar.CORE_PROPS,"xmlns:dc":ar.dc,"xmlns:dcterms":ar.dcterms,"xmlns:dcmitype":ar.dcmitype,"xmlns:xsi":ar.xsi})],p={};if(!s&&!a.Props)return f.join("");s&&(null!=s.CreatedDate&&Al("dcterms:created","string"==typeof s.CreatedDate?s.CreatedDate:ts(s.CreatedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},f,p),null!=s.ModifiedDate&&Al("dcterms:modified","string"==typeof s.ModifiedDate?s.ModifiedDate:ts(s.ModifiedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},f,p));for(var d=0;d!=Gn.length;++d){var h=Gn[d],g=a.Props&&null!=a.Props[h[1]]?a.Props[h[1]]:s?s[h[1]]:null;!0===g?g="1":!1===g?g="0":"number"==typeof g&&(g=String(g)),null!=g&&Al(h[0],g,null,f,p)}return f.length>2&&(f[f.length]="</cp:coreProperties>",f[1]=f[1].replace("/>",">")),f.join("")}var Ao=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Dl=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function vp(s){var l=[],a=Ae;return s||(s={}),s.Application="SheetJS",l[l.length]=sr,l[l.length]=Ae("Properties",null,{xmlns:ar.EXT_PROPS,"xmlns:vt":ar.vt}),Ao.forEach(function(f){if(void 0!==s[f[1]]){var p;switch(f[2]){case"string":p=kt(String(s[f[1]]));break;case"bool":p=s[f[1]]?"true":"false"}void 0!==p&&(l[l.length]=a(f[0],p))}}),l[l.length]=a("HeadingPairs",a("vt:vector",a("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+a("vt:variant",a("vt:i4",String(s.Worksheets))),{size:2,baseType:"variant"})),l[l.length]=a("TitlesOfParts",a("vt:vector",s.SheetNames.map(function(f){return"<vt:lpstr>"+kt(f)+"</vt:lpstr>"}).join(""),{size:s.Worksheets,baseType:"lpstr"})),l.length>2&&(l[l.length]="</Properties>",l[1]=l[1].replace("/>",">")),l.join("")}function mp(s){var l=[sr,Ae("Properties",null,{xmlns:ar.CUST_PROPS,"xmlns:vt":ar.vt})];if(!s)return l.join("");var a=1;return qt(s).forEach(function(p){++a,l[l.length]=Ae("property",function zi(s,l){switch(typeof s){case"string":var a=Ae("vt:lpwstr",kt(s));return l&&(a=a.replace(/&quot;/g,"_x0022_")),a;case"number":return Ae((0|s)==s?"vt:i4":"vt:r8",kt(String(s)));case"boolean":return Ae("vt:bool",s?"true":"false")}if(s instanceof Date)return Ae("vt:filetime",ts(s));throw new Error("Unable to serialize "+s)}(s[p],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:a,name:kt(p)})}),l.length>2&&(l[l.length]="</Properties>",l[1]=l[1].replace("/>",">")),l.join("")}var bl={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function pn(s,l){var a=de(4),f=de(4);switch(a.write_shift(4,80==s?31:s),s){case 3:f.write_shift(-4,l);break;case 5:(f=de(8)).write_shift(8,l,"f");break;case 11:f.write_shift(4,l?1:0);break;case 64:f=function yp(s){var a=("string"==typeof s?new Date(Date.parse(s)):s).getTime()/1e3+11644473600,f=a%Math.pow(2,32),p=(a-f)/Math.pow(2,32);p*=1e7;var d=(f*=1e7)/Math.pow(2,32)|0;d>0&&(f%=Math.pow(2,32),p+=d);var h=de(8);return h.write_shift(4,f),h.write_shift(4,p),h}(l);break;case 31:case 80:for((f=de(4+2*(l.length+1)+(l.length%2?0:2))).write_shift(4,l.length+1),f.write_shift(0,l,"dbcs");f.l!=f.length;)f.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+s+" "+l)}return fr([a,f])}var vs=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Zh(s){switch(typeof s){case"boolean":return 11;case"number":return(0|s)==s?3:5;case"string":return 31;case"object":if(s instanceof Date)return 64}return-1}function fc(s,l,a){var f=de(8),p=[],d=[],h=8,g=0,y=de(8),w=de(8);if(y.write_shift(4,2),y.write_shift(4,1200),w.write_shift(4,1),d.push(y),p.push(w),h+=8+y.length,!l){(w=de(8)).write_shift(4,0),p.unshift(w);var S=[de(4)];for(S[0].write_shift(4,s.length),g=0;g<s.length;++g){var E=s[g][0];for((y=de(8+2*(E.length+1)+(E.length%2?0:2))).write_shift(4,g+2),y.write_shift(4,E.length+1),y.write_shift(0,E,"dbcs");y.l!=y.length;)y.write_shift(1,0);S.push(y)}y=fr(S),d.unshift(y),h+=8+y.length}for(g=0;g<s.length;++g)if((!l||l[s[g][0]])&&!(vs.indexOf(s[g][0])>-1||Dl.indexOf(s[g][0])>-1)&&null!=s[g][1]){var R=s[g][1],T=0;if(l){var A=a[T=+l[s[g][0]]];if("version"==A.p&&"string"==typeof R){var x=R.split(".");R=(+x[0]<<16)+(+x[1]||0)}y=pn(A.t,R)}else{var b=Zh(R);-1==b&&(b=31,R=String(R)),y=pn(b,R)}d.push(y),(w=de(8)).write_shift(4,l?T:2+g),p.push(w),h+=8+y.length}var H=8*(d.length+1);for(g=0;g<d.length;++g)p[g].write_shift(4,H),H+=d[g].length;return f.write_shift(4,h),f.write_shift(4,d.length),fr([f].concat(p).concat(d))}function Ep(s,l,a,f,p,d){var h=de(p?68:48),g=[h];h.write_shift(2,65534),h.write_shift(2,0),h.write_shift(4,842412599),h.write_shift(16,tt.utils.consts.HEADER_CLSID,"hex"),h.write_shift(4,p?2:1),h.write_shift(16,l,"hex"),h.write_shift(4,p?68:48);var y=fc(s,a,f);if(g.push(y),p){var w=fc(p,null,null);h.write_shift(16,d,"hex"),h.write_shift(4,68+y.length),g.push(w)}return fr(g)}function hr(s,l){return 1===s.read_shift(l)}function It(s,l){return l||(l=de(2)),l.write_shift(2,+!!s),l}function vr(s){return s.read_shift(2,"u")}function pi(s,l){return l||(l=de(2)),l.write_shift(2,s),l}function dc(s,l,a){return a||(a=de(2)),a.write_shift(1,"e"==l?+s:+!!s),a.write_shift(1,"e"==l?1:0),a}function gs(s,l,a){var f=s.read_shift(a&&a.biff>=12?2:1),p="sbcs-cont",d=Xt;(a&&a.biff>=8&&(Xt=1200),a&&8!=a.biff)?12==a.biff&&(p="wstr"):s.read_shift(1)&&(p="dbcs-cont");a.biff>=2&&a.biff<=5&&(p="cpstr");var g=f?s.read_shift(f,p):"";return Xt=d,g}function ev(s){var l=s.t||"",f=de(3);f.write_shift(2,l.length),f.write_shift(1,1);var p=de(2*l.length);return p.write_shift(2*l.length,l,"utf16le"),fr([f,p])}function no(s,l,a){if(a){if(a.biff>=2&&a.biff<=5)return s.read_shift(l,"cpstr");if(a.biff>=12)return s.read_shift(l,"dbcs-cont")}return 0===s.read_shift(1)?s.read_shift(l,"sbcs-cont"):s.read_shift(l,"dbcs-cont")}function na(s,l,a){var f=s.read_shift(a&&2==a.biff?1:2);return 0===f?(s.l++,""):no(s,f,a)}function Hn(s,l,a){if(a.biff>5)return na(s,0,a);var f=s.read_shift(1);return 0===f?(s.l++,""):s.read_shift(f,a.biff<=4||!s.lens?"cpstr":"sbcs-cont")}function Ap(s,l,a){return a||(a=de(3+2*s.length)),a.write_shift(2,s.length),a.write_shift(1,1),a.write_shift(31,s,"utf16le"),a}function Dp(s,l){l||(l=de(6+2*s.length)),l.write_shift(4,1+s.length);for(var a=0;a<s.length;++a)l.write_shift(2,s.charCodeAt(a));return l.write_shift(2,0),l}function bp(s){var l=de(512),a=0,f=s.Target;"file://"==f.slice(0,7)&&(f=f.slice(7));var p=f.indexOf("#"),d=p>-1?31:23;switch(f.charAt(0)){case"#":d=28;break;case".":d&=-3}l.write_shift(4,2),l.write_shift(4,d);var h=[8,6815827,6619237,4849780,83];for(a=0;a<h.length;++a)l.write_shift(4,h[a]);if(28==d)Dp(f=f.slice(1),l);else if(2&d){for(h="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<h.length;++a)l.write_shift(1,parseInt(h[a],16));var g=p>-1?f.slice(0,p):f;for(l.write_shift(4,2*(g.length+1)),a=0;a<g.length;++a)l.write_shift(2,g.charCodeAt(a));l.write_shift(2,0),8&d&&Dp(p>-1?f.slice(p+1):"",l)}else{for(h="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),a=0;a<h.length;++a)l.write_shift(1,parseInt(h[a],16));for(var y=0;"../"==f.slice(3*y,3*y+3)||"..\\"==f.slice(3*y,3*y+3);)++y;for(l.write_shift(2,y),l.write_shift(4,f.length-3*y+1),a=0;a<f.length-3*y;++a)l.write_shift(1,255&f.charCodeAt(a+3*y));for(l.write_shift(1,0),l.write_shift(2,65535),l.write_shift(2,57005),a=0;a<6;++a)l.write_shift(4,0)}return l.slice(0,l.l)}function oo(s,l,a,f){return f||(f=de(6)),f.write_shift(2,s),f.write_shift(2,l),f.write_shift(2,a||0),f}function mc(s,l,a){var f=a.biff>8?4:2;return[s.read_shift(f),s.read_shift(f,"i"),s.read_shift(f,"i")]}function oa(s){var l=s.read_shift(2),a=s.read_shift(2);return{s:{c:s.read_shift(2),r:l},e:{c:s.read_shift(2),r:a}}}function wc(s,l){return l||(l=de(8)),l.write_shift(2,s.s.r),l.write_shift(2,s.e.r),l.write_shift(2,s.s.c),l.write_shift(2,s.e.c),l}function _c(s,l,a){var f=1536,p=16;switch(a.bookType){case"biff8":case"xla":break;case"biff5":f=1280,p=8;break;case"biff4":f=4,p=6;break;case"biff3":f=3,p=6;break;case"biff2":f=2,p=4;break;default:throw new Error("unsupported BIFF version")}var d=de(p);return d.write_shift(2,f),d.write_shift(2,l),p>4&&d.write_shift(2,29282),p>6&&d.write_shift(2,1997),p>8&&(d.write_shift(2,49161),d.write_shift(2,1),d.write_shift(2,1798),d.write_shift(2,0)),d}function pv(s,l){var a=!l||l.biff>=8?2:1,f=de(8+a*s.name.length);f.write_shift(4,s.pos),f.write_shift(1,s.hs||0),f.write_shift(1,s.dt),f.write_shift(1,s.name.length),l.biff>=8&&f.write_shift(1,1),f.write_shift(a*s.name.length,s.name,l.biff<8?"sbcs":"utf16le");var p=f.slice(0,f.l);return p.l=f.l,p}function wt(s,l,a,f){var p=a&&5==a.biff;f||(f=de(p?3+l.length:5+2*l.length)),f.write_shift(2,s),f.write_shift(p?1:2,l.length),p||f.write_shift(1,1),f.write_shift((p?1:2)*l.length,l,p?"sbcs":"utf16le");var d=f.length>f.l?f.slice(0,f.l):f;return null==d.l&&(d.l=d.length),d}function Po(s,l,a,f){var p=a&&5==a.biff;f||(f=de(p?16:20)),f.write_shift(2,0),s.style?(f.write_shift(2,s.numFmtId||0),f.write_shift(2,65524)):(f.write_shift(2,s.numFmtId||0),f.write_shift(2,l<<4));var d=0;return s.numFmtId>0&&p&&(d|=1024),f.write_shift(4,d),f.write_shift(4,0),p||f.write_shift(4,0),f.write_shift(2,0),f}function Vp(s,l,a){if(a.biff<8)return function bv(s,l,a){3==s[s.l+1]&&s[s.l]++;var f=gs(s,0,a);return 3==f.charCodeAt(0)?f.slice(1):f}(s,0,a);for(var f=[],p=s.l+l,d=s.read_shift(a.biff>8?4:2);0!=d--;)f.push(mc(s,a.biff,a));if(s.l!=p)throw new Error("Bad ExternSheet: "+s.l+" != "+p);return f}function Hv(s){var l=de(24),a=Ze(s[0]);l.write_shift(2,a.r),l.write_shift(2,a.r),l.write_shift(2,a.c),l.write_shift(2,a.c);for(var f="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),p=0;p<16;++p)l.write_shift(1,parseInt(f[p],16));return fr([l,bp(s[1])])}function Vv(s){var l=s[1].Tooltip,a=de(10+2*(l.length+1));a.write_shift(2,2048);var f=Ze(s[0]);a.write_shift(2,f.r),a.write_shift(2,f.r),a.write_shift(2,f.c),a.write_shift(2,f.c);for(var p=0;p<l.length;++p)a.write_shift(2,l.charCodeAt(p));return a.write_shift(2,0),a}function Rc(s,l,a){if(!a.cellStyles)return Er(s,l);var f=a&&a.biff>=12?4:2,p=s.read_shift(f),d=s.read_shift(f),h=s.read_shift(f),g=s.read_shift(f),y=s.read_shift(2);2==f&&(s.l+=2);var w={s:p,e:d,w:h,ixfe:g,flags:y};return(a.biff>=5||!a.biff)&&(w.level=y>>8&7),w}var fa=function(){var s={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},l=cl({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function f(g,y){var w=y||{};w.dateNF||(w.dateNF="yyyymmdd");var S=cn(function a(g,y){var w=[],S=Ir(1);switch(y.type){case"base64":S=Ci(yi(g));break;case"binary":S=Ci(g);break;case"buffer":case"array":S=g}Br(S,0);var E=S.read_shift(1),R=!!(136&E),T=!1,A=!1;switch(E){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:T=!0,R=!0;break;case 140:A=!0;break;default:throw new Error("DBF Unsupported Version: "+E.toString(16))}var x=0,b=521;2==E&&(x=S.read_shift(2)),S.l+=3,2!=E&&(x=S.read_shift(4)),x>1048576&&(x=1e6),2!=E&&(b=S.read_shift(2));var H=S.read_shift(2),G=y.codepage||1252;2!=E&&(S.l+=16,S.read_shift(1),0!==S[S.l]&&(G=s[S[S.l]]),S.l+=1,S.l+=2),A&&(S.l+=36);for(var N=[],Q={},ie=Math.min(S.length,2==E?521:b-10-(T?264:0)),ce=A?32:11;S.l<ie&&13!=S[S.l];)switch(Q={},Q.name=Xe.utils.decode(G,S.slice(S.l,S.l+ce)).replace(/[\u0000\r\n].*$/g,""),S.l+=ce,Q.type=String.fromCharCode(S.read_shift(1)),2!=E&&!A&&(Q.offset=S.read_shift(4)),Q.len=S.read_shift(1),2==E&&(Q.offset=S.read_shift(2)),Q.dec=S.read_shift(1),Q.name.length&&N.push(Q),2!=E&&(S.l+=A?13:14),Q.type){case"B":(!T||8!=Q.len)&&y.WTF&&console.log("Skipping "+Q.name+":"+Q.type);break;case"G":case"P":y.WTF&&console.log("Skipping "+Q.name+":"+Q.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+Q.type)}if(13!==S[S.l]&&(S.l=b-1),13!==S.read_shift(1))throw new Error("DBF Terminator not found "+S.l+" "+S[S.l]);S.l=b;var K=0,te=0;for(w[0]=[],te=0;te!=N.length;++te)w[0][te]=N[te].name;for(;x-- >0;)if(42!==S[S.l])for(++S.l,w[++K]=[],te=0,te=0;te!=N.length;++te){var J=S.slice(S.l,S.l+N[te].len);S.l+=N[te].len,Br(J,0);var fe=Xe.utils.decode(G,J);switch(N[te].type){case"C":fe.trim().length&&(w[K][te]=fe.replace(/\s+$/,""));break;case"D":8===fe.length?w[K][te]=new Date(+fe.slice(0,4),+fe.slice(4,6)-1,+fe.slice(6,8)):w[K][te]=fe;break;case"F":w[K][te]=parseFloat(fe.trim());break;case"+":case"I":w[K][te]=A?2147483648^J.read_shift(-4,"i"):J.read_shift(4,"i");break;case"L":switch(fe.trim().toUpperCase()){case"Y":case"T":w[K][te]=!0;break;case"N":case"F":w[K][te]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+fe+"|")}break;case"M":if(!R)throw new Error("DBF Unexpected MEMO for type "+E.toString(16));w[K][te]="##MEMO##"+(A?parseInt(fe.trim(),10):J.read_shift(4));break;case"N":(fe=fe.replace(/\u0000/g,"").trim())&&"."!=fe&&(w[K][te]=+fe||0);break;case"@":w[K][te]=new Date(J.read_shift(-8,"f")-621356832e5);break;case"T":w[K][te]=new Date(864e5*(J.read_shift(4)-2440588)+J.read_shift(4));break;case"Y":w[K][te]=J.read_shift(4,"i")/1e4+J.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":w[K][te]=-J.read_shift(-8,"f");break;case"B":if(T&&8==N[te].len){w[K][te]=J.read_shift(8,"f");break}case"G":case"P":J.l+=N[te].len;break;case"0":if("_NullFlags"===N[te].name)break;default:throw new Error("DBF Unsupported data type "+N[te].type)}}else S.l+=H;if(2!=E&&S.l<S.length&&26!=S[S.l++])throw new Error("DBF EOF Marker missing "+(S.l-1)+" of "+S.length+" "+S[S.l-1].toString(16));return y&&y.sheetRows&&(w=w.slice(0,y.sheetRows)),y.DBF=N,w}(g,w),w);return S["!cols"]=w.DBF.map(function(E){return{wch:E.len,DBF:E}}),delete w.DBF,S}var d={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function p(g,y){try{return un(f(g,y),y)}catch(w){if(y&&y.WTF)throw w}return{SheetNames:[],Sheets:{}}},to_sheet:f,from_sheet:function h(g,y){var w=y||{};if(+w.codepage>=0&&ct(+w.codepage),"string"==w.type)throw new Error("Cannot write DBF to JS string");var S=ri(),E=ph(g,{header:1,raw:!0,cellDates:!0}),R=E[0],T=E.slice(1),A=g["!cols"]||[],x=0,b=0,H=0,G=1;for(x=0;x<R.length;++x)if(((A[x]||{}).DBF||{}).name)R[x]=A[x].DBF.name,++H;else if(null!=R[x]){if(++H,"number"==typeof R[x]&&(R[x]=R[x].toString(10)),"string"!=typeof R[x])throw new Error("DBF Invalid column name "+R[x]+" |"+typeof R[x]+"|");if(R.indexOf(R[x])!==x)for(b=0;b<1024;++b)if(-1==R.indexOf(R[x]+"_"+b)){R[x]+="_"+b;break}}var N=Ct(g["!ref"]),Q=[],ie=[],ce=[];for(x=0;x<=N.e.c-N.s.c;++x){var K="",te="",J=0,fe=[];for(b=0;b<T.length;++b)null!=T[b][x]&&fe.push(T[b][x]);if(0!=fe.length&&null!=R[x]){for(b=0;b<fe.length;++b){switch(typeof fe[b]){case"number":te="B";break;case"string":default:te="C";break;case"boolean":te="L";break;case"object":te=fe[b]instanceof Date?"D":"C"}J=Math.max(J,String(fe[b]).length),K=K&&K!=te?"C":te}J>250&&(J=250),"C"==(te=((A[x]||{}).DBF||{}).type)&&A[x].DBF.len>J&&(J=A[x].DBF.len),"B"==K&&"N"==te&&(K="N",ce[x]=A[x].DBF.dec,J=A[x].DBF.len),ie[x]="C"==K||"N"==te?J:d[K]||0,G+=ie[x],Q[x]=K}else Q[x]="?"}var he=S.next(32);for(he.write_shift(4,318902576),he.write_shift(4,T.length),he.write_shift(2,296+32*H),he.write_shift(2,G),x=0;x<4;++x)he.write_shift(4,0);for(he.write_shift(4,0|(+l[me]||3)<<8),x=0,b=0;x<R.length;++x)if(null!=R[x]){var ee=S.next(32),Ie=(R[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ee.write_shift(1,Ie,"sbcs"),ee.write_shift(1,"?"==Q[x]?"C":Q[x],"sbcs"),ee.write_shift(4,b),ee.write_shift(1,ie[x]||d[Q[x]]||0),ee.write_shift(1,ce[x]||0),ee.write_shift(1,2),ee.write_shift(4,0),ee.write_shift(1,0),ee.write_shift(4,0),ee.write_shift(4,0),b+=ie[x]||d[Q[x]]||0}var Ke=S.next(264);for(Ke.write_shift(4,13),x=0;x<65;++x)Ke.write_shift(4,0);for(x=0;x<T.length;++x){var ke=S.next(G);for(ke.write_shift(1,0),b=0;b<R.length;++b)if(null!=R[b])switch(Q[b]){case"L":ke.write_shift(1,null==T[x][b]?63:T[x][b]?84:70);break;case"B":ke.write_shift(8,T[x][b]||0,"f");break;case"N":var ut="0";for("number"==typeof T[x][b]&&(ut=T[x][b].toFixed(ce[b]||0)),H=0;H<ie[b]-ut.length;++H)ke.write_shift(1,32);ke.write_shift(1,ut,"sbcs");break;case"D":T[x][b]?(ke.write_shift(4,("0000"+T[x][b].getFullYear()).slice(-4),"sbcs"),ke.write_shift(2,("00"+(T[x][b].getMonth()+1)).slice(-2),"sbcs"),ke.write_shift(2,("00"+T[x][b].getDate()).slice(-2),"sbcs")):ke.write_shift(8,"00000000","sbcs");break;case"C":var Qe=String(null!=T[x][b]?T[x][b]:"").slice(0,ie[b]);for(ke.write_shift(1,Qe,"sbcs"),H=0;H<ie[b]-Qe.length;++H)ke.write_shift(1,32)}}return S.next(1).write_shift(1,26),S.end()}}}(),Kp=function(){var s={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},l=new RegExp("\x1bN("+qt(s).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),a=function(R,T){var A=s[T];return"number"==typeof A?Un(A):A},f=function(R,T,A){var x=T.charCodeAt(0)-32<<4|A.charCodeAt(0)-48;return 59==x?R:Un(x)};function d(R,T){var he,A=R.split(/[\n\r]+/),x=-1,b=-1,H=0,G=0,N=[],Q=[],ie=null,ce={},K=[],te=[],J=[],fe=0;for(+T.codepage>=0&&ct(+T.codepage);H!==A.length;++H){fe=0;var ke,ee=A[H].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,f).replace(l,a),Ie=ee.replace(/;;/g,"\0").split(";").map(function(Y){return Y.replace(/\u0000/g,";")}),Ke=Ie[0];if(ee.length>0)switch(Ke){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==Ie[1].charAt(0)&&Q.push(ee.slice(3).replace(/;;/g,";"));break;case"C":var ut=!1,Qe=!1,Ot=!1,je=!1,pt=-1,Ee=-1;for(G=1;G<Ie.length;++G)switch(Ie[G].charAt(0)){case"A":case"G":break;case"X":b=parseInt(Ie[G].slice(1))-1,Qe=!0;break;case"Y":for(x=parseInt(Ie[G].slice(1))-1,Qe||(b=0),he=N.length;he<=x;++he)N[he]=[];break;case"K":'"'===(ke=Ie[G].slice(1)).charAt(0)?ke=ke.slice(1,ke.length-1):"TRUE"===ke?ke=!0:"FALSE"===ke?ke=!1:isNaN(Vt(ke))?isNaN(Qn(ke).getDate())||(ke=rr(ke)):(ke=Vt(ke),null!==ie&&kr(ie)&&(ke=Nu(ke))),typeof Xe<"u"&&"string"==typeof ke&&"string"!=(T||{}).type&&(T||{}).codepage&&(ke=Xe.utils.decode(T.codepage,ke)),ut=!0;break;case"E":je=!0;var j=co(Ie[G].slice(1),{r:x,c:b});N[x][b]=[N[x][b],j];break;case"S":Ot=!0,N[x][b]=[N[x][b],"S5S"];break;case"R":pt=parseInt(Ie[G].slice(1))-1;break;case"C":Ee=parseInt(Ie[G].slice(1))-1;break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+ee)}if(ut&&(N[x][b]&&2==N[x][b].length?N[x][b][0]=ke:N[x][b]=ke,ie=null),Ot){if(je)throw new Error("SYLK shared formula cannot have own formula");var ae=pt>-1&&N[pt][Ee];if(!ae||!ae[1])throw new Error("SYLK shared formula cannot find base");N[x][b][1]=md(ae[1],{r:x-pt,c:b-Ee})}break;case"F":var X=0;for(G=1;G<Ie.length;++G)switch(Ie[G].charAt(0)){case"X":b=parseInt(Ie[G].slice(1))-1,++X;break;case"Y":for(x=parseInt(Ie[G].slice(1))-1,he=N.length;he<=x;++he)N[he]=[];break;case"M":fe=parseInt(Ie[G].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":ie=Q[parseInt(Ie[G].slice(1))];break;case"W":for(J=Ie[G].slice(1).split(" "),he=parseInt(J[0],10);he<=parseInt(J[1],10);++he)fe=parseInt(J[2],10),te[he-1]=0===fe?{hidden:!0}:{wch:fe},ao(te[he-1]);break;case"C":te[b=parseInt(Ie[G].slice(1))-1]||(te[b]={});break;case"R":K[x=parseInt(Ie[G].slice(1))-1]||(K[x]={}),fe>0?(K[x].hpt=fe,K[x].hpx=jl(fe)):0===fe&&(K[x].hidden=!0);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+ee)}X<1&&(ie=null);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+ee)}}return K.length>0&&(ce["!rows"]=K),te.length>0&&(ce["!cols"]=te),T&&T.sheetRows&&(N=N.slice(0,T.sheetRows)),[N,ce]}function h(R,T){var A=function p(R,T){switch(T.type){case"base64":return d(yi(R),T);case"binary":return d(R,T);case"buffer":return d(St&&Buffer.isBuffer(R)?R.toString("binary"):zn(R),T);case"array":return d(rn(R),T)}throw new Error("Unrecognized type "+T.type)}(R,T),x=A[0],b=A[1],H=cn(x,T);return qt(b).forEach(function(G){H[G]=b[G]}),H}function y(R,T,A,x){var b="C;Y"+(A+1)+";X"+(x+1)+";K";switch(R.t){case"n":b+=R.v||0,R.f&&!R.F&&(b+=";E"+Es(R.f,{r:A,c:x}));break;case"b":b+=R.v?"TRUE":"FALSE";break;case"e":b+=R.w||R.v;break;case"d":b+='"'+(R.w||R.v)+'"';break;case"s":b+='"'+R.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return b}return s["|"]=254,{to_workbook:function g(R,T){return un(h(R,T),T)},to_sheet:h,from_sheet:function E(R,T){var H,A=["ID;PWXL;N;E"],x=[],b=Ct(R["!ref"]),G=Array.isArray(R),N="\r\n";A.push("P;PGeneral"),A.push("F;P0;DG0G8;M255"),R["!cols"]&&function w(R,T){T.forEach(function(A,x){var b="F;W"+(x+1)+" "+(x+1)+" ";A.hidden?b+="0":("number"==typeof A.width&&!A.wpx&&(A.wpx=ha(A.width)),"number"==typeof A.wpx&&!A.wch&&(A.wch=va(A.wpx)),"number"==typeof A.wch&&(b+=Math.round(A.wch)))," "!=b.charAt(b.length-1)&&R.push(b)})}(A,R["!cols"]),R["!rows"]&&function S(R,T){T.forEach(function(A,x){var b="F;";A.hidden?b+="M0;":A.hpt?b+="M"+20*A.hpt+";":A.hpx&&(b+="M"+20*lo(A.hpx)+";"),b.length>2&&R.push(b+"R"+(x+1))})}(A,R["!rows"]),A.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var Q=b.s.r;Q<=b.e.r;++Q)for(var ie=b.s.c;ie<=b.e.c;++ie){var ce=at({r:Q,c:ie});(H=G?(R[Q]||[])[ie]:R[ce])&&(null!=H.v||H.f&&!H.F)&&x.push(y(H,0,Q,ie))}return A.join(N)+N+x.join(N)+N+"E"+N}}}(),hn=function(){function l(d,h){for(var g=d.split("\n"),y=-1,w=-1,S=0,E=[];S!==g.length;++S)if("BOT"!==g[S].trim()){if(!(y<0)){for(var R=g[S].trim().split(","),T=R[0],A=R[1],x=g[++S]||"";1&(x.match(/["]/g)||[]).length&&S<g.length-1;)x+="\n"+g[++S];switch(x=x.trim(),+T){case-1:if("BOT"===x){E[++y]=[],w=0;continue}if("EOD"!==x)throw new Error("Unrecognized DIF special command "+x);break;case 0:"TRUE"===x?E[y][w]=!0:"FALSE"===x?E[y][w]=!1:isNaN(Vt(A))?isNaN(Qn(A).getDate())?E[y][w]=A:E[y][w]=rr(A):E[y][w]=Vt(A),++w;break;case 1:x=(x=x.slice(1,x.length-1)).replace(/""/g,'"'),jn&&x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),E[y][w++]=""!==x?x:null}if("EOD"===x)break}}else E[++y]=[],w=0;return h&&h.sheetRows&&(E=E.slice(0,h.sheetRows)),E}function a(d,h){return cn(function s(d,h){switch(h.type){case"base64":return l(yi(d),h);case"binary":return l(d,h);case"buffer":return l(St&&Buffer.isBuffer(d)?d.toString("binary"):zn(d),h);case"array":return l(rn(d),h)}throw new Error("Unrecognized type "+h.type)}(d,h),h)}return{to_workbook:function f(d,h){return un(a(d,h),h)},to_sheet:a,from_sheet:function(){var d=function(y,w,S,E,R){y.push(w),y.push(S+","+E),y.push('"'+R.replace(/"/g,'""')+'"')},h=function(y,w,S,E){y.push(w+","+S),y.push(1==w?'"'+E.replace(/"/g,'""')+'"':E)};return function(y){var E,w=[],S=Ct(y["!ref"]),R=Array.isArray(y);d(w,"TABLE",0,1,"sheetjs"),d(w,"VECTORS",0,S.e.r-S.s.r+1,""),d(w,"TUPLES",0,S.e.c-S.s.c+1,""),d(w,"DATA",0,0,"");for(var T=S.s.r;T<=S.e.r;++T){h(w,-1,0,"BOT");for(var A=S.s.c;A<=S.e.c;++A){var x=at({r:T,c:A});if(E=R?(y[T]||[])[A]:y[x])switch(E.t){case"n":var b=jn?E.w:E.v;!b&&null!=E.v&&(b=E.v),null==b?jn&&E.f&&!E.F?h(w,1,0,"="+E.f):h(w,1,0,""):h(w,0,b,"V");break;case"b":h(w,0,E.v?1:0,E.v?"TRUE":"FALSE");break;case"s":h(w,1,0,!jn||isNaN(E.v)?E.v:'="'+E.v+'"');break;case"d":E.w||(E.w=Si(E.z||ot[14],Cr(rr(E.v)))),jn?h(w,0,E.w,"V"):h(w,1,0,E.w);break;default:h(w,1,0,"")}else h(w,1,0,"")}}h(w,-1,0,"EOD");return w.join("\r\n")}}()}}(),bt=function(){function s(E){return E.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function l(E){return E.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function f(E,R){return cn(function a(E,R){for(var T=E.split("\n"),A=-1,x=-1,b=0,H=[];b!==T.length;++b){var G=T[b].trim().split(":");if("cell"===G[0]){var N=Ze(G[1]);if(H.length<=N.r)for(A=H.length;A<=N.r;++A)H[A]||(H[A]=[]);switch(A=N.r,x=N.c,G[2]){case"t":H[A][x]=s(G[3]);break;case"v":H[A][x]=+G[3];break;case"vtf":var Q=G[G.length-1];case"vtc":"nl"===G[3]?H[A][x]=!!+G[4]:H[A][x]=+G[4],"vtf"==G[2]&&(H[A][x]=[H[A][x],Q])}}}return R&&R.sheetRows&&(H=H.slice(0,R.sheetRows)),H}(E,R),R)}var d=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),h=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",g=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),y="--SocialCalcSpreadsheetControlSave--";function w(E){if(!E||!E["!ref"])return"";for(var A,R=[],T=[],x="",b=mr(E["!ref"]),H=Array.isArray(E),G=b.s.r;G<=b.e.r;++G)for(var N=b.s.c;N<=b.e.c;++N)if(x=at({r:G,c:N}),(A=H?(E[G]||[])[N]:E[x])&&null!=A.v&&"z"!==A.t){switch(T=["cell",x,"t"],A.t){case"s":case"str":T.push(l(A.v));break;case"n":A.f?(T[2]="vtf",T[3]="n",T[4]=A.v,T[5]=l(A.f)):(T[2]="v",T[3]=A.v);break;case"b":T[2]="vt"+(A.f?"f":"c"),T[3]="nl",T[4]=A.v?"1":"0",T[5]=l(A.f||(A.v?"TRUE":"FALSE"));break;case"d":var Q=Cr(rr(A.v));T[2]="vtc",T[3]="nd",T[4]=""+Q,T[5]=A.w||Si(A.z||ot[14],Q);break;case"e":continue}R.push(T.join(":"))}return R.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),R.push("valueformat:1:text-wiki"),R.join("\n")}return{to_workbook:function p(E,R){return un(f(E,R),R)},to_sheet:f,from_sheet:function S(E){return[d,h,g,h,w(E),y].join("\n")}}}(),xt=function(){function s(S,E,R,T,A){A.raw?E[R][T]=S:""===S||("TRUE"===S?E[R][T]=!0:"FALSE"===S?E[R][T]=!1:isNaN(Vt(S))?isNaN(Qn(S).getDate())?E[R][T]=S:E[R][T]=rr(S):E[R][T]=Vt(S))}var a={44:",",9:"\t",59:";",124:"|"},f={44:3,9:2,59:1,124:0};function p(S){for(var E={},R=!1,T=0,A=0;T<S.length;++T)34==(A=S.charCodeAt(T))?R=!R:!R&&A in a&&(E[A]=(E[A]||0)+1);for(T in A=[],E)Object.prototype.hasOwnProperty.call(E,T)&&A.push([E[T],T]);if(!A.length)for(T in E=f)Object.prototype.hasOwnProperty.call(E,T)&&A.push([E[T],T]);return A.sort(function(x,b){return x[0]-b[0]||f[x[1]]-f[b[1]]}),a[A.pop()[1]]||44}function d(S,E){var R=E||{},T="";null!=or&&null==R.dense&&(R.dense=or);var A=R.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};"sep="==S.slice(0,4)?13==S.charCodeAt(5)&&10==S.charCodeAt(6)?(T=S.charAt(4),S=S.slice(7)):13==S.charCodeAt(5)||10==S.charCodeAt(5)?(T=S.charAt(4),S=S.slice(6)):T=p(S.slice(0,1024)):T=R&&R.FS?R.FS:p(S.slice(0,1024));var b=0,H=0,G=0,N=0,Q=0,ie=T.charCodeAt(0),ce=!1,K=0,te=S.charCodeAt(0);S=S.replace(/\r\n/gm,"\n");var J=null!=R.dateNF?function ll(s){var l="number"==typeof s?ot[s]:s;return l=l.replace(al,"(\\d+)"),new RegExp("^"+l+"$")}(R.dateNF):null;function fe(){var he=S.slice(N,Q),ee={};if('"'==he.charAt(0)&&'"'==he.charAt(he.length-1)&&(he=he.slice(1,-1).replace(/""/g,'"')),0===he.length)ee.t="z";else if(R.raw)ee.t="s",ee.v=he;else if(0===he.trim().length)ee.t="s",ee.v=he;else if(61==he.charCodeAt(0))34==he.charCodeAt(1)&&34==he.charCodeAt(he.length-1)?(ee.t="s",ee.v=he.slice(2,-1).replace(/""/g,'"')):function Bc(s){return 1!=s.length}(he)?(ee.t="n",ee.f=he.slice(1)):(ee.t="s",ee.v=he);else if("TRUE"==he)ee.t="b",ee.v=!0;else if("FALSE"==he)ee.t="b",ee.v=!1;else if(isNaN(G=Vt(he)))if(!isNaN(Qn(he).getDate())||J&&he.match(J)){ee.z=R.dateNF||ot[14];var Ie=0;J&&he.match(J)&&(he=function ul(s,l,a){var f=-1,p=-1,d=-1,h=-1,g=-1,y=-1;(l.match(al)||[]).forEach(function(E,R){var T=parseInt(a[R+1],10);switch(E.toLowerCase().charAt(0)){case"y":f=T;break;case"d":d=T;break;case"h":h=T;break;case"s":y=T;break;case"m":h>=0?g=T:p=T}}),y>=0&&-1==g&&p>=0&&(g=p,p=-1);var w=(""+(f>=0?f:(new Date).getFullYear())).slice(-4)+"-"+("00"+(p>=1?p:1)).slice(-2)+"-"+("00"+(d>=1?d:1)).slice(-2);7==w.length&&(w="0"+w),8==w.length&&(w="20"+w);var S=("00"+(h>=0?h:0)).slice(-2)+":"+("00"+(g>=0?g:0)).slice(-2)+":"+("00"+(y>=0?y:0)).slice(-2);return-1==h&&-1==g&&-1==y?w:-1==f&&-1==p&&-1==d?S:w+"T"+S}(0,R.dateNF,he.match(J)||[]),Ie=1),R.cellDates?(ee.t="d",ee.v=rr(he,Ie)):(ee.t="n",ee.v=Cr(rr(he,Ie))),!1!==R.cellText&&(ee.w=Si(ee.z,ee.v instanceof Date?Cr(ee.v):ee.v)),R.cellNF||delete ee.z}else ee.t="s",ee.v=he;else ee.t="n",!1!==R.cellText&&(ee.w=he),ee.v=G;if("z"==ee.t||(R.dense?(A[b]||(A[b]=[]),A[b][H]=ee):A[at({c:H,r:b})]=ee),N=Q+1,te=S.charCodeAt(N),x.e.c<H&&(x.e.c=H),x.e.r<b&&(x.e.r=b),K==ie)++H;else if(H=0,++b,R.sheetRows&&R.sheetRows<=b)return!0}e:for(;Q<S.length;++Q)switch(K=S.charCodeAt(Q)){case 34:34===te&&(ce=!ce);break;case ie:case 10:case 13:if(!ce&&fe())break e}return Q-N>0&&fe(),A["!ref"]=lt(x),A}function h(S,E){return!E||!E.PRN||E.FS||"sep="==S.slice(0,4)||S.indexOf("\t")>=0||S.indexOf(",")>=0||S.indexOf(";")>=0?d(S,E):cn(function l(S,E){var R=E||{},T=[];if(!S||0===S.length)return T;for(var A=S.split(/[\r\n]/),x=A.length-1;x>=0&&0===A[x].length;)--x;for(var b=10,H=0,G=0;G<=x;++G)-1==(H=A[G].indexOf(" "))?H=A[G].length:H++,b=Math.max(b,H);for(G=0;G<=x;++G){T[G]=[];var N=0;for(s(A[G].slice(0,b).trim(),T,G,N,R),N=1;N<=(A[G].length-b)/10+1;++N)s(A[G].slice(b+10*(N-1),b+10*N).trim(),T,G,N,R)}return R.sheetRows&&(T=T.slice(0,R.sheetRows)),T}(S,E),E)}function g(S,E){var R="",T="string"==E.type?[0,0,0,0]:_(S,E);switch(E.type){case"base64":R=yi(S);break;case"binary":case"string":R=S;break;case"buffer":R=65001==E.codepage?S.toString("utf8"):E.codepage&&typeof Xe<"u"?Xe.utils.decode(E.codepage,S):St&&Buffer.isBuffer(S)?S.toString("binary"):zn(S);break;case"array":R=rn(S);break;default:throw new Error("Unrecognized type "+E.type)}return 239==T[0]&&187==T[1]&&191==T[2]?R=vt(R.slice(3)):"string"!=E.type&&"buffer"!=E.type&&65001==E.codepage?R=vt(R):"binary"==E.type&&typeof Xe<"u"&&E.codepage&&(R=Xe.utils.decode(E.codepage,Xe.utils.encode(28591,R))),"socialcalc:version:"==R.slice(0,19)?bt.to_sheet("string"==E.type?R:vt(R),E):h(R,E)}return{to_workbook:function y(S,E){return un(g(S,E),E)},to_sheet:g,from_sheet:function w(S){for(var T,E=[],R=Ct(S["!ref"]),A=Array.isArray(S),x=R.s.r;x<=R.e.r;++x){for(var b=[],H=R.s.c;H<=R.e.c;++H){var G=at({r:x,c:H});if((T=A?(S[x]||[])[H]:S[G])&&null!=T.v){for(var N=(T.w||(Ei(T),T.w)||"").slice(0,10);N.length<10;)N+=" ";b.push(N+(0===H?" ":""))}else b.push("          ")}E.push(b.join(""))}return E.join("\n")}}}();var Lo=function(){function s(j,ae,X){if(j){Br(j,j.l||0);for(var Y=X.Enum||pt;j.l<j.length;){var ye=j.read_shift(2),Be=Y[ye]||Y[65535],Fe=j.read_shift(2),Pe=j.l+Fe,xe=Be.f&&Be.f(j,Fe,X);if(j.l=Pe,ae(xe,Be,ye))return}}}function a(j,ae){if(!j)return j;var X=ae||{};null!=or&&null==X.dense&&(X.dense=or);var Y=X.dense?[]:{},ye="Sheet1",Be="",Fe=0,Pe={},xe=[],Rt=[],U={s:{r:0,c:0},e:{r:0,c:0}},jt=X.sheetRows||0;if(0==j[2]&&(8==j[3]||9==j[3])&&j.length>=16&&5==j[14]&&108===j[15])throw new Error("Unsupported Works 3 for Mac file");if(2==j[2])X.Enum=pt,s(j,function(We,_r,En){switch(En){case 0:X.vers=We,We>=4096&&(X.qpro=!0);break;case 6:U=We;break;case 204:We&&(Be=We);break;case 222:Be=We;break;case 15:case 51:X.qpro||(We[1].v=We[1].v.slice(1));case 13:case 14:case 16:14==En&&112==(112&We[2])&&(15&We[2])>1&&(15&We[2])<15&&(We[1].z=X.dateNF||ot[14],X.cellDates&&(We[1].t="d",We[1].v=Nu(We[1].v))),X.qpro&&We[3]>Fe&&(Y["!ref"]=lt(U),Pe[ye]=Y,xe.push(ye),Y=X.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},Fe=We[3],ye=Be||"Sheet"+(Fe+1),Be="");var go=X.dense?(Y[We[0].r]||[])[We[0].c]:Y[at(We[0])];if(go){go.t=We[1].t,go.v=We[1].v,null!=We[1].z&&(go.z=We[1].z),null!=We[1].f&&(go.f=We[1].f);break}X.dense?(Y[We[0].r]||(Y[We[0].r]=[]),Y[We[0].r][We[0].c]=We[1]):Y[at(We[0])]=We[1]}},X);else{if(26!=j[2]&&14!=j[2])throw new Error("Unrecognized LOTUS BOF "+j[2]);X.Enum=Ee,14==j[2]&&(X.qpro=!0,j.l=0),s(j,function(We,_r,En){switch(En){case 204:ye=We;break;case 22:We[1].v=We[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(We[3]>Fe&&(Y["!ref"]=lt(U),Pe[ye]=Y,xe.push(ye),Y=X.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},Fe=We[3],ye="Sheet"+(Fe+1)),jt>0&&We[0].r>=jt)break;X.dense?(Y[We[0].r]||(Y[We[0].r]=[]),Y[We[0].r][We[0].c]=We[1]):Y[at(We[0])]=We[1],U.e.c<We[0].c&&(U.e.c=We[0].c),U.e.r<We[0].r&&(U.e.r=We[0].r);break;case 27:We[14e3]&&(Rt[We[14e3][0]]=We[14e3][1]);break;case 1537:Rt[We[0]]=We[1],We[0]==Fe&&(ye=We[1])}},X)}if(Y["!ref"]=lt(U),Pe[Be||ye]=Y,xe.push(Be||ye),!Rt.length)return{SheetNames:xe,Sheets:Pe};for(var At={},zt=[],Dt=0;Dt<Rt.length;++Dt)Pe[xe[Dt]]?(zt.push(Rt[Dt]||xe[Dt]),At[Rt[Dt]]=Pe[Rt[Dt]]||Pe[xe[Dt]]):(zt.push(Rt[Dt]),At[Rt[Dt]]={"!ref":"A1"});return{SheetNames:zt,Sheets:At}}function w(j,ae,X){var Y=[{c:0,r:0},{t:"n",v:0},0,0];return X.qpro&&20768!=X.vers?(Y[0].c=j.read_shift(1),Y[3]=j.read_shift(1),Y[0].r=j.read_shift(2),j.l+=2):(Y[2]=j.read_shift(1),Y[0].c=j.read_shift(2),Y[0].r=j.read_shift(2)),Y}function S(j,ae,X){var Y=j.l+ae,ye=w(j,0,X);if(ye[1].t="s",20768==X.vers){j.l++;var Be=j.read_shift(1);return ye[1].v=j.read_shift(Be,"utf8"),ye}return X.qpro&&j.l++,ye[1].v=j.read_shift(Y-j.l,"cstr"),ye}function E(j,ae,X){var Y=de(7+X.length);Y.write_shift(1,255),Y.write_shift(2,ae),Y.write_shift(2,j),Y.write_shift(1,39);for(var ye=0;ye<Y.length;++ye){var Be=X.charCodeAt(ye);Y.write_shift(1,Be>=128?95:Be)}return Y.write_shift(1,0),Y}function T(j,ae,X){var Y=de(7);return Y.write_shift(1,255),Y.write_shift(2,ae),Y.write_shift(2,j),Y.write_shift(2,X,"i"),Y}function x(j,ae,X){var Y=de(13);return Y.write_shift(1,255),Y.write_shift(2,ae),Y.write_shift(2,j),Y.write_shift(8,X,"f"),Y}function H(j,ae,X){var Y=32768&ae;return ae=(Y?j:0)+((ae&=-32769)>=8192?ae-16384:ae),(Y?"":"$")+(X?$t(ae):lr(ae))}var G={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function ie(j){var ae=[{c:0,r:0},{t:"n",v:0},0];return ae[0].r=j.read_shift(2),ae[3]=j[j.l++],ae[0].c=j[j.l++],ae}function K(j,ae,X,Y){var ye=de(6+Y.length);ye.write_shift(2,j),ye.write_shift(1,X),ye.write_shift(1,ae),ye.write_shift(1,39);for(var Be=0;Be<Y.length;++Be){var Fe=Y.charCodeAt(Be);ye.write_shift(1,Fe>=128?95:Fe)}return ye.write_shift(1,0),ye}function J(j,ae){var X=ie(j),Y=j.read_shift(4),ye=j.read_shift(4),Be=j.read_shift(2);if(65535==Be)return 0===Y&&3221225472===ye?(X[1].t="e",X[1].v=15):0===Y&&3489660928===ye?(X[1].t="e",X[1].v=42):X[1].v=0,X;var Fe=32768&Be;return Be=(32767&Be)-16446,X[1].v=(1-2*Fe)*(ye*Math.pow(2,Be+32)+Y*Math.pow(2,Be)),X}function fe(j,ae,X,Y){var ye=de(14);if(ye.write_shift(2,j),ye.write_shift(1,X),ye.write_shift(1,ae),0==Y)return ye.write_shift(4,0),ye.write_shift(4,0),ye.write_shift(2,65535),ye;var Pe,Be=0,Fe=0,xe=0;return Y<0&&(Be=1,Y=-Y),Fe=0|Math.log2(Y),2147483648&(xe=(Y/=Math.pow(2,Fe-31))>>>0)||(++Fe,xe=(Y/=2)>>>0),Y-=xe,xe|=2147483648,xe>>>=0,Pe=(Y*=Math.pow(2,32))>>>0,ye.write_shift(4,Pe),ye.write_shift(4,xe),Fe+=16383+(Be?32768:0),ye.write_shift(2,Fe),ye}function Ie(j,ae){var X=ie(j),Y=j.read_shift(8,"f");return X[1].v=Y,X}function ke(j,ae){return 0==j[j.l+ae-1]?j.read_shift(ae,"cstr"):""}function je(j,ae){var X=de(5+j.length);X.write_shift(2,14e3),X.write_shift(2,ae);for(var Y=0;Y<j.length;++Y){var ye=j.charCodeAt(Y);X[X.l++]=ye>127?95:ye}return X[X.l++]=0,X}var pt={0:{n:"BOF",f:vr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function g(j,ae,X){var Y={s:{c:0,r:0},e:{c:0,r:0}};return 8==ae&&X.qpro?(Y.s.c=j.read_shift(1),j.l++,Y.s.r=j.read_shift(2),Y.e.c=j.read_shift(1),j.l++,Y.e.r=j.read_shift(2),Y):(Y.s.c=j.read_shift(2),Y.s.r=j.read_shift(2),12==ae&&X.qpro&&(j.l+=2),Y.e.c=j.read_shift(2),Y.e.r=j.read_shift(2),12==ae&&X.qpro&&(j.l+=2),65535==Y.s.c&&(Y.s.c=Y.e.c=Y.s.r=Y.e.r=0),Y)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function R(j,ae,X){var Y=w(j,0,X);return Y[1].v=j.read_shift(2,"i"),Y}},14:{n:"NUMBER",f:function A(j,ae,X){var Y=w(j,0,X);return Y[1].v=j.read_shift(8,"f"),Y}},15:{n:"LABEL",f:S},16:{n:"FORMULA",f:function b(j,ae,X){var Y=j.l+ae,ye=w(j,0,X);if(ye[1].v=j.read_shift(8,"f"),X.qpro)j.l=Y;else{var Be=j.read_shift(2);(function Q(j,ae){Br(j,0);for(var X=[],Y=0,ye="",Be="",Fe="",Pe="";j.l<j.length;){var xe=j[j.l++];switch(xe){case 0:X.push(j.read_shift(8,"f"));break;case 1:Be=H(ae[0].c,j.read_shift(2),!0),ye=H(ae[0].r,j.read_shift(2),!1),X.push(Be+ye);break;case 2:var Rt=H(ae[0].c,j.read_shift(2),!0),U=H(ae[0].r,j.read_shift(2),!1);Be=H(ae[0].c,j.read_shift(2),!0),ye=H(ae[0].r,j.read_shift(2),!1),X.push(Rt+U+":"+Be+ye);break;case 3:if(j.l<j.length)return void console.error("WK1 premature formula end");break;case 4:X.push("("+X.pop()+")");break;case 5:X.push(j.read_shift(2));break;case 6:for(var jt="";xe=j[j.l++];)jt+=String.fromCharCode(xe);X.push('"'+jt.replace(/"/g,'""')+'"');break;case 8:X.push("-"+X.pop());break;case 23:X.push("+"+X.pop());break;case 22:X.push("NOT("+X.pop()+")");break;case 20:case 21:Pe=X.pop(),Fe=X.pop(),X.push(["AND","OR"][xe-20]+"("+Fe+","+Pe+")");break;default:if(xe<32&&N[xe])Pe=X.pop(),Fe=X.pop(),X.push(Fe+N[xe]+Pe);else{if(!G[xe])return xe<=7?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=24?console.error("WK1 unsupported op "+xe.toString(16)):xe<=30?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=115?console.error("WK1 unsupported function opcode "+xe.toString(16)):console.error("WK1 unrecognized opcode "+xe.toString(16));if(69==(Y=G[xe][1])&&(Y=j[j.l++]),Y>X.length)return void console.error("WK1 bad formula parse 0x"+xe.toString(16)+":|"+X.join("|")+"|");var At=X.slice(-Y);X.length-=Y,X.push(G[xe][0]+"("+At.join(",")+")")}}}1==X.length?ae[1].f=""+X[0]:console.error("WK1 bad formula parse |"+X.join("|")+"|")})(j.slice(j.l,j.l+Be),ye),j.l+=Be}return ye}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:S},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ke},222:{n:"SHEETNAMELP",f:function ut(j,ae){var X=j[j.l++];X>ae-1&&(X=ae-1);for(var Y="";Y.length<X;)Y+=String.fromCharCode(j[j.l++]);return Y}},65535:{n:""}},Ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function ce(j,ae){var X=ie(j);return X[1].t="s",X[1].v=j.read_shift(ae-4,"cstr"),X}},23:{n:"NUMBER17",f:J},24:{n:"NUMBER18",f:function te(j,ae){var X=ie(j);X[1].v=j.read_shift(2);var Y=X[1].v>>1;if(1&X[1].v)switch(7&Y){case 0:Y=5e3*(Y>>3);break;case 1:Y=500*(Y>>3);break;case 2:Y=(Y>>3)/20;break;case 3:Y=(Y>>3)/200;break;case 4:Y=(Y>>3)/2e3;break;case 5:Y=(Y>>3)/2e4;break;case 6:Y=(Y>>3)/16;break;case 7:Y=(Y>>3)/64}return X[1].v=Y,X}},25:{n:"FORMULA19",f:function he(j,ae){var X=J(j);return j.l+=ae-14,X}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function Ot(j,ae){for(var X={},Y=j.l+ae;j.l<Y;){var ye=j.read_shift(2);if(14e3==ye){for(X[ye]=[0,""],X[ye][0]=j.read_shift(2);j[j.l];)X[ye][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return X}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function ee(j,ae){var X=ie(j),Y=j.read_shift(4);return X[1].v=Y>>6,X}},38:{n:"??"},39:{n:"NUMBER27",f:Ie},40:{n:"FORMULA28",f:function Ke(j,ae){var X=Ie(j);return j.l+=ae-10,X}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ke},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function Qe(j,ae,X){if(X.qpro&&!(ae<21)){var Y=j.read_shift(1);return j.l+=17,j.l+=1,j.l+=2,[Y,j.read_shift(ae-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function f(j,ae){var X=ae||{};if(+X.codepage>=0&&ct(+X.codepage),"string"==X.type)throw new Error("Cannot write WK1 to JS string");var Y=ri(),ye=Ct(j["!ref"]),Be=Array.isArray(j),Fe=[];De(Y,0,function d(j){var ae=de(2);return ae.write_shift(2,j),ae}(1030)),De(Y,6,function y(j){var ae=de(8);return ae.write_shift(2,j.s.c),ae.write_shift(2,j.s.r),ae.write_shift(2,j.e.c),ae.write_shift(2,j.e.r),ae}(ye));for(var Pe=Math.min(ye.e.r,8191),xe=ye.s.r;xe<=Pe;++xe)for(var Rt=lr(xe),U=ye.s.c;U<=ye.e.c;++U){xe===ye.s.r&&(Fe[U]=$t(U));var jt=Fe[U]+Rt,At=Be?(j[xe]||[])[U]:j[jt];if(At&&"z"!=At.t)if("n"==At.t)(0|At.v)==At.v&&At.v>=-32768&&At.v<=32767?De(Y,13,T(xe,U,At.v)):De(Y,14,x(xe,U,At.v));else{De(Y,15,E(xe,U,Ei(At).slice(0,239)))}}return De(Y,1),Y.end()},book_to_wk3:function p(j,ae){var X=ae||{};if(+X.codepage>=0&&ct(+X.codepage),"string"==X.type)throw new Error("Cannot write WK3 to JS string");var Y=ri();De(Y,0,function h(j){var ae=de(26);ae.write_shift(2,4096),ae.write_shift(2,4),ae.write_shift(4,0);for(var X=0,Y=0,ye=0,Be=0;Be<j.SheetNames.length;++Be){var Fe=j.SheetNames[Be],Pe=j.Sheets[Fe];if(Pe&&Pe["!ref"]){++ye;var xe=mr(Pe["!ref"]);X<xe.e.r&&(X=xe.e.r),Y<xe.e.c&&(Y=xe.e.c)}}return X>8191&&(X=8191),ae.write_shift(2,X),ae.write_shift(1,ye),ae.write_shift(1,Y),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(1,1),ae.write_shift(1,2),ae.write_shift(4,0),ae.write_shift(4,0),ae}(j));for(var ye=0,Be=0;ye<j.SheetNames.length;++ye)(j.Sheets[j.SheetNames[ye]]||{})["!ref"]&&De(Y,27,je(j.SheetNames[ye],Be++));var Fe=0;for(ye=0;ye<j.SheetNames.length;++ye){var Pe=j.Sheets[j.SheetNames[ye]];if(Pe&&Pe["!ref"]){for(var xe=Ct(Pe["!ref"]),Rt=Array.isArray(Pe),U=[],jt=Math.min(xe.e.r,8191),At=xe.s.r;At<=jt;++At)for(var zt=lr(At),Dt=xe.s.c;Dt<=xe.e.c;++Dt){At===xe.s.r&&(U[Dt]=$t(Dt));var We=U[Dt]+zt,_r=Rt?(Pe[At]||[])[Dt]:Pe[We];if(_r&&"z"!=_r.t)if("n"==_r.t)De(Y,23,fe(At,Dt,Fe,_r.v));else{De(Y,22,K(At,Dt,Fe,Ei(_r).slice(0,239)))}}++Fe}}return De(Y,1),Y.end()},to_workbook:function l(j,ae){switch(ae.type){case"base64":return a(Ci(yi(j)),ae);case"binary":return a(Ci(j),ae);case"buffer":case"array":return a(j,ae)}throw"Unsupported type "+ae.type}}}();var yr=/^\s|\s$|[\t\n\r]/;function Hl(s,l){if(!l.bookSST)return"";var a=[sr];a[a.length]=Ae("sst",null,{xmlns:Fn[0],count:s.Count,uniqueCount:s.Unique});for(var f=0;f!=s.length;++f)if(null!=s[f]){var p=s[f],d="<si>";p.r?d+=p.r:(d+="<t",p.t||(p.t=""),p.t.match(yr)&&(d+=' xml:space="preserve"'),d+=">"+kt(p.t)+"</t>"),d+="</si>",a[a.length]=d}return a.length>2&&(a[a.length]="</sst>",a[1]=a[1].replace("/>",">")),a.join("")}var pg=function Nh(s,l){var a=!1;return null==l&&(a=!0,l=de(15+4*s.t.length)),l.write_shift(1,0),Rr(s.t,l),a?l.slice(0,l.l):l};function dg(s){var l=ri();_e(l,159,function so(s,l){return l||(l=de(8)),l.write_shift(4,s.Count),l.write_shift(4,s.Unique),l}(s));for(var a=0;a<s.length;++a)_e(l,19,pg(s[a]));return _e(l,160),l.end()}function Yp(s){if(typeof Xe<"u")return Xe.utils.encode(me,s);for(var l=[],a=s.split(""),f=0;f<a.length;++f)l[f]=a[f].charCodeAt(0);return l}function Dc(s){var a,d,l=0,f=Yp(s),p=f.length+1;for((a=Ir(p))[0]=f.length,d=1;d!=p;++d)a[d]=f[d-1];for(d=p-1;d>=0;--d)l=((16384&l?1:0)|l<<1&32767)^a[d];return 52811^l}var Qp=function(){function s(p,d){switch(d.type){case"base64":return l(yi(p),d);case"binary":return l(p,d);case"buffer":return l(St&&Buffer.isBuffer(p)?p.toString("binary"):zn(p),d);case"array":return l(rn(p),d)}throw new Error("Unrecognized type "+d.type)}function l(p,d){var g=(d||{}).dense?[]:{},y=p.match(/\\trowd.*?\\row\b/g);if(!y.length)throw new Error("RTF missing table");var w={s:{c:0,r:0},e:{c:0,r:y.length-1}};return y.forEach(function(S,E){Array.isArray(g)&&(g[E]=[]);for(var A,R=/\\\w+\b/g,T=0,x=-1;A=R.exec(S);){if("\\cell"===A[0]){var b=S.slice(T,R.lastIndex-A[0].length);if(" "==b[0]&&(b=b.slice(1)),++x,b.length){var H={v:b,t:"s"};Array.isArray(g)?g[E][x]=H:g[at({r:E,c:x})]=H}}T=R.lastIndex}x>w.e.c&&(w.e.c=x)}),g["!ref"]=lt(w),g}return{to_workbook:function a(p,d){return un(s(p,d),d)},to_sheet:s,from_sheet:function f(p){for(var g,d=["{\\rtf1\\ansi"],h=Ct(p["!ref"]),y=Array.isArray(p),w=h.s.r;w<=h.e.r;++w){d.push("\\trowd\\trautofit1");for(var S=h.s.c;S<=h.e.c;++S)d.push("\\cellx"+(S+1));for(d.push("\\pard\\intbl"),S=h.s.c;S<=h.e.c;++S){var E=at({r:w,c:S});(g=y?(p[w]||[])[S]:p[E])&&(null!=g.v||g.f&&!g.F)&&(d.push(" "+(g.w||(Ei(g),g.w))),d.push("\\cell"))}d.push("\\pard\\intbl\\row")}return d.join("")+"}"}}}();function da(s){for(var l=0,a=1;3!=l;++l)a=256*a+(s[l]>255?255:s[l]<0?0:s[l]);return a.toString(16).toUpperCase().slice(1)}var Jp=6,Wr=Jp;function ha(s){return Math.floor((s+Math.round(128/Wr)/256)*Wr)}function va(s){return Math.floor((s-5)/Wr*100+.5)/100}function Ul(s){return Math.round((s*Wr+5)/Wr*256)/256}function ao(s){s.width?(s.wpx=ha(s.width),s.wch=va(s.wpx),s.MDW=Wr):s.wpx?(s.wch=va(s.wpx),s.width=Ul(s.wch),s.MDW=Wr):"number"==typeof s.wch&&(s.width=Ul(s.wch),s.wpx=ha(s.width),s.MDW=Wr),s.customWidth&&delete s.customWidth}var Zp=96;function lo(s){return 96*s/Zp}function jl(s){return s*Zp/96}function ed(s,l){var f,a=[sr,Ae("styleSheet",null,{xmlns:Fn[0],"xmlns:vt":ar.vt})];return s.SSF&&null!=(f=function bg(s){var l=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var f=a[0];f<=a[1];++f)null!=s[f]&&(l[l.length]=Ae("numFmt",null,{numFmtId:f,formatCode:kt(s[f])}))}),1===l.length?"":(l[l.length]="</numFmts>",l[0]=Ae("numFmts",null,{count:l.length-2}).replace("/>",">"),l.join(""))}(s.SSF))&&(a[a.length]=f),a[a.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',a[a.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',a[a.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',a[a.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(f=function ko(s){var l=[];return l[l.length]=Ae("cellXfs",null),s.forEach(function(a){l[l.length]=Ae("xf",null,a)}),l[l.length]="</cellXfs>",2===l.length?"":(l[0]=Ae("cellXfs",null,{count:l.length-2}).replace("/>",">"),l.join(""))}(l.cellXfs))&&(a[a.length]=f),a[a.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',a[a.length]='<dxfs count="0"/>',a[a.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',a.length>2&&(a[a.length]="</styleSheet>",a[1]=a[1].replace("/>",">")),a.join("")}function Ig(s,l,a){a||(a=de(6+4*l.length)),a.write_shift(2,s),Rr(l,a);var f=a.length>a.l?a.slice(0,a.l):a;return null==a.l&&(a.l=a.length),f}function Lg(s,l){l||(l=de(153)),l.write_shift(2,20*s.sz),function Hh(s,l){l||(l=de(2));var a=(s.italic?2:0)|(s.strike?8:0)|(s.outline?16:0)|(s.shadow?32:0)|(s.condense?64:0)|(s.extend?128:0);return l.write_shift(1,a),l.write_shift(1,0),l}(s,l),l.write_shift(2,s.bold?700:400);var a=0;"superscript"==s.vertAlign?a=1:"subscript"==s.vertAlign&&(a=2),l.write_shift(2,a),l.write_shift(1,s.underline||0),l.write_shift(1,s.family||0),l.write_shift(1,s.charset||0),l.write_shift(1,0),ii(s.color,l);var f=0;return"major"==s.scheme&&(f=1),"minor"==s.scheme&&(f=2),l.write_shift(1,f),Rr(s.name,l),l.length>l.l?l.slice(0,l.l):l}var Ic,Go=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ti=Er;function td(s,l){l||(l=de(84)),Ic||(Ic=cl(Go));var a=Ic[s.patternType];null==a&&(a=40),l.write_shift(4,a);var f=0;if(40!=a)for(ii({auto:1},l),ii({auto:1},l);f<12;++f)l.write_shift(4,0);else{for(;f<4;++f)l.write_shift(4,0);for(;f<12;++f)l.write_shift(4,0)}return l.length>l.l?l.slice(0,l.l):l}function rd(s,l,a){a||(a=de(16)),a.write_shift(2,l||0),a.write_shift(2,s.numFmtId||0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(1,0),a.write_shift(1,0);return a.write_shift(1,0),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(1,0),a}function uo(s,l){return l||(l=de(10)),l.write_shift(1,0),l.write_shift(1,0),l.write_shift(4,0),l.write_shift(4,0),l}var Ng=Er;function od(s){_e(s,613,li(1)),_e(s,46,function kg(s,l){return l||(l=de(51)),l.write_shift(1,0),uo(0,l),uo(0,l),uo(0,l),uo(0,l),uo(0,l),l.length>l.l?l.slice(0,l.l):l}()),_e(s,614)}function Lc(s){_e(s,619,li(1)),_e(s,48,function id(s,l){return l||(l=de(52)),l.write_shift(4,s.xfId),l.write_shift(2,1),l.write_shift(1,+s.builtinId),l.write_shift(1,0),qs(s.name||"",l),l.length>l.l?l.slice(0,l.l):l}({xfId:0,builtinId:0,name:"Normal"})),_e(s,620)}function jg(s){_e(s,508,function Gg(s,l,a){var f=de(2052);return f.write_shift(4,s),qs(l,f),qs(a,f),f.length>f.l?f.slice(0,f.l):f}(0,"TableStyleMedium9","PivotStyleMedium4")),_e(s,509)}function Mc(s,l){var a=ri();return _e(a,278),function nd(s,l){if(l){var a=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(f){for(var p=f[0];p<=f[1];++p)null!=l[p]&&++a}),0!=a&&(_e(s,615,li(a)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(f){for(var p=f[0];p<=f[1];++p)null!=l[p]&&_e(s,44,Ig(p,l[p]))}),_e(s,616))}}(a,s.SSF),function Bg(s){_e(s,611,li(1)),_e(s,43,Lg({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),_e(s,612)}(a),function Vg(s){_e(s,603,li(2)),_e(s,45,td({patternType:"none"})),_e(s,45,td({patternType:"gray125"})),_e(s,604)}(a),od(a),function sd(s){_e(s,626,li(1)),_e(s,47,rd({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),_e(s,627)}(a),function Wg(s,l){_e(s,617,li(l.length)),l.forEach(function(a){_e(s,47,rd(a,0))}),_e(s,618)}(a,l.cellXfs),Lc(a),function Ug(s){_e(s,505,li(0)),_e(s,506)}(a),jg(a),_e(a,279),a.end()}function $l(s,l){if(l&&l.themeXLSX)return l.themeXLSX;if(s&&"string"==typeof s.raw)return s.raw;var a=[sr];return a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',a[a.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',a[a.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',a[a.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',a[a.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',a[a.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',a[a.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join("")}function l0(){var s=ri();return _e(s,332),_e(s,334,li(1)),_e(s,335,function i0(s){var l=de(12+2*s.name.length);return l.write_shift(4,s.flags),l.write_shift(4,s.version),Rr(s.name,l),l.slice(0,l.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),_e(s,336),_e(s,339,function hi(s,l){var a=de(8+2*l.length);return a.write_shift(4,s),Rr(l,a),a.slice(0,a.l)}(1,"XLDAPR")),_e(s,52),_e(s,35,li(514)),_e(s,4096,li(0)),_e(s,4097,pi(1)),_e(s,36),_e(s,53),_e(s,340),_e(s,337,function s0(s,l){var a=de(8);return a.write_shift(4,s),a.write_shift(4,l?1:0),a}(1,!0)),_e(s,51,function Yl(s){var l=de(4+8*s.length);l.write_shift(4,s.length);for(var a=0;a<s.length;++a)l.write_shift(4,s[a][0]),l.write_shift(4,s[a][1]);return l}([[1,0]])),_e(s,338),_e(s,333),s.end()}function cd(){var s=[sr];return s.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),s.join("")}var xs=1024;function kc(s,l){for(var a=[21600,21600],f=["m0,0l0",a[1],a[0],a[1],a[0],"0xe"].join(","),p=[Ae("xml",null,{"xmlns:v":ai.v,"xmlns:o":ai.o,"xmlns:x":ai.x,"xmlns:mv":ai.mv}).replace(/\/>/,">"),Ae("o:shapelayout",Ae("o:idmap",null,{"v:ext":"edit",data:s}),{"v:ext":"edit"}),Ae("v:shapetype",[Ae("v:stroke",null,{joinstyle:"miter"}),Ae("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:a.join(","),path:f})];xs<1e3*s;)xs+=1e3;return l.forEach(function(d){var h=Ze(d[0]),g={color2:"#BEFF82",type:"gradient"};"gradient"==g.type&&(g.angle="-180");var y="gradient"==g.type?Ae("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,w=Ae("v:fill",y,g);++xs,p=p.concat(["<v:shape"+es({id:"_x0000_s"+xs,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(d[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",w,Ae("v:shadow",null,{on:"t",obscured:"t"}),Ae("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Hr("x:Anchor",[h.c+1,0,h.r+1,0,h.c+3,20,h.r+5,20].join(",")),Hr("x:AutoFill","False"),Hr("x:Row",String(h.r)),Hr("x:Column",String(h.c)),d[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),p.push("</xml>"),p.join("")}function dd(s){var l=[sr,Ae("comments",null,{xmlns:Fn[0]})],a=[];return l.push("<authors>"),s.forEach(function(f){f[1].forEach(function(p){var d=kt(p.a);-1==a.indexOf(d)&&(a.push(d),l.push("<author>"+d+"</author>")),p.T&&p.ID&&-1==a.indexOf("tc="+p.ID)&&(a.push("tc="+p.ID),l.push("<author>tc="+p.ID+"</author>"))})}),0==a.length&&(a.push("SheetJ5"),l.push("<author>SheetJ5</author>")),l.push("</authors>"),l.push("<commentList>"),s.forEach(function(f){var p=0,d=[];if(f[1][0]&&f[1][0].T&&f[1][0].ID?p=a.indexOf("tc="+f[1][0].ID):f[1].forEach(function(y){y.a&&(p=a.indexOf(kt(y.a))),d.push(y.t||"")}),l.push('<comment ref="'+f[0]+'" authorId="'+p+'"><text>'),d.length<=1)l.push(Hr("t",kt(d[0]||"")));else{for(var h="Comment:\n    "+d[0]+"\n",g=1;g<d.length;++g)h+="Reply:\n    "+d[g]+"\n";l.push(Hr("t",kt(h)))}l.push("</text></comment>")}),l.push("</commentList>"),l.length>2&&(l[l.length]="</comments>",l[1]=l[1].replace("/>",">")),l.join("")}function v0(s,l,a){var f=[sr,Ae("ThreadedComments",null,{xmlns:ar.TCMNT}).replace(/[\/]>/,">")];return s.forEach(function(p){var d="";(p[1]||[]).forEach(function(h,g){if(h.T){h.a&&-1==l.indexOf(h.a)&&l.push(h.a);var y={ref:p[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+a.tcid++).slice(-12)+"}"};0==g?d=y.id:y.parentId=d,h.ID=y.id,h.a&&(y.personId="{54EE7950-7262-4200-6969-"+("000000000000"+l.indexOf(h.a)).slice(-12)+"}"),f.push(Ae("threadedComment",Hr("text",h.t||""),y))}else delete h.ID})}),f.push("</ThreadedComments>"),f.join("")}var hd=Wt;function w0(s){var l=ri(),a=[];return _e(l,628),_e(l,630),s.forEach(function(f){f[1].forEach(function(p){a.indexOf(p.a)>-1||(a.push(p.a.slice(0,54)),_e(l,632,function C0(s){return Rr(s.slice(0,54))}(p.a)))})}),_e(l,631),_e(l,633),s.forEach(function(f){f[1].forEach(function(p){p.iauthor=a.indexOf(p.a);var d={s:Ze(f[0]),e:Ze(f[0])};_e(l,635,function y0(s,l){return null==l&&(l=de(36)),l.write_shift(4,s[1].iauthor),fn(s[0],l),l.write_shift(4,0),l.write_shift(4,0),l.write_shift(4,0),l.write_shift(4,0),l}([d,p])),p.t&&p.t.length>0&&_e(l,637,qu(p)),_e(l,636),delete p.iauthor})}),_e(l,634),_e(l,629),l.end()}var vd=["xlsb","xlsm","xlam","biff8","xla"];var co=function(){var s=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,l={r:0,c:0};function a(f,p,d,h){var g=!1,y=!1;0==d.length?y=!0:"["==d.charAt(0)&&(y=!0,d=d.slice(1,-1)),0==h.length?g=!0:"["==h.charAt(0)&&(g=!0,h=h.slice(1,-1));var w=d.length>0?0|parseInt(d,10):0,S=h.length>0?0|parseInt(h,10):0;return g?S+=l.c:--S,y?w+=l.r:--w,p+(g?"":"$")+$t(S)+(y?"":"$")+lr(w)}return function(p,d){return l=d,p.replace(s,a)}}(),Hc=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Es=function(){return function(l,a){return l.replace(Hc,function(f,p,d,h,g,y){var w=ss(h)-(d?0:a.c),S=ln(y)-(g?0:a.r);return p+"R"+(0==S?"":g?S+1:"["+S+"]")+"C"+(0==w?"":d?w+1:"["+w+"]")})}}();function md(s,l){return s.replace(Hc,function(a,f,p,d,h,g){return f+("$"==p?p+d:$t(ss(d)+l.c))+("$"==h?h+g:lr(ln(g)+l.r))})}function gr(s){s.l+=1}function gn(s,l){var a=s.read_shift(1==l?1:2);return[16383&a,a>>14&1,a>>15&1]}function yd(s,l,a){var f=2;if(a){if(a.biff>=2&&a.biff<=5)return ql(s);12==a.biff&&(f=4)}var p=s.read_shift(f),d=s.read_shift(f),h=gn(s,2),g=gn(s,2);return{s:{r:p,c:h[0],cRel:h[1],rRel:h[2]},e:{r:d,c:g[0],cRel:g[1],rRel:g[2]}}}function ql(s){var l=gn(s,2),a=gn(s,2),f=s.read_shift(1),p=s.read_shift(1);return{s:{r:l[0],c:f,cRel:l[1],rRel:l[2]},e:{r:a[0],c:p,cRel:a[1],rRel:a[2]}}}function Cd(s,l,a){if(a&&a.biff>=2&&a.biff<=5)return function Vc(s){var l=gn(s,2),a=s.read_shift(1);return{r:l[0],c:a,cRel:l[1],rRel:l[2]}}(s);var f=s.read_shift(a&&12==a.biff?4:2),p=gn(s,2);return{r:f,c:p[0],cRel:p[1],rRel:p[2]}}function T0(s){var l=s.read_shift(2),a=s.read_shift(2);return{r:l,c:255&a,fQuoted:!!(16384&a),cRel:a>>15,rRel:a>>15}}function wd(s){var l=1&s[s.l+1];return s.l+=4,[l,1]}function Sd(s){return[s.read_shift(1),s.read_shift(1)]}function j0(s,l){var a=[s.read_shift(1)];if(12==l)switch(a[0]){case 2:a[0]=4;break;case 4:a[0]=16;break;case 0:a[0]=1;break;case 1:a[0]=2}switch(a[0]){case 4:a[1]=hr(s,1)?"TRUE":"FALSE",12!=l&&(s.l+=7);break;case 37:case 16:a[1]=ir[s[s.l]],s.l+=12==l?4:8;break;case 0:s.l+=8;break;case 1:a[1]=Tr(s);break;case 2:a[1]=Hn(s,0,{biff:l>0&&l<8?2:l});break;default:throw new Error("Bad SerAr: "+a[0])}return a}function z0(s,l,a){for(var f=s.read_shift(12==a.biff?4:2),p=[],d=0;d!=f;++d)p.push((12==a.biff?to:oa)(s,8));return p}function eu(s,l,a){var f=0,p=0;12==a.biff?(f=s.read_shift(4),p=s.read_shift(4)):(p=1+s.read_shift(1),f=1+s.read_shift(2)),a.biff>=2&&a.biff<8&&(--f,0==--p&&(p=256));for(var d=0,h=[];d!=f&&(h[d]=[]);++d)for(var g=0;g!=p;++g)h[d][g]=j0(s,a.biff);return h}function Sa(s,l,a){return s.l+=2,[T0(s)]}function Rs(s){return s.l+=6,[]}function xd(s){return s.l+=2,[vr(s),1&s.read_shift(2)]}var _a=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var Ed={1:{n:"PtgExp",f:function W0(s,l,a){return s.l++,a&&12==a.biff?[s.read_shift(4,"i"),0]:[s.read_shift(2),s.read_shift(a&&2==a.biff?1:2)]}},2:{n:"PtgTbl",f:Er},3:{n:"PtgAdd",f:gr},4:{n:"PtgSub",f:gr},5:{n:"PtgMul",f:gr},6:{n:"PtgDiv",f:gr},7:{n:"PtgPower",f:gr},8:{n:"PtgConcat",f:gr},9:{n:"PtgLt",f:gr},10:{n:"PtgLe",f:gr},11:{n:"PtgEq",f:gr},12:{n:"PtgGe",f:gr},13:{n:"PtgGt",f:gr},14:{n:"PtgNe",f:gr},15:{n:"PtgIsect",f:gr},16:{n:"PtgUnion",f:gr},17:{n:"PtgRange",f:gr},18:{n:"PtgUplus",f:gr},19:{n:"PtgUminus",f:gr},20:{n:"PtgPercent",f:gr},21:{n:"PtgParen",f:gr},22:{n:"PtgMissArg",f:gr},23:{n:"PtgStr",f:function mn(s,l,a){return s.l++,gs(s,0,a)}},26:{n:"PtgSheet",f:function ru(s,l,a){return s.l+=5,s.l+=2,s.l+=2==a.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function lm(s,l,a){return s.l+=2==a.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function Uc(s){return s.l++,ir[s.read_shift(1)]}},29:{n:"PtgBool",f:function U0(s){return s.l++,0!==s.read_shift(1)}},30:{n:"PtgInt",f:function jc(s){return s.l++,s.read_shift(2)}},31:{n:"PtgNum",f:function Ca(s){return s.l++,Tr(s)}},32:{n:"PtgArray",f:function Jl(s,l,a){var f=(96&s[s.l++])>>5;return s.l+=2==a.biff?6:12==a.biff?14:7,[f]}},33:{n:"PtgFunc",f:function ya(s,l,a){var f=(96&s[s.l])>>5;s.l+=1;var p=s.read_shift(a&&a.biff<=3?1:2);return[Sm[p],Zc[p],f]}},34:{n:"PtgFuncVar",f:function H0(s,l,a){var f=s[s.l++],p=s.read_shift(1),d=a&&a.biff<=3?[88==f?-1:0,s.read_shift(1)]:function B0(s){return[s[s.l+1]>>7,32767&s.read_shift(2)]}(s);return[p,(0===d[0]?Zc:wm)[d[1]]]}},35:{n:"PtgName",f:function K0(s,l,a){var f=s.read_shift(1)>>>5&3,p=!a||a.biff>=8?4:2,d=s.read_shift(p);switch(a.biff){case 2:s.l+=5;break;case 3:case 4:s.l+=8;break;case 5:s.l+=12}return[f,0,d]}},36:{n:"PtgRef",f:function k0(s,l,a){var f=(96&s[s.l])>>5;return s.l+=1,[f,Cd(s,0,a)]}},37:{n:"PtgArea",f:function A0(s,l,a){return[(96&s[s.l++])>>5,yd(s,a.biff>=2&&a.biff,a)]}},38:{n:"PtgMemArea",f:function X0(s,l,a){var f=s.read_shift(1)>>>5&3;return s.l+=a&&2==a.biff?3:4,[f,s.read_shift(a&&2==a.biff?1:2)]}},39:{n:"PtgMemErr",f:Er},40:{n:"PtgMemNoMem",f:Er},41:{n:"PtgMemFunc",f:function q0(s,l,a){return[s.read_shift(1)>>>5&3,s.read_shift(a&&2==a.biff?1:2)]}},42:{n:"PtgRefErr",f:function zc(s,l,a){var f=s.read_shift(1)>>>5&3;return s.l+=4,a.biff<8&&s.l--,12==a.biff&&(s.l+=2),[f]}},43:{n:"PtgAreaErr",f:function Vn(s,l,a){var f=(96&s[s.l++])>>5;return s.l+=a&&a.biff>8?12:a.biff<8?6:8,[f]}},44:{n:"PtgRefN",f:function Wc(s,l,a){var f=(96&s[s.l])>>5;s.l+=1;var p=function O0(s,l,a){var f=a&&a.biff?a.biff:8;if(f>=2&&f<=5)return function Ql(s){var l=s.read_shift(2),a=s.read_shift(1),f=(32768&l)>>15,p=(16384&l)>>14;return l&=16383,1==f&&l>=8192&&(l-=16384),1==p&&a>=128&&(a-=256),{r:l,c:a,cRel:p,rRel:f}}(s);var p=s.read_shift(f>=12?4:2),d=s.read_shift(2),h=(16384&d)>>14,g=(32768&d)>>15;if(d&=16383,1==g)for(;p>524287;)p-=1048576;if(1==h)for(;d>8191;)d-=16384;return{r:p,c:d,cRel:h,rRel:g}}(s,0,a);return[f,p]}},45:{n:"PtgAreaN",f:function F0(s,l,a){var f=(96&s[s.l++])>>5,p=function R0(s,l,a){if(a.biff<8)return ql(s);var f=s.read_shift(12==a.biff?4:2),p=s.read_shift(12==a.biff?4:2),d=gn(s,2),h=gn(s,2);return{s:{r:f,c:d[0],cRel:d[1],rRel:d[2]},e:{r:p,c:h[0],cRel:h[1],rRel:h[2]}}}(s,0,a);return[f,p]}},46:{n:"PtgMemAreaN",f:function um(s){return[s.read_shift(1)>>>5&3,s.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function cm(s){return[s.read_shift(1)>>>5&3,s.read_shift(2)]}},57:{n:"PtgNameX",f:function $0(s,l,a){return 5==a.biff?function Y0(s){var l=s.read_shift(1)>>>5&3,a=s.read_shift(2,"i");s.l+=8;var f=s.read_shift(2);return s.l+=12,[l,a,f]}(s):[s.read_shift(1)>>>5&3,s.read_shift(2),s.read_shift(4)]}},58:{n:"PtgRef3d",f:function G0(s,l,a){var f=(96&s[s.l])>>5;s.l+=1;var p=s.read_shift(2);return a&&5==a.biff&&(s.l+=12),[f,p,Cd(s,0,a)]}},59:{n:"PtgArea3d",f:function D0(s,l,a){var f=(96&s[s.l++])>>5,p=s.read_shift(2,"i");if(a)switch(a.biff){case 5:s.l+=12,6;break;case 12:12}return[f,p,yd(s,0,a)]}},60:{n:"PtgRefErr3d",f:function Q0(s,l,a){var f=(96&s[s.l++])>>5,p=s.read_shift(2),d=4;if(a)switch(a.biff){case 5:d=15;break;case 12:d=6}return s.l+=d,[f,p]}},61:{n:"PtgAreaErr3d",f:function b0(s,l,a){var f=(96&s[s.l++])>>5,p=s.read_shift(2),d=8;if(a)switch(a.biff){case 5:s.l+=12,d=6;break;case 12:d=12}return s.l+=d,[f,p]}},255:{}},Xi={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},pm={1:{n:"PtgElfLel",f:xd},2:{n:"PtgElfRw",f:Sa},3:{n:"PtgElfCol",f:Sa},6:{n:"PtgElfRwV",f:Sa},7:{n:"PtgElfColV",f:Sa},10:{n:"PtgElfRadical",f:Sa},11:{n:"PtgElfRadicalS",f:Rs},13:{n:"PtgElfColS",f:Rs},15:{n:"PtgElfColSV",f:Rs},16:{n:"PtgElfRadicalLel",f:xd},25:{n:"PtgList",f:function sm(s){s.l+=2;var l=s.read_shift(2),a=s.read_shift(2),f=s.read_shift(4),p=s.read_shift(2),d=s.read_shift(2);return{ixti:l,coltype:3&a,rt:_a[a>>2&31],idx:f,c:p,C:d}}},29:{n:"PtgSxName",f:function am(s){return s.l+=2,[s.read_shift(4)]}},255:{}},Kc={0:{n:"PtgAttrNoop",f:function fm(s){return s.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function Zl(s,l,a){var f=255&s[s.l+1]?1:0;return s.l+=a&&2==a.biff?3:4,[f]}},2:{n:"PtgAttrIf",f:function L0(s,l,a){var f=255&s[s.l+1]?1:0;return s.l+=2,[f,s.read_shift(a&&2==a.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function P0(s,l,a){s.l+=2;for(var f=s.read_shift(a&&2==a.biff?1:2),p=[],d=0;d<=f;++d)p.push(s.read_shift(a&&2==a.biff?1:2));return p}},8:{n:"PtgAttrGoto",f:function I0(s,l,a){var f=255&s[s.l+1]?1:0;return s.l+=2,[f,s.read_shift(a&&2==a.biff?1:2)]}},16:{n:"PtgAttrSum",f:function V0(s,l,a){s.l+=a&&2==a.biff?3:4}},32:{n:"PtgAttrBaxcel",f:wd},33:{n:"PtgAttrBaxcel",f:wd},64:{n:"PtgAttrSpace",f:function N0(s){return s.read_shift(2),Sd(s)}},65:{n:"PtgAttrSpaceSemi",f:function _d(s){return s.read_shift(2),Sd(s)}},128:{n:"PtgAttrIfError",f:function M0(s){var l=255&s[s.l+1]?1:0;return s.l+=2,[l,s.read_shift(2)]}},255:{}};function xa(s,l,a,f){if(f.biff<8)return Er(s,l);for(var p=s.l+l,d=[],h=0;h!==a.length;++h)switch(a[h][0]){case"PtgArray":a[h][1]=eu(s,0,f),d.push(a[h][1]);break;case"PtgMemArea":a[h][2]=z0(s,a[h][1],f),d.push(a[h][2]);break;case"PtgExp":f&&12==f.biff&&(a[h][1][1]=s.read_shift(4),d.push(a[h][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+a[h][0]}return 0!==(l=p-s.l)&&d.push(Er(s,l)),d}function Ea(s,l,a){for(var p,d,f=s.l+l,h=[];f!=s.l;)l=f-s.l,d=s[s.l],p=Ed[d]||Ed[Xi[d]],(24===d||25===d)&&(p=(24===d?pm:Kc)[s[s.l+1]]),p&&p.f?h.push([p.n,p.f(s,l,a)]):Er(s,l);return h}function dm(s){for(var l=[],a=0;a<s.length;++a){for(var f=s[a],p=[],d=0;d<f.length;++d){var h=f[d];if(h)if(2===h[0])p.push('"'+h[1].replace(/"/g,'""')+'"');else p.push(h[1]);else p.push("")}l.push(p.join(","))}return l.join(";")}var hm={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function $c(s,l,a){if(!s)return"SH33TJSERR0";if(a.biff>8&&(!s.XTI||!s.XTI[l]))return s.SheetNames[l];if(!s.XTI)return"SH33TJSERR6";var f=s.XTI[l];if(a.biff<8)return l>1e4&&(l-=65536),l<0&&(l=-l),0==l?"":s.XTI[l-1];if(!f)return"SH33TJSERR1";var p="";if(a.biff>8)switch(s[f[0]][0]){case 357:return p=-1==f[1]?"#REF":s.SheetNames[f[1]],f[1]==f[2]?p:p+":"+s.SheetNames[f[2]];case 358:return null!=a.SID?s.SheetNames[a.SID]:"SH33TJSSAME"+s[f[0]][0];default:return"SH33TJSSRC"+s[f[0]][0]}switch(s[f[0]][0][0]){case 1025:return p=-1==f[1]?"#REF":s.SheetNames[f[1]]||"SH33TJSERR3",f[1]==f[2]?p:p+":"+s.SheetNames[f[2]];case 14849:return s[f[0]].slice(1).map(function(d){return d.Name}).join(";;");default:return s[f[0]][0][3]?(p=-1==f[1]?"#REF":s[f[0]][0][3][f[1]]||"SH33TJSERR4",f[1]==f[2]?p:p+":"+s[f[0]][0][3][f[2]]):"SH33TJSERR2"}}function Rd(s,l,a){var f=$c(s,l,a);return"#REF"==f?f:function vm(s,l){if(!(s||l&&l.biff<=5&&l.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(s)?"'"+s+"'":s}(f,a)}function $r(s,l,a,f,p){var y,w,S,T,d=p&&p.biff||8,h={s:{c:0,r:0},e:{c:0,r:0}},g=[],E=0,R=0,A="";if(!s[0]||!s[0][0])return"";for(var x=-1,b="",H=0,G=s[0].length;H<G;++H){var N=s[0][H];switch(N[0]){case"PtgUminus":g.push("-"+g.pop());break;case"PtgUplus":g.push("+"+g.pop());break;case"PtgPercent":g.push(g.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(y=g.pop(),w=g.pop(),x>=0){switch(s[0][x][1][0]){case 0:b=Qt(" ",s[0][x][1][1]);break;case 1:b=Qt("\r",s[0][x][1][1]);break;default:if(b="",p.WTF)throw new Error("Unexpected PtgAttrSpaceType "+s[0][x][1][0])}w+=b,x=-1}g.push(w+hm[N[0]]+y);break;case"PtgIsect":y=g.pop(),w=g.pop(),g.push(w+" "+y);break;case"PtgUnion":y=g.pop(),w=g.pop(),g.push(w+","+y);break;case"PtgRange":y=g.pop(),w=g.pop(),g.push(w+":"+y);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":S=Eo(N[1][1],h,p),g.push(Ro(S,d));break;case"PtgRefN":S=a?Eo(N[1][1],a,p):N[1][1],g.push(Ro(S,d));break;case"PtgRef3d":E=N[1][1],S=Eo(N[1][2],h,p);A=Rd(f,E,p);g.push(A+"!"+Ro(S,d));break;case"PtgFunc":case"PtgFuncVar":var ie=N[1][0],ce=N[1][1];ie||(ie=0);var K=0==(ie&=127)?[]:g.slice(-ie);g.length-=ie,"User"===ce&&(ce=K.shift()),g.push(ce+"("+K.join(",")+")");break;case"PtgBool":g.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":g.push(N[1]);break;case"PtgNum":g.push(String(N[1]));break;case"PtgStr":g.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":T=ns(N[1][1],a?{s:a}:h,p),g.push(os(T,p));break;case"PtgArea":T=ns(N[1][1],h,p),g.push(os(T,p));break;case"PtgArea3d":E=N[1][1],T=N[1][2],A=Rd(f,E,p),g.push(A+"!"+os(T,p));break;case"PtgAttrSum":g.push("SUM("+g.pop()+")");break;case"PtgName":R=N[1][2];var te=(f.names||[])[R-1]||(f[0]||[])[R],J=te?te.Name:"SH33TJSNAME"+String(R);J&&"_xlfn."==J.slice(0,6)&&!p.xlfn&&(J=J.slice(6)),g.push(J);break;case"PtgNameX":var he,fe=N[1][1];if(R=N[1][2],!(p.biff<=5)){var ee="";if(14849==((f[fe]||[])[0]||[])[0]||(1025==((f[fe]||[])[0]||[])[0]?f[fe][R]&&f[fe][R].itab>0&&(ee=f.SheetNames[f[fe][R].itab-1]+"!"):ee=f.SheetNames[R-1]+"!"),f[fe]&&f[fe][R])ee+=f[fe][R].Name;else if(f[0]&&f[0][R])ee+=f[0][R].Name;else{var Ie=($c(f,fe,p)||"").split(";;");Ie[R-1]?ee=Ie[R-1]:ee+="SH33TJSERRX"}g.push(ee);break}fe<0&&(fe=-fe),f[fe]&&(he=f[fe][R]),he||(he={Name:"SH33TJSERRY"}),g.push(he.Name);break;case"PtgParen":var Ke="(",ke=")";if(x>=0){switch(b="",s[0][x][1][0]){case 2:Ke=Qt(" ",s[0][x][1][1])+Ke;break;case 3:Ke=Qt("\r",s[0][x][1][1])+Ke;break;case 4:ke=Qt(" ",s[0][x][1][1])+ke;break;case 5:ke=Qt("\r",s[0][x][1][1])+ke;break;default:if(p.WTF)throw new Error("Unexpected PtgAttrSpaceType "+s[0][x][1][0])}x=-1}g.push(Ke+g.pop()+ke);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":g.push("#REF!");break;case"PtgExp":S={c:N[1][1],r:N[1][0]};var ut={c:a.c,r:a.r};if(f.sharedf[at(S)]){var Qe=f.sharedf[at(S)];g.push($r(Qe,h,ut,f,p))}else{var Ot=!1;for(y=0;y!=f.arrayf.length;++y)if(w=f.arrayf[y],!(S.c<w[0].s.c||S.c>w[0].e.c||S.r<w[0].s.r||S.r>w[0].e.r)){g.push($r(w[1],h,ut,f,p)),Ot=!0;break}Ot||g.push(N[1])}break;case"PtgArray":g.push("{"+dm(N[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=H;break;case"PtgMissArg":g.push("");break;case"PtgList":g.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(N))}if(3!=p.biff&&x>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(s[0][H][0])){var pt=!0;switch((N=s[0][x])[1][0]){case 4:pt=!1;case 0:b=Qt(" ",N[1][1]);break;case 5:pt=!1;case 1:b=Qt("\r",N[1][1]);break;default:if(b="",p.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}g.push((pt?b:"")+g.pop()+(pt?"":b)),x=-1}}if(g.length>1&&p.WTF)throw new Error("bad formula stack");return g[0]}function iu(s,l,a,f,p){var d=oo(l,a,p),h=function qc(s){if(null==s){var l=de(8);return l.write_shift(1,3),l.write_shift(1,0),l.write_shift(2,0),l.write_shift(2,0),l.write_shift(2,65535),l}return To("number"==typeof s?s:0)}(s.v),g=de(6);g.write_shift(2,33),g.write_shift(4,0);for(var w=de(s.bf.length),S=0;S<s.bf.length;++S)w[S]=s.bf[S];return fr([d,h,g,w])}function nu(s,l,a){var f=s.read_shift(4),p=Ea(s,f,a),d=s.read_shift(4);return[p,d>0?xa(s,d,p,a):null]}var ym=nu,ou=nu,Jc=nu,Cm=nu,wm={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Zc={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Sm={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function _m(s){return("of:="+s.replace(Hc,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function xm(s){return s.replace(/\./,"!")}var Ra=typeof Map<"u";function Os(s,l,a){var f=0,p=s.length;if(a){if(Ra?a.has(l):Object.prototype.hasOwnProperty.call(a,l))for(var d=Ra?a.get(l):a[l];f<d.length;++f)if(s[d[f]].t===l)return s.Count++,d[f]}else for(;f<p;++f)if(s[f].t===l)return s.Count++,f;return s[p]={t:l},s.Count++,s.Unique++,a&&(Ra?(a.has(l)||a.set(l,[]),a.get(l).push(p)):(Object.prototype.hasOwnProperty.call(a,l)||(a[l]=[]),a[l].push(p))),p}function au(s,l){var a={min:s+1,max:s+1},f=-1;return l.MDW&&(Wr=l.MDW),null!=l.width?a.customWidth=1:null!=l.wpx?f=va(l.wpx):null!=l.wch&&(f=l.wch),f>-1?(a.width=Ul(f),a.customWidth=1):null!=l.width&&(a.width=l.width),l.hidden&&(a.hidden=!0),null!=l.level&&(a.outlineLevel=a.level=l.level),a}function Bo(s,l){if(s){var a=[.7,.7,.75,.75,.3,.3];"xlml"==l&&(a=[1,1,1,1,.5,.5]),null==s.left&&(s.left=a[0]),null==s.right&&(s.right=a[1]),null==s.top&&(s.top=a[2]),null==s.bottom&&(s.bottom=a[3]),null==s.header&&(s.header=a[4]),null==s.footer&&(s.footer=a[5])}}function oi(s,l,a){var f=a.revssf[null!=l.z?l.z:"General"],p=60,d=s.length;if(null==f&&a.ssf)for(;p<392;++p)if(null==a.ssf[p]){Bi(l.z,p),a.ssf[p]=l.z,a.revssf[l.z]=f=p;break}for(p=0;p!=d;++p)if(s[p].numFmtId===f)return p;return s[d]={numFmtId:f,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},d}function Rm(s,l,a){if(s&&s["!ref"]){var f=Ct(s["!ref"]);if(f.e.c<f.s.c||f.e.r<f.s.r)throw new Error("Bad range ("+a+"): "+s["!ref"])}}var Oa=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Mm=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function ba(s,l,a,f){if(s.c&&a["!comments"].push([l,s.c]),void 0===s.v&&"string"!=typeof s.f||"z"===s.t&&!s.f)return"";var p="",d=s.t,h=s.v;if("z"!==s.t)switch(s.t){case"b":p=s.v?"1":"0";break;case"n":p=""+s.v;break;case"e":p=ir[s.v];break;case"d":f&&f.cellDates?p=rr(s.v,-1).toISOString():((s=Bt(s)).t="n",p=""+(s.v=Cr(rr(s.v)))),typeof s.z>"u"&&(s.z=ot[14]);break;default:p=s.v}var g=Hr("v",kt(p)),y={r:l},w=oi(f.cellXfs,s,f);switch(0!==w&&(y.s=w),s.t){case"n":case"z":break;case"d":y.t="d";break;case"b":y.t="b";break;case"e":y.t="e";break;default:if(null==s.v){delete s.t;break}if(s.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(f&&f.bookSST){g=Hr("v",""+Os(f.Strings,s.v,f.revStrings)),y.t="s";break}y.t="str"}if(s.t!=d&&(s.t=d,s.v=h),"string"==typeof s.f&&s.f){var S=s.F&&s.F.slice(0,l.length)==l?{t:"array",ref:s.F}:null;g=Ae("f",kt(s.f),S)+(null!=s.v?g:"")}return s.l&&a["!links"].push([l,s.l]),s.D&&(y.cm=1),Ae("c",g,y)}function Pd(s,l,a,f){var h,p=[sr,Ae("worksheet",null,{xmlns:Fn[0],"xmlns:r":ar.r})],d=a.SheetNames[s],g="",y=a.Sheets[d];null==y&&(y={});var w=y["!ref"]||"A1",S=Ct(w);if(S.e.c>16383||S.e.r>1048575){if(l.WTF)throw new Error("Range "+w+" exceeds format limit A1:XFD1048576");S.e.c=Math.min(S.e.c,16383),S.e.r=Math.min(S.e.c,1048575),w=lt(S)}f||(f={}),y["!comments"]=[];var E=[];(function bd(s,l,a,f,p){var d=!1,h={},g=null;if("xlsx"!==f.bookType&&l.vbaraw){var y=l.SheetNames[a];try{l.Workbook&&(y=l.Workbook.Sheets[a].CodeName||y)}catch{}d=!0,h.codeName=ji(kt(y))}if(s&&s["!outline"]){var w={summaryBelow:1,summaryRight:1};s["!outline"].above&&(w.summaryBelow=0),s["!outline"].left&&(w.summaryRight=0),g=(g||"")+Ae("outlinePr",null,w)}!d&&!g||(p[p.length]=Ae("sheetPr",g,h))})(y,a,s,l,p),p[p.length]=Ae("dimension",null,{ref:w}),p[p.length]=function Vm(s,l,a,f){var p={workbookViewId:"0"};return(((f||{}).Workbook||{}).Views||[])[0]&&(p.rightToLeft=f.Workbook.Views[0].RTL?"1":"0"),Ae("sheetViews",Ae("sheetView",null,p),{})}(0,0,0,a),l.sheetFormat&&(p[p.length]=Ae("sheetFormatPr",null,{defaultRowHeight:l.sheetFormat.defaultRowHeight||"16",baseColWidth:l.sheetFormat.baseColWidth||"10",outlineLevelRow:l.sheetFormat.outlineLevelRow||"7"})),null!=y["!cols"]&&y["!cols"].length>0&&(p[p.length]=function Gm(s,l){for(var f,a=["<cols>"],p=0;p!=l.length;++p)(f=l[p])&&(a[a.length]=Ae("col",null,au(p,f)));return a[a.length]="</cols>",a.join("")}(0,y["!cols"])),p[h=p.length]="<sheetData/>",y["!links"]=[],null!=y["!ref"]&&(g=function Fa(s,l,a,f){var y,b,p=[],d=[],h=Ct(s["!ref"]),g="",w="",S=[],E=0,R=0,T=s["!rows"],A=Array.isArray(s),x={r:w},H=-1;for(R=h.s.c;R<=h.e.c;++R)S[R]=$t(R);for(E=h.s.r;E<=h.e.r;++E){for(d=[],w=lr(E),R=h.s.c;R<=h.e.c;++R){y=S[R]+w;var G=A?(s[E]||[])[R]:s[y];void 0!==G&&null!=(g=ba(G,y,s,l))&&d.push(g)}(d.length>0||T&&T[E])&&(x={r:w},T&&T[E]&&((b=T[E]).hidden&&(x.hidden=1),H=-1,b.hpx?H=lo(b.hpx):b.hpt&&(H=b.hpt),H>-1&&(x.ht=H,x.customHeight=1),b.level&&(x.outlineLevel=b.level)),p[p.length]=Ae("row",d.join(""),x))}if(T)for(;E<T.length;++E)T&&T[E]&&(x={r:E+1},(b=T[E]).hidden&&(x.hidden=1),H=-1,b.hpx?H=lo(b.hpx):b.hpt&&(H=b.hpt),H>-1&&(x.ht=H,x.customHeight=1),b.level&&(x.outlineLevel=b.level),p[p.length]=Ae("row","",x));return p.join("")}(y,l,0,0),g.length>0&&(p[p.length]=g)),p.length>h+1&&(p[p.length]="</sheetData>",p[h]=p[h].replace("/>",">")),y["!protect"]&&(p[p.length]=function Aa(s){var l={sheet:1};return Oa.forEach(function(a){null!=s[a]&&s[a]&&(l[a]="1")}),Mm.forEach(function(a){null!=s[a]&&!s[a]&&(l[a]="0")}),s.password&&(l.password=Dc(s.password).toString(16).toUpperCase()),Ae("sheetProtection",null,l)}(y["!protect"])),null!=y["!autofilter"]&&(p[p.length]=function Da(s,l,a,f){var p="string"==typeof s.ref?s.ref:lt(s.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var d=a.Workbook.Names,h=mr(p);h.s.r==h.e.r&&(h.e.r=mr(l["!ref"]).e.r,p=lt(h));for(var g=0;g<d.length;++g){var y=d[g];if("_xlnm._FilterDatabase"==y.Name&&y.Sheet==f){y.Ref="'"+a.SheetNames[f]+"'!"+p;break}}return g==d.length&&d.push({Name:"_xlnm._FilterDatabase",Sheet:f,Ref:"'"+a.SheetNames[f]+"'!"+p}),Ae("autoFilter",null,{ref:p})}(y["!autofilter"],y,a,s)),null!=y["!merges"]&&y["!merges"].length>0&&(p[p.length]=function Im(s){if(0===s.length)return"";for(var l='<mergeCells count="'+s.length+'">',a=0;a!=s.length;++a)l+='<mergeCell ref="'+lt(s[a])+'"/>';return l+"</mergeCells>"}(y["!merges"]));var T,R=-1,A=-1;return y["!links"].length>0&&(p[p.length]="<hyperlinks>",y["!links"].forEach(function(x){x[1].Target&&(T={ref:x[0]},"#"!=x[1].Target.charAt(0)&&(A=Ue(f,-1,kt(x[1].Target).replace(/#.*$/,""),gt.HLINK),T["r:id"]="rId"+A),(R=x[1].Target.indexOf("#"))>-1&&(T.location=kt(x[1].Target.slice(R+1))),x[1].Tooltip&&(T.tooltip=kt(x[1].Tooltip)),p[p.length]=Ae("hyperlink",null,T))}),p[p.length]="</hyperlinks>"),delete y["!links"],null!=y["!margins"]&&(p[p.length]=function uu(s){return Bo(s),Ae("pageMargins",null,s)}(y["!margins"])),(!l||l.ignoreEC||null==l.ignoreEC)&&(p[p.length]=Hr("ignoredErrors",Ae("ignoredError",null,{numberStoredAsText:1,sqref:w}))),E.length>0&&(A=Ue(f,-1,"../drawings/drawing"+(s+1)+".xml",gt.DRAW),p[p.length]=Ae("drawing",null,{"r:id":"rId"+A}),y["!drawing"]=E),y["!comments"].length>0&&(A=Ue(f,-1,"../drawings/vmlDrawing"+(s+1)+".vml",gt.VML),p[p.length]=Ae("legacyDrawing",null,{"r:id":"rId"+A}),y["!legacy"]=A),p.length>1&&(p[p.length]="</worksheet>",p[1]=p[1].replace("/>",">")),p.join("")}function jm(s,l,a,f){var p=function fo(s,l,a){var f=de(145),p=(a["!rows"]||[])[s]||{};f.write_shift(4,s),f.write_shift(4,0);var d=320;p.hpx?d=20*lo(p.hpx):p.hpt&&(d=20*p.hpt),f.write_shift(2,d),f.write_shift(1,0);var h=0;p.level&&(h|=p.level),p.hidden&&(h|=16),(p.hpx||p.hpt)&&(h|=32),f.write_shift(1,h),f.write_shift(1,0);var g=0,y=f.l;f.l+=4;for(var w={r:s,c:0},S=0;S<16;++S)if(!(l.s.c>S+1<<10||l.e.c<S<<10)){for(var E=-1,R=-1,T=S<<10;T<S+1<<10;++T)w.c=T,(Array.isArray(a)?(a[w.r]||[])[w.c]:a[at(w)])&&(E<0&&(E=T),R=T);E<0||(++g,f.write_shift(4,E),f.write_shift(4,R))}var x=f.l;return f.l=y,f.write_shift(4,g),f.l=x,f.length>f.l?f.slice(0,f.l):f}(f,a,l);(p.length>17||(l["!rows"]||[])[f])&&_e(s,0,p)}var zm=to,Km=fn;function Ld(s){return[Nn(s),Tr(s),"n"]}var of=to,my=fn;var Na=["left","right","top","bottom","header","footer"];function af(s,l,a,f,p,d,h){if(void 0===l.v)return!1;var g="";switch(l.t){case"b":g=l.v?"1":"0";break;case"d":(l=Bt(l)).z=l.z||ot[14],l.v=Cr(rr(l.v)),l.t="n";break;case"n":case"e":g=""+l.v;break;default:g=l.v}var y={r:a,c:f};switch(y.s=oi(p.cellXfs,l,p),l.l&&d["!links"].push([at(y),l.l]),l.c&&d["!comments"].push([at(y),l.c]),l.t){case"s":case"str":return p.bookSST?(g=Os(p.Strings,l.v,p.revStrings),y.t="s",y.v=g,h?_e(s,18,function ny(s,l,a){return null==a&&(a=de(8)),eo(l,a),a.write_shift(4,l.v),a}(0,y)):_e(s,7,function Ia(s,l,a){return null==a&&(a=de(12)),Mn(l,a),a.write_shift(4,l.v),a}(0,y))):(y.t="str",h?_e(s,17,function dy(s,l,a){return null==a&&(a=de(8+4*s.v.length)),eo(l,a),Rr(s.v,a),a.length>a.l?a.slice(0,a.l):a}(l,y)):_e(s,6,function fy(s,l,a){return null==a&&(a=de(12+4*s.v.length)),Mn(l,a),Rr(s.v,a),a.length>a.l?a.slice(0,a.l):a}(l,y))),!0;case"n":return l.v==(0|l.v)&&l.v>-1e3&&l.v<1e3?h?_e(s,13,function Md(s,l,a){return null==a&&(a=de(8)),eo(l,a),El(s.v,a),a}(l,y)):_e(s,2,function ay(s,l,a){return null==a&&(a=de(12)),Mn(l,a),El(s.v,a),a}(l,y)):h?_e(s,16,function sy(s,l,a){return null==a&&(a=de(12)),eo(l,a),To(s.v,a),a}(l,y)):_e(s,5,function nf(s,l,a){return null==a&&(a=de(16)),Mn(l,a),To(s.v,a),a}(l,y)),!0;case"b":return y.t="b",h?_e(s,15,function Zm(s,l,a){return null==a&&(a=de(5)),eo(l,a),a.write_shift(1,s.v?1:0),a}(l,y)):_e(s,4,function Qm(s,l,a){return null==a&&(a=de(9)),Mn(l,a),a.write_shift(1,s.v?1:0),a}(l,y)),!0;case"e":return y.t="e",h?_e(s,14,function ry(s,l,a){return null==a&&(a=de(8)),eo(l,a),a.write_shift(1,s.v),a.write_shift(2,0),a.write_shift(1,0),a}(l,y)):_e(s,3,function ey(s,l,a){return null==a&&(a=de(9)),Mn(l,a),a.write_shift(1,s.v),a}(l,y)),!0}return h?_e(s,12,function Ds(s,l,a){return null==a&&(a=de(4)),eo(l,a)}(0,y)):_e(s,1,function Id(s,l,a){return null==a&&(a=de(8)),Mn(l,a)}(0,y)),!0}function by(s,l){!l||!l["!merges"]||(_e(s,177,function bs(s,l){return null==l&&(l=de(4)),l.write_shift(4,s),l}(l["!merges"].length)),l["!merges"].forEach(function(a){_e(s,176,my(a))}),_e(s,178))}function Gd(s,l){!l||!l["!cols"]||(_e(s,390),l["!cols"].forEach(function(a,f){a&&_e(s,60,function kd(s,l,a){null==a&&(a=de(18));var f=au(s,l);a.write_shift(-4,s),a.write_shift(-4,s),a.write_shift(4,256*(f.width||10)),a.write_shift(4,0);var p=0;return l.hidden&&(p|=1),"number"==typeof f.width&&(p|=2),l.level&&(p|=l.level<<8),a.write_shift(2,p),a}(f,a))}),_e(s,391))}function Fy(s,l){!l||!l["!ref"]||(_e(s,648),_e(s,649,function Ry(s){var l=de(24);return l.write_shift(4,4),l.write_shift(4,1),fn(s,l),l}(Ct(l["!ref"]))),_e(s,650))}function Py(s,l,a){l["!links"].forEach(function(f){if(f[1].Target){var p=Ue(a,-1,f[1].Target.replace(/#.*$/,""),gt.HLINK);_e(s,494,function Cy(s,l){var a=de(50+4*(s[1].Target.length+(s[1].Tooltip||"").length));fn({s:Ze(s[0]),e:Ze(s[0])},a),Qu("rId"+l,a);var f=s[1].Target.indexOf("#");return Rr((-1==f?"":s[1].Target.slice(f+1))||"",a),Rr(s[1].Tooltip||"",a),Rr("",a),a.slice(0,a.l)}(f,p))}}),delete l["!links"]}function Ly(s,l,a){_e(s,133),_e(s,137,function Ey(s,l,a){null==a&&(a=de(30));var f=924;return(((l||{}).Views||[])[0]||{}).RTL&&(f|=32),a.write_shift(2,f),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(2,0),a.write_shift(2,100),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(4,0),a}(0,a)),_e(s,138),_e(s,134)}function Hd(s,l){l["!protect"]&&_e(s,535,function Ty(s,l){return null==l&&(l=de(66)),l.write_shift(2,s.password?Dc(s.password):0),l.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(a){a[1]?l.write_shift(4,null==s[a[0]]||s[a[0]]?0:1):l.write_shift(4,null!=s[a[0]]&&s[a[0]]?0:1)}),l}(l["!protect"]))}function My(s,l,a,f){var p=ri(),d=a.SheetNames[s],h=a.Sheets[d]||{},g=d;try{a&&a.Workbook&&(g=a.Workbook.Sheets[s].CodeName||g)}catch{}var y=Ct(h["!ref"]||"A1");if(y.e.c>16383||y.e.r>1048575){if(l.WTF)throw new Error("Range "+(h["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");y.e.c=Math.min(y.e.c,16383),y.e.r=Math.min(y.e.c,1048575)}return h["!links"]=[],h["!comments"]=[],_e(p,129),(a.vbaraw||h["!outline"])&&_e(p,147,function $m(s,l,a){null==a&&(a=de(84+4*s.length));var f=192;l&&(l.above&&(f&=-65),l.left&&(f&=-129)),a.write_shift(1,f);for(var p=1;p<3;++p)a.write_shift(1,0);return ii({auto:1},a),a.write_shift(-4,-1),a.write_shift(-4,-1),_l(s,a),a.slice(0,a.l)}(g,h["!outline"])),_e(p,148,Km(y)),Ly(p,0,a.Workbook),Gd(p,h),function Dy(s,l,a,f){var d,p=Ct(l["!ref"]||"A1"),h="",g=[];_e(s,145);var y=Array.isArray(l),w=p.e.r;l["!rows"]&&(w=Math.max(p.e.r,l["!rows"].length-1));for(var S=p.s.r;S<=w;++S){h=lr(S),jm(s,l,p,S);var E=!1;if(S<=p.e.r)for(var R=p.s.c;R<=p.e.c;++R){S===p.s.r&&(g[R]=$t(R)),d=g[R]+h;var T=y?(l[S]||[])[R]:l[d];E=!!T&&af(s,T,S,R,f,l,E)}}_e(s,146)}(p,h,0,l),Hd(p,h),function Iy(s,l,a,f){if(l["!autofilter"]){var p=l["!autofilter"],d="string"==typeof p.ref?p.ref:lt(p.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var h=a.Workbook.Names,g=mr(d);g.s.r==g.e.r&&(g.e.r=mr(l["!ref"]).e.r,d=lt(g));for(var y=0;y<h.length;++y){var w=h[y];if("_xlnm._FilterDatabase"==w.Name&&w.Sheet==f){w.Ref="'"+a.SheetNames[f]+"'!"+d;break}}y==h.length&&h.push({Name:"_xlnm._FilterDatabase",Sheet:f,Ref:"'"+a.SheetNames[f]+"'!"+d}),_e(s,161,fn(Ct(d))),_e(s,162)}}(p,h,a,s),by(p,h),Py(p,h,f),h["!margins"]&&_e(p,476,function _y(s,l){return null==l&&(l=de(48)),Bo(s),Na.forEach(function(a){To(s[a],l)}),l}(h["!margins"])),(!l||l.ignoreEC||null==l.ignoreEC)&&Fy(p,h),function fu(s,l,a,f){if(l["!comments"].length>0){var p=Ue(f,-1,"../drawings/vmlDrawing"+(a+1)+".vml",gt.VML);_e(s,551,Qu("rId"+p)),l["!legacy"]=p}}(p,h,s,f),_e(p,130),p.end()}var cf=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];var Wy="][*?/\\".split("");function Ud(s,l){if(s.length>31){if(l)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var a=!0;return Wy.forEach(function(f){if(-1!=s.indexOf(f)){if(!l)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");a=!1}}),a}function jd(s){if(!s||!s.SheetNames||!s.Sheets)throw new Error("Invalid Workbook");if(!s.SheetNames.length)throw new Error("Workbook is empty");var l=s.Workbook&&s.Workbook.Sheets||[];!function hu(s,l,a){s.forEach(function(f,p){Ud(f);for(var d=0;d<p;++d)if(f==s[d])throw new Error("Duplicate Sheet Name: "+f);if(a){var h=l&&l[p]&&l[p].CodeName||f;if(95==h.charCodeAt(0)&&h.length>22)throw new Error("Bad Code Name: Worksheet"+h)}})}(s.SheetNames,l,!!s.vbaraw);for(var a=0;a<s.SheetNames.length;++a)Rm(s.Sheets[s.SheetNames[a]],s.SheetNames[a],a)}function pf(s){var l=[sr];l[l.length]=Ae("workbook",null,{xmlns:Fn[0],"xmlns:r":ar.r});var a=s.Workbook&&(s.Workbook.Names||[]).length>0,f={codeName:"ThisWorkbook"};s.Workbook&&s.Workbook.WBProps&&(cf.forEach(function(g){null!=s.Workbook.WBProps[g[0]]&&s.Workbook.WBProps[g[0]]!=g[1]&&(f[g[0]]=s.Workbook.WBProps[g[0]])}),s.Workbook.WBProps.CodeName&&(f.codeName=s.Workbook.WBProps.CodeName,delete f.CodeName)),l[l.length]=Ae("workbookPr",null,f);var p=s.Workbook&&s.Workbook.Sheets||[],d=0;if(p&&p[0]&&p[0].Hidden){for(l[l.length]="<bookViews>",d=0;d!=s.SheetNames.length&&p[d]&&p[d].Hidden;++d);d==s.SheetNames.length&&(d=0),l[l.length]='<workbookView firstSheet="'+d+'" activeTab="'+d+'"/>',l[l.length]="</bookViews>"}for(l[l.length]="<sheets>",d=0;d!=s.SheetNames.length;++d){var h={name:kt(s.SheetNames[d].slice(0,31))};if(h.sheetId=""+(d+1),h["r:id"]="rId"+(d+1),p[d])switch(p[d].Hidden){case 1:h.state="hidden";break;case 2:h.state="veryHidden"}l[l.length]=Ae("sheet",null,h)}return l[l.length]="</sheets>",a&&(l[l.length]="<definedNames>",s.Workbook&&s.Workbook.Names&&s.Workbook.Names.forEach(function(g){var y={name:g.Name};g.Comment&&(y.comment=g.Comment),null!=g.Sheet&&(y.localSheetId=""+g.Sheet),g.Hidden&&(y.hidden="1"),g.Ref&&(l[l.length]=Ae("definedName",kt(g.Ref),y))}),l[l.length]="</definedNames>"),l.length>2&&(l[l.length]="</workbook>",l[1]=l[1].replace("/>",">")),l.join("")}function Ky(s,l){return l||(l=de(127)),l.write_shift(4,s.Hidden),l.write_shift(4,s.iTabID),Qu(s.strRelID,l),Rr(s.name.slice(0,31),l),l.length>l.l?l.slice(0,l.l):l}function Qy(s,l){if(l.Workbook&&l.Workbook.Sheets){for(var a=l.Workbook.Sheets,f=0,p=-1,d=-1;f<a.length;++f)!a[f]||!a[f].Hidden&&-1==p?p=f:1==a[f].Hidden&&-1==d&&(d=f);d>p||(_e(s,135),_e(s,158,function vu(s,l){return l||(l=de(29)),l.write_shift(-4,0),l.write_shift(-4,460),l.write_shift(4,28800),l.write_shift(4,17600),l.write_shift(4,500),l.write_shift(4,s),l.write_shift(4,s),l.write_shift(1,120),l.length>l.l?l.slice(0,l.l):l}(p)),_e(s,136))}}function Jy(s,l){var a=ri();return _e(a,131),_e(a,128,function qy(s,l){l||(l=de(127));for(var a=0;4!=a;++a)l.write_shift(4,0);return Rr("SheetJS",l),Rr(Se.version,l),Rr(Se.version,l),Rr("7262",l),l.length>l.l?l.slice(0,l.l):l}()),_e(a,153,function $y(s,l){l||(l=de(72));var a=0;return s&&s.filterPrivacy&&(a|=8),l.write_shift(4,a),l.write_shift(4,0),_l(s&&s.CodeName||"ThisWorkbook",l),l.slice(0,l.l)}(s.Workbook&&s.Workbook.WBProps||null)),Qy(a,s),function Xy(s,l){_e(s,143);for(var a=0;a!=l.SheetNames.length;++a)_e(s,156,Ky({Hidden:l.Workbook&&l.Workbook.Sheets&&l.Workbook.Sheets[a]&&l.Workbook.Sheets[a].Hidden||0,iTabID:a+1,strRelID:"rId"+(a+1),name:l.SheetNames[a]}));_e(s,144)}(a,s),_e(a,132),a.end()}function hf(s,l,a,f,p){return(".bin"===l.slice(-4)?My:Pd)(s,a,f,p)}function vf(s,l,a){return(".bin"===l.slice(-4)?w0:dd)(s,a)}function Va(s,l){var a=[];return s.Props&&a.push(function Fl(s,l){var a=[];return qt(bl).map(function(f){for(var p=0;p<Gn.length;++p)if(Gn[p][1]==f)return Gn[p];for(p=0;p<Ao.length;++p)if(Ao[p][1]==f)return Ao[p];throw f}).forEach(function(f){if(null!=s[f[1]]){var p=l&&l.Props&&null!=l.Props[f[1]]?l.Props[f[1]]:s[f[1]];"date"===f[2]&&(p=new Date(p).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof p?p=String(p):!0===p||!1===p?p=p?"1":"0":p instanceof Date&&(p=new Date(p).toISOString().replace(/\.\d*Z/,"")),a.push(Hr(bl[f[1]]||f[1],p))}}),Ae("DocumentProperties",a.join(""),{xmlns:ai.o})}(s.Props,l)),s.Custprops&&a.push(function $h(s,l){var a=["Worksheets","SheetNames"],f="CustomDocumentProperties",p=[];return s&&qt(s).forEach(function(d){if(Object.prototype.hasOwnProperty.call(s,d)){for(var h=0;h<Gn.length;++h)if(d==Gn[h][1])return;for(h=0;h<Ao.length;++h)if(d==Ao[h][1])return;for(h=0;h<a.length;++h)if(d==a[h])return;var g=s[d],y="string";"number"==typeof g?(y="float",g=String(g)):!0===g||!1===g?(y="boolean",g=g?"1":"0"):g=String(g),p.push(Ae(Yf(d),g,{"dt:dt":y}))}}),l&&qt(l).forEach(function(d){if(Object.prototype.hasOwnProperty.call(l,d)&&(!s||!Object.prototype.hasOwnProperty.call(s,d))){var h=l[d],g="string";"number"==typeof h?(g="float",h=String(h)):!0===h||!1===h?(g="boolean",h=h?"1":"0"):h instanceof Date?(g="dateTime.tz",h=h.toISOString()):h=String(h),p.push(Ae(Yf(d),h,{"dt:dt":g}))}}),"<"+f+' xmlns="'+ai.o+'">'+p.join("")+"</"+f+">"}(s.Props,s.Custprops)),a.join("")}function Cu(s){return Ae("NamedRange",null,{"ss:Name":s.Name,"ss:RefersTo":"="+Es(s.Ref,{r:0,c:0})})}function mf(s,l,a,f,p,d,h){if(!s||null==s.v&&null==s.f)return"";var g={};if(s.f&&(g["ss:Formula"]="="+kt(Es(s.f,h))),s.F&&s.F.slice(0,l.length)==l){var y=Ze(s.F.slice(l.length+1));g["ss:ArrayRange"]="RC:R"+(y.r==h.r?"":"["+(y.r-h.r)+"]")+"C"+(y.c==h.c?"":"["+(y.c-h.c)+"]")}if(s.l&&s.l.Target&&(g["ss:HRef"]=kt(s.l.Target),s.l.Tooltip&&(g["x:HRefScreenTip"]=kt(s.l.Tooltip))),a["!merges"])for(var w=a["!merges"],S=0;S!=w.length;++S)w[S].s.c!=h.c||w[S].s.r!=h.r||(w[S].e.c>w[S].s.c&&(g["ss:MergeAcross"]=w[S].e.c-w[S].s.c),w[S].e.r>w[S].s.r&&(g["ss:MergeDown"]=w[S].e.r-w[S].s.r));var E="",R="";switch(s.t){case"z":if(!f.sheetStubs)return"";break;case"n":E="Number",R=String(s.v);break;case"b":E="Boolean",R=s.v?"1":"0";break;case"e":E="Error",R=ir[s.v];break;case"d":E="DateTime",R=new Date(s.v).toISOString(),null==s.z&&(s.z=s.z||ot[14]);break;case"s":E="String",R=function Dh(s){return(s+"").replace(Hu,function(a){return Gu[a]}).replace(Xf,function(a){return"&#x"+a.charCodeAt(0).toString(16).toUpperCase()+";"})}(s.v||"")}var T=oi(f.cellXfs,s,f);g["ss:StyleID"]="s"+(21+T),g["ss:Index"]=h.c+1;var A=null!=s.v?R:"",x="z"==s.t?"":'<Data ss:Type="'+E+'">'+A+"</Data>";return(s.c||[]).length>0&&(x+=function wC(s){return s.map(function(l){var a=function bh(s){return s.replace(/(\r\n|[\r\n])/g,"&#10;")}(l.t||""),f=Ae("ss:Data",a,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ae("Comment",f,{"ss:Author":l.a})}).join("")}(s.c)),Ae("Cell",x,g)}function po(s,l){var a='<Row ss:Index="'+(s+1)+'"';return l&&(l.hpt&&!l.hpx&&(l.hpx=jl(l.hpt)),l.hpx&&(a+=' ss:AutoFitHeight="0" ss:Height="'+l.hpx+'"'),l.hidden&&(a+=' ss:Hidden="1"')),a+">"}function SC(s,l,a){var f=[],p=a.SheetNames[s],d=a.Sheets[p],h=d?function CC(s,l,a,f){if(!s||!((f||{}).Workbook||{}).Names)return"";for(var p=f.Workbook.Names,d=[],h=0;h<p.length;++h){var g=p[h];g.Sheet==a&&(g.Name.match(/^_xlfn\./)||d.push(Cu(g)))}return d.join("")}(d,0,s,a):"";return h.length>0&&f.push("<Names>"+h+"</Names>"),h=d?function $d(s,l,a,f){if(!s["!ref"])return"";var p=Ct(s["!ref"]),d=s["!merges"]||[],h=0,g=[];s["!cols"]&&s["!cols"].forEach(function(b,H){ao(b);var G=!!b.width,N=au(H,b),Q={"ss:Index":H+1};G&&(Q["ss:Width"]=ha(N.width)),b.hidden&&(Q["ss:Hidden"]="1"),g.push(Ae("Column",null,Q))});for(var y=Array.isArray(s),w=p.s.r;w<=p.e.r;++w){for(var S=[po(w,(s["!rows"]||[])[w])],E=p.s.c;E<=p.e.c;++E){var R=!1;for(h=0;h!=d.length;++h)if(!(d[h].s.c>E||d[h].s.r>w||d[h].e.c<E||d[h].e.r<w)){(d[h].s.c!=E||d[h].s.r!=w)&&(R=!0);break}if(!R){var T={r:w,c:E},A=at(T),x=y?(s[w]||[])[E]:s[A];S.push(mf(x,A,s,l,0,0,T))}}S.push("</Row>"),S.length>2&&g.push(S.join(""))}return g.join("")}(d,l):"",h.length>0&&f.push("<Table>"+h+"</Table>"),f.push(function wu(s,l,a,f){if(!s)return"";var p=[];if(s["!margins"]&&(p.push("<PageSetup>"),s["!margins"].header&&p.push(Ae("Header",null,{"x:Margin":s["!margins"].header})),s["!margins"].footer&&p.push(Ae("Footer",null,{"x:Margin":s["!margins"].footer})),p.push(Ae("PageMargins",null,{"x:Bottom":s["!margins"].bottom||"0.75","x:Left":s["!margins"].left||"0.7","x:Right":s["!margins"].right||"0.7","x:Top":s["!margins"].top||"0.75"})),p.push("</PageSetup>")),f&&f.Workbook&&f.Workbook.Sheets&&f.Workbook.Sheets[a])if(f.Workbook.Sheets[a].Hidden)p.push(Ae("Visible",1==f.Workbook.Sheets[a].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var d=0;d<a&&(!f.Workbook.Sheets[d]||f.Workbook.Sheets[d].Hidden);++d);d==a&&p.push("<Selected/>")}return((((f||{}).Workbook||{}).Views||[])[0]||{}).RTL&&p.push("<DisplayRightToLeft/>"),s["!protect"]&&(p.push(Hr("ProtectContents","True")),s["!protect"].objects&&p.push(Hr("ProtectObjects","True")),s["!protect"].scenarios&&p.push(Hr("ProtectScenarios","True")),null==s["!protect"].selectLockedCells||s["!protect"].selectLockedCells?null!=s["!protect"].selectUnlockedCells&&!s["!protect"].selectUnlockedCells&&p.push(Hr("EnableSelection","UnlockedCells")):p.push(Hr("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(h){s["!protect"][h[0]]&&p.push("<"+h[1]+"/>")})),0==p.length?"":Ae("WorksheetOptions",p.join(""),{xmlns:ai.x})}(d,0,s,a)),f.join("")}function _C(s,l){l||(l={}),s.SSF||(s.SSF=Bt(ot)),s.SSF&&(qn(),Gs(s.SSF),l.revssf=Hs(s.SSF),l.revssf[s.SSF[65535]]=0,l.ssf=s.SSF,l.cellXfs=[],oi(l.cellXfs,{},{revssf:{General:0}}));var a=[];a.push(Va(s,l)),a.push(""),a.push(""),a.push("");for(var f=0;f<s.SheetNames.length;++f)a.push(Ae("Worksheet",SC(f,l,s),{"ss:Name":kt(s.SheetNames[f])}));return a[2]=function mC(s,l){var a=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return l.cellXfs.forEach(function(f,p){var d=[];d.push(Ae("NumberFormat",null,{"ss:Format":kt(ot[f.numFmtId])}));var h={"ss:ID":"s"+(21+p)};a.push(Ae("Style",d.join(""),h))}),Ae("Styles",a.join(""))}(0,l),a[3]=function yC(s){if(!((s||{}).Workbook||{}).Names)return"";for(var l=s.Workbook.Names,a=[],f=0;f<l.length;++f){var p=l[f];null==p.Sheet&&(p.Name.match(/^_xlfn\./)||a.push(Cu(p)))}return Ae("Names",a.join(""))}(s),sr+Ae("Workbook",a.join(""),{xmlns:ai.ss,"xmlns:o":ai.o,"xmlns:x":ai.x,"xmlns:ss":ai.ss,"xmlns:dt":ai.dt,"xmlns:html":ai.html})}var Wa={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function qd(s,l){var a=l||{},f=tt.utils.cfb_new({root:"R"}),p="/Workbook";switch(a.bookType||"xls"){case"xls":a.bookType="biff8";case"xla":a.bookType||(a.bookType="xla");case"biff8":p="/Workbook",a.biff=8;break;case"biff5":p="/Book",a.biff=5;break;default:throw new Error("invalid type "+a.bookType+" for XLS CFB")}return tt.utils.cfb_add(f,p,Cf(s,a)),8==a.biff&&(s.Props||s.Custprops)&&function OC(s,l){var h,a=[],f=[],p=[],d=0,g=Bf(ea,"n"),y=Bf(tc,"n");if(s.Props)for(h=qt(s.Props),d=0;d<h.length;++d)(Object.prototype.hasOwnProperty.call(g,h[d])?a:Object.prototype.hasOwnProperty.call(y,h[d])?f:p).push([h[d],s.Props[h[d]]]);if(s.Custprops)for(h=qt(s.Custprops),d=0;d<h.length;++d)Object.prototype.hasOwnProperty.call(s.Props||{},h[d])||(Object.prototype.hasOwnProperty.call(g,h[d])?a:Object.prototype.hasOwnProperty.call(y,h[d])?f:p).push([h[d],s.Custprops[h[d]]]);var w=[];for(d=0;d<p.length;++d)vs.indexOf(p[d][0])>-1||Dl.indexOf(p[d][0])>-1||null!=p[d][1]&&w.push(p[d]);f.length&&tt.utils.cfb_add(l,"/\x05SummaryInformation",Ep(f,Wa.SI,y,tc)),(a.length||w.length)&&tt.utils.cfb_add(l,"/\x05DocumentSummaryInformation",Ep(a,Wa.DSI,g,ea,w.length?w:null,Wa.UDI))}(s,f),8==a.biff&&s.vbaraw&&function _0(s,l){l.FullPaths.forEach(function(a,f){if(0!=f){var p=a.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==p.slice(-1)&&tt.utils.cfb_add(s,p,l.FileIndex[f].content)}})}(f,tt.read(s.vbaraw,{type:"string"==typeof s.vbaraw?"binary":"buffer"})),f}var Ua={0:{f:function Um(s,l){var a={},f=s.l+l;a.r=s.read_shift(4),s.l+=4;var p=s.read_shift(2);s.l+=1;var d=s.read_shift(1);return s.l=f,7&d&&(a.level=7&d),16&d&&(a.hidden=!0),32&d&&(a.hpt=p/20),a}},1:{f:function Ym(s){return[ui(s)]}},2:{f:function La(s){return[ui(s),kn(s),"n"]}},3:{f:function Pa(s){return[ui(s),s.read_shift(1),"e"]}},4:{f:function qm(s){return[ui(s),s.read_shift(1),"b"]}},5:{f:function oy(s){return[ui(s),Tr(s),"n"]}},6:{f:function cy(s){return[ui(s),Wt(s),"str"]}},7:{f:function cu(s){return[ui(s),s.read_shift(4),"s"]}},8:{f:function gy(s,l,a){var f=s.l+l,p=ui(s);p.r=a["!row"];var h=[p,Wt(s),"str"];if(a.cellFormula){s.l+=2;var g=ou(s,f-s.l,a);h[3]=$r(g,0,p,a.supbooks,a)}else s.l=f;return h}},9:{f:function vy(s,l,a){var f=s.l+l,p=ui(s);p.r=a["!row"];var h=[p,Tr(s),"n"];if(a.cellFormula){s.l+=2;var g=ou(s,f-s.l,a);h[3]=$r(g,0,p,a.supbooks,a)}else s.l=f;return h}},10:{f:function hy(s,l,a){var f=s.l+l,p=ui(s);p.r=a["!row"];var h=[p,s.read_shift(1),"b"];if(a.cellFormula){s.l+=2;var g=ou(s,f-s.l,a);h[3]=$r(g,0,p,a.supbooks,a)}else s.l=f;return h}},11:{f:function Nd(s,l,a){var f=s.l+l,p=ui(s);p.r=a["!row"];var h=[p,s.read_shift(1),"e"];if(a.cellFormula){s.l+=2;var g=ou(s,f-s.l,a);h[3]=$r(g,0,p,a.supbooks,a)}else s.l=f;return h}},12:{f:function Xm(s){return[Nn(s)]}},13:{f:function ly(s){return[Nn(s),kn(s),"n"]}},14:{f:function ty(s){return[Nn(s),s.read_shift(1),"e"]}},15:{f:function Jm(s){return[Nn(s),s.read_shift(1),"b"]}},16:{f:Ld},17:{f:function py(s){return[Nn(s),Wt(s),"str"]}},18:{f:function iy(s){return[Nn(s),s.read_shift(4),"s"]}},19:{f:Sr},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function Fs(s,l,a){var f=s.l+l;s.l+=4,s.l+=1;var p=s.read_shift(4),d=Qs(s),h=Jc(s,0,a),g=xl(s);s.l=f;var y={Name:d,Ptg:h};return p<268435455&&(y.Sheet=p),g&&(y.Comment=g),y}},40:{},42:{},43:{f:function di(s,l,a){var f={};f.sz=s.read_shift(2)/20;var p=function pr(s){var l=s.read_shift(1);return s.l++,{fBold:1&l,fItalic:2&l,fUnderline:4&l,fStrikeout:8&l,fOutline:16&l,fShadow:32&l,fCondense:64&l,fExtend:128&l}}(s);switch(p.fItalic&&(f.italic=1),p.fCondense&&(f.condense=1),p.fExtend&&(f.extend=1),p.fShadow&&(f.shadow=1),p.fOutline&&(f.outline=1),p.fStrikeout&&(f.strike=1),700===s.read_shift(2)&&(f.bold=1),s.read_shift(2)){case 1:f.vertAlign="superscript";break;case 2:f.vertAlign="subscript"}var h=s.read_shift(1);0!=h&&(f.underline=h);var g=s.read_shift(1);g>0&&(f.family=g);var y=s.read_shift(1);switch(y>0&&(f.charset=y),s.l++,f.color=function ap(s){var l={},f=s.read_shift(1)>>>1,p=s.read_shift(1),d=s.read_shift(2,"i"),h=s.read_shift(1),g=s.read_shift(1),y=s.read_shift(1);switch(s.l++,f){case 0:l.auto=1;break;case 1:l.index=p;var w=Pi[p];w&&(l.rgb=da(w));break;case 2:l.rgb=da([h,g,y]);break;case 3:l.theme=p}return 0!=d&&(l.tint=d>0?d/32767:d/32768),l}(s),s.read_shift(1)){case 1:f.scheme="major";break;case 2:f.scheme="minor"}return f.name=Wt(s),f}},44:{f:function Pg(s,l){return[s.read_shift(2),Wt(s)]}},45:{f:Ti},46:{f:Ng},47:{f:function Mg(s,l){var a=s.l+l,f=s.read_shift(2),p=s.read_shift(2);return s.l=a,{ixfe:f,numFmtId:p}}},48:{},49:{f:function Xs(s){return s.read_shift(4,"i")}},50:{},51:{f:function n0(s){for(var l=[],a=s.read_shift(4);a-- >0;)l.push([s.read_shift(4),s.read_shift(4)]);return l}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Rc},62:{f:function uy(s){return[ui(s),Sr(s),"is"]}},63:{f:function f0(s){var l={};l.i=s.read_shift(4);var a={};a.r=s.read_shift(4),a.c=s.read_shift(4),l.r=at(a);var f=s.read_shift(1);return 2&f&&(l.l="1"),8&f&&(l.a="1"),l}},64:{f:function sf(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Er,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function xy(s){var l=s.read_shift(2);return s.l+=28,{RTL:32&l}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function dw(s,l){var a={},f=s[s.l];return++s.l,a.above=!(64&f),a.left=!(128&f),s.l+=18,a.name=Gh(s,l-19),a}},148:{f:zm,p:16},151:{f:function Ma(){}},152:{},153:{f:function Mi(s,l){var a={},f=s.read_shift(4);a.defaultThemeVersion=s.read_shift(4);var p=l>8?Wt(s):"";return p.length>0&&(a.CodeName=p),a.autoCompressPictures=!!(65536&f),a.backupFile=!!(64&f),a.checkCompatibility=!!(4096&f),a.date1904=!!(1&f),a.filterPrivacy=!!(8&f),a.hidePivotFieldList=!!(1024&f),a.promptedSolutions=!!(16&f),a.publishItems=!!(2048&f),a.refreshAllConnections=!!(262144&f),a.saveExternalLinkValues=!!(128&f),a.showBorderUnselectedTables=!!(4&f),a.showInkAnnotation=!!(32&f),a.showObjects=["all","placeholders","none"][f>>13&3],a.showPivotChartFilter=!!(32768&f),a.updateLinks=["userSet","never","always"][f>>8&3],a}},154:{},155:{},156:{f:function zy(s,l){var a={};return a.Hidden=s.read_shift(4),a.iTabID=s.read_shift(4),a.strRelID=ci(s,l-8),a.name=Wt(s),a}},157:{},158:{},159:{T:1,f:function fg(s){return[s.read_shift(4),s.read_shift(4)]}},160:{T:-1},161:{T:1,f:to},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:of},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function ud(s,l){return{flags:s.read_shift(4),version:s.read_shift(4),name:Wt(s)}}},336:{T:-1},337:{f:function o0(s){return s.l+=4,0!=s.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ci},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Vp},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function wy(s,l,a){var f=s.l+l,p=us(s),d=s.read_shift(1),h=[p];if(h[2]=d,a.cellFormula){var g=ym(s,f-s.l,a);h[1]=g}else s.l=f;return h}},427:{f:function Sy(s,l,a){var f=s.l+l,d=[to(s,16)];if(a.cellFormula){var h=Cm(s,f-s.l,a);d[1]=h,s.l=f}else s.l=f;return d}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function ka(s){var l={};return Na.forEach(function(a){l[a]=Tr(s)}),l}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function rf(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function yy(s,l){var a=s.l+l,f=to(s,16),p=xl(s),d=Wt(s),h=Wt(s),g=Wt(s);s.l=a;var y={rfx:f,relId:p,loc:d,display:g};return h&&(y.Tooltip=h),y}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ci},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:hd},633:{T:1},634:{T:-1},635:{T:1,f:function m0(s){var l={};l.iauthor=s.read_shift(4);var a=to(s,16);return l.rfx=a.s,l.ref=at(a.s),s.l+=16,l}},636:{T:-1},637:{f:kh},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function uf(s,l){return s.l+=10,{name:Wt(s)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function Oy(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function De(s,l,a,f){var p=l;if(!isNaN(p)){var d=f||(a||[]).length||0,h=s.next(4);h.write_shift(2,p),h.write_shift(2,d),d>0&&on(a)&&s.push(a)}}function _u(s,l,a){return s||(s=de(7)),s.write_shift(2,l),s.write_shift(2,a),s.write_shift(2,0),s.write_shift(1,0),s}function Cw(s,l,a,f){if(null!=l.v)switch(l.t){case"d":case"n":var p="d"==l.t?Cr(rr(l.v)):l.v;return void(p==(0|p)&&p>=0&&p<65536?De(s,2,function ig(s,l,a){var f=de(9);return _u(f,s,l),f.write_shift(2,a),f}(a,f,p)):De(s,3,function tg(s,l,a){var f=de(15);return _u(f,s,l),f.write_shift(8,a,"f"),f}(a,f,p)));case"b":case"e":return void De(s,5,function mw(s,l,a,f){var p=de(9);return _u(p,s,l),dc(a,f||"b",p),p}(a,f,l.v,l.t));case"s":case"str":return void De(s,4,function yw(s,l,a){var f=de(8+2*a.length);return _u(f,s,l),f.write_shift(1,a.length),f.write_shift(a.length,a,"sbcs"),f.l<f.length?f.slice(0,f.l):f}(a,f,(l.v||"").slice(0,255)))}De(s,1,_u(null,a,f))}function Is(s,l){var a=l||{};null!=or&&null==a.dense&&(a.dense=or);for(var f=ri(),p=0,d=0;d<s.SheetNames.length;++d)s.SheetNames[d]==a.sheet&&(p=d);if(0==p&&a.sheet&&s.SheetNames[0]!=a.sheet)throw new Error("Sheet not found: "+a.sheet);return De(f,4==a.biff?1033:3==a.biff?521:9,_c(0,16,a)),function Qd(s,l,a,f){var h,p=Array.isArray(l),d=Ct(l["!ref"]||"A1"),g="",y=[];if(d.e.c>255||d.e.r>16383){if(f.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,16383),h=lt(d)}for(var w=d.s.r;w<=d.e.r;++w){g=lr(w);for(var S=d.s.c;S<=d.e.c;++S){w===d.s.r&&(y[S]=$t(S)),h=y[S]+g;var E=p?(l[w]||[])[S]:l[h];E&&Cw(s,E,w,S)}}}(f,s.Sheets[s.SheetNames[p]],0,a),De(f,10),f.end()}function AC(s,l,a){De(s,49,function _v(s,l){var a=s.name||"Arial",f=l&&5==l.biff,d=de(f?15+a.length:16+2*a.length);return d.write_shift(2,20*(s.sz||12)),d.write_shift(4,0),d.write_shift(2,400),d.write_shift(4,0),d.write_shift(2,0),d.write_shift(1,a.length),f||d.write_shift(1,1),d.write_shift((f?1:2)*a.length,a,f?"sbcs":"utf16le"),d}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},a))}function FC(s,l){if(l){var a=0;l.forEach(function(f,p){++a<=256&&f&&De(s,125,function Kv(s,l){var a=de(12);a.write_shift(2,l),a.write_shift(2,l),a.write_shift(2,256*s.width),a.write_shift(2,0);var f=0;return s.hidden&&(f|=1),a.write_shift(1,f),f=s.level||0,a.write_shift(1,f),a.write_shift(2,0),a}(au(p,f),p))})}}function xu(s,l,a,f,p){var d=16+oi(p.cellXfs,l,p);if(null!=l.v||l.bf)if(l.bf)De(s,6,iu(l,a,f,0,d));else switch(l.t){case"d":case"n":De(s,515,function Gp(s,l,a,f){var p=de(14);return oo(s,l,f,p),To(a,p),p}(a,f,"d"==l.t?Cr(rr(l.v)):l.v,d));break;case"b":case"e":De(s,517,function ua(s,l,a,f,p,d){var h=de(8);return oo(s,l,f,h),dc(a,d,h),h}(a,f,l.v,d,0,l.t));break;case"s":case"str":if(p.bookSST)De(s,253,function Ev(s,l,a,f){var p=de(10);return oo(s,l,f,p),p.write_shift(4,a),p}(a,f,Os(p.Strings,l.v,p.revStrings),d));else De(s,516,function Tv(s,l,a,f,p){var d=!p||8==p.biff,h=de(+d+8+(1+d)*a.length);return oo(s,l,f,h),h.write_shift(2,a.length),d&&h.write_shift(1,1),h.write_shift((1+d)*a.length,a,d?"utf16le":"sbcs"),h}(a,f,(l.v||"").slice(0,255),d,p));break;default:De(s,513,oo(a,f,d))}else De(s,513,oo(a,f,d))}function Sn(s,l,a){var S,f=ri(),p=a.SheetNames[s],d=a.Sheets[p]||{},h=(a||{}).Workbook||{},g=(h.Sheets||[])[s]||{},y=Array.isArray(d),w=8==l.biff,E="",R=[],T=Ct(d["!ref"]||"A1"),A=w?65536:16384;if(T.e.c>255||T.e.r>=A){if(l.WTF)throw new Error("Range "+(d["!ref"]||"A1")+" exceeds format limit A1:IV16384");T.e.c=Math.min(T.e.c,255),T.e.r=Math.min(T.e.c,A-1)}De(f,2057,_c(0,16,l)),De(f,13,pi(1)),De(f,12,pi(100)),De(f,15,It(!0)),De(f,17,It(!1)),De(f,16,To(.001)),De(f,95,It(!0)),De(f,42,It(!1)),De(f,43,It(!1)),De(f,130,pi(1)),De(f,128,function Vr(s){var l=de(8);return l.write_shift(4,0),l.write_shift(2,s[0]?s[0]+1:0),l.write_shift(2,s[1]?s[1]+1:0),l}([0,0])),De(f,131,It(!1)),De(f,132,It(!1)),w&&FC(f,d["!cols"]),De(f,512,function Np(s,l){var a=8!=l.biff&&l.biff?2:4,f=de(2*a+6);return f.write_shift(a,s.s.r),f.write_shift(a,s.e.r+1),f.write_shift(2,s.s.c),f.write_shift(2,s.e.c+1),f.write_shift(2,0),f}(T,l)),w&&(d["!links"]=[]);for(var x=T.s.r;x<=T.e.r;++x){E=lr(x);for(var b=T.s.c;b<=T.e.c;++b){x===T.s.r&&(R[b]=$t(b)),S=R[b]+E;var H=y?(d[x]||[])[b]:d[S];H&&(xu(f,H,x,b,l),w&&H.l&&d["!links"].push([S,H.l]))}}var G=g.CodeName||g.name||p;return w&&De(f,574,function Cv(s){var l=de(18),a=1718;return s&&s.RTL&&(a|=64),l.write_shift(2,a),l.write_shift(4,0),l.write_shift(4,64),l.write_shift(4,0),l.write_shift(4,0),l}((h.Views||[])[0])),w&&(d["!merges"]||[]).length&&De(f,229,function Lv(s){var l=de(2+8*s.length);l.write_shift(2,s.length);for(var a=0;a<s.length;++a)wc(s[a],l);return l}(d["!merges"])),w&&function vi(s,l){for(var a=0;a<l["!links"].length;++a){var f=l["!links"][a];De(s,440,Hv(f)),f[1].Tooltip&&De(s,2048,Vv(f))}delete l["!links"]}(f,d),De(f,442,Ap(G)),w&&function DC(s,l){var a=de(19);a.write_shift(4,2151),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,1),a.write_shift(4,0),De(s,2151,a),(a=de(39)).write_shift(4,2152),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,0),a.write_shift(4,0),a.write_shift(2,1),a.write_shift(4,4),a.write_shift(2,0),wc(Ct(l["!ref"]||"A1"),a),a.write_shift(4,4),De(s,2152,a)}(f,d),De(f,10),f.end()}function PC(s,l,a){var f=ri(),p=(s||{}).Workbook||{},d=p.Sheets||[],h=p.WBProps||{},g=8==a.biff,y=5==a.biff;(De(f,2057,_c(0,5,a)),"xla"==a.bookType&&De(f,135),De(f,225,g?pi(1200):null),De(f,193,function pc(s,l){l||(l=de(s));for(var a=0;a<s;++a)l.write_shift(1,0);return l}(2)),y&&De(f,191),y&&De(f,192),De(f,226),De(f,92,function cv(s,l){var a=!l||8==l.biff,f=de(a?112:54);for(f.write_shift(8==l.biff?2:1,7),a&&f.write_shift(1,0),f.write_shift(4,859007059),f.write_shift(4,5458548|(a?0:536870912));f.l<f.length;)f.write_shift(1,a?0:32);return f}(0,a)),De(f,66,pi(g?1200:1252)),g&&De(f,353,pi(0)),g&&De(f,448),De(f,317,function Tc(s){for(var l=de(2*s),a=0;a<s;++a)l.write_shift(2,a+1);return l}(s.SheetNames.length)),g&&s.vbaraw&&De(f,211),g&&s.vbaraw)&&De(f,442,Ap(h.CodeName||"ThisWorkbook"));De(f,156,pi(17)),De(f,25,It(!1)),De(f,18,It(!1)),De(f,19,pi(0)),g&&De(f,431,It(!1)),g&&De(f,444,pi(0)),De(f,61,function yv(){var s=de(18);return s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,29280),s.write_shift(2,17600),s.write_shift(2,56),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,1),s.write_shift(2,500),s}()),De(f,64,It(!1)),De(f,141,pi(0)),De(f,34,It("true"==function Wd(s){return s.Workbook&&s.Workbook.WBProps&&Zt(s.Workbook.WBProps.date1904)?"true":"false"}(s))),De(f,14,It(!0)),g&&De(f,439,It(!1)),De(f,218,pi(0)),AC(f,0,a),function Jd(s,l,a){l&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(f){for(var p=f[0];p<=f[1];++p)null!=l[p]&&De(s,1054,wt(p,l[p],a))})}(f,s.SSF,a),function bC(s,l){for(var a=0;a<16;++a)De(s,224,Po({numFmtId:0,style:!0},0,l));l.cellXfs.forEach(function(f){De(s,224,Po(f,0,l))})}(f,a),g&&De(f,352,It(!1));var S=f.end(),E=ri();g&&De(E,140,function Uv(s){return s||(s=de(4)),s.write_shift(2,1),s.write_shift(2,1),s}()),g&&a.Strings&&function gw(s,l,a,f){var p=f||(a||[]).length||0;if(p<=8224)return De(s,l,a,p);var d=l;if(!isNaN(d)){for(var h=a.parts||[],g=0,y=0,w=0;w+(h[g]||8224)<=8224;)w+=h[g]||8224,g++;var S=s.next(4);for(S.write_shift(2,d),S.write_shift(2,w),s.push(a.slice(y,y+w)),y+=w;y<p;){for((S=s.next(4)).write_shift(2,60),w=0;w+(h[g]||8224)<=8224;)w+=h[g]||8224,g++;S.write_shift(2,w),s.push(a.slice(y,y+w)),y+=w}}}(E,252,function dv(s,l){var a=de(8);a.write_shift(4,s.Count),a.write_shift(4,s.Unique);for(var f=[],p=0;p<s.length;++p)f[p]=ev(s[p]);var d=fr([a].concat(f));return d.parts=[a.length].concat(f.map(function(h){return h.length})),d}(a.Strings)),De(E,10);var R=E.end(),T=ri(),A=0,x=0;for(x=0;x<s.SheetNames.length;++x)A+=(g?12:11)+(g?2:1)*s.SheetNames[x].length;var b=S.length+A+R.length;for(x=0;x<s.SheetNames.length;++x){De(T,133,pv({pos:b,hs:(d[x]||{}).Hidden||0,dt:0,name:s.SheetNames[x]},a)),b+=l[x].length}var G=T.end();if(A!=G.length)throw new Error("BS8 "+A+" != "+G.length);var N=[];return S.length&&N.push(S),G.length&&N.push(G),R.length&&N.push(R),fr(N)}function Cf(s,l){for(var a=0;a<=s.SheetNames.length;++a){var f=s.Sheets[s.SheetNames[a]];if(f&&f["!ref"])mr(f["!ref"]).e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+s.SheetNames[a]+"' extends beyond column IV (255).  Data may be lost.")}var d=l||{};switch(d.biff||2){case 8:case 5:return function IC(s,l){var a=l||{},f=[];s&&!s.SSF&&(s.SSF=Bt(ot)),s&&s.SSF&&(qn(),Gs(s.SSF),a.revssf=Hs(s.SSF),a.revssf[s.SSF[65535]]=0,a.ssf=s.SSF),a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,t(a),a.cellXfs=[],oi(a.cellXfs,{},{revssf:{General:0}}),s.Props||(s.Props={});for(var p=0;p<s.SheetNames.length;++p)f[f.length]=Sn(p,a,s);return f.unshift(PC(s,f,a)),fr(f)}(s,l);case 4:case 3:case 2:return Is(s,l)}throw new Error("invalid type "+d.bookType+" for BIFF")}function eh(s,l,a,f){for(var p=s["!merges"]||[],d=[],h=l.s.c;h<=l.e.c;++h){for(var g=0,y=0,w=0;w<p.length;++w)if(!(p[w].s.r>a||p[w].s.c>h||p[w].e.r<a||p[w].e.c<h)){if(p[w].s.r<a||p[w].s.c<h){g=-1;break}g=p[w].e.r-p[w].s.r+1,y=p[w].e.c-p[w].s.c+1;break}if(!(g<0)){var S=at({r:a,c:h}),E=f.dense?(s[a]||[])[h]:s[S],R=E&&null!=E.v&&(E.h||qf(E.w||(Ei(E),E.w)||""))||"",T={};g>1&&(T.rowspan=g),y>1&&(T.colspan=y),f.editable?R='<span contenteditable="true">'+R+"</span>":E&&(T["data-t"]=E&&E.t||"z",null!=E.v&&(T["data-v"]=E.v),null!=E.z&&(T["data-z"]=E.z),E.l&&"#"!=(E.l.Target||"#").charAt(0)&&(R='<a href="'+E.l.Target+'">'+R+"</a>")),T.id=(f.id||"sjs")+"-"+S,d.push(Ae("td",R,T))}}return"<tr>"+d.join("")+"</tr>"}var ja='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',th="</body></html>";function Eu(s,l,a){return[].join("")+"<table"+(a&&a.id?' id="'+a.id+'"':"")+">"}function rh(s,l){var a=l||{},f=null!=a.header?a.header:ja,p=null!=a.footer?a.footer:th,d=[f],h=mr(s["!ref"]);a.dense=Array.isArray(s),d.push(Eu(0,0,a));for(var g=h.s.r;g<=h.e.r;++g)d.push(eh(s,h,g,a));return d.push("</table>"+p),d.join("")}function ih(s,l,a){var f=a||{};null!=or&&(f.dense=or);var p=0,d=0;if(null!=f.origin)if("number"==typeof f.origin)p=f.origin;else{var h="string"==typeof f.origin?Ze(f.origin):f.origin;p=h.r,d=h.c}var g=l.getElementsByTagName("tr"),y=Math.min(f.sheetRows||1e7,g.length),w={s:{r:0,c:0},e:{r:p,c:d}};if(s["!ref"]){var S=mr(s["!ref"]);w.s.r=Math.min(w.s.r,S.s.r),w.s.c=Math.min(w.s.c,S.s.c),w.e.r=Math.max(w.e.r,S.e.r),w.e.c=Math.max(w.e.c,S.e.c),-1==p&&(w.e.r=p=S.e.r+1)}var E=[],R=0,T=s["!rows"]||(s["!rows"]=[]),A=0,x=0,b=0,H=0,G=0,N=0;for(s["!cols"]||(s["!cols"]=[]);A<g.length&&x<y;++A){var Q=g[A];if(nh(Q)){if(f.display)continue;T[x]={hidden:!0}}var ie=Q.children;for(b=H=0;b<ie.length;++b){var ce=ie[b];if(!f.display||!nh(ce)){var K=ce.hasAttribute("data-v")?ce.getAttribute("data-v"):ce.hasAttribute("v")?ce.getAttribute("v"):Bu(ce.innerHTML),te=ce.getAttribute("data-z")||ce.getAttribute("z");for(R=0;R<E.length;++R){var J=E[R];J.s.c==H+d&&J.s.r<x+p&&x+p<=J.e.r&&(H=J.e.c+1-d,R=-1)}N=+ce.getAttribute("colspan")||1,((G=+ce.getAttribute("rowspan")||1)>1||N>1)&&E.push({s:{r:x+p,c:H+d},e:{r:x+p+(G||1)-1,c:H+d+(N||1)-1}});var fe={t:"s",v:K},he=ce.getAttribute("data-t")||ce.getAttribute("t")||"";null!=K&&(0==K.length?fe.t=he||"z":f.raw||0==K.trim().length||"s"==he||("TRUE"===K?fe={t:"b",v:!0}:"FALSE"===K?fe={t:"b",v:!1}:isNaN(Vt(K))?isNaN(Qn(K).getDate())||(fe={t:"d",v:rr(K)},f.cellDates||(fe={t:"n",v:Cr(fe.v)}),fe.z=f.dateNF||ot[14]):fe={t:"n",v:Vt(K)})),void 0===fe.z&&null!=te&&(fe.z=te);var ee="",Ie=ce.getElementsByTagName("A");if(Ie&&Ie.length)for(var Ke=0;Ke<Ie.length&&(!Ie[Ke].hasAttribute("href")||"#"==(ee=Ie[Ke].getAttribute("href")).charAt(0));++Ke);ee&&"#"!=ee.charAt(0)&&(fe.l={Target:ee}),f.dense?(s[x+p]||(s[x+p]=[]),s[x+p][H+d]=fe):s[at({c:H+d,r:x+p})]=fe,w.e.c<H+d&&(w.e.c=H+d),H+=N}}++x}return E.length&&(s["!merges"]=(s["!merges"]||[]).concat(E)),w.e.r=Math.max(w.e.r,x-1+p),s["!ref"]=lt(w),x>=y&&(s["!fullref"]=lt((w.e.r=g.length-A+x-1+p,w))),s}function za(s,l){return ih((l||{}).dense?[]:{},s,l)}function nh(s){var l="",a=function oh(s){return s.ownerDocument.defaultView&&"function"==typeof s.ownerDocument.defaultView.getComputedStyle?s.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(s);return a&&(l=a(s).getPropertyValue("display")),l||(l=s.style&&s.style.display),"none"===l}var kC=function(){var s=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),l="<office:document-styles "+es({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+s+"</office:document-styles>";return function(){return sr+l}}(),uh=function(){var s=function(d){return kt(d).replace(/  +/g,function(h){return'<text:s text:c="'+h.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},l="          <table:table-cell />\n",f=function(d,h,g){var y=[];y.push('      <table:table table:name="'+kt(h.SheetNames[g])+'" table:style-name="ta1">\n');var w=0,S=0,E=mr(d["!ref"]||"A1"),R=d["!merges"]||[],T=0,A=Array.isArray(d);if(d["!cols"])for(S=0;S<=E.e.c;++S)y.push("        <table:table-column"+(d["!cols"][S]?' table:style-name="co'+d["!cols"][S].ods+'"':"")+"></table:table-column>\n");var x="",b=d["!rows"]||[];for(w=0;w<E.s.r;++w)x=b[w]?' table:style-name="ro'+b[w].ods+'"':"",y.push("        <table:table-row"+x+"></table:table-row>\n");for(;w<=E.e.r;++w){for(x=b[w]?' table:style-name="ro'+b[w].ods+'"':"",y.push("        <table:table-row"+x+">\n"),S=0;S<E.s.c;++S)y.push(l);for(;S<=E.e.c;++S){var H=!1,G={},N="";for(T=0;T!=R.length;++T)if(!(R[T].s.c>S||R[T].s.r>w||R[T].e.c<S||R[T].e.r<w)){(R[T].s.c!=S||R[T].s.r!=w)&&(H=!0),G["table:number-columns-spanned"]=R[T].e.c-R[T].s.c+1,G["table:number-rows-spanned"]=R[T].e.r-R[T].s.r+1;break}if(H)y.push("          <table:covered-table-cell/>\n");else{var Q=at({r:w,c:S}),ie=A?(d[w]||[])[S]:d[Q];if(ie&&ie.f&&(G["table:formula"]=kt(_m(ie.f)),ie.F&&ie.F.slice(0,Q.length)==Q)){var ce=mr(ie.F);G["table:number-matrix-columns-spanned"]=ce.e.c-ce.s.c+1,G["table:number-matrix-rows-spanned"]=ce.e.r-ce.s.r+1}if(ie){switch(ie.t){case"b":N=ie.v?"TRUE":"FALSE",G["office:value-type"]="boolean",G["office:boolean-value"]=ie.v?"true":"false";break;case"n":N=ie.w||String(ie.v||0),G["office:value-type"]="float",G["office:value"]=ie.v||0;break;case"s":case"str":N=null==ie.v?"":ie.v,G["office:value-type"]="string";break;case"d":N=ie.w||rr(ie.v).toISOString(),G["office:value-type"]="date",G["office:date-value"]=rr(ie.v).toISOString(),G["table:style-name"]="ce1";break;default:y.push(l);continue}var K=s(N);if(ie.l&&ie.l.Target){var te=ie.l.Target;"#"!=(te="#"==te.charAt(0)?"#"+xm(te.slice(1)):te).charAt(0)&&!te.match(/^\w+:/)&&(te="../"+te),K=Ae("text:a",K,{"xlink:href":te.replace(/&/g,"&amp;")})}y.push("          "+Ae("table:table-cell",Ae("text:p",K,{}),G)+"\n")}else y.push(l)}}y.push("        </table:table-row>\n")}return y.push("      </table:table>\n"),y.join("")};return function(h,g){var y=[sr],w=es({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),S=es({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==g.bookType?(y.push("<office:document"+w+S+">\n"),y.push(ic().replace(/office:document-meta/g,"office:meta"))):y.push("<office:document-content"+w+">\n"),function(d,h){d.push(" <office:automatic-styles>\n"),d.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),d.push('   <number:month number:style="long"/>\n'),d.push("   <number:text>/</number:text>\n"),d.push('   <number:day number:style="long"/>\n'),d.push("   <number:text>/</number:text>\n"),d.push("   <number:year/>\n"),d.push("  </number:date-style>\n");var g=0;h.SheetNames.map(function(w){return h.Sheets[w]}).forEach(function(w){if(w&&w["!cols"])for(var S=0;S<w["!cols"].length;++S)if(w["!cols"][S]){var E=w["!cols"][S];if(null==E.width&&null==E.wpx&&null==E.wch)continue;ao(E),E.ods=g;var R=w["!cols"][S].wpx+"px";d.push('  <style:style style:name="co'+g+'" style:family="table-column">\n'),d.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+R+'"/>\n'),d.push("  </style:style>\n"),++g}});var y=0;h.SheetNames.map(function(w){return h.Sheets[w]}).forEach(function(w){if(w&&w["!rows"])for(var S=0;S<w["!rows"].length;++S)if(w["!rows"][S]){w["!rows"][S].ods=y;var E=w["!rows"][S].hpx+"px";d.push('  <style:style style:name="ro'+y+'" style:family="table-row">\n'),d.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+E+'"/>\n'),d.push("  </style:style>\n"),++y}}),d.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),d.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),d.push("  </style:style>\n"),d.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),d.push(" </office:automatic-styles>\n")}(y,h),y.push("  <office:body>\n"),y.push("    <office:spreadsheet>\n");for(var E=0;E!=h.SheetNames.length;++E)y.push(f(h.Sheets[h.SheetNames[E]],h,E));return y.push("    </office:spreadsheet>\n"),y.push("  </office:body>\n"),"fods"==g.bookType?y.push("</office:document>"):y.push("</office:document-content>"),y.join("")}}();function ch(s,l){if("fods"==l.bookType)return uh(s,l);var a=dl(),f="",p=[],d=[];return yt(a,f="mimetype","application/vnd.oasis.opendocument.spreadsheet"),yt(a,f="content.xml",uh(s,l)),p.push([f,"text/xml"]),d.push([f,"ContentFile"]),yt(a,f="styles.xml",kC(s,l)),p.push([f,"text/xml"]),d.push([f,"StylesFile"]),yt(a,f="meta.xml",sr+ic()),p.push([f,"text/xml"]),d.push([f,"MetadataFile"]),yt(a,f="manifest.rdf",function Kh(s){var l=[sr];l.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var a=0;a!=s.length;++a)l.push(dp(s[a][0],s[a][1])),l.push(zh("",s[a][0]));return l.push(dp("","Document","pkg")),l.push("</rdf:RDF>"),l.join("")}(d)),p.push([f,"application/rdf+xml"]),yt(a,f="META-INF/manifest.xml",function pp(s){var l=[sr];l.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),l.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var a=0;a<s.length;++a)l.push('  <manifest:file-entry manifest:full-path="'+s[a][0]+'" manifest:media-type="'+s[a][1]+'"/>\n');return l.push("</manifest:manifest>"),l.join("")}(p)),a}function Wn(s){return new DataView(s.buffer,s.byteOffset,s.byteLength)}function GC(s){return typeof TextEncoder<"u"?(new TextEncoder).encode(s):Ci(ji(s))}function ho(s){var l=s.reduce(function(p,d){return p+d.length},0),a=new Uint8Array(l),f=0;return s.forEach(function(p){a.set(p,f),f+=p.length}),a}function $a(s,l){var a=l?l[0]:0,f=127&s[a];e:if(s[a++]>=128&&(f|=(127&s[a])<<7,s[a++]<128||(f|=(127&s[a])<<14,s[a++]<128)||(f|=(127&s[a])<<21,s[a++]<128)||(f+=(127&s[a])*Math.pow(2,28),++a,s[a++]<128)||(f+=(127&s[a])*Math.pow(2,35),++a,s[a++]<128)||(f+=(127&s[a])*Math.pow(2,42),++a,s[a++]<128)))break e;return l&&(l[0]=a),f}function Nt(s){var l=new Uint8Array(7);l[0]=127&s;var a=1;e:if(s>127){if(l[a-1]|=128,l[a]=s>>7&127,++a,s<=16383||(l[a-1]|=128,l[a]=s>>14&127,++a,s<=2097151)||(l[a-1]|=128,l[a]=s>>21&127,++a,s<=268435455)||(l[a-1]|=128,l[a]=s/256>>>21&127,++a,s<=34359738367)||(l[a-1]|=128,l[a]=s/65536>>>21&127,++a,s<=4398046511103))break e;l[a-1]|=128,l[a]=s/16777216>>>21&127,++a}return l.slice(0,a)}function ur(s){var l=0,a=127&s[l];e:if(s[l++]>=128){if(a|=(127&s[l])<<7,s[l++]<128||(a|=(127&s[l])<<14,s[l++]<128)||(a|=(127&s[l])<<21,s[l++]<128))break e;a|=(127&s[l])<<28}return a}function Lt(s){for(var l=[],a=[0];a[0]<s.length;){var g,f=a[0],p=$a(s,a),d=7&p,h=0;if(0==(p=Math.floor(p/8)))break;switch(d){case 0:for(var y=a[0];s[a[0]++]>=128;);g=s.slice(y,a[0]);break;case 5:h=4,g=s.slice(a[0],a[0]+h),a[0]+=h;break;case 1:h=8,g=s.slice(a[0],a[0]+h),a[0]+=h;break;case 2:h=$a(s,a),g=s.slice(a[0],a[0]+h),a[0]+=h;break;default:throw new Error("PB Type ".concat(d," for Field ").concat(p," at offset ").concat(f))}var w={data:g,type:d};null==l[p]?l[p]=[w]:l[p].push(w)}return l}function Ar(s){var l=[];return s.forEach(function(a,f){a.forEach(function(p){p.data&&(l.push(Nt(8*f+p.type)),2==p.type&&l.push(Nt(p.data.length)),l.push(p.data))})}),ho(l)}function Ni(s){for(var l,a=[],f=[0];f[0]<s.length;){var p=$a(s,f),d=Lt(s.slice(f[0],f[0]+p));f[0]+=p;var h={id:ur(d[1][0].data),messages:[]};d[2].forEach(function(g){var y=Lt(g.data),w=ur(y[3][0].data);h.messages.push({meta:y,data:s.slice(f[0],f[0]+w)}),f[0]+=w}),null!=(l=d[3])&&l[0]&&(h.merge=ur(d[3][0].data)>>>0>0),a.push(h)}return a}function Vo(s){var l=[];return s.forEach(function(a){var f=[];f[1]=[{data:Nt(a.id),type:0}],f[2]=[],null!=a.merge&&(f[3]=[{data:Nt(+!!a.merge),type:0}]);var p=[];a.messages.forEach(function(h){p.push(h.data),h.meta[3]=[{type:0,data:Nt(h.data.length)}],f[2].push({data:Ar(h.meta),type:2})});var d=Ar(f);l.push(Nt(d.length)),l.push(d),p.forEach(function(h){return l.push(h)})}),ho(l)}function BC(s,l){if(0!=s)throw new Error("Unexpected Snappy chunk type ".concat(s));for(var a=[0],f=$a(l,a),p=[];a[0]<l.length;){var d=3&l[a[0]];if(0!=d){var y=0,w=0;if(1==d?(w=4+(l[a[0]]>>2&7),y=(224&l[a[0]++])<<3,y|=l[a[0]++]):(w=1+(l[a[0]++]>>2),2==d?(y=l[a[0]]|l[a[0]+1]<<8,a[0]+=2):(y=(l[a[0]]|l[a[0]+1]<<8|l[a[0]+2]<<16|l[a[0]+3]<<24)>>>0,a[0]+=4)),p=[ho(p)],0==y)throw new Error("Invalid offset 0");if(y>p[0].length)throw new Error("Invalid offset beyond length");if(w>=y)for(p.push(p[0].slice(-y)),w-=y;w>=p[p.length-1].length;)p.push(p[p.length-1]),w-=p[p.length-1].length;p.push(p[0].slice(-y,-y+w))}else{var h=l[a[0]++]>>2;if(h<60)++h;else{var g=h-59;h=l[a[0]],g>1&&(h|=l[a[0]+1]<<8),g>2&&(h|=l[a[0]+2]<<16),g>3&&(h|=l[a[0]+3]<<24),h>>>=0,h++,a[0]+=g}p.push(l.slice(a[0],a[0]+h)),a[0]+=h}}var S=ho(p);if(S.length!=f)throw new Error("Unexpected length: ".concat(S.length," != ").concat(f));return S}function ki(s){for(var l=[],a=0;a<s.length;){var f=s[a++],p=s[a]|s[a+1]<<8|s[a+2]<<16;a+=3,l.push(BC(f,s.slice(a,a+p))),a+=p}if(a!==s.length)throw new Error("data is not a valid framed stream!");return ho(l)}function Qi(s){for(var l=[],a=0;a<s.length;){var f=Math.min(s.length-a,268435455),p=new Uint8Array(4);l.push(p);var d=Nt(f),h=d.length;l.push(d),f<=60?(h++,l.push(new Uint8Array([f-1<<2]))):f<=256?(h+=2,l.push(new Uint8Array([240,f-1&255]))):f<=65536?(h+=3,l.push(new Uint8Array([244,f-1&255,f-1>>8&255]))):f<=16777216?(h+=4,l.push(new Uint8Array([248,f-1&255,f-1>>8&255,f-1>>16&255]))):f<=4294967296&&(h+=5,l.push(new Uint8Array([252,f-1&255,f-1>>8&255,f-1>>16&255,f-1>>>24&255]))),l.push(s.slice(a,a+f)),h+=f,p[0]=0,p[1]=255&h,p[2]=h>>8&255,p[3]=h>>16&255,a+=f}return ho(l)}function _n(s,l){var a=new Uint8Array(32),f=Wn(a),p=12,d=0;switch(a[0]=5,s.t){case"n":a[1]=2,function vo(s,l,a){var f=Math.floor(0==a?0:Math.LOG10E*Math.log(Math.abs(a)))+6176-20,p=a/Math.pow(10,f-6176);s[l+15]|=f>>7,s[l+14]|=(127&f)<<1;for(var d=0;p>=1;++d,p/=256)s[l+d]=255&p;s[l+15]|=a>=0?0:128}(a,p,s.v),d|=1,p+=16;break;case"b":a[1]=6,f.setFloat64(p,s.v?1:0,!0),d|=2,p+=8;break;case"s":if(-1==l.indexOf(s.v))throw new Error("Value ".concat(s.v," missing from SST!"));a[1]=3,f.setUint32(p,l.indexOf(s.v),!0),d|=8,p+=4;break;default:throw"unsupported cell type "+s.t}return f.setUint32(8,d,!0),a.slice(0,p)}function Ou(s,l){var a=new Uint8Array(32),f=Wn(a),p=12,d=0;switch(a[0]=3,s.t){case"n":a[2]=2,f.setFloat64(p,s.v,!0),d|=32,p+=8;break;case"b":a[2]=6,f.setFloat64(p,s.v?1:0,!0),d|=32,p+=8;break;case"s":if(-1==l.indexOf(s.v))throw new Error("Value ".concat(s.v," missing from SST!"));a[2]=3,f.setUint32(p,l.indexOf(s.v),!0),d|=16,p+=4;break;default:throw"unsupported cell type "+s.t}return f.setUint32(4,d,!0),a.slice(0,p)}function Yr(s){return $a(Lt(s)[1][0].data)}function $C(s,l,a){var f,p,d,h;if(null==(f=s[6])||!f[0]||null==(p=s[7])||!p[0])throw"Mutation only works on post-BNC storages!";if((null==(h=null==(d=s[8])?void 0:d[0])?void 0:h.data)&&ur(s[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var y=0,w=Wn(s[7][0].data),S=0,E=[],R=Wn(s[4][0].data),T=0,A=[],x=0;x<l.length;++x)if(null!=l[x]){var b,H;switch(w.setUint16(2*x,S,!0),R.setUint16(2*x,T,!0),typeof l[x]){case"string":b=_n({t:"s",v:l[x]},a),H=Ou({t:"s",v:l[x]},a);break;case"number":b=_n({t:"n",v:l[x]},a),H=Ou({t:"n",v:l[x]},a);break;case"boolean":b=_n({t:"b",v:l[x]},a),H=Ou({t:"b",v:l[x]},a);break;default:throw new Error("Unsupported value "+l[x])}E.push(b),S+=b.length,A.push(H),T+=H.length,++y}else w.setUint16(2*x,65535,!0),R.setUint16(2*x,65535);for(s[2][0].data=Nt(y);x<s[7][0].data.length/2;++x)w.setUint16(2*x,65535,!0),R.setUint16(2*x,65535,!0);return s[6][0].data=ho(E),s[3][0].data=ho(A),y}function Uo(s){return function(a){for(var f=0;f!=s.length;++f){var p=s[f];void 0===a[p[0]]&&(a[p[0]]=p[1]),"n"===p[2]&&(a[p[0]]=Number(a[p[0]]))}}}function t(s){Uo([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(s)}function v(s,l){return"ods"==l.bookType?ch(s,l):"numbers"==l.bookType?function Xa(s,l){if(!l||!l.numbers)throw new Error("Must pass a `numbers` option -- check the README");var a=s.Sheets[s.SheetNames[0]];s.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var f=mr(a["!ref"]);f.s.r=f.s.c=0;var p=!1;f.e.c>9&&(p=!0,f.e.c=9),f.e.r>49&&(p=!0,f.e.r=49),p&&console.error("The Numbers writer is currently limited to ".concat(lt(f)));var d=ph(a,{range:f,header:1}),h=["~Sh33tJ5~"];d.forEach(function(X){return X.forEach(function(Y){"string"==typeof Y&&h.push(Y)})});var g={},y=[],w=tt.read(l.numbers,{type:"base64"});w.FileIndex.map(function(X,Y){return[X,w.FullPaths[Y]]}).forEach(function(X){var Y=X[0],ye=X[1];2==Y.type&&Y.name.match(/\.iwa/)&&Ni(ki(Y.content)).forEach(function(xe){y.push(xe.id),g[xe.id]={deps:[],location:ye,type:ur(xe.messages[0].meta[1][0].data)}})}),y.sort(function(X,Y){return X-Y});var S=y.filter(function(X){return X>1}).map(function(X){return[X,Nt(X)]});w.FileIndex.map(function(X,Y){return[X,w.FullPaths[Y]]}).forEach(function(X){var Y=X[0];X[1],Y.name.match(/\.iwa/)&&Ni(ki(Y.content)).forEach(function(Fe){Fe.messages.forEach(function(Pe){S.forEach(function(xe){Fe.messages.some(function(Rt){return 11006!=ur(Rt.meta[1][0].data)&&function Tu(s,l){e:for(var a=0;a<=s.length-l.length;++a){for(var f=0;f<l.length;++f)if(s[a+f]!=l[f])continue e;return!0}return!1}(Rt.data,xe[1])})&&g[xe[0]].deps.push(Fe.id)})})})});for(var A,R=tt.find(w,g[1].location),T=Ni(ki(R.content)),x=0;x<T.length;++x){var b=T[x];1==b.id&&(A=b)}var H=Yr(Lt(A.messages[0].data)[1][0].data);for(T=Ni(ki((R=tt.find(w,g[H].location)).content)),x=0;x<T.length;++x)(b=T[x]).id==H&&(A=b);for(H=Yr(Lt(A.messages[0].data)[2][0].data),T=Ni(ki((R=tt.find(w,g[H].location)).content)),x=0;x<T.length;++x)(b=T[x]).id==H&&(A=b);for(H=Yr(Lt(A.messages[0].data)[2][0].data),T=Ni(ki((R=tt.find(w,g[H].location)).content)),x=0;x<T.length;++x)(b=T[x]).id==H&&(A=b);var G=Lt(A.messages[0].data);G[6][0].data=Nt(f.e.r+1),G[7][0].data=Nt(f.e.c+1);for(var N=Yr(G[46][0].data),Q=tt.find(w,g[N].location),ie=Ni(ki(Q.content)),ce=0;ce<ie.length&&ie[ce].id!=N;++ce);if(ie[ce].id!=N)throw"Bad ColumnRowUIDMapArchive";var K=Lt(ie[ce].messages[0].data);K[1]=[],K[2]=[],K[3]=[];for(var te=0;te<=f.e.c;++te){var J=[];J[1]=J[2]=[{type:0,data:Nt(te+420690)}],K[1].push({type:2,data:Ar(J)}),K[2].push({type:0,data:Nt(te)}),K[3].push({type:0,data:Nt(te)})}K[4]=[],K[5]=[],K[6]=[];for(var fe=0;fe<=f.e.r;++fe)(J=[])[1]=J[2]=[{type:0,data:Nt(fe+726270)}],K[4].push({type:2,data:Ar(J)}),K[5].push({type:0,data:Nt(fe)}),K[6].push({type:0,data:Nt(fe)});ie[ce].messages[0].data=Ar(K),Q.content=Qi(Vo(ie)),Q.size=Q.content.length,delete G[46];var he=Lt(G[4][0].data);he[7][0].data=Nt(f.e.r+1);var Ie=Yr(Lt(he[1][0].data)[2][0].data);if((ie=Ni(ki((Q=tt.find(w,g[Ie].location)).content)))[0].id!=Ie)throw"Bad HeaderStorageBucket";var Ke=Lt(ie[0].messages[0].data);for(fe=0;fe<d.length;++fe){var ke=Lt(Ke[2][0].data);ke[1][0].data=Nt(fe),ke[4][0].data=Nt(d[fe].length),Ke[2][fe]={type:Ke[2][0].type,data:Ar(ke)}}ie[0].messages[0].data=Ar(Ke),Q.content=Qi(Vo(ie)),Q.size=Q.content.length;var ut=Yr(he[2][0].data);if((ie=Ni(ki((Q=tt.find(w,g[ut].location)).content)))[0].id!=ut)throw"Bad HeaderStorageBucket";for(Ke=Lt(ie[0].messages[0].data),te=0;te<=f.e.c;++te)(ke=Lt(Ke[2][0].data))[1][0].data=Nt(te),ke[4][0].data=Nt(f.e.r+1),Ke[2][te]={type:Ke[2][0].type,data:Ar(ke)};ie[0].messages[0].data=Ar(Ke),Q.content=Qi(Vo(ie)),Q.size=Q.content.length;var Qe=Yr(he[4][0].data);!function(){for(var ye,X=tt.find(w,g[Qe].location),Y=Ni(ki(X.content)),Be=0;Be<Y.length;++Be){var Fe=Y[Be];Fe.id==Qe&&(ye=Fe)}var Pe=Lt(ye.messages[0].data);Pe[3]=[];var xe=[];h.forEach(function(jt,At){xe[1]=[{type:0,data:Nt(At)}],xe[2]=[{type:0,data:Nt(1)}],xe[3]=[{type:2,data:GC(jt)}],Pe[3].push({type:2,data:Ar(xe)})}),ye.messages[0].data=Ar(Pe);var U=Qi(Vo(Y));X.content=U,X.size=X.content.length}();var Ot=Lt(he[3][0].data),je=Ot[1][0];delete Ot[2];var pt=Lt(je.data),Ee=Yr(pt[2][0].data);!function(){for(var ye,X=tt.find(w,g[Ee].location),Y=Ni(ki(X.content)),Be=0;Be<Y.length;++Be){var Fe=Y[Be];Fe.id==Ee&&(ye=Fe)}var Pe=Lt(ye.messages[0].data);delete Pe[6],delete Ot[7];var xe=new Uint8Array(Pe[5][0].data);Pe[5]=[];for(var Rt=0,U=0;U<=f.e.r;++U){var jt=Lt(xe);Rt+=$C(jt,d[U],h),jt[1][0].data=Nt(U),Pe[5].push({data:Ar(jt),type:2})}Pe[1]=[{type:0,data:Nt(f.e.c+1)}],Pe[2]=[{type:0,data:Nt(f.e.r+1)}],Pe[3]=[{type:0,data:Nt(Rt)}],Pe[4]=[{type:0,data:Nt(f.e.r+1)}],ye.messages[0].data=Ar(Pe);var zt=Qi(Vo(Y));X.content=zt,X.size=X.content.length}(),je.data=Ar(pt),he[3][0].data=Ar(Ot),G[4][0].data=Ar(he),A.messages[0].data=Ar(G);var ae=Qi(Vo(T));return R.content=ae,R.size=R.content.length,w}(s,l):"xlsb"==l.bookType?function m(s,l){xs=1024,s&&!s.SSF&&(s.SSF=Bt(ot)),s&&s.SSF&&(qn(),Gs(s.SSF),l.revssf=Hs(s.SSF),l.revssf[s.SSF[65535]]=0,l.ssf=s.SSF),l.rels={},l.wbrels={},l.Strings=[],l.Strings.Count=0,l.Strings.Unique=0,Ra?l.revStrings=new Map:(l.revStrings={},l.revStrings.foo=[],delete l.revStrings.foo);var a="xlsb"==l.bookType?"bin":"xml",f=vd.indexOf(l.bookType)>-1,p={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};t(l=l||{});var d=dl(),h="",g=0;if(l.cellXfs=[],oi(l.cellXfs,{},{revssf:{General:0}}),s.Props||(s.Props={}),yt(d,h="docProps/core.xml",nc(s.Props,l)),p.coreprops.push(h),Ue(l.rels,2,h,gt.CORE_PROPS),h="docProps/app.xml",!s.Props||!s.Props.SheetNames)if(s.Workbook&&s.Workbook.Sheets){for(var y=[],w=0;w<s.SheetNames.length;++w)2!=(s.Workbook.Sheets[w]||{}).Hidden&&y.push(s.SheetNames[w]);s.Props.SheetNames=y}else s.Props.SheetNames=s.SheetNames;for(s.Props.Worksheets=s.Props.SheetNames.length,yt(d,h,vp(s.Props)),p.extprops.push(h),Ue(l.rels,3,h,gt.EXT_PROPS),s.Custprops!==s.Props&&qt(s.Custprops||{}).length>0&&(yt(d,h="docProps/custom.xml",mp(s.Custprops)),p.custprops.push(h),Ue(l.rels,4,h,gt.CUST_PROPS)),g=1;g<=s.SheetNames.length;++g){var S={"!id":{}},E=s.Sheets[s.SheetNames[g-1]];(E||{})["!type"];if(yt(d,h="xl/worksheets/sheet"+g+"."+a,hf(g-1,h,l,s,S)),p.sheets.push(h),Ue(l.wbrels,-1,"worksheets/sheet"+g+"."+a,gt.WS[0]),E){var T=E["!comments"],A=!1,x="";T&&T.length>0&&(yt(d,x="xl/comments"+g+"."+a,vf(T,x,l)),p.comments.push(x),Ue(S,-1,"../comments"+g+"."+a,gt.CMNT),A=!0),E["!legacy"]&&A&&yt(d,"xl/drawings/vmlDrawing"+g+".vml",kc(g,E["!comments"])),delete E["!comments"],delete E["!legacy"]}S["!id"].rId1&&yt(d,ra(h),ps(S))}return null!=l.Strings&&l.Strings.length>0&&(yt(d,h="xl/sharedStrings."+a,function lC(s,l,a){return(".bin"===l.slice(-4)?dg:Hl)(s,a)}(l.Strings,h,l)),p.strs.push(h),Ue(l.wbrels,-1,"sharedStrings."+a,gt.SST)),yt(d,h="xl/workbook."+a,function sC(s,l,a){return(".bin"===l.slice(-4)?Jy:pf)(s,a)}(s,h,l)),p.workbooks.push(h),Ue(l.rels,1,h,gt.WB),yt(d,h="xl/theme/theme1.xml",$l(s.Themes,l)),p.themes.push(h),Ue(l.wbrels,-1,"theme/theme1.xml",gt.THEME),yt(d,h="xl/styles."+a,function aC(s,l,a){return(".bin"===l.slice(-4)?Mc:ed)(s,a)}(s,h,l)),p.styles.push(h),Ue(l.wbrels,-1,"styles."+a,gt.STY),s.vbaraw&&f&&(yt(d,h="xl/vbaProject.bin",s.vbaraw),p.vba.push(h),Ue(l.wbrels,-1,"vbaProject.bin",gt.VBA)),yt(d,h="xl/metadata."+a,function uC(s){return(".bin"===s.slice(-4)?l0:cd)()}(h)),p.metadata.push(h),Ue(l.wbrels,-1,"metadata."+a,gt.XLMETA),yt(d,"[Content_Types].xml",Tl(p,l)),yt(d,"_rels/.rels",ps(l.rels)),yt(d,"xl/_rels/workbook."+a+".rels",ps(l.wbrels)),delete l.revssf,delete l.ssf,d}(s,l):C(s,l)}function C(s,l){xs=1024,s&&!s.SSF&&(s.SSF=Bt(ot)),s&&s.SSF&&(qn(),Gs(s.SSF),l.revssf=Hs(s.SSF),l.revssf[s.SSF[65535]]=0,l.ssf=s.SSF),l.rels={},l.wbrels={},l.Strings=[],l.Strings.Count=0,l.Strings.Unique=0,Ra?l.revStrings=new Map:(l.revStrings={},l.revStrings.foo=[],delete l.revStrings.foo);var a="xml",f=vd.indexOf(l.bookType)>-1,p={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};t(l=l||{});var d=dl(),h="",g=0;if(l.cellXfs=[],oi(l.cellXfs,{},{revssf:{General:0}}),s.Props||(s.Props={}),yt(d,h="docProps/core.xml",nc(s.Props,l)),p.coreprops.push(h),Ue(l.rels,2,h,gt.CORE_PROPS),h="docProps/app.xml",!s.Props||!s.Props.SheetNames)if(s.Workbook&&s.Workbook.Sheets){for(var y=[],w=0;w<s.SheetNames.length;++w)2!=(s.Workbook.Sheets[w]||{}).Hidden&&y.push(s.SheetNames[w]);s.Props.SheetNames=y}else s.Props.SheetNames=s.SheetNames;s.Props.Worksheets=s.Props.SheetNames.length,yt(d,h,vp(s.Props)),p.extprops.push(h),Ue(l.rels,3,h,gt.EXT_PROPS),s.Custprops!==s.Props&&qt(s.Custprops||{}).length>0&&(yt(d,h="docProps/custom.xml",mp(s.Custprops)),p.custprops.push(h),Ue(l.rels,4,h,gt.CUST_PROPS));var S=["SheetJ5"];for(l.tcid=0,g=1;g<=s.SheetNames.length;++g){var E={"!id":{}},R=s.Sheets[s.SheetNames[g-1]];(R||{})["!type"];if(yt(d,h="xl/worksheets/sheet"+g+"."+a,Pd(g-1,l,s,E)),p.sheets.push(h),Ue(l.wbrels,-1,"worksheets/sheet"+g+"."+a,gt.WS[0]),R){var A=R["!comments"],x=!1,b="";if(A&&A.length>0){var H=!1;A.forEach(function(G){G[1].forEach(function(N){1==N.T&&(H=!0)})}),H&&(yt(d,b="xl/threadedComments/threadedComment"+g+"."+a,v0(A,S,l)),p.threadedcomments.push(b),Ue(E,-1,"../threadedComments/threadedComment"+g+"."+a,gt.TCMNT)),yt(d,b="xl/comments"+g+"."+a,dd(A)),p.comments.push(b),Ue(E,-1,"../comments"+g+"."+a,gt.CMNT),x=!0}R["!legacy"]&&x&&yt(d,"xl/drawings/vmlDrawing"+g+".vml",kc(g,R["!comments"])),delete R["!comments"],delete R["!legacy"]}E["!id"].rId1&&yt(d,ra(h),ps(E))}return null!=l.Strings&&l.Strings.length>0&&(yt(d,h="xl/sharedStrings."+a,Hl(l.Strings,l)),p.strs.push(h),Ue(l.wbrels,-1,"sharedStrings."+a,gt.SST)),yt(d,h="xl/workbook."+a,pf(s)),p.workbooks.push(h),Ue(l.rels,1,h,gt.WB),yt(d,h="xl/theme/theme1.xml",$l(s.Themes,l)),p.themes.push(h),Ue(l.wbrels,-1,"theme/theme1.xml",gt.THEME),yt(d,h="xl/styles."+a,ed(s,l)),p.styles.push(h),Ue(l.wbrels,-1,"styles."+a,gt.STY),s.vbaraw&&f&&(yt(d,h="xl/vbaProject.bin",s.vbaraw),p.vba.push(h),Ue(l.wbrels,-1,"vbaProject.bin",gt.VBA)),yt(d,h="xl/metadata."+a,cd()),p.metadata.push(h),Ue(l.wbrels,-1,"metadata."+a,gt.XLMETA),S.length>1&&(yt(d,h="xl/persons/person.xml",function g0(s){var l=[sr,Ae("personList",null,{xmlns:ar.TCMNT,"xmlns:x":Fn[0]}).replace(/[\/]>/,">")];return s.forEach(function(a,f){l.push(Ae("person",null,{displayName:a,id:"{54EE7950-7262-4200-6969-"+("000000000000"+f).slice(-12)+"}",userId:a,providerId:"None"}))}),l.push("</personList>"),l.join("")}(S)),p.people.push(h),Ue(l.wbrels,-1,"persons/person.xml",gt.PEOPLE)),yt(d,"[Content_Types].xml",Tl(p,l)),yt(d,"_rels/.rels",ps(l.rels)),yt(d,"xl/_rels/workbook.xml.rels",ps(l.wbrels)),delete l.revssf,delete l.ssf,d}function _(s,l){var a="";switch((l||{}).type||"base64"){case"buffer":case"array":return[s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7]];case"base64":a=yi(s.slice(0,12));break;case"binary":a=s;break;default:throw new Error("Unrecognized type "+(l&&l.type||"undefined"))}return[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3),a.charCodeAt(4),a.charCodeAt(5),a.charCodeAt(6),a.charCodeAt(7)]}function be(s,l){switch(l.type){case"base64":case"binary":break;case"buffer":case"array":l.type="";break;case"file":return we(l.file,tt.write(s,{type:St?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+l.bookType+"' files");default:throw new Error("Unrecognized type "+l.type)}return tt.write(s,l)}function ze(s,l){var a={},f=St?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(l.compression&&(a.compression="DEFLATE"),l.password)a.type=f;else switch(l.type){case"base64":a.type="base64";break;case"binary":a.type="string";break;case"string":throw new Error("'string' output type invalid for '"+l.bookType+"' files");case"buffer":case"file":a.type=f;break;default:throw new Error("Unrecognized type "+l.type)}var p=s.FullPaths?tt.write(s,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[a.type]||a.type,compression:!!l.compression}):s.generate(a);if(typeof Deno<"u"&&"string"==typeof p){if("binary"==l.type||"base64"==l.type)return p;p=new Uint8Array(ks(p))}return l.password&&typeof encrypt_agile<"u"?be(encrypt_agile(p,l.password),l):"file"===l.type?we(l.file,p):"string"==l.type?vt(p):p}function nt(s,l,a){a||(a="");var f=a+s;switch(l.type){case"base64":return Yo(ji(f));case"binary":return ji(f);case"string":return s;case"file":return we(l.file,f,"utf8");case"buffer":return St?en(f,"utf8"):typeof TextEncoder<"u"?(new TextEncoder).encode(f):nt(f,{type:"binary"}).split("").map(function(p){return p.charCodeAt(0)})}throw new Error("Unrecognized type "+l.type)}function Et(s,l){switch(l.type){case"string":case"base64":case"binary":for(var a="",f=0;f<s.length;++f)a+=String.fromCharCode(s[f]);return"base64"==l.type?Yo(a):"string"==l.type?vt(a):a;case"file":return we(l.file,s);case"buffer":return s;default:throw new Error("Unrecognized type "+l.type)}}function Xr(s,l){Fr(),jd(s);var a=Bt(l||{});if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),"array"==a.type){a.type="binary";var f=Xr(s,a);return a.type="array",ks(f)}var p=0;if(a.sheet&&(p="number"==typeof a.sheet?a.sheet:s.SheetNames.indexOf(a.sheet),!s.SheetNames[p]))throw new Error("Sheet not found: "+a.sheet+" : "+typeof a.sheet);switch(a.bookType||"xlsb"){case"xml":case"xlml":return nt(_C(s,a),a);case"slk":case"sylk":return nt(Kp.from_sheet(s.Sheets[s.SheetNames[p]],a),a);case"htm":case"html":return nt(rh(s.Sheets[s.SheetNames[p]],a),a);case"txt":return function Gt(s,l){switch(l.type){case"base64":return Yo(s);case"binary":case"string":return s;case"file":return we(l.file,s,"binary");case"buffer":return St?en(s,"binary"):s.split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+l.type)}(Rw(s.Sheets[s.SheetNames[p]],a),a);case"csv":return nt(YC(s.Sheets[s.SheetNames[p]],a),a,"\ufeff");case"dif":return nt(hn.from_sheet(s.Sheets[s.SheetNames[p]],a),a);case"dbf":return Et(fa.from_sheet(s.Sheets[s.SheetNames[p]],a),a);case"prn":return nt(xt.from_sheet(s.Sheets[s.SheetNames[p]],a),a);case"rtf":return nt(Qp.from_sheet(s.Sheets[s.SheetNames[p]],a),a);case"eth":return nt(bt.from_sheet(s.Sheets[s.SheetNames[p]],a),a);case"fods":return nt(ch(s,a),a);case"wk1":return Et(Lo.sheet_to_wk1(s.Sheets[s.SheetNames[p]],a),a);case"wk3":return Et(Lo.book_to_wk3(s,a),a);case"biff2":a.biff||(a.biff=2);case"biff3":a.biff||(a.biff=3);case"biff4":return a.biff||(a.biff=4),Et(Cf(s,a),a);case"biff5":a.biff||(a.biff=5);case"biff8":case"xla":case"xls":return a.biff||(a.biff=8),function st(s,l){var a=l||{};return be(qd(s,a),a)}(s,a);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function qe(s,l){var a=Bt(l||{});return ze(v(s,a),a)}(s,a);default:throw new Error("Unrecognized bookType |"+a.bookType+"|")}}function Yt(s){if(!s.bookType){var a=s.file.slice(s.file.lastIndexOf(".")).toLowerCase();a.match(/^\.[a-z]+$/)&&(s.bookType=a.slice(1)),s.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[s.bookType]||s.bookType}}function Ht(s,l,a){var f=a||{};return f.type="file",f.file=l,Yt(f),Xr(s,f)}function qa(s,l,a,f,p,d,h,g){var y=lr(a),w=g.defval,S=g.raw||!Object.prototype.hasOwnProperty.call(g,"raw"),E=!0,R=1===p?[]:{};if(1!==p)if(Object.defineProperty)try{Object.defineProperty(R,"__rowNum__",{value:a,enumerable:!1})}catch{R.__rowNum__=a}else R.__rowNum__=a;if(!h||s[a])for(var T=l.s.c;T<=l.e.c;++T){var A=h?s[a][T]:s[f[T]+y];if(void 0!==A&&void 0!==A.t){var x=A.v;switch(A.t){case"z":if(null==x)break;continue;case"e":x=0==x?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+A.t)}if(null!=d[T]){if(null==x)if("e"==A.t&&null===x)R[d[T]]=null;else if(void 0!==w)R[d[T]]=w;else{if(!S||null!==x)continue;R[d[T]]=null}else R[d[T]]=S&&("n"!==A.t||"n"===A.t&&!1!==g.rawNumbers)?x:Ei(A,x,g);null!=x&&(E=!1)}}else{if(void 0===w)continue;null!=d[T]&&(R[d[T]]=w)}}return{row:R,isempty:E}}function ph(s,l){if(null==s||null==s["!ref"])return[];var a={t:"n",v:0},f=0,p=1,d=[],h=0,g="",y={s:{r:0,c:0},e:{r:0,c:0}},w=l||{},S=null!=w.range?w.range:s["!ref"];switch(1===w.header?f=1:"A"===w.header?f=2:Array.isArray(w.header)?f=3:null==w.header&&(f=0),typeof S){case"string":y=Ct(S);break;case"number":(y=Ct(s["!ref"])).s.r=S;break;default:y=S}f>0&&(p=0);var E=lr(y.s.r),R=[],T=[],A=0,x=0,b=Array.isArray(s),H=y.s.r,G=0,N={};b&&!s[H]&&(s[H]=[]);var Q=w.skipHidden&&s["!cols"]||[],ie=w.skipHidden&&s["!rows"]||[];for(G=y.s.c;G<=y.e.c;++G)if(!(Q[G]||{}).hidden)switch(R[G]=$t(G),a=b?s[H][G]:s[R[G]+E],f){case 1:d[G]=G-y.s.c;break;case 2:d[G]=R[G];break;case 3:d[G]=w.header[G-y.s.c];break;default:if(null==a&&(a={w:"__EMPTY",t:"s"}),g=h=Ei(a,null,w),x=N[h]||0){do{g=h+"_"+x++}while(N[g]);N[h]=x,N[g]=1}else N[h]=1;d[G]=g}for(H=y.s.r+p;H<=y.e.r;++H)if(!(ie[H]||{}).hidden){var ce=qa(s,y,H,R,f,d,b,w);(!1===ce.isempty||(1===f?!1!==w.blankrows:w.blankrows))&&(T[A++]=ce.row)}return T.length=A,T}var xw=/"/g;function Ew(s,l,a,f,p,d,h,g){for(var y=!0,w=[],S="",E=lr(a),R=l.s.c;R<=l.e.c;++R)if(f[R]){var T=g.dense?(s[a]||[])[R]:s[f[R]+E];if(null==T)S="";else if(null!=T.v){y=!1,S=""+(g.rawNumbers&&"n"==T.t?T.v:Ei(T,null,g));for(var A=0,x=0;A!==S.length;++A)if((x=S.charCodeAt(A))===p||x===d||34===x||g.forceQuotes){S='"'+S.replace(xw,'""')+'"';break}"ID"==S&&(S='"ID"')}else null==T.f||T.F?S="":(y=!1,(S="="+T.f).indexOf(",")>=0&&(S='"'+S.replace(xw,'""')+'"'));w.push(S)}return!1===g.blankrows&&y?null:w.join(h)}function YC(s,l){var a=[],f=l??{};if(null==s||null==s["!ref"])return"";var p=Ct(s["!ref"]),d=void 0!==f.FS?f.FS:",",h=d.charCodeAt(0),g=void 0!==f.RS?f.RS:"\n",y=g.charCodeAt(0),w=new RegExp(("|"==d?"\\|":d)+"+$"),S="",E=[];f.dense=Array.isArray(s);for(var R=f.skipHidden&&s["!cols"]||[],T=f.skipHidden&&s["!rows"]||[],A=p.s.c;A<=p.e.c;++A)(R[A]||{}).hidden||(E[A]=$t(A));for(var x=0,b=p.s.r;b<=p.e.r;++b)(T[b]||{}).hidden||null!=(S=Ew(s,p,b,E,h,y,d,f))&&(f.strip&&(S=S.replace(w,"")),(S||!1!==f.blankrows)&&a.push((x++?g:"")+S));return delete f.dense,a.join("")}function Rw(s,l){l||(l={}),l.FS="\t",l.RS="\n";var a=YC(s,l);if(typeof Xe>"u"||"string"==l.type)return a;var f=Xe.utils.encode(1200,a,"str");return String.fromCharCode(255)+String.fromCharCode(254)+f}function Tw(s,l,a){var f=a||{},p=+!f.skipHeader,d=s||{},h=0,g=0;if(d&&null!=f.origin)if("number"==typeof f.origin)h=f.origin;else{var y="string"==typeof f.origin?Ze(f.origin):f.origin;h=y.r,g=y.c}var w,S={s:{c:0,r:0},e:{c:g,r:h+l.length-1+p}};if(d["!ref"]){var E=Ct(d["!ref"]);S.e.c=Math.max(S.e.c,E.e.c),S.e.r=Math.max(S.e.r,E.e.r),-1==h&&(h=E.e.r+1,S.e.r=h+l.length-1+p)}else-1==h&&(h=0,S.e.r=l.length-1+p);var R=f.header||[],T=0;l.forEach(function(x,b){qt(x).forEach(function(H){-1==(T=R.indexOf(H))&&(R[T=R.length]=H);var G=x[H],N="z",Q="",ie=at({c:g+T,r:h+b+p});w=Sf(d,ie),!G||"object"!=typeof G||G instanceof Date?("number"==typeof G?N="n":"boolean"==typeof G?N="b":"string"==typeof G?N="s":G instanceof Date?(N="d",f.cellDates||(N="n",G=Cr(G)),Q=f.dateNF||ot[14]):null===G&&f.nullError&&(N="e",G=0),w?(w.t=N,w.v=G,delete w.w,delete w.R,Q&&(w.z=Q)):d[ie]=w={t:N,v:G},Q&&(w.z=Q)):d[ie]=G})}),S.e.c=Math.max(S.e.c,g+R.length-1);var A=lr(h);if(p)for(T=0;T<R.length;++T)d[$t(T+g)+A]={t:"s",v:R[T]};return d["!ref"]=lt(S),d}function Sf(s,l,a){if("string"==typeof l){if(Array.isArray(s)){var f=Ze(l);return s[f.r]||(s[f.r]=[]),s[f.r][f.c]||(s[f.r][f.c]={t:"z"})}return s[l]||(s[l]={t:"z"})}return Sf(s,at("number"!=typeof l?l:{r:l,c:a||0}))}function XC(){return{SheetNames:[],Sheets:{}}}function qC(s,l,a,f){var p=1;if(!a)for(;p<=65535&&-1!=s.SheetNames.indexOf(a="Sheet"+p);++p,a=void 0);if(!a||s.SheetNames.length>=65535)throw new Error("Too many worksheets");if(f&&s.SheetNames.indexOf(a)>=0){var d=a.match(/(^.*?)(\d+)$/);p=d&&+d[2]||0;var h=d&&d[1]||a;for(++p;p<=65535&&-1!=s.SheetNames.indexOf(a=h+p);++p);}if(Ud(a),s.SheetNames.indexOf(a)>=0)throw new Error("Worksheet with name |"+a+"| already exists!");return s.SheetNames.push(a),s.Sheets[a]=l,a}function Ow(s,l,a){return l?(s.l={Target:l},a&&(s.l.Tooltip=a)):delete s.l,s}var Bw={encode_col:$t,encode_row:lr,encode_cell:at,encode_range:lt,decode_col:ss,decode_row:ln,split_cell:function Xu(s){return s.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Ze,decode_range:mr,format_cell:Ei,sheet_add_aoa:Ys,sheet_add_json:Tw,sheet_add_dom:ih,aoa_to_sheet:cn,json_to_sheet:function Iw(s,l){return Tw(null,s,l)},table_to_sheet:za,table_to_book:function MC(s,l){return un(za(s,l),l)},sheet_to_csv:YC,sheet_to_txt:Rw,sheet_to_json:ph,sheet_to_html:rh,sheet_to_formulae:function Pw(s){var a,l="",f="";if(null==s||null==s["!ref"])return[];var g,p=Ct(s["!ref"]),d="",h=[],y=[],w=Array.isArray(s);for(g=p.s.c;g<=p.e.c;++g)h[g]=$t(g);for(var S=p.s.r;S<=p.e.r;++S)for(d=lr(S),g=p.s.c;g<=p.e.c;++g)if(l=h[g]+d,f="",void 0!==(a=w?(s[S]||[])[g]:s[l])){if(null!=a.F){if(l=a.F,!a.f)continue;f=a.f,-1==l.indexOf(":")&&(l=l+":"+l)}if(null!=a.f)f=a.f;else{if("z"==a.t)continue;if("n"==a.t&&null!=a.v)f=""+a.v;else if("b"==a.t)f=a.v?"TRUE":"FALSE";else if(void 0!==a.w)f="'"+a.w;else{if(void 0===a.v)continue;f="s"==a.t?"'"+a.v:""+a.v}}y[y.length]=l+"="+f}return y},sheet_to_row_object_array:ph,sheet_get_cell:Sf,book_new:XC,book_append_sheet:qC,book_set_sheet_visibility:function Mw(s,l,a){s.Workbook||(s.Workbook={}),s.Workbook.Sheets||(s.Workbook.Sheets=[]);var f=function Lw(s,l){if("number"==typeof l){if(l>=0&&s.SheetNames.length>l)return l;throw new Error("Cannot find sheet # "+l)}if("string"==typeof l){var a=s.SheetNames.indexOf(l);if(a>-1)return a;throw new Error("Cannot find sheet name |"+l+"|")}throw new Error("Cannot find sheet |"+l+"|")}(s,l);switch(s.Workbook.Sheets[f]||(s.Workbook.Sheets[f]={}),a){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+a)}s.Workbook.Sheets[f].Hidden=a},cell_set_number_format:function Nw(s,l){return s.z=l,s},cell_set_hyperlink:Ow,cell_set_internal_link:function kw(s,l,a){return Ow(s,"#"+l,a)},cell_add_comment:function Gw(s,l,a){s.c||(s.c=[]),s.c.push({t:l,a:a||"SheetJS"})},sheet_set_array_formula:function Hw(s,l,a,f){for(var p="string"!=typeof l?l:Ct(l),d="string"==typeof l?l:lt(l),h=p.s.r;h<=p.e.r;++h)for(var g=p.s.c;g<=p.e.c;++g){var y=Sf(s,h,g);y.t="n",y.F=d,delete y.v,h==p.s.r&&g==p.s.c&&(y.f=a,f&&(y.D=!0))}return s},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};Se.version}}]);