"use strict";(self.webpackChunkroadis_app=self.webpackChunkroadis_app||[]).push([[8653],{85246:(M,p,r)=>{r.d(p,{B:()=>s});var e=r(94650),c=r(36895),f=r(58390);const h=["grid"];function g(_,u){if(1&_){const l=e.EpF();e.TgZ(0,"div",8),e.NdJ("click",function(){e.CHM(l);const C=e.oxw();return e.KtG(C.onAgregarClick())}),e.TgZ(1,"button",9),e._uU(2),e.qZA()()}if(2&_){const l=e.oxw();e.xp6(2),e.hij("Agregar ",l.tituloBoton," ")}}class s{constructor(){this.mostrarBotonExcel=!1,this.disableXLS=!1,this.gridClick=new e.vpe,this.agregarClick=new e.vpe,this.excelClick=new e.vpe,this.disableEdit=!0,this.disableDelete=!0}ngOnInit(){this.mapearAccesos()}mapearAccesos(){const u=this.crudConfig.configEliminar;u&&(this.accesoEliminar=u.acceso,this.disableDelete=!1);const l=this.crudConfig.formConfig,d=l&&l.configEditar;d&&(this.accesoEditar=d.acceso,this.disableEdit=!1)}onGridClick(u){this.gridClick.emit(u)}onAgregarClick(){this.agregarClick.emit()}onExcelClick(){this.excelClick.emit()}static#e=this.\u0275fac=function(l){return new(l||s)};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-catalogo-base"]],viewQuery:function(l,d){if(1&l&&e.Gf(h,5),2&l){let C;e.iGM(C=e.CRH())&&(d.grid=C.first)}},inputs:{columns:"columns",titulo:"titulo",tituloBoton:"tituloBoton",gridOptions:"gridOptions",crudConfig:"crudConfig",elementos$:"elementos$",tieneAccesoAgregar$:"tieneAccesoAgregar$",mostrarBotonExcel:"mostrarBotonExcel",disableXLS:"disableXLS"},outputs:{gridClick:"gridClick",agregarClick:"agregarClick",excelClick:"excelClick"},decls:11,vars:17,consts:[[1,"contenedor"],[1,"titulo-contenedor",3,"hidden"],[1,"cuerpo-contenedor"],[1,"row"],[1,"col-12"],["class","contenedor-agregar",3,"click",4,"ngIf"],[3,"headerName","data","gridOptions","children","disableDelete","disableEdit","accesoEditar","accesoEliminar","mostrarBotonExcel","disableXLS","event","exportarExcelEvent"],["grid",""],[1,"contenedor-agregar",3,"click"],[1,"btn-agregar"]],template:function(l,d){1&l&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2),e.qZA(),e.TgZ(3,"div",2)(4,"div",3)(5,"div",4),e.YNc(6,g,3,1,"div",5),e.ALo(7,"async"),e.TgZ(8,"app-grid-general",6,7),e.NdJ("event",function(T){return d.onGridClick(T)})("exportarExcelEvent",function(){return d.onExcelClick()}),e.ALo(10,"async"),e.qZA()()()()()),2&l&&(e.xp6(1),e.Q6J("hidden",null==d.titulo),e.xp6(1),e.hij(" ",d.titulo," "),e.xp6(4),e.Q6J("ngIf",e.lcZ(7,13,d.tieneAccesoAgregar$)),e.xp6(2),e.Q6J("headerName",d.crudConfig.nombreEntidad)("data",e.lcZ(10,15,d.elementos$))("gridOptions",d.gridOptions)("children",d.columns)("disableDelete",d.disableDelete)("disableEdit",d.disableEdit)("accesoEditar",d.accesoEditar)("accesoEliminar",d.accesoEliminar)("mostrarBotonExcel",d.mostrarBotonExcel)("disableXLS",d.disableXLS))},dependencies:[c.O5,f.$,c.Ov]})}},92020:(M,p,r)=>{r.d(p,{A:()=>g});var e=r(20388),c=r(63405),f=r(71436),h=r(94650);class g{static#e=this.\u0275fac=function(u){return new(u||g)};static#t=this.\u0275mod=h.oAB({type:g});static#i=this.\u0275inj=h.cJS({imports:[c.m,f.a,e.zk.forChild()]})}},27974:(M,p,r)=>{r.d(p,{v:()=>h});var e=r(94540),c=r(40675),f=r(14815);class h{constructor(s,_,u){this.accesoService=s,this.bsModalService=_,this.mensajeService=u}onInit(){this.actualizarGrid(),this.consultarAccesoAgregar()}actualizarGrid(){this.registros$=this.consultarGrid()}consultarAccesoAgregar(){if(!this.crudConfig.formConfig)return;const s=this.crudConfig.formConfig.configAgregar;s&&(this.tieneAccesoAgregar$=this.accesoService.tieneAcceso(s.acceso))}onGridClick(s){const _=this.crudConfig.nombrePropiedadId,u=s.data[_];if(this.esConfig=s.data.esConfig??!1,"number"!=typeof u)throw new Error(`No se pudo obtener el id del elemento. La propiedad "${this.crudConfig.nombrePropiedadId}" no es un n\xfamero.`);({[e.gy.Editar]:()=>this.editar(u),[e.gy.Eliminar]:()=>this.confirmarEliminacion(s.data,u)})[s.accion]()}openForm(s,_){if(!this.crudConfig.formConfig)throw new Error('No se configur\xf3 la propiedad "formConfig" en el objeto "crudConfig"');const u=s===c.V_.Agregar?this.crudConfig.formConfig.configAgregar:this.crudConfig.formConfig.configEditar;if(!u){const C=s===c.V_.Editar?"configEditar":"configAgregar";throw new Error(`No se configur\xf3 la propiedad "${C}" en el objeto "crudConfig"`)}let l={accion:s,idEntidad:_,nombreEntidad:this.crudConfig.nombreEntidad,generoGramatical:this.crudConfig.generoGramatical,esConfig:this.esConfig,...u.params};l.onClose=C=>{C&&this.actualizarGrid(),d.hide()};const d=this.bsModalService.show(this.crudConfig.formConfig.ComponenteFormulario,{initialState:l,...this.crudConfig.formConfig.modalConfig})}agregar(s){void 0!==s?this.openForm(c.V_.Agregar,s):this.openForm(c.V_.Agregar)}editar(s){this.openForm(c.V_.Editar,s)}confirmarEliminacion(s,_){if(!this.crudConfig.configEliminar)throw new Error('No se configur\xf3 la propiedad "configEliminar" en el objeto "crudConfig"');const u=`Eliminar ${this.crudConfig.nombreEntidad}`,[l,d]="masc"===this.crudConfig.generoGramatical?["El","eliminado"]:["La","eliminada"],N=`\xbfDesea eliminar ${`${l.toLowerCase()} ${this.crudConfig.nombreEntidad.toLowerCase()}`}: <strong>${this.crudConfig.configEliminar.elementToString(s)}</strong>?`;this.mensajeService.modalConfirmacion(N,u,f.m.Cruz).then(()=>{const R=`${l} ${this.crudConfig.nombreEntidad.toLowerCase()} ha sido ${d}`;this.eliminar(_).subscribe(()=>{this.mensajeService.modalExito(R),this.actualizarGrid()})}).catch(()=>{})}}},70615:(M,p,r)=>{r.d(p,{P:()=>f});var e=r(40675),c=r(90429);class f{constructor(g){this.mensajeService=g,this.submitting=!1,this.entidad={}}onInit(){this.accion===e.V_.Editar&&this.idEntidad&&this.consultar(this.idEntidad).subscribe({next:g=>{this.entidad=g}})}onSubmit(g){if(this.submitting=!0,!g.valid)return c.CW(g),void(this.submitting=!1);const[s,_]="masc"===this.generoGramatical?["El","o"]:["La","a"],u=this.accion===e.V_.Agregar?`agregad${_}`:`modificad${_}`,l=`${s} ${this.nombreEntidad.toLocaleLowerCase()} ha sido ${u}`;(this.accion===e.V_.Agregar?this.agregar(this.entidad):this.editar(this.entidad)).subscribe({next:()=>{this.mensajeService.modalExito(l),this.onClose(!0)},error:()=>{this.submitting=!1}})}cancelar(g){g=g??!1,this.onClose(g)}}},40675:(M,p,r)=>{r.d(p,{V_:()=>c,aQ:()=>h,vf:()=>f});var c,g;r(40675);(g=c||(c={})).Agregar="Agregar",g.Editar="Editar",g.Ver="Consultar";const f="Seleccione una opci\xf3n",h="No hay opciones disponibles"},14815:(M,p,r)=>{var e,c;r.d(p,{m:()=>e}),(c=e||(e={})).Cruz="fa fa-times",c.Pesos="fa fa-dollar-sign",c.Cambio="fas fa-exchange-alt",c.CheckOut="fas fa-door-open",c.Exito="fas fa-check"},94540:(M,p,r)=>{r.d(p,{gy:()=>c,sO:()=>f});var c,h;r(94540);(h=c||(c={})).Editar="edit",h.Eliminar="delete",h.Ver="see",h.DescargarPdf="DescargarPdf",h.Revisar="Revisar",h.Presentar="presentar";const f={headerName:"",field:"",cellClass:"center-ag",minWidth:44,maxWidth:44,suppressMovable:!0,resizable:!1,filter:!1,lockPinned:!0,pinned:"right",lockPosition:!0}},78653:(M,p,r)=>{r.r(p),r.d(p,{ConfiguracionEntidadModule:()=>I});var e=r(94650),c=r(80529);class f{constructor(t){this.http=t,this.dataUrl="entidad/"}consultar(t){return this.http.get(this.dataUrl+`consultar/${t}`)}consultarPorClave(t){return this.http.get(this.dataUrl+`consultarPorClave/${t}`)}consultarTodosParaGrid(){return this.http.get(this.dataUrl+"consultarTodosParaGrid")}agregar(t){return this.http.post(this.dataUrl+"agregar",t)}editar(t){return this.http.put(this.dataUrl+"editar",t)}eliminar(t){return this.http.delete(this.dataUrl+`eliminar/${t}`)}static#e=this.\u0275fac=function(i){return new(i||f)(e.LFG(c.eN))};static#t=this.\u0275prov=e.Yz7({token:f,factory:f.\u0275fac})}var h=r(92020),g=r(8816),s=r(20388),_=r(41283),u=r(63405),l=r(63666);class d{constructor(t){this.http=t,this.dataUrl="entidadEstructura/"}consultarArbol(t){return this.http.get(this.dataUrl+`consultarArbol/${t}`)}consultarParaTabulador(t){return this.http.get(this.dataUrl+`tabulador/${t}`)}consultarPorEntidadParaSelector(t){return this.http.get(this.dataUrl+`consultarPorEntidadParaSelector/${t}`)}agregar(t){return this.http.post(this.dataUrl+"agregar",t)}eliminar(t){return this.http.delete(this.dataUrl+`eliminar/${t}`)}static#e=this.\u0275fac=function(i){return new(i||d)(e.LFG(c.eN))};static#t=this.\u0275prov=e.Yz7({token:d,factory:d.\u0275fac})}var C=r(59077),T=r(21890),N=r(88796),R=r(87682);class x{static#e=this.\u0275fac=function(i){return new(i||x)};static#t=this.\u0275mod=e.oAB({type:x});static#i=this.\u0275inj=e.cJS({providers:[f,d,C.t,T.D],imports:[u.m,_.Z,N.A0,l.xc,R.jA,s.zk.forChild()]})}var F=r(9116),S=r(85087),J=r(13050),G=r(27974),b=r(50986),v=r(15861),k=r(70615),q=r(54004),L=r(58390);class Z{constructor(t){this.seccionCampoService=t,this.HEADER_GRID_CAMPOS="Campos",this.columnsCampos=[{headerName:"Clave",field:"clave",minWidth:30},{headerName:"Descripci\xf3n",field:"descripcion",minWidth:30},{headerName:"Dominio",field:"nombreDominio",minWidth:30},{headerName:"Orden",field:"orden",minWidth:30},{headerName:"Requerido",field:"requerido",minWidth:30,valueGetter:i=>this.convertirSiNo(i.data)}]}ngOnInit(){this.consultarGridCampos()}consultarGridCampos(){this.seccionCampoService.consultarPorSeccion(this.idSeccion).subscribe(t=>{this.camposList=t})}cerrar(){this.onClose()}convertirSiNo(t){return t.requerido?"S\xed":"No"}static#e=this.\u0275fac=function(i){return new(i||Z)(e.Y36(C.t))};static#t=this.\u0275cmp=e.Xpm({type:Z,selectors:[["app-seccion-campo-modal"]],decls:16,vars:6,consts:[[1,"d-flex"],[1,"barra-lateral-modal"],[1,"fa","fa-plus"],[1,"modal-content"],[1,"modal-header"],["type","button","aria-label","Close",1,"close","pull-right",3,"click"],[1,"far","fa-times-circle"],[1,"container","cuerpo-contenedor"],[1,"row"],[1,"col-sm-12"],[1,"subseccion"],[1,"col-md-12"],[3,"headerName","data","children","disableEdit","disableDelete","disableXLS"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"i",2),e.qZA(),e.TgZ(3,"div",3)(4,"div",4),e._uU(5," Desglose de Secci\xf3n "),e.TgZ(6,"button",5),e.NdJ("click",function(){return n.cerrar()}),e._UZ(7,"i",6),e.qZA()(),e.TgZ(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10),e._uU(12,"Campos"),e.qZA()()(),e.TgZ(13,"div",8)(14,"div",11),e._UZ(15,"app-grid-general",12),e.qZA()()()()()),2&i&&(e.xp6(15),e.Q6J("headerName",n.HEADER_GRID_CAMPOS)("data",n.camposList)("children",n.columnsCampos)("disableEdit",!0)("disableDelete",!0)("disableXLS",!0))},dependencies:[L.$]})}var y=r(2060),A=r(24006),U=r(36895);const B=["claveEntidadEstructura"],j=["nombreEntidadEstructura"];function $(m,t){1&m&&(e.TgZ(0,"div",25),e._uU(1," La clave es requerida "),e.qZA())}function W(m,t){1&m&&(e.TgZ(0,"div",25),e._uU(1," El nombre es requerido "),e.qZA())}const w=function(m){return{"node-expander-virtual":m}};function Q(m,t){if(1&m){const i=e.EpF();e.TgZ(0,"div",48),e.NdJ("dblclick",function(a){const E=e.CHM(i).$implicit;return e.KtG(E.mouseAction("dblClick",a))}),e._UZ(1,"tree-node-expander",49),e.TgZ(2,"div",50)(3,"div",51),e.NdJ("click",function(){const o=e.CHM(i).$implicit,E=e.oxw(2);return e.KtG(E.eliminarEntidadEstructura(o.data))}),e.qZA()(),e.TgZ(4,"tree-node-content",52),e.NdJ("click",function(){const o=e.CHM(i).$implicit,E=e.oxw(2);return e.KtG(E.seleccionarCuentaPadre(o.data))}),e.qZA()()}if(2&m){const i=t.$implicit,n=t.index,a=e.oxw(2);e.Q6J("ngClass","fondo-impar"),e.xp6(1),e.Q6J("node",i),e.xp6(1),e.Q6J("ngClass",e.VKq(7,w,i.isLeaf&&!i.hasChildren)),e.xp6(1),e.ekj("delete-disabled",a.submitting),e.xp6(1),e.Q6J("node",i)("index",n)}}function K(m,t){if(1&m){const i=e.EpF();e.TgZ(0,"div",45)(1,"div",53)(2,"div",54),e._uU(3,"Secciones"),e.qZA(),e.TgZ(4,"app-grid-general",55),e.NdJ("event",function(a){e.CHM(i);const o=e.oxw(2);return e.KtG(o.onGridClick(a))})("selectionChanged",function(a){e.CHM(i);const o=e.oxw(2);return e.KtG(o.onSelectionChange(a))}),e.qZA()()()}if(2&m){const i=e.oxw(2);e.xp6(4),e.Q6J("headerName",i.HEADER_GRID_SECCIONES)("data",i.seccionesList)("children",i.columnsSeccion)("disableEdit",!0)("disableDelete",!0)("disableXLS",!0)}}function H(m,t){1&m&&(e.TgZ(0,"div",25),e._uU(1," La clave es requerida "),e.qZA())}function Y(m,t){1&m&&(e.TgZ(0,"div",25),e._uU(1," El nombre es requerido "),e.qZA())}function z(m,t){if(1&m){const i=e.EpF();e.TgZ(0,"div",45)(1,"div",12)(2,"div",13)(3,"label",14),e._uU(4,"Clave"),e.qZA(),e.TgZ(5,"div")(6,"input",56,57),e.NdJ("ngModelChange",function(a){e.CHM(i);const o=e.oxw(2);return e.KtG(o.entidadEstructura.clave=a)}),e.qZA(),e.YNc(8,H,2,0,"div",17),e.qZA()()(),e.TgZ(9,"div",58)(10,"div",13)(11,"label",14),e._uU(12,"Nombre"),e.qZA(),e.TgZ(13,"div")(14,"input",59,60),e.NdJ("ngModelChange",function(a){e.CHM(i);const o=e.oxw(2);return e.KtG(o.entidadEstructura.nombre=a)}),e.qZA(),e.YNc(16,Y,2,0,"div",17),e.qZA()()()()}if(2&m){const i=e.MAs(7),n=e.MAs(15),a=e.oxw(2);e.xp6(6),e.Q6J("ngModel",a.entidadEstructura.clave)("required",a.esNuevaPestana),e.xp6(2),e.Q6J("ngIf",(null==i.errors?null:i.errors.required)&&i.touched),e.xp6(6),e.Q6J("ngModel",a.entidadEstructura.nombre)("required",a.esNuevaPestana),e.xp6(2),e.Q6J("ngIf",(null==n.errors?null:n.errors.required)&&n.touched)}}function V(m,t){if(1&m){const i=e.EpF();e.TgZ(0,"div",10),e._UZ(1,"div",26),e.TgZ(2,"div",11)(3,"div",27)(4,"div",28)(5,"span",29),e._uU(6,"Jerarqu\xeda"),e.qZA(),e.TgZ(7,"tree-root",30,31),e.YNc(9,Q,5,9,"ng-template",null,32,e.W1O),e.qZA()()(),e.TgZ(11,"div",27)(12,"div",10)(13,"div",11)(14,"div",33)(15,"div",13)(16,"label",14),e._uU(17,"Pesta\xf1a Padre"),e.qZA(),e.TgZ(18,"ng-select",34,35),e.NdJ("ngModelChange",function(a){e.CHM(i);const o=e.oxw();return e.KtG(o.idJerarquiaPadre=a)}),e.qZA()()(),e.TgZ(20,"div",36)(21,"label",14),e._uU(22,"Nueva Pesta\xf1a"),e.qZA(),e.TgZ(23,"div",37)(24,"label",38)(25,"input",39,40),e.NdJ("ngModelChange",function(a){e.CHM(i);const o=e.oxw();return e.KtG(o.esNuevaPestana=a)})("ngModelChange",function(){e.CHM(i);const a=e.oxw();return e.KtG(a.actualizarBotonAgregar())}),e.qZA(),e.TgZ(27,"div",41)(28,"span",42),e._uU(29,"S\xed"),e.qZA(),e.TgZ(30,"span",43),e._uU(31,"No"),e.qZA()()()()()(),e.YNc(32,K,5,6,"div",44),e.YNc(33,z,17,6,"div",44),e.TgZ(34,"div",45)(35,"div",46)(36,"button",47),e.NdJ("click",function(){e.CHM(i);const a=e.oxw();return e.KtG(a.onAgregarClick())}),e._uU(37," Agregar "),e.qZA()()()()()()()}if(2&m){const i=e.oxw();e.xp6(7),e.Q6J("nodes",i.jerarquiaArbol)("options",i.options),e.xp6(11),e.Q6J("items",i.entidadList)("ngModel",i.idJerarquiaPadre)("placeholder",i.placeholderSelect)("notFoundText",i.placeholderNoOptions),e.xp6(7),e.Q6J("ngModel",i.esNuevaPestana),e.xp6(7),e.Q6J("ngIf",!i.esNuevaPestana),e.xp6(1),e.Q6J("ngIf",i.esNuevaPestana),e.xp6(3),e.Q6J("disabled",i.disableAgregar)}}class P extends k.P{constructor(t,i,n,a,o,E){super(E),this.entidadService=t,this.entidadEstructuraService=i,this.seccionService=n,this.bsModalRef=a,this.bsModalService=o,this.TITULO_MODAL_ELIMINAR="Eliminar Jerarqu\xeda Estructura",this.MENSAJE_EXITO_ELIMINAR="La estructura de jerarqu\xeda ha sido eliminada",this.MENSAJE_EXITO_AGREGAR_ESTRUCTURA="La secci\xf3n ha sido agregada",this.elementosSeleccionados=[],this.HEADER_GRID_SECCIONES="Secciones",this.seccionesList=[],this.columnaVer=Object.assign({title:"Ver",action:b.g.GRID_ACCION_VER,cellRendererSelector:ie=>({component:"actionButton",params:{disabled:!1}})},b.g.CONFIG_COLUMN_ACTION),this.columnaCheckbox={headerName:"",field:"",width:30,minWidth:40,cellClass:"center-ag",headerCheckboxSelection:!0,headerCheckboxSelectionFilteredOnly:!0,checkboxSelection:!0,resizable:!1,sortable:!1,filter:!1,suppressMovable:!0,lockPosition:!0,pinned:"right"},this.columnsSeccion=[{headerName:"Clave",field:"clave",minWidth:50},{headerName:"Secci\xf3n",field:"nombre",minWidth:150},this.columnaCheckbox,this.columnaVer],this.jerarquiaArbol=[],this.options={displayField:"nombre",isExpandedField:"expanded",idField:"idEntidadEstructura",childrenField:"hijos",useCheckbox:!1,useTriState:!1,actionMapping:{mouse:{dblClick:l.iM.TOGGLE_EXPANDED}}},this.entidadList=[],this.placeholderSelect=b.g.PLACEHOLDER_DROPDOWN,this.placeholderNoOptions=b.g.PLACEHOLDER_DROPDOWN_NO_OPTIONS,this.configJerarquiaPadre=Object.assign({labelField:"nombre",valueField:"idEntidadEstructura",searchField:["nombre"]},b.g.CONFIG_DROPDOWN_DEFAULT),this.entidadEstructura={},this.disableAgregar=!0,this.loading=!0,this.esNuevaPestana=!1}ngOnInit(){var t=()=>super.onInit,i=this;return(0,v.Z)(function*(){yield t().call(i),i.actualizarInformacion()})()}consultarArbol(){var t=this;return(0,v.Z)(function*(){return(yield t.entidadEstructuraService.consultarArbol(t.idEntidad).toPromise())??[]})()}consultarGrid(){var t=this;return(0,v.Z)(function*(){return(yield t.seccionService.consultarGeneral().toPromise())??[]})()}consultarSelector(){var t=this;return(0,v.Z)(function*(){return(yield t.entidadEstructuraService.consultarPorEntidadParaSelector(t.idEntidad).toPromise())??[]})()}actualizarInformacion(){var t=this;return(0,v.Z)(function*(){if(t.accion!=b.g.MODAL_ACCION_EDITAR)return void(t.loading=!1);let i=t.consultarArbol(),n=t.consultarSelector(),a=t.consultarGrid();return Promise.all([i,n,a]).then(o=>{t.idJerarquiaPadre=void 0,t.elementosSeleccionados=[],t.jerarquiaArbol=o[0],t.entidadList=o[1],t.seccionesList=o[2]}).catch(o=>{}).finally(()=>{t.loading=!1})})()}onSelectionChange(t){this.elementosSeleccionados=[],t.forEach(i=>{this.elementosSeleccionados.push(i.data)}),this.actualizarBotonAgregar()}onGridClick(t){t.accion===b.g.GRID_ACCION_VER&&this.verCamposSeccion(t.data.idSeccion)}seleccionarCuentaPadre(t){void 0===t.idEntidadEstructuraPadre&&(this.idJerarquiaPadre=t.idEntidadEstructura)}verCamposSeccion(t){const i={idSeccion:t};this.bsModalRef=this.bsModalService.show(Z,{initialState:i,...b.g.CONFIG_MODAL_MEDIUM}),this.bsModalRef.content.onClose=()=>{this.bsModalRef.hide()}}obtenerJerarquiasSeleccionadas(){let t=[];return this.elementosSeleccionados.forEach(i=>{let n={};n.idEntidad=this.entidad.idEntidad,n.idEntidadEstructuraPadre=this.idJerarquiaPadre,n.idSeccion=i.idSeccion,t.push(n)}),t}onAgregarClick(){var t=this;return(0,v.Z)(function*(){t.esNuevaPestana||void 0!==t.idJerarquiaPadre?(t.disableAgregar=!0,t.submitting=!0,t.esNuevaPestana?yield t.agregarNuevoNodo():yield t.agregarNodosSeleccionados(),t.submitting=!1,t.elementosSeleccionados=[],t.actualizarBotonAgregar()):t.mensajeService.modalError("Es necesario seleccionar una pesta\xf1a, para asignar sus secciones")})()}limpiarCamposNuevoNodo(){this.entidadEstructura.clave="",this.entidadEstructura.nombre="",null!=this.claveEstructuraRef&&(this.claveEstructuraRef.control?.markAsPristine(),this.claveEstructuraRef.control?.markAsUntouched()),null!=this.nombreEstructuraRef&&(this.nombreEstructuraRef.control?.markAsPristine(),this.nombreEstructuraRef.control?.markAsUntouched())}agregarNuevoNodo(){var t=this;return(0,v.Z)(function*(){if(!t.claveEstructuraRef.valid||!t.nombreEstructuraRef.valid)return t.claveEstructuraRef.control?.markAsDirty(),t.claveEstructuraRef.control?.markAsTouched(),t.nombreEstructuraRef.control?.markAsDirty(),void t.nombreEstructuraRef.control?.markAsTouched();t.entidadEstructura.idEntidad=t.entidad.idEntidad,t.entidadEstructura.idSeccion=void 0,t.entidadEstructura.tabulacion=!0,yield t.agregarEntidadEstructura([t.entidadEstructura]),t.limpiarCamposNuevoNodo()})()}agregarNodosSeleccionados(){var t=this;return(0,v.Z)(function*(){let i=t.obtenerJerarquiasSeleccionadas();yield t.agregarEntidadEstructura(i)})()}agregarEntidadEstructura(t){var i=this;return(0,v.Z)(function*(){return i.entidadEstructuraService.agregar(t).toPromise().then(function(){var n=(0,v.Z)(function*(a){yield i.actualizarInformacion(),i.mensajeService.modalExito(i.MENSAJE_EXITO_AGREGAR_ESTRUCTURA)});return function(a){return n.apply(this,arguments)}}()).catch(n=>{})})()}eliminarEntidadEstructura(t){var i=this;return(0,v.Z)(function*(){if(i.submitting)return;let n=!1;yield i.mensajeService.modalConfirmacion(`\n        \xbfDesea eliminar la estructura de jerarqu\xeda <strong>'${t.nombre}'</strong>?\n        Tambi\xe9n se eliminar\xe1n las jerarqu\xedas hijas.\n      `,i.TITULO_MODAL_ELIMINAR,b.g.ICONO_CRUZ).catch(a=>{n=!0}),!n&&(i.disableAgregar=!0,i.submitting=!0,i.entidadEstructuraService.eliminar(t.idEntidadEstructura).toPromise().then(function(){var a=(0,v.Z)(function*(o){yield i.actualizarInformacion(),i.mensajeService.modalExito(i.MENSAJE_EXITO_ELIMINAR)});return function(o){return a.apply(this,arguments)}}()).catch(a=>{}).finally(()=>{i.disableAgregar=!1,i.submitting=!1}))})()}actualizarBotonAgregar(){this.submitting||(this.esNuevaPestana?this.disableAgregar=!1:this.disableAgregar=this.elementosSeleccionados.length<=0)}agregar(t){return this.entidadService.agregar(t).pipe((0,q.U)(i=>{}))}editar(t){return this.entidadService.editar(t)}consultar(t){return this.entidadService.consultar(t)}static#e=this.\u0275fac=function(i){return new(i||P)(e.Y36(f),e.Y36(d),e.Y36(T.D),e.Y36(s.UZ),e.Y36(s.tT),e.Y36(y.V))};static#t=this.\u0275cmp=e.Xpm({type:P,selectors:[["app-configuracion-entidad-formulario"]],viewQuery:function(i,n){if(1&i&&(e.Gf(B,5),e.Gf(j,5)),2&i){let a;e.iGM(a=e.CRH())&&(n.claveEstructuraRef=a.first),e.iGM(a=e.CRH())&&(n.nombreEstructuraRef=a.first)}},features:[e.qOj],decls:38,vars:8,consts:[[1,"d-flex"],[1,"barra-lateral-modal"],[1,"fa","fa-plus"],[1,"modal-content"],[1,"modal-header"],["type","button","aria-label","Close",1,"close","pull-right",3,"click"],[1,"far","fa-times-circle"],["novalidate","novalidate",3,"keydown.enter","ngSubmit"],["formulario","ngForm"],["id","modal",1,"modal-body"],[1,"container"],[1,"row"],[1,"col-md-4"],[1,"form-group"],[1,"label-input","required-label"],["name","claveName","type","text","maxlength","20","required","required","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["clave","ngModel"],["class","error",4,"ngIf"],["name","nombreName","type","text","maxlength","200","required","required","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["nombre","ngModel"],["class","container",4,"ngIf"],[1,"modal-footer"],[1,"text-right"],["type","button",1,"btn-secundario","btn-margin-left",3,"click"],["type","submit",1,"btn-primario","btn-margin-left",3,"disabled"],[1,"error"],[1,"separador"],[1,"col-md-6"],[1,"form-group","contenedor-jerarquia"],[2,"font-weight","600"],[3,"nodes","options"],["tree",""],["treeNodeWrapperTemplate",""],[1,"col-md-9"],["name","jerarquiaPadreName","bindLabel","nombre","bindValue","idEntidadEstructura",1,"select-custom",3,"items","ngModel","placeholder","notFoundText","ngModelChange"],["jerarquiaPadre","ngModel"],[1,"col-md-3"],[1,"form-group","switch-flex"],["for","nuevoNodo",1,"switch"],["name","nuevoNodoName","id","nuevoNodo","type","checkbox",3,"ngModel","ngModelChange"],["nuevoNodo","ngModel"],[1,"slider","round"],[1,"on"],[1,"off"],["class","row mb-4",4,"ngIf"],[1,"row","mb-4"],[1,"col-md-12","d-flex","justify-content-center"],["type","button",1,"btn-terceario","btn-margin-left",3,"disabled","click"],[1,"node-wrapper",3,"ngClass","dblclick"],[3,"node"],[1,"checkbox","mr-1",3,"ngClass"],["type","button",1,"delete",3,"click"],[3,"node","index","click"],[1,"col-md-12"],[1,"subseccion"],[3,"headerName","data","children","disableEdit","disableDelete","disableXLS","event","selectionChanged"],["name","claveEntidadEstructuraName","type","text","autocomplete","off","maxlength","20",1,"form-control",3,"ngModel","required","ngModelChange"],["claveEntidadEstructura","ngModel"],[1,"col-md-8"],["name","nombreEntidadEstructuraName","type","text","autocomplete","off","maxlength","200",1,"form-control",3,"ngModel","required","ngModelChange"],["nombreEntidadEstructura","ngModel"]],template:function(i,n){if(1&i){const a=e.EpF();e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"i",2),e.qZA(),e.TgZ(3,"div",3)(4,"div",4)(5,"div"),e._uU(6),e.qZA(),e.TgZ(7,"button",5),e.NdJ("click",function(){return n.cancelar()}),e._UZ(8,"i",6),e.qZA()(),e.TgZ(9,"form",7,8),e.NdJ("keydown.enter",function(E){return E.preventDefault()})("ngSubmit",function(){e.CHM(a);const E=e.MAs(10);return e.KtG(n.onSubmit(E))}),e.TgZ(11,"div",9)(12,"div",10)(13,"div",11)(14,"div",12)(15,"div",13)(16,"label",14),e._uU(17,"Clave"),e.qZA(),e.TgZ(18,"div")(19,"input",15,16),e.NdJ("ngModelChange",function(E){return n.entidad.clave=E}),e.qZA(),e.YNc(21,$,2,0,"div",17),e.qZA()()(),e.TgZ(22,"div",12)(23,"div",13)(24,"label",14),e._uU(25,"Entidad"),e.qZA(),e.TgZ(26,"div")(27,"input",18,19),e.NdJ("ngModelChange",function(E){return n.entidad.nombre=E}),e.qZA(),e.YNc(29,W,2,0,"div",17),e.qZA()()()(),e.YNc(30,V,38,10,"div",20),e.qZA()(),e.TgZ(31,"div",21)(32,"div",22)(33,"button",23),e.NdJ("click",function(){return n.cancelar()}),e._uU(34),e.qZA()(),e.TgZ(35,"div",22)(36,"button",24),e._uU(37," Guardar "),e.qZA()()()()()()}if(2&i){const a=e.MAs(20),o=e.MAs(28);e.xp6(6),e.hij("",n.accion," Entidad"),e.xp6(13),e.Q6J("ngModel",n.entidad.clave),e.xp6(2),e.Q6J("ngIf",(null==a.errors?null:a.errors.required)&&a.touched),e.xp6(6),e.Q6J("ngModel",n.entidad.nombre),e.xp6(2),e.Q6J("ngIf",(null==o.errors?null:o.errors.required)&&o.touched),e.xp6(1),e.Q6J("ngIf",n.entidad.idEntidad>0),e.xp6(4),e.hij(" ","Cancelar"," "),e.xp6(2),e.Q6J("disabled",n.submitting)}},dependencies:[A._Y,A.Fj,A.Wl,A.JJ,A.JL,A.Q7,A.nD,A.On,A.F,U.mk,U.O5,L.$,N.w9,l.qr,l.rO,l.kj],styles:[".delete[_ngcontent-%COMP%]{background-image:url(ico-15x15-Eliminar.0e6e10f0125d927b.svg);background-repeat:no-repeat;cursor:pointer;width:15px;height:15px;display:block}.delete-disabled[_ngcontent-%COMP%]{cursor:default}  app-configuracion-entidad-formulario .ag-body-viewport{max-height:calc(100vh - 530px)}  app-configuracion-entidad-formulario tree-viewport{max-height:calc(100vh - 345px);overflow-y:scroll}thead[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%], tfoot[_ngcontent-%COMP%], tr[_ngcontent-%COMP%], td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{border-color:inherit;border-style:solid;border-width:0}"]})}var X=r(62861),ee=r(85246);class O extends G.v{constructor(t,i,n,a){super(i,n,a),this.entidadService=t,this.NOMBRE_ENTIDAD="Entidad",this.crudConfig={nombreEntidad:this.NOMBRE_ENTIDAD,generoGramatical:"fem",nombrePropiedadId:"idEntidad",formConfig:{ComponenteFormulario:P,modalConfig:b.g.CONFIG_MODAL_FULL,configAgregar:{acceso:S.v.AGREGAR_ENTIDAD},configEditar:{acceso:S.v.EDITAR_ENTIDAD}},configEliminar:{acceso:S.v.ELIMINAR_ENTIDAD,elementToString:o=>o.nombre}},this.columns=[{headerName:"Clave",field:"clave",minWidth:150},{headerName:"Nombre",field:"nombre",minWidth:150}]}ngOnInit(){super.onInit()}consultarGrid(){return this.entidadService.consultarTodosParaGrid()}eliminar(t){return this.entidadService.eliminar(t)}static#e=this.\u0275fac=function(i){return new(i||O)(e.Y36(f),e.Y36(X.Q),e.Y36(s.tT),e.Y36(y.V))};static#t=this.\u0275cmp=e.Xpm({type:O,selectors:[["app-configuracion-entidad"]],features:[e.qOj],decls:1,vars:4,consts:[["titulo","Cat\xe1logo de Configuraci\xf3n de Entidades",3,"columns","crudConfig","elementos$","tieneAccesoAgregar$","agregarClick","gridClick"]],template:function(i,n){1&i&&(e.TgZ(0,"app-catalogo-base",0),e.NdJ("agregarClick",function(){return n.agregar()})("gridClick",function(o){return n.onGridClick(o)}),e.qZA()),2&i&&e.Q6J("columns",n.columns)("crudConfig",n.crudConfig)("elementos$",n.registros$)("tieneAccesoAgregar$",n.tieneAccesoAgregar$)},dependencies:[ee.B]})}const te=[{path:"",component:O,canActivate:[J.m],data:{title:"Entidad",acceso:S.v.CONFIGURADOR_ENTIDAD}}];class D{static#e=this.\u0275fac=function(i){return new(i||D)};static#t=this.\u0275mod=e.oAB({type:D});static#i=this.\u0275inj=e.cJS({imports:[F.Bz.forChild(te),F.Bz]})}class I{static#e=this.\u0275fac=function(i){return new(i||I)};static#t=this.\u0275mod=e.oAB({type:I});static#i=this.\u0275inj=e.cJS({providers:[f],imports:[h.A,s.zk.forRoot(),g.f,u.m,_.Z,D,x]})}}}]);