"use strict";(self.webpackChunkroadis_app=self.webpackChunkroadis_app||[]).push([[4037],{83083:(P,g,i)=>{i.d(g,{c:()=>l});var h=i(94650),m=i(80529);class l{constructor(n){this.http=n,this.dataUrl="compania/"}consultar(n){return this.http.get(this.dataUrl+`consultar/${n}`)}consultarGeneral(){return this.http.get(this.dataUrl+"consultarGeneral")}consultarTodosParaSelector(){return this.http.get(this.dataUrl+"consultarTodosParaSelector")}consultarPorUsuarioPermiso(){return this.http.get(this.dataUrl+"consultarPorUsuarioPermiso")}consultarTodosParaGrid(n){return this.http.post(this.dataUrl+"consultarTodosParaGrid",n)}agregar(n){return this.http.post(this.dataUrl+"agregar",n)}editar(n){return this.http.put(this.dataUrl+"editar",n)}eliminar(n){return this.http.delete(this.dataUrl+`eliminar/${n}`)}consultarPorUsuario(){return this.http.get(this.dataUrl+"consultarPorUsuario")}consultarClaveCompaniaUsuarioSesion(){return this.http.get(this.dataUrl+"consultarClaveCompaniaUsuarioSesion/",{responseType:"text"})}static#t=this.\u0275fac=function(v){return new(v||l)(h.LFG(m.eN))};static#e=this.\u0275prov=h.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"})}},8923:(P,g,i)=>{i.d(g,{X:()=>l});var h=i(94650),m=i(80529);class l{constructor(n){this.http=n,this.dataUrl="tipoGuia/"}consultarTodosParaSelector(){return this.http.get(this.dataUrl+"consultarTodosParaSelector")}consultar(n){return this.http.get(this.dataUrl+`consultar/${n}`)}consultarGeneral(){return this.http.get(this.dataUrl+"consultarGeneral")}agregar(n){return this.http.post(this.dataUrl+"agregar",n)}editar(n){return this.http.put(this.dataUrl+"editar",n)}eliminar(n){return this.http.delete(this.dataUrl+`eliminar/${n}`)}static#t=this.\u0275fac=function(v){return new(v||l)(h.LFG(m.eN))};static#e=this.\u0275prov=h.Yz7({token:l,factory:l.\u0275fac})}},57913:(P,g,i)=>{i.d(g,{p:()=>l});var h=i(94650),m=i(80529);class l{constructor(n){this.http=n,this.dataUrl="guiaActividad/"}consultarTodosParaSelector(){return this.http.get(this.dataUrl+"consultarTodosParaSelector")}consultarParaFormulario(n){return this.http.get(this.dataUrl+`consultarParaFormulario/${n}`)}consultarGeneral(n){return this.http.get(this.dataUrl+`consultarGeneral/${n}`)}agregar(n){return this.http.post(this.dataUrl+"agregar",n)}editar(n){return this.http.put(this.dataUrl+"editar",n)}eliminar(n){return this.http.delete(this.dataUrl+`eliminar/${n}`)}static#t=this.\u0275fac=function(v){return new(v||l)(h.LFG(m.eN))};static#e=this.\u0275prov=h.Yz7({token:l,factory:l.\u0275fac})}},93397:(P,g,i)=>{i.d(g,{M:()=>l});var h=i(94650),m=i(80529);class l{constructor(n){this.http=n,this.dataUrl="guiaElementoTecnica/"}consultarTodosParaSelector(){return this.http.get(this.dataUrl+"consultarTodosParaSelector")}consultar(n){return this.http.get(this.dataUrl+`consultar/${n}`)}consultarGeneral(n){return this.http.get(this.dataUrl+`consultarGeneral/${n}`)}agregar(n){return this.http.post(this.dataUrl+"agregar",n)}editar(n){return this.http.put(this.dataUrl+"editar",n)}eliminar(n){return this.http.delete(this.dataUrl+`eliminar/${n}`)}static#t=this.\u0275fac=function(v){return new(v||l)(h.LFG(m.eN))};static#e=this.\u0275prov=h.Yz7({token:l,factory:l.\u0275fac})}},62868:(P,g,i)=>{i.d(g,{F:()=>l});var h=i(94650),m=i(80529);class l{constructor(n){this.http=n,this.dataUrl="perfil/"}consultar(n){return this.http.get(this.dataUrl+`consultar/${n}`)}consultarPorCompania(){return this.http.get(this.dataUrl+"consultarPorCompania")}consultarPorCompaniaParaSelector(n){return this.http.get(this.dataUrl+`consultarPorCompaniaParaSelector/${n}`)}consultarTodosParaSelector(){return this.http.get(this.dataUrl+"consultarTodosParaSelector")}agregar(n){return this.http.post(this.dataUrl+"agregar",n)}editar(n){return this.http.put(this.dataUrl+"editar",n)}eliminar(n){return this.http.delete(this.dataUrl+`eliminar/${n}`)}static#t=this.\u0275fac=function(v){return new(v||l)(h.LFG(m.eN))};static#e=this.\u0275prov=h.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"})}},54037:(P,g,i)=>{i.r(g),i.d(g,{ProyectoModule:()=>N});var h=i(88796),m=i(20388),l=i(41283),w=i(63405),n=i(71436),v=i(63666),z=i(90061),V=i(62868),$=i(93823),K=i(93397),Q=i(57913),W=i(51818),H=i(48946),B=i(8923),X=i(4724),y=i(9116),E=i(13050),x=i(79619),M=i(15861),f=i(15439),k=i(11620),d=i(50986),_=i(75040),q=i(32302),t=i(94650),tt=i(62861),F=i(21006),D=i(2060),L=i(25587),et=i(46558),ot=i(11481),at=i(12846),T=i(24006),A=i(36895),it=i(58390),nt=i(40603),G=i(1581),R=i(8816);const rt=["gridPerfil"];function st(r,o){1&r&&t._UZ(0,"i",31)}function ct(r,o){1&r&&t._UZ(0,"i",32)}function lt(r,o){if(1&r){const e=t.EpF();t.TgZ(0,"div",33),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.agregar())}),t.TgZ(1,"button",34),t._uU(2,"Agregar Curso"),t.qZA()()}}function dt(r,o){if(1&r){const e=t.EpF();t.TgZ(0,"div")(1,"app-grid-general",35,36),t.NdJ("event",function(s){t.CHM(e);const c=t.oxw();return t.KtG(c.onGridClick(s))}),t.qZA()()}if(2&r){const e=t.oxw();t.xp6(1),t.Q6J("headerName",e.HEADER_GRID)("data",e.proyectoList)("gridOptions",e.gridOptions)("children",e.columns)("accesoEditar",e.EDITAR_GUIA)("accesoEliminar",e.ELIMINAR_GUIA)}}function ut(r,o){if(1&r){const e=t.EpF();t.TgZ(0,"div",42)(1,"app-tarjeta",43),t.NdJ("editar",function(s){t.CHM(e);const c=t.oxw(2);return t.KtG(c.editarCuadricula(s))})("eliminar",function(s){t.CHM(e);const c=t.oxw(2);return t.KtG(c.eliminarCuadricula(s))}),t.qZA()()}if(2&r){const e=o.$implicit,a=t.oxw(2);t.xp6(1),t.Q6J("titulo",e.nombre)("clave",e.clave)("numeroParticipantes",e.participantes)("porcentajeAciertos",e.porcentajeAciertos)("imagen",a.imagen.bind(a))("idImagen",e.idProyectoImagen)("idProyecto",e.idProyecto)("fechaInicio",e.fechaInicio)("fechaFin",e.fechaFin)}}function ht(r,o){if(1&r){const e=t.EpF();t.TgZ(0,"div"),t._UZ(1,"div",37),t.TgZ(2,"div",28)(3,"div",38)(4,"div",39),t.YNc(5,ut,2,9,"div",40),t.qZA()(),t.TgZ(6,"mat-paginator",41),t.NdJ("page",function(s){t.CHM(e);const c=t.oxw();return t.KtG(c.onPageChange(s))}),t.qZA()()()}if(2&r){const e=t.oxw();t.xp6(5),t.Q6J("ngForOf",e.pagedItems),t.xp6(1),t.Q6J("length",e.tarjetasList.length)("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions)}}class U{constructor(o,e,a,s,c,u,O,S,Ht,Bt){this.accesoService=o,this.encryptionService=e,this.modalMensajeService=a,this.proyectoService=s,this.router=c,this.usuarioService=u,this.bsModalRef=O,this.modalService=S,this.sanitizer=Ht,this.formularioService=Bt,this.HEADER_GRID="Cursos",this.MENSAJE_EXITO_ELIMINAR="Curso eliminado exitosamente.",this.TITULO_MODAL_ELIMINAR="Eliminar Curso.",this.fechaInicio=new Date,this.fechaFin=new Date,this.idPerfilesSeleccionadas=[],this.optionsFecha=d.g.CONFIG_DATEPICKER,this.tieneAccesoAgregar=!1,this.EDITAR_GUIA=_._v.Editar,this.ELIMINAR_GUIA=_._v.Eliminar,this.guiaList=[],this.proyectoList=[],this.isCollapsed=!0,this.filtro=new q.K,this.placeHolderSelect=d.g.PLACEHOLDER_DROPDOWN,this.placeHolderNoOptions=d.g.PLACEHOLDER_DROPDOWN_NO_OPTIONS,this.idsEstatusList=[{idEstatus:0,nombre:"Inactivo"},{idEstatus:1,nombre:"Activo"}],this.idsEstatusSeleccionados=[],this.vista=!1,this.pageSizeOptions=[1,5,10,25,100],this.pageIndex=0,this.pagedItems=[],this.pageSize=10,this.tarjetasList=[],this.columnaDetalle=Object.assign({headerName:"",field:"",action:d.g.GRID_ACCION_VER,cellRendererSelector:p=>({component:"actionButton",params:{disabled:!1}}),minWidth:44,maxWidth:44,resizable:!1,sortable:!1,filter:!1,suppressMovable:!0,lockPosition:!0,pinned:"right"},d.g.CONFIG_COLUMN_ACTION),this.columnaVer=Object.assign({title:"Ver",action:d.g.GRID_ACCION_VER,cellRendererSelector:p=>({component:"actionButton",params:{disabled:p.data.idUsuarioResponsable!==this.idUsuarioSesion}})},d.g.CONFIG_COLUMN_ACTION),this.columns=[{headerName:"Clave",field:"idProyecto",minWidth:50,width:50},{headerName:"Estatus",field:"estatus",minWidth:50,width:100,valueGetter:p=>p.data.estatus?"Activo":"Inactivo"},{headerName:"Fecha Alta",field:"fechaAlta",minWidth:100,width:100,cellRenderer:p=>f(p.data.fechaAlta).format("DD/MM/YYYY"),valueGetter:p=>f(p.data.fechaAlta).format("DD/MM/YYYY")},{headerName:"Curso",field:"nombre",minWidth:200,width:200},{headerName:"Tipo Gu\xeda de Curso",field:"tipoGuia",minWidth:150,width:150},{headerName:"Fecha Inicio",field:"fechaInicio",minWidth:100,width:100,cellRenderer:p=>f(p.data.fechaInicio).format("DD/MM/YYYY"),valueGetter:p=>f(p.data.fechaInicio).format("DD/MM/YYYY")},{headerName:"Fecha Fin",field:"fechaFin",minWidth:100,width:100,cellRenderer:p=>f(p.data.fechaFin).format("DD/MM/YYYY"),valueGetter:p=>f(p.data.fechaFin).format("DD/MM/YYYY")},{headerName:"Locaci\xf3n",field:"sucursal",minWidth:200,width:200},{headerName:"Evaluador Responsable",field:"usuarioResponsable",minWidth:200,width:200}]}ngOnInit(){var o=this;return(0,M.Z)(function*(){o.height="calc(80vh - 55px)",o.consultarUsuarioSesion(),o.consultarGrid(),o.accesoService.tieneAcceso(_._v.Agregar).subscribe(e=>{o.tieneAccesoAgregar=e})})()}consultarGrid(){this.proyectoService.consultarGeneral().subscribe(o=>{this.proyectoList=o}),this.consultarCuadricula()}consultarUsuarioSesion(){var o=this;return(0,M.Z)(function*(){const e=yield o.usuarioService.consultarMiPerfil().toPromise();o.idUsuarioSesion=e.idUsuario})()}onGridClick(o){o.accion===d.g.GRID_ACCION_EDITAR?this.editar(o.data.idProyecto):o.accion===d.g.GRID_ACCION_ELIMINAR?this.eliminar(o.data):o.accion===d.g.GRID_ACCION_VER&&this.ver(o.data)}editar(o){this.proyectoService.consultar(o).subscribe(e=>{var a=this.sanitizer.bypassSecurityTrustResourceUrl(`data:${e.proyectoImagen.archivoTipoMime};base64,${e.proyectoImagen.archivo}`);e.proyectoImagen.imagenUrl=a;const s={accion:d.g.COMPONENT_ACCION_EDITAR,proyecto:e,idProyecto:o};this.bsModalRef=this.modalService.show(x.j,{initialState:s,...d.g.CONFIG_MODAL_LARGE}),this.bsModalRef.content.onClose=c=>{c&&this.consultarGrid(),this.bsModalRef.hide()}})}eliminar(o){this.modalMensajeService.modalConfirmacion("\xbfDesea eliminar el proyecto de implementaci\xf3n <strong>"+o.nombre+"</strong>?",this.TITULO_MODAL_ELIMINAR,d.g.ICONO_CRUZ).then(e=>{this.proyectoService.eliminar(o.idProyecto).subscribe(a=>{this.modalMensajeService.modalExito(this.MENSAJE_EXITO_ELIMINAR),this.consultarGrid()})})}ver(o){this.router.navigate(["/administrador/proyectos/proyecto/ver"],{queryParams:this.encryptionService.generateURL({i:o.idProyecto.toString(),n:o.nombre})})}cancelar(){this.onClose(!1),this.bsModalRef.hide()}agregar(){this.bsModalRef=this.modalService.show(x.j,d.g.CONFIG_MODAL_LARGE),this.bsModalRef.content.accion=d.g.MODAL_ACCION_AGREGAR,this.bsModalRef.content.onClose=o=>{o&&this.consultarGrid(),this.bsModalRef.hide()}}modoTarjetaLista(){this.vista=!this.vista}loadPagedItems(){const o=this.pageIndex*this.pageSize,e=o+this.pageSize;this.pagedItems=this.tarjetasList.slice(o,e)}onPageChange(o){this.pageIndex=o.pageIndex,this.pageSize=o.pageSize,this.loadPagedItems()}consultarCuadricula(){this.proyectoService.consultarCuadricula().subscribe(o=>{this.tarjetasList=o,this.loadPagedItems()})}imagen(o){return this.proyectoService.consultarImagen(o)}editarCuadricula(o){this.editar(o)}eliminarCuadricula(o){let e=new k.k;e=this.proyectoList.find(a=>a.idProyecto===o),this.eliminar(e)}isCollapsedFunction(){this.isCollapsed=!this.isCollapsed,this.isCollapsed?this.height="calc(80vh - 55px)":this.height="calc(64vh - 55px)"}enviarFormulario(o){o.valid?(this.idsEstatusSeleccionados.includes(0)&&(this.filtro.inactivo=!0),this.idsEstatusSeleccionados.includes(1)&&(this.filtro.activo=!0),this.proyectoService.consultarFiltro(this.filtro).subscribe(e=>{this.proyectoList=e,this.reiniciarFiltro()}),this.consultarCuadricula()):this.formularioService.validarCamposRequeridos(o)}reiniciarFiltro(){this.filtro.activo=!1,this.filtro.inactivo=!1}static#t=this.\u0275fac=function(e){return new(e||U)(t.Y36(tt.Q),t.Y36(F.C),t.Y36(D.V),t.Y36(L.X),t.Y36(y.F0),t.Y36(et.i),t.Y36(m.UZ),t.Y36(m.tT),t.Y36(ot.H7),t.Y36(at.Y))};static#e=this.\u0275cmp=t.Xpm({type:U,selectors:[["ng-component"]],viewQuery:function(e,a){if(1&e&&t.Gf(rt,5),2&e){let s;t.iGM(s=t.CRH())&&(a.gridPerfil=s.first)}},decls:38,vars:14,consts:[[1,"contenedor"],[1,"cuerpo-contenedor"],["novalidate","novalidate",3,"keydown.enter","ngSubmit"],["formulario","ngForm"],[3,"collapse","isAnimated"],[1,"row"],[1,"col-md-4"],[1,"form-group"],[1,"label-input"],["name","idEstatusName","bindLabel","nombre","bindValue","idEstatus",3,"items","placeholder","notFoundText","ngModel","multiple","ngModelChange"],["idEstatusLst","ngModel"],[1,"col-md-2"],[1,"row","mb-4"],[1,"col-md-12","text-center"],["type","submit",1,"btn-primario",3,"click"],[1,"form-row","panel-busqueda","mb-4"],[1,"panel-carga-elementos","center-element-vertically",3,"click"],[1,"titulo-panel"],[1,"arow-down-up"],["class","fa fa-chevron-down",4,"ngIf"],["class","fa fa-chevron-up",4,"ngIf"],[1,"titulo-contenedor"],[1,"col-md-12"],[1,"contenedor-derecha"],["type","button","title","Mostrar tarjetas",1,"botones-icono",3,"disabled","click"],["src","assets/img/svg/ico-20x20-Grid-Bloques.svg","alt","..."],["type","button","title","Mostrar grid",1,"botones-icono",3,"disabled","click"],["src","assets/img/svg/ico-20x20-Grid-Lista.svg","alt","..."],[1,"row","justify-content-center"],["class","contenedor-agregar",3,"click",4,"ngIf"],[4,"ngIf"],[1,"fa","fa-chevron-down"],[1,"fa","fa-chevron-up"],[1,"contenedor-agregar",3,"click"],[1,"btn-agregar"],[3,"headerName","data","gridOptions","children","accesoEditar","accesoEliminar","event"],["gridNecesidad",""],[1,"row",2,"height","30px"],[1,"col-md-11"],[1,"row","row-cols-1","row-cols-md-4","g-4"],["class","col",4,"ngFor","ngForOf"],[3,"length","pageSize","pageSizeOptions","page"],[1,"col"],[3,"titulo","clave","numeroParticipantes","porcentajeAciertos","imagen","idImagen","idProyecto","fechaInicio","fechaFin","editar","eliminar"]],template:function(e,a){if(1&e){const s=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"form",2,3),t.NdJ("keydown.enter",function(u){return u.preventDefault()})("ngSubmit",function(){t.CHM(s);const u=t.MAs(3);return t.KtG(a.enviarFormulario(u))}),t.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"label",8),t._uU(9,"Estatus"),t.qZA(),t.TgZ(10,"ng-select",9,10),t.NdJ("ngModelChange",function(u){return a.idsEstatusSeleccionados=u}),t.qZA()()()(),t._UZ(12,"div",11),t.TgZ(13,"div",12)(14,"div",13)(15,"button",14),t.NdJ("click",function(){t.CHM(s);const u=t.MAs(3);return t.KtG(a.enviarFormulario(u))}),t._uU(16,"Buscar"),t.qZA()()()()(),t.TgZ(17,"div",15)(18,"div",16),t.NdJ("click",function(){return a.isCollapsedFunction()}),t.TgZ(19,"span",17),t._uU(20,"Panel de B\xfasqueda"),t.qZA(),t.TgZ(21,"span",18),t.YNc(22,st,1,0,"i",19),t.YNc(23,ct,1,0,"i",20),t.qZA()()(),t.TgZ(24,"div",5)(25,"div",21),t._uU(26,"Cursos Programados"),t.qZA(),t.TgZ(27,"div",22)(28,"div",23)(29,"button",24),t.NdJ("click",function(){return a.modoTarjetaLista()}),t._UZ(30,"img",25),t.qZA(),t.TgZ(31,"button",26),t.NdJ("click",function(){return a.modoTarjetaLista()}),t._UZ(32,"img",27),t.qZA()()()(),t.TgZ(33,"div",28)(34,"div",22),t.YNc(35,lt,3,0,"div",29),t.YNc(36,dt,3,6,"div",30),t.YNc(37,ht,7,4,"div",30),t.qZA()()()()}2&e&&(t.xp6(4),t.Q6J("collapse",a.isCollapsed)("isAnimated",!0),t.xp6(6),t.Q6J("items",a.idsEstatusList)("placeholder",a.placeHolderSelect)("notFoundText",a.placeHolderNoOptions)("ngModel",a.idsEstatusSeleccionados)("multiple",!0),t.xp6(12),t.Q6J("ngIf",a.isCollapsed),t.xp6(1),t.Q6J("ngIf",!a.isCollapsed),t.xp6(6),t.Q6J("disabled",a.vista),t.xp6(2),t.Q6J("disabled",!a.vista),t.xp6(4),t.Q6J("ngIf",a.tieneAccesoAgregar),t.xp6(1),t.Q6J("ngIf",!1===a.vista),t.xp6(1),t.Q6J("ngIf",!0===a.vista))},dependencies:[T._Y,T.JJ,T.JL,T.On,T.F,A.sg,A.O5,it.$,h.w9,nt.O,G.NW,R.Y],styles:[".excel[_ngcontent-%COMP%]{color:#217346}.word[_ngcontent-%COMP%]{color:#2b579a}.powerpoint[_ngcontent-%COMP%]{color:#b7472a}.pdf[_ngcontent-%COMP%]{color:#b30b00}.upload[_ngcontent-%COMP%]{color:#33b64c}.notUpload[_ngcontent-%COMP%]{color:#e53b3b}.estatus[_ngcontent-%COMP%]{background-repeat:no-repeat;aspect-ratio:1/1;width:15px}.botones-icono[_ngcontent-%COMP%]{border:none;background-color:#fff}.contenedor-derecha[_ngcontent-%COMP%]{display:flex;justify-content:end;align-items:center}"]})}var pt=i(56832),C=i(80574);function mt(r,o){const e=C.P6.aoa_to_sheet([]);(function gt(r,o){const e=o.map(a=>a.header);return C.P6.sheet_add_aoa(r,[e])})(e,r),function vt(r,o){let e=2;for(const a of r)ft(o,a,e),e++,_t(o,a,e),e+=a.rows.length}(o,e),e["!merges"]=function Ct(r,o){const e=[];let a=2;for(const s of r)e.push({s:{r:a-1,c:0},e:{r:a-1,c:o.length-1}}),a+=s.rows.length+1;return e}(o,r),e["!cols"]=function Pt(r,o){const e=[],a=r.reduce((s,c)=>s.concat(c.rows),[]);for(const s of o){let c=s.header.length;for(const O of a){const S=String(O[s.field]).length;S>c&&(c=S)}const u={wch:c};e.push(u)}return e}(o,r);const a=C.P6.book_new();return C.P6.book_append_sheet(a,e,"Sheet1"),a}function ft(r,o,e){C.P6.sheet_add_aoa(r,[[o.name]],{origin:"A"+e})}function _t(r,o,e){C.P6.sheet_add_json(r,o.rows,{skipHeader:!0,origin:"A"+e})}var yt=i(50590),Mt=i(9230),Tt=i(85909),Y=i(60230),j=i(30153),J=i(38548),At=i(10805),bt=i(79007);function Ot(r,o){if(1&r){const e=t.EpF();t.TgZ(0,"div",16)(1,"button",17),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2);return t.KtG(s.descargarExcel())}),t._UZ(2,"img",18),t.qZA()()}}function Et(r,o){1&r&&(t.TgZ(0,"tr",19)(1,"th"),t._uU(2,"Clave"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Nombre"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Responsable"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Flujo"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Estatus"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Fecha Inicio"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Fecha Fin"),t.qZA(),t._UZ(15,"th"),t.qZA())}function xt(r,o){if(1&r){const e=t.EpF();t.TgZ(0,"tr",22)(1,"td",23)(2,"div",24)(3,"div",25),t._UZ(4,"i",26),t.TgZ(5,"span",27),t._uU(6),t.qZA(),t.TgZ(7,"div",28),t._UZ(8,"div",29),t.ALo(9,"obtenerClaseEstatusProyecto"),t.qZA()(),t.TgZ(10,"div")(11,"button",30),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2).$implicit,c=t.oxw(2);return t.KtG(c.abrirFormularioElementoTecnica(s.idProyectoElementoTecnica))}),t._UZ(12,"i",31),t.qZA()()()()()}if(2&r){const e=t.oxw().ngVar,a=t.oxw(),s=a.$implicit,c=a.expanded;t.xp6(3),t.Q6J("pRowToggler",s),t.xp6(1),t.Q6J("ngClass",c?"fa fa-chevron-circle-down":"fa fa-chevron-circle-right"),t.xp6(2),t.Oqu(e.nombre),t.xp6(2),t.Q6J("ngClass",t.lcZ(9,5,e.idProyectoEstatus))("title",e.proyectoEstatus)}}function Ut(r,o){if(1&r&&(t.ynx(0),t.YNc(1,xt,13,7,"tr",21),t.BQk()),2&r){const e=o.ngVar,a=t.oxw().rowIndex;t.xp6(1),t.Q6J("ngIf",e.index===a)}}function It(r,o){if(1&r&&t.YNc(0,Ut,2,1,"ng-container",20),2&r){const e=o.$implicit,a=t.oxw(2);t.Q6J("ngVar",a.rowGroupMetadata[e.idProyectoElementoTecnica])}}function Zt(r,o){if(1&r){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td")(10,"div",32),t._UZ(11,"div",29),t.ALo(12,"obtenerClaseEstatusProyecto"),t.qZA()(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"date"),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"date"),t.qZA(),t.TgZ(19,"td",33)(20,"button",34),t.NdJ("click",function(){const c=t.CHM(e).$implicit,u=t.oxw(2);return t.KtG(u.liberarActividad(c))}),t._UZ(21,"i",35),t.qZA(),t.TgZ(22,"button",36),t.NdJ("click",function(){const c=t.CHM(e).$implicit,u=t.oxw(2);return t.KtG(u.verFlujoDeSeguimiento(c.idProyectoActividad))}),t._UZ(23,"i",37),t.qZA(),t.TgZ(24,"button",30),t.NdJ("click",function(){const c=t.CHM(e).$implicit,u=t.oxw(2);return t.KtG(u.abrirFormularioActividad(c.idProyectoActividad))}),t._UZ(25,"i",31),t.qZA()()()}if(2&r){const e=o.$implicit;t.xp6(2),t.Oqu(e.numero),t.xp6(2),t.Oqu(e.descripcion),t.xp6(2),t.Oqu(e.responsable),t.xp6(2),t.Oqu(e.nombreFlujo),t.xp6(3),t.Q6J("ngClass",t.lcZ(12,9,e.idEstatus))("title",e.proyectoEstatus),t.xp6(3),t.Oqu(t.xi3(15,11,e.fechaInicio,"dd/MM/yyyy")),t.xp6(3),t.Oqu(t.xi3(18,14,e.fechaFin,"dd/MM/yyyy")),t.xp6(3),t.Q6J("disabled",e.liberada)}}function Nt(r,o){if(1&r&&(t.TgZ(0,"p-table",11),t.YNc(1,Ot,3,0,"ng-template",12),t.YNc(2,Et,16,0,"ng-template",13),t.YNc(3,It,1,1,"ng-template",14),t.YNc(4,Zt,26,17,"ng-template",15),t.qZA()),2&r){const e=t.oxw();t.Q6J("value",e.actividades)("autoLayout",e.autoLayout)}}class I{constructor(o,e,a,s,c,u,O){this.proyectoActividadService=o,this.proyectoElementoTecnicaService=e,this.route=a,this.router=s,this.encryptionService=c,this.mensajeService=u,this.modalService=O,this.autoLayout=!0,this.elementosTecnicas=[],this.actividades=[],this.rowGroupMetadata={}}ngOnInit(){var o=this;return(0,M.Z)(function*(){const e=yield o.route.queryParams.pipe((0,yt.P)()).toPromise(),a=o.encryptionService.readUrlParams(e);o.idProyecto=a.i,o.nombreProyecto=a.n,yield o.actualizarInformacion()})()}actualizarInformacion(){var o=this;return(0,M.Z)(function*(){o.actividades=[],yield o.consultarElementosTecnicas(o.idProyecto),o.actualizarMetadata();const e=o.elementosTecnicas.map(a=>a.actividades);o.actividades=[].concat(...e)})()}consultarElementosTecnicas(o){var e=this;return(0,M.Z)(function*(){e.elementosTecnicas=yield e.proyectoElementoTecnicaService.consultarParaVisor(o).toPromise()})()}actualizarMetadata(){if(this.rowGroupMetadata={},!this.elementosTecnicas)return;let o=0;for(let e=0;e<this.elementosTecnicas.length;e++){let a=this.elementosTecnicas[e],s=a.idProyectoElementoTecnica;this.rowGroupMetadata[s]={index:o,size:a.actividades.length,nombre:a.elementoTecnica,idProyectoEstatus:a.idProyectoEstatus,proyectoEstatus:a.proyectoEstatus},o+=a.actividades.length}}regresar(){this.router.navigate(["/administrador/proyecto/proyecto"])}liberarActividad(o){this.mensajeService.modalConfirmacion(`\xbfDesea liberar la actividad <strong>${o.descripcion.toLowerCase()}</strong>?`,"Liberar Actividad",d.g.ICONO_CRUZ).then(()=>{this.proyectoActividadService.liberar(o.idProyectoActividad).subscribe(()=>{this.mensajeService.modalExito("La actividad ha sido liberada"),this.actualizarInformacion()})}).catch(()=>{})}abrirFormularioElementoTecnica(o){const e={idProyectoElementoTecnica:o,accion:d.g.MODAL_ACCION_EDITAR,onClose:s=>{s&&this.actualizarInformacion(),a.hide()}},a=this.modalService.show(Tt.C,{initialState:e,...d.g.CONFIG_MODAL_DEFAULT})}abrirFormularioActividad(o){const e={idProyectoActividad:o,accion:d.g.MODAL_ACCION_EDITAR,onClose:s=>{s&&this.actualizarInformacion(),a.hide()}},a=this.modalService.show(Mt.D,{initialState:e,...d.g.CONFIG_MODAL_DEFAULT})}verFlujoDeSeguimiento(o){const e={idProyectoActividad:o,onClose:()=>{a.hide()}},a=this.modalService.show(pt.o,{initialState:e,...d.g.CONFIG_MODAL_DEFAULT})}descargarExcel(){const a=mt([{header:"Clave",field:"clave"},{header:"Nombre",field:"nombre"},{header:"Responsable",field:"responsable"},{header:"Flujo",field:"flujo"},{header:"Estatus",field:"estatus"},{header:"Fecha Inicio",field:"fechaInicio"},{header:"Fecha Fin",field:"fechaFin"}],this.mapearElementosYTecnicas(this.elementosTecnicas)),c=`${f().format("YYYYMMDD")}_VisorProyecto.xlsx`;C.NC(a,c)}mapearElementosYTecnicas(o){return o.map(e=>({name:e.elementoTecnica,rows:this.mapearActividades(e.actividades)}))}mapearActividades(o){return o.map(e=>({clave:e.numero,nombre:e.descripcion,responsable:e.responsable,flujo:e.nombreFlujo,estatus:e.proyectoEstatus,fechaInicio:e.fechaInicio?f(e.fechaInicio).format("DD/MM/YYYY"):"",fechaFin:e.fechaFin?f(e.fechaFin).format("DD/MM/YYYY"):""}))}static#t=this.\u0275fac=function(e){return new(e||I)(t.Y36(Y.E),t.Y36(j.V),t.Y36(y.gz),t.Y36(y.F0),t.Y36(F.C),t.Y36(D.V),t.Y36(m.tT))};static#e=this.\u0275cmp=t.Xpm({type:I,selectors:[["app-visor-proyecto"]],decls:16,vars:2,consts:[[1,"modal-content"],[1,"modal-header"],[1,"p-3"],[1,"container-fluid"],[1,"row"],[1,"col-12","titulo-seccion","mb-3"],[1,"col-12"],["class","primeng-tale","dataKey","idProyectoElementoTecnica",3,"value","autoLayout",4,"ngIf"],[1,"modal-footer"],[1,"d-flex","flex-wrap","justify-content-center","w-100",2,"gap","10px"],["type","button",1,"btn-secundario","mr-3",3,"click"],["dataKey","idProyectoElementoTecnica",1,"primeng-tale",3,"value","autoLayout"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],[2,"text-align","right"],["type","button",1,"btn",3,"click"],["src","assets/img/svg/ico-15x15-Descargar.svg","title","Descargar Excel",1,"grid-download"],[1,"table-header"],[4,"ngVar"],["class","row-group-header ui-widget-header",4,"ngIf"],[1,"row-group-header","ui-widget-header"],["colspan","8",1,"py-0"],[1,"d-flex","justify-content-between","py-2"],[1,"d-inline-flex","align-items-center","pointer",3,"pRowToggler"],[1,"icono-primario","mr-1",3,"ngClass"],[1,"mr-2"],[1,"center","d-inline-flex"],[1,"estatus",3,"ngClass","title"],["type","button","title","Ver Actividad",1,"btn",3,"click"],[1,"fa","fa-lg","fa-eye","icono-primario"],[1,"center"],[1,"text-center","px-0",2,"border-left","1px solid #BDC3C7 !important"],["type","button","title","Liberar Actividad",1,"btn",3,"disabled","click"],[1,"fa","fa-lg","fa-check-circle","icono-primario"],["type","button","title","Ver Flujo de Seguimiento",1,"btn",3,"click"],[1,"fa","fa-lg","fa-info-circle","icono-primario"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div"),t._uU(3),t.qZA()(),t.TgZ(4,"div",2)(5,"div",3)(6,"div",4)(7,"div",5),t._uU(8,"Detalles"),t.qZA()(),t.TgZ(9,"div",4)(10,"div",6),t.YNc(11,Nt,5,2,"p-table",7),t.qZA()()()(),t.TgZ(12,"div",8)(13,"div",9)(14,"button",10),t.NdJ("click",function(){return a.regresar()}),t._uU(15,"Regresar"),t.qZA()()()()),2&e&&(t.xp6(3),t.hij("Visor de Proyecto ",a.nombreProyecto,""),t.xp6(8),t.Q6J("ngIf",a.actividades))},dependencies:[A.mk,A.O5,J.iA,At.jx,J.jB,A.uU,bt.a],styles:[".excel[_ngcontent-%COMP%]{color:#217346}.word[_ngcontent-%COMP%]{color:#2b579a}.powerpoint[_ngcontent-%COMP%]{color:#b7472a}.pdf[_ngcontent-%COMP%]{color:#b30b00}.upload[_ngcontent-%COMP%]{color:#33b64c}.notUpload[_ngcontent-%COMP%]{color:#e53b3b}.estatus[_ngcontent-%COMP%]{background-repeat:no-repeat;aspect-ratio:1/1;width:15px}.botones-icono[_ngcontent-%COMP%]{border:none;background-color:#fff}.contenedor-derecha[_ngcontent-%COMP%]{display:flex;justify-content:end;align-items:center}[_ngcontent-%COMP%]:ng-deep   .ui-table-caption[_ngcontent-%COMP%]{padding:0!important;background-color:#fff!important;border:none!important}  .primeng-table .ui-state-highlight{background-color:#deebf7!important;color:#000!important}.primeng-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%], .primeng-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%], .primeng-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .primeng-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border:none!important;font-family:Roboto,Segoe UI,sans-serif;font-size:13px}.primeng-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .primeng-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-top:3px;padding-bottom:3px}.primeng-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:13px}.primeng-table[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%] > th[_ngcontent-%COMP%]{color:#0000008a;background-color:#fff;font-weight:600}.primeng-table[_ngcontent-%COMP%]   .row-group-header[_ngcontent-%COMP%]{font-weight:700}.primeng-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-top:1px solid #bdc3c7!important;border-bottom:1px solid #bdc3c7!important}.primeng-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:not(.ui-state-highlight):nth-child(even){background-color:#ededed!important}.primeng-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:not(.ui-state-highlight):hover{background-color:#fff2cc!important}.center[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}td[_ngcontent-%COMP%]   button.btn[_ngcontent-%COMP%]{padding:0 3px;margin:0 3px}"]})}const St=[{path:"",redirectTo:"consultar",pathMatch:"full"},{path:"",data:{title:"Proyectos"},children:[{path:"",component:U,canActivate:[E.m],data:{title:"Consulta",acceso:_._v.Consultar}},{path:"agregar",component:x.j,canActivate:[E.m],data:{title:"Alta",acceso:_._v.Agregar}},{path:"editar",component:x.j,canActivate:[E.m],data:{title:"Modificar",acceso:_._v.Editar}},{path:"ver",component:I,canActivate:[E.m],data:{title:"Ver",acceso:_._v.Consultar}}]}];class Z{static#t=this.\u0275fac=function(e){return new(e||Z)};static#e=this.\u0275mod=t.oAB({type:Z});static#o=this.\u0275inj=t.cJS({imports:[y.Bz.forChild(St),y.Bz]})}var Ft=i(83083),Dt=i(18145),Lt=i(45679),Gt=i(80529);class b{constructor(o){this.http=o,this.dataUrl="ProyectoActividadParticipante/"}consultarTodosParaSelector(){return this.http.get(this.dataUrl+"consultarTodosParaSelector")}consultar(o){return this.http.get(this.dataUrl+`consultar/${o}`)}consultarGeneral(o){return this.http.get(this.dataUrl+`consultarGeneral/${o}`)}agregar(o){return this.http.post(this.dataUrl+"agregar",o)}editar(o){return this.http.put(this.dataUrl+"editar",o)}eliminar(o){return this.http.delete(this.dataUrl+`eliminar/${o}`)}actualizar(o){return this.http.post(this.dataUrl+"actualizar",o)}static#t=this.\u0275fac=function(e){return new(e||b)(t.LFG(Gt.eN))};static#e=this.\u0275prov=t.Yz7({token:b,factory:b.\u0275fac})}var Rt=i(28231),Yt=i(38500),jt=i(5955),Jt=i(74369),wt=i(92237),zt=i(59241),Vt=i(98520),$t=i(13024),Kt=i(50012),Qt=i(86211),Wt=i(92020);class N{static#t=this.\u0275fac=function(e){return new(e||N)};static#e=this.\u0275mod=t.oAB({type:N});static#o=this.\u0275inj=t.cJS({providers:[Ft.c,H.N,W.L,Q.p,K.M,$.j,jt.W,V.F,Dt.w,Lt.C,b,Y.E,j.V,Qt.q,Rt.d,L.X,Yt.f,B.X],imports:[w.m,Z,n.a,v.xc,h.A0,l.Z,m.zk.forChild(),z.kn,X.w,Jt.E,wt.m,zt.P4,Vt.G,$t.u,Kt.M,G.TU,R.f,Wt.A]})}}}]);