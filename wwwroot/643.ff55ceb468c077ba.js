"use strict";(self.webpackChunkroadis_app=self.webpackChunkroadis_app||[]).push([[643],{13719:(_,h,t)=>{t.d(h,{X:()=>s});var p=t(94650),l=t(80529);class s{constructor(a){this.http=a,this.dataUrl="examen/"}consultarTodosParaSelector(){return this.http.get(this.dataUrl+"consultarTodosParaSelector")}consultar(a){return this.http.get(this.dataUrl+`consultar/${a}`)}consultarGeneral(a){return this.http.get(this.dataUrl+`consultarGeneral/${a}`)}agregar(a){return this.http.post(this.dataUrl+"agregar",a)}editar(a){return this.http.put(this.dataUrl+"editar",a)}eliminar(a){return this.http.delete(this.dataUrl+`eliminar/${a}`)}actualizar(a){return this.http.post(this.dataUrl+"actualizar",a)}consultarMisExamenes(){return this.http.get(this.dataUrl+"consultarMisExamenes")}consultarExamenesPendientesAsignados(){return this.http.get(this.dataUrl+"misExamenesAsignados")}consultarExamenesContestadosAsignados(){return this.http.get(this.dataUrl+"misExamenesAsignados/contestados")}consultarExamenesVencidosAsignados(){return this.http.get(this.dataUrl+"misExamenesAsignados/vencidos")}consultarMiExamen(a){return this.http.get(this.dataUrl+`consultarMiExamen/${a}`)}consultarMiExamenIndividual(a){return this.http.get(this.dataUrl+`consultarMiExamenIndividual/${a}`)}consultarCalificaciones(a){return this.http.get(this.dataUrl+`consultarCalificaciones/${a}`)}descargarRespuestasPDF(a){return this.http.post(this.dataUrl+`descargarExamenPdf/${a}`,{},{responseType:"blob"})}static#e=this.\u0275fac=function(g){return new(g||s)(p.LFG(l.eN))};static#t=this.\u0275prov=p.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}},94183:(_,h,t)=>{t.d(h,{F:()=>s});var p=t(94650),l=t(80529);class s{constructor(a){this.http=a,this.dataUrl="programacionExamen/"}consultarTodosParaSelector(){return this.http.get(this.dataUrl+"consultarTodosParaSelector")}consultar(a){return this.http.get(this.dataUrl+`consultar/${a}`)}consultarGeneral(){return this.http.get(this.dataUrl+"consultarGeneral")}agregar(a){return this.http.post(this.dataUrl+"agregar",a)}editar(a){return this.http.put(this.dataUrl+"editar",a)}eliminar(a){return this.http.delete(this.dataUrl+`eliminar/${a}`)}static#e=this.\u0275fac=function(g){return new(g||s)(p.LFG(l.eN))};static#t=this.\u0275prov=p.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}},86990:(_,h,t)=>{t.d(h,{q:()=>s});var p=t(94650),l=t(80529);class s{constructor(a){this.http=a,this.dataUrl="TipoExamen/"}consultarTodosParaSelector(){return this.http.get(this.dataUrl+"consultarTodosParaSelector")}consultar(a){return this.http.get(this.dataUrl+`consultar/${a}`)}consultarGeneral(){return this.http.get(this.dataUrl+"consultarGeneral")}agregar(a){return this.http.post(this.dataUrl+"agregar",a)}editar(a){return this.http.put(this.dataUrl+"editar",a)}eliminar(a){return this.http.delete(this.dataUrl+`eliminar/${a}`)}static#e=this.\u0275fac=function(g){return new(g||s)(p.LFG(l.eN))};static#t=this.\u0275prov=p.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}},70312:(_,h,t)=>{t.d(h,{X:()=>p});class p{constructor(){}}},12846:(_,h,t)=>{t.d(h,{Y:()=>u});var p=t(50986),l=t(94650),s=t(2060);class u{constructor(g){this.modalMensajeService=g}validarCamposRequeridos(g){Object.keys(g.controls).forEach(E=>{const x=g.controls[E];x.markAsTouched({onlySelf:!0}),x.markAsDirty({onlySelf:!0})})}validarCamposRequeridosConMensaje(g){Object.keys(g.controls).forEach(E=>{const x=g.controls[E];x.markAsTouched({onlySelf:!0}),x.markAsDirty({onlySelf:!0})}),Object.keys(g.controls).some(E=>{const x=g.controls[E];return!!(x.errors&&x.errors.required&&x.invalid)&&(this.modalMensajeService.modalError(p.g.MENSAJE_REQUERIDOS),!0)})}markAsUntouched(g){Object.keys(g.controls).forEach(E=>{g.controls[E].markAsUntouched({onlySelf:!0})})}static#e=this.\u0275fac=function(E){return new(E||u)(l.LFG(s.V))};static#t=this.\u0275prov=l.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})}},40675:(_,h,t)=>{t.d(h,{V_:()=>l,aQ:()=>u,vf:()=>s});var l,a;t(40675);(a=l||(l={})).Agregar="Agregar",a.Editar="Editar",a.Ver="Consultar";const s="Seleccione una opci\xf3n",u="No hay opciones disponibles"},14815:(_,h,t)=>{var p,l;t.d(h,{m:()=>p}),(l=p||(p={})).Cruz="fa fa-times",l.Pesos="fa fa-dollar-sign",l.Cambio="fas fa-exchange-alt",l.CheckOut="fas fa-door-open",l.Exito="fas fa-check"},94540:(_,h,t)=>{t.d(h,{gy:()=>l,sO:()=>s});var l,u;t(94540);(u=l||(l={})).Editar="edit",u.Eliminar="delete",u.Ver="see",u.DescargarPdf="DescargarPdf",u.Revisar="Revisar",u.Presentar="presentar";const s={headerName:"",field:"",cellClass:"center-ag",minWidth:44,maxWidth:44,suppressMovable:!0,resizable:!1,filter:!1,lockPinned:!0,pinned:"right",lockPosition:!0}},5918:(_,h,t)=>{t.d(h,{D:()=>v});var p=t(70312);class l{constructor(){}}var s=t(40675),u=t(94540),a=t(39841),g=t(54482),E=t(75797),x=t(83268),U=t(89635),O=t(63269);function T(...d){const r=(0,O.jO)(d);return r?(0,U.z)(T(...d),(0,x.Z)(r)):(0,g.e)((n,i)=>{(0,a.l)([n,...(0,E.k)(d)])(i)})}function D(...d){return T(...d)}var A=t(95577),L=t(90429),Z=t(50986),e=t(94650),F=t(21006),y=t(13719),R=t(12846),S=t(2060),N=t(94183),J=t(9116),G=t(86990),I=t(46558),W=t(36895),f=t(24006),Y=t(58390),K=t(88796),b=t(90061),j=t(383);function Q(d,r){1&d&&(e.TgZ(0,"div",32),e._uU(1," El tipo de cuestionario es requerido "),e.qZA())}function q(d,r){1&d&&(e.TgZ(0,"div",32),e._uU(1," La fecha inicial es requerida "),e.qZA())}function H(d,r){1&d&&(e.TgZ(0,"div",32),e._uU(1," La fecha final es requerida "),e.qZA())}function z(d,r){1&d&&(e.TgZ(0,"div",32),e._uU(1," La duraci\xf3n es requerida "),e.qZA())}function B(d,r){if(1&d){const n=e.EpF();e.TgZ(0,"div",6)(1,"div",33)(2,"app-grid-general",34,35),e.NdJ("event",function(o){e.CHM(n);const c=e.oxw(2);return e.KtG(c.onGridClick(o))}),e.qZA()()()}if(2&d){const n=e.oxw(2);e.xp6(2),e.Q6J("headerName",n.HEADER_GRID)("data",n.examenList)("children",n.columns)("disableDelete",!0)("disableEdit",!0)}}function V(d,r){if(1&d){const n=e.EpF();e.TgZ(0,"form",3,4),e.NdJ("keydown.enter",function(o){return o.preventDefault()})("ngSubmit",function(){e.CHM(n);const o=e.MAs(1),c=e.oxw();return e.KtG(c.enviarFormulario(o))}),e.TgZ(2,"div",5)(3,"div",6)(4,"div",7)(5,"div",8)(6,"label",9),e._uU(7,"M\xf3dulo y Subm\xf3dulo"),e.qZA(),e.TgZ(8,"div")(9,"input",10,11),e.NdJ("ngModelChange",function(o){e.CHM(n);const c=e.oxw();return e.KtG(c.programacionExamen.elementoTecnica=o)}),e.qZA()()()(),e.TgZ(11,"div",7)(12,"div",8)(13,"label",9),e._uU(14,"Tema de Capacitaci\xf3n"),e.qZA(),e.TgZ(15,"div")(16,"input",12,11),e.NdJ("ngModelChange",function(o){e.CHM(n);const c=e.oxw();return e.KtG(c.programacionExamen.temaCapacitacion=o)}),e.qZA()()()(),e.TgZ(18,"div",7)(19,"div",8)(20,"label",9),e._uU(21,"Evaluaci\xf3n"),e.qZA(),e.TgZ(22,"div")(23,"ng-select",13,14),e.NdJ("ngModelChange",function(o){e.CHM(n);const c=e.oxw();return e.KtG(c.programacionExamen.idTipoExamen=o)})("ngModelChange",function(){e.CHM(n);const o=e.oxw();return e.KtG(o.actualizarDuracion())}),e.qZA()(),e.YNc(25,Q,2,0,"div",15),e.qZA()()(),e.TgZ(26,"div",6)(27,"div",16)(28,"div",8)(29,"label",9),e._uU(30,"Fecha Inicial"),e.qZA(),e.TgZ(31,"div",17)(32,"input",18,19),e.NdJ("ngModelChange",function(o){e.CHM(n);const c=e.oxw();return e.KtG(c.programacionExamen.fechaExamen=o)}),e.qZA(),e._UZ(34,"i",20),e.qZA(),e.YNc(35,q,2,0,"div",15),e.qZA()(),e.TgZ(36,"div",16)(37,"div",8)(38,"label",9),e._uU(39,"Fecha Final"),e.qZA(),e.TgZ(40,"div",17)(41,"input",18,21),e.NdJ("ngModelChange",function(o){e.CHM(n);const c=e.oxw();return e.KtG(c.programacionExamen.fechaTermino=o)}),e.qZA(),e._UZ(43,"i",20),e.qZA(),e.YNc(44,H,2,0,"div",15),e.qZA()(),e.TgZ(45,"div",16)(46,"div",8)(47,"label",9),e._uU(48,"Duraci\xf3n (minutos)"),e.qZA(),e.TgZ(49,"div")(50,"input",22,23),e.NdJ("ngModelChange",function(o){e.CHM(n);const c=e.oxw();return e.KtG(c.programacionExamen.duracion=o)}),e.qZA()(),e.YNc(52,z,2,0,"div",15),e.qZA()()(),e.TgZ(53,"div",6)(54,"div",16)(55,"div",8)(56,"label",9),e._uU(57,"Usuario Responsable"),e.qZA(),e.TgZ(58,"div")(59,"input",24,25),e.NdJ("ngModelChange",function(o){e.CHM(n);const c=e.oxw();return e.KtG(c.programacionExamen.usuarioResponsable=o)}),e.qZA()()()()(),e.YNc(61,B,4,5,"div",26),e.qZA(),e.TgZ(62,"div",6)(63,"div",16)(64,"button",27),e._uU(65," Consultar Evaluaci\xf3n "),e.qZA()()(),e.TgZ(66,"div",28)(67,"div",29)(68,"button",30),e.NdJ("click",function(){e.CHM(n);const o=e.oxw();return e.KtG(o.cancelar())}),e._uU(69," Cancelar "),e.qZA(),e.TgZ(70,"button",31),e._uU(71," Guardar Evaluaci\xf3n del Tema "),e.qZA()()()()}if(2&d){const n=e.MAs(24),i=e.MAs(33),o=e.MAs(42),c=e.MAs(51),m=e.oxw();e.xp6(9),e.Q6J("ngModel",m.programacionExamen.elementoTecnica)("disabled",!0),e.xp6(7),e.Q6J("ngModel",m.programacionExamen.temaCapacitacion)("disabled",!0),e.xp6(7),e.Q6J("items",m.tipoExamenList)("required",!0)("ngModel",m.programacionExamen.idTipoExamen)("placeholder",m.DROPDOWN_PLACEHOLDER)("notFoundText",m.DROPDOWN_NO_OPTIONS),e.xp6(2),e.Q6J("ngIf",(null==n.errors?null:n.errors.required)&&n.touched),e.xp6(7),e.Q6J("ngModel",m.programacionExamen.fechaExamen)("required",!0)("bsConfig",m.configDate),e.xp6(3),e.Q6J("ngIf",(null==i.errors?null:i.errors.required)&&i.touched),e.xp6(6),e.Q6J("ngModel",m.programacionExamen.fechaTermino)("required",!0)("bsConfig",m.configDate),e.xp6(3),e.Q6J("ngIf",(null==o.errors?null:o.errors.required)&&o.touched),e.xp6(6),e.Q6J("ngModel",m.programacionExamen.duracion)("required",!0)("disabled",!0),e.xp6(2),e.Q6J("ngIf",(null==c.errors?null:c.errors.required)&&c.touched),e.xp6(7),e.Q6J("ngModel",m.programacionExamen.usuarioResponsable)("disabled",!0),e.xp6(2),e.Q6J("ngIf",m.examenList.length>0),e.xp6(3),e.Q6J("disabled",m.submitting),e.xp6(6),e.Q6J("disabled",m.submitting)}}function $(d,r){1&d&&(e.TgZ(0,"div",36),e._UZ(1,"img",37),e.TgZ(2,"span"),e._uU(3,"Procesando... por favor espere"),e.qZA()())}class v{constructor(r,n,i,o,c,m,C,w){this.encryptionService=r,this.examenService=n,this.formularioService=i,this.mensajeService=o,this.programacionExamenService=c,this.router=m,this.tipoExamenService=C,this.usuarioService=w,this.programacionExamen=new l,this.submitting=!1,this.DROPDOWN_PLACEHOLDER=s.vf,this.DROPDOWN_NO_OPTIONS=s.aQ,this.usuarioList=[],this.tipoExamenList=[],this.examenList=[],this.esEdicion=!1,this.participantes=[],this.HEADER_GRID="Ex\xe1menes",this.configDate=Z.g.CONFIG_DATEPICKER,this.COLUMNA_DETALLE=Object.assign({action:u.gy.Ver,cellRendererSelector:M=>null!=M.data.resultado?{component:"actionButton",params:{disabled:!1}}:"",minWidth:44,maxWidth:44},u.sO),this.COLUMNA_DESCARGAR_PDF=Object.assign({action:u.gy.DescargarPdf,cellRendererSelector:M=>null!=M.data.resultado?{component:"actionButton",params:{disabled:!1}}:"",minWidth:44,maxWidth:44},u.sO),this.columns=[{headerName:"Participantes",field:"nombreUsuario",minWidth:200,width:200},{headerName:"Resultado",field:"resultado",minWidth:70,width:70},{headerName:"Preguntas Correctas",field:"preguntasCorrectas",minWidth:70,width:70},this.COLUMNA_DETALLE,this.COLUMNA_DESCARGAR_PDF]}ngOnInit(){this.consultarUsuarios(),this.consultarTipoExamen(),this.programacionExamen.participantes=[],this.accion===s.V_.Agregar?(this.programacionExamen.fechaAlta=new Date,this.programacionExamen.estatus=!0,this.programacionExamen.idProyectoElementoTecnica=this.idProyectoElementoTecnica,this.programacionExamen.idProgramacionExamen=this.idProgramacionExamen,this.programacionExamen.idProyectoActividad=this.idProyectoActividad,this.programacionExamen.idUsuarioResponsable=this.idUsuarioResponsable,this.programacionExamen.usuarioResponsable=this.usuarioResponsable,this.programacionExamen.elementoTecnica=this.elementoTecnica,this.programacionExamen.temaCapacitacion=this.temaCapacitacion):this.accion===s.V_.Editar&&this.consultarProgramacionExamen(this.idProgramacionExamen)}consultarProgramacionExamen(r){const n=this.programacionExamenService.consultar(r),i=this.examenService.consultarCalificaciones(r);n.pipe(D(i)).subscribe(([o,c])=>{const m=c.map(C=>C.idUsuarioParticipante);o.participantes=m,o.fechaExamen=new Date(o.fechaExamen),o.fechaAlta=new Date(o.fechaAlta),this.examenList=c,this.programacionExamen=o})}consultarUsuarios(){this.usuarioService.consultarGeneral().subscribe(r=>{this.usuarioList=r.filter(n=>n.habilitado)})}consultarTipoExamen(){this.tipoExamenService.consultarTodosParaSelector().subscribe(r=>{this.tipoExamenList=r})}onGridClick(r){r.accion===u.gy.Ver&&this.revisar(r.data.idExamen),r.accion===u.gy.DescargarPdf&&this.descargarRespuestasPdf(r.data.idExamen,this.programacionExamen.clave,r.data.nombreUsuario)}enviarFormulario(r){if(this.submitting=!0,!r.valid)return this.formularioService.validarCamposRequeridos(r),void(this.submitting=!1);this.accion===s.V_.Agregar?this.agregar():this.accion===s.V_.Editar&&this.editar()}agregar(){this.programacionExamenService.agregar(this.programacionExamen).pipe((0,A.z)(n=>(this.idProgramacionExamen=n,this.passToList(),this.examenService.actualizar(this.examenList)))).subscribe({next:n=>{this.mensajeService.modalExito("La programaci\xf3n de la Evaluaci\xf3n ha sido agregada"),this.onClose(!0)},error:n=>{this.submitting=!0}})}editar(){this.programacionExamenService.editar(this.programacionExamen).pipe((0,A.z)(n=>(this.passToList(),this.examenService.actualizar(this.examenList)))).subscribe({next:n=>{this.mensajeService.modalExito("La programaci\xf3n de examen ha sido modificada"),this.onClose(!0)},error:n=>{this.submitting=!0}})}cancelar(){this.onClose(!0)}passToList(){const r=this.examenList.map(n=>n.idUsuarioParticipante);for(const n of this.programacionExamen.participantes){if(r.includes(n))continue;const i=new p.X;i.idProgramacionExamen=this.idProgramacionExamen,i.idUsuarioParticipante=n,i.idEstatusExamen=1,i.fechaAlta=new Date,i.estatus=!0,this.examenList.push(i)}}actualizarDuracion(){null!=this.programacionExamen.idTipoExamen&&0!=this.programacionExamen.idTipoExamen&&this.tipoExamenService.consultar(this.programacionExamen.idTipoExamen).subscribe(r=>{this.programacionExamen.duracion=r.duracion})}revisar(r){this.cancelar(),this.examenService.consultarMiExamenIndividual(r).subscribe(n=>{this.router.navigate(["/administrador/encuesta/examen/presentar"],{queryParams:this.encryptionService.generateURL({i:r.toString(),revision:"1"})})})}descargarRespuestasPdf(r,n,i){this.examenService.descargarRespuestasPDF(r).subscribe(o=>{const c=document.createElement("a"),m=URL.createObjectURL(o);c.href=m,c.download=L.LD("Respuestas_"+n+"_"+i,"pdf"),c.click(),URL.revokeObjectURL(m)})}static#e=this.\u0275fac=function(n){return new(n||v)(e.Y36(F.C),e.Y36(y.X),e.Y36(R.Y),e.Y36(S.V),e.Y36(N.F),e.Y36(J.F0),e.Y36(G.q),e.Y36(I.i))};static#t=this.\u0275cmp=e.Xpm({type:v,selectors:[["app-programacionExamen-formulario"]],inputs:{participantes:"participantes"},decls:4,vars:2,consts:[[3,"titulo"],["modalBody",""],["id","loading-cdis",4,"ngIf"],["novalidate","novalidate",3,"keydown.enter","ngSubmit"],["formulario","ngForm"],["id","modal",1,"modal-body",2,"overflow","visible"],[1,"row"],[1,"col-md-4"],[1,"form-group"],[1,"label-input","required-label"],["name","elementoTecnica","type","text","autocomplete","off","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["clave","ngModel"],["name","temaCapacitacion","type","text","autocomplete","off","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","tipoExamenLstName","bindLabel","nombre","bindValue","idTipoExamen",3,"items","required","ngModel","placeholder","notFoundText","ngModelChange"],["tipoExamenLst","ngModel"],["class","error",4,"ngIf"],[1,"col-md-3"],[1,"date-input-container"],["type","text","autocomplete","off","placeholder","dd/mm/aaaa","name","fechaExamenName","bsDatepicker","",1,"form-control",3,"ngModel","required","bsConfig","ngModelChange"],["fechaExamenName","ngModel"],[1,"fa-regular","fa-calendar-days","ml-auto"],["fechaFinalName","ngModel"],["name","duracion","type","number",1,"form-control",3,"ngModel","required","disabled","ngModelChange"],["duracion","ngModel"],["name","usuarioResponsab\xf1e","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["usuarioResponsable","ngModel"],["class","row",4,"ngIf"],["type","submit",1,"btn-primario","btn-margin-left",3,"disabled"],[1,"modal-footer"],[1,"d-flex","justify-content-center","w-100"],["type","button",1,"btn","btn-secundario","mr-3",3,"click"],["type","submit",1,"btn","btn-primario",3,"disabled"],[1,"error"],[1,"col-md-12"],[3,"headerName","data","children","disableDelete","disableEdit","event"],["gridNecesidad",""],["id","loading-cdis"],["src","assets/img/spinner.gif","alt","Procesando..."]],template:function(n,i){1&n&&(e.TgZ(0,"app-modal-base",0),e.YNc(1,V,72,27,"ng-template",null,1,e.W1O),e.YNc(3,$,4,0,"div",2),e.qZA()),2&n&&(e.Q6J("titulo","Programaci\xf3n de Evaluaci\xf3n - "+i.accion),e.xp6(3),e.Q6J("ngIf",i.submitting))},dependencies:[W.O5,f._Y,f.Fj,f.wV,f.JJ,f.JL,f.Q7,f.On,f.F,Y.$,K.w9,b.Np,b.Y5,j.B],styles:[".cuerpo-contenedor[_ngcontent-%COMP%]{padding-left:1em;padding-right:1em}.preguntaTextArea[_ngcontent-%COMP%]{height:5em!important}.respuestaTextArea[_ngcontent-%COMP%]{height:9em!important}.btn-cargar[_ngcontent-%COMP%]{background-color:#92d050;border:0px;color:#000;margin-top:4em;font-weight:400}.date-input-container[_ngcontent-%COMP%]{position:relative;width:100%}.date-input-container[_ngcontent-%COMP%]   input[type=date][_ngcontent-%COMP%]{width:100%;padding-right:30px}.date-input-container[_ngcontent-%COMP%]   .fa-calendar-days[_ngcontent-%COMP%]{position:absolute;right:10px;top:50%;transform:translateY(-50%);pointer-events:none}"]})}}}]);